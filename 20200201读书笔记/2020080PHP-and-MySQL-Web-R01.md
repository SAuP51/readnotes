## 记忆时间

## 卡片

### 0101. 反常识卡——

这本书的主题核心，就是最大的反常识卡，并且注意时间脉络。

#### 01. 常识

#### 02. 反常识

#### 03. 知识来源

比如提出者，如何演化成型的；书或专栏具体出现的地方。

#### 04. 例子

### 0201. 术语卡——

根据反常识，再补充三个证据——就产生三张术语卡。

例子。

### 0202. 术语卡——

### 0203. 术语卡——

### 0301. 人名卡——Luke Welling

Luke Welling

Laura Thomson

根据这些证据和案例，找出源头和提出术语的人是谁——产生一张人名卡，并且分析他为什么牛，有哪些作品，生平经历是什么。

维基百科链接：有的话。

#### 01. 基本信息

本书的作者，PHP 以及 web 开发的大牛。

#### 02. 贡献及著作


### 0401. 金句卡——

最后根据他写的非常震撼的话语——产生一张金句卡。

### 0501. 行动卡——

行动卡是能够指导自己的行动的卡。

### 0601. 任意卡——

最后还有一张任意卡，记录个人阅读感想。

## 模板

### 1. 逻辑脉络

用自己的话总结主题，梳理逻辑脉络，也就是这本书整个地图里这一章所在的节点。

### 2. 摘录及评论

1『自己的观点』

2『行动指南』

3『与其他知识的连接』

英文第 5 版的出版时间：2016 年 9 月

## 书评

### 02

为了备战面试：我没有考上理想的研究院，就业的压力再一次摆在了我的面前。记得当初做毕业设计使用的 asp.net2.0 技术，发现网上已经开始使用 3.0+ 了。而且又在网上看到，说用 .net 做网站的程序员挣不了多少钱。再加上，我也不太喜欢 visual studio（我讨厌自动生成模板，就像《程序员修炼之道》中‘邪恶的向导’所提到的一样）。这时，我想到了另一种语言 php（大学没接触 jsp 或是什么别的语言了）。那是距离我规定的找工作时间还有一个多月，我又一次拿出了这本书，开始从头看起。书的内容不用说自然是一本好书，从最简单的 php 标记开始讲起，然后的变量，逻辑，操作符，读写文件，使用数组，正则表达式，处理字符串，最后的面向对象的基本支持。讲完 php 后开始教授 mysql，然后是一些我认为的废话（电子商务与安全性），再然后的一些进阶的 php 知识，包括文件上传，网络函数，日期管理，创建图片，会话控制等，最后是一大堆的实例。因为时间的关系，我实现了购物车功能的那个实例（当时看到了 500 页）就急匆匆的开始投简历去了。

小小的打击： 记得当时面试 ZOL 时我还特意拿着这本书，面试官看我没有任何的工作经验，就把我叫到了一旁，问我：你虽然没有工作经验，但公司很喜欢你身上那种精神，你和另外两位已经进入了最后一轮面试。当时真没想到自己会这么幸运。我们三个人进入了一个小小的房间，面试官是 cto。在几个试探性的问题后，他看出了我的技术经验不足，从他的眼神中我看到，他想给我机会，但是我还不能达到他的目标。他看了我一眼，说：好吧，我问大家最后一个问题。如果我想用 mysql 降序排列一组数据，我该如何办？ 他手指指向我，让我第一个回答，显然这个问题对于另外两个人实在是太简单了。他希望通过我回答出这个问题，给我一次在这里工作的机会。我想了一下，说： 用 select top 然后跟。。。。他打断了我，并让另外两个人回答。显然我的答案是错的。就这样我的第一次面试失败了。出来后我翻遍了一整本书都没有找到为什么不能用 top（我把 mysql 和 sqlserver 记混了）。这件事情告诉我，学习任何技术一定要踏实，在去尝试新技术之前，应该熟练掌握已学习的知识。让他们变得更加的扎实！

遗忘： 我运气好，没经过太多波折就找到了一份工作，在那里干了二年三个月的时间。工作的压力让我淡忘了自己对 php 基础知识的不足。更多的时间拖入到跟框架有关的工作中，也没有在意自己的底子是不是扎实。那时候就想说，把工作任务先完成，书以后再学。就这样，两年的时间一下子就过去了。

重逢： 当我再次拿起他的时候，已经是我决定要离开第一家公司的时候。我希望可以去更加有发展的公司，但我也想起了第一次面试留给我的惨痛的经验教训。我现在应该把基础打牢！ 所以我再一次从书柜里面拿出了他。再一次从第一页开始读起，不管内容多么简单，我也认真的学习。虽然现在看来，后面的实例已经显得不那么实用，传授的知识也是很基础的，但是每当我翻开他的时候，看到的不仅仅是一个个知识点，更多的是当时学习 php 时的自己的模样。

### 03

[PHP和MySQL Web应用开发核心技术（Core Web Application Development with PHP and MySQL）](https://book.douban.com/subject/1824542/)

上面这个链接的书名字叫《PHP 和 MySQL Web 应用开发核心技术》（以后我们简称「web 核心」），不管是名字还是书皮都跟这本书非常像，如果你都读过的话，会感觉里面的章节安排也是非常像的。我评论的这本书（以后简称「web 开发」，和「web 核心」区分开）由于被他的「圣经」光环所笼罩，所以当我拿到「web 核心」这本书的时候，感觉他其实就是在抄袭「web 开发」，不值得去阅读，但是当我有一次无意读了他其中的某些章节的时候，我感觉「web 核心」比「web 开发」更胜一筹，具体哪里更好，我现在已经无法细数了，现在只是留有印象：前者比后者讲的更清楚明白，项目开发中的经验讲的更多，新技术新思想也涉及的更多等等。

如果还要深入研究的话，上面两本书都不够，推荐下面这本书，PHP 5 权威编程：[PHP 5权威编程](https://book.douban.com/subject/2981954/)。里面的代码优化和扩展开发部分对想深入学习的人非常有用！

2『以下载原文书籍「2020087Core_Web_Application_Development_with_」以及「2020090PHP5_Power_Programming」。』

### 06

《PHP 和 MySQL Web 开发》（SAMS）风格类似散文，精髓就是形散神不散，牢牢抓住「web 开发」的主旨，粗看前两篇（记得是 1-14 章）会让人感觉「东一榔头西一棒」，提了下显示动态内容，即刻就带到使用函数。这粗看让人觉得有些乱，但实际上这种写作风格却更好的体现了本书作者的思想，他把实践看的很重，所以几乎每篇每节都是围绕一个实例在做诠释，而因此本书的精髓则在后三篇。但正如上面一位老师说的，它没有详细的函数说明。

《PHP 与 MySQL 5 程序设计》（Apress）则是「说明文」，详细严谨的逐步解释每个概念，本书的读者能够了解并熟悉 php 和 mysql 技术中的各个细节，这非常适合刚入门的初学者，甚至你无需了解更多的相关内容（如 asp，c 语言）就能够看懂本书。而讲到的各个细节，则是说本书对函数做了大篇幅的说明，这是本书的一个特色。

## 前言

Welcome to PHP and MySQL Web Development. Within its pages, you will find distilled knowledge from our experiences using PHP and MySQL, two of the most important and widely used web development tools around. Key topics covered in this introduction include: 1) Why you should read this book. 2) What you will be able to achieve using this book. 3) What PHP and MySQL are and why they’re great. 4) What’s changed in the latest versions of PHP and MySQL. 5) How this book is organized.

Why You Should Read This Book. This book will teach you how to create interactive web applications from the simplest order form through to complex, secure web applications. What’s more, you’ll learn how to do it using open-source technologies. We wrote the first edition of this book because we were tired of finding PHP books that were basically function references. These books are useful, but they don’t help when your boss or client has said,「Go build me a shopping cart.」In this book, we have done our best to make every example useful. You can use many of the code samples directly in your website, and you can use many others with only minor modifications.

What You Will Learn from This Book. Reading this book will enable you to build real-world, dynamic web applications. If you’ve built websites using plain HTML, you realize the limitations of this approach. Static content from a pure HTML website is just that — static. It stays the same unless you physically update it. Your users can’t interact with the site in any meaningful fashion. Using a language such as PHP and a database such as MySQL allows you to make your sites dynamic: to have them be customizable and contain real-time information.

1『使用「PHP and a database」可以实现动态网页。』

We have deliberately focused this book on real-world applications, even in the introductory chapters. We begin by looking at simple systems and work our way through the various parts of PHP and MySQL. We then discuss aspects of security and authentication as they relate to building a real-world website and show you how to implement these aspects in PHP and MySQL. We also introduce you to integrating front-end and back-end technologies by discussing JavaScript and the role it can play in your application development.

1『前端和后端技术的英文名找到了，「front-end」和「back-end」。』

In the final part of this book, we describe how to approach real-world projects and take you through the design, planning, and building of the following projects: 1) User authentication and personalization. 2) Web-based email. 3) Social media integration.

You should be able to use any of these projects as is, or you can modify them to suit your needs. We chose them because we believe they represent some the most common web  applications built by programmers. If your needs are different, this book should help you along the way to achieving your goals.

What Is PHP? PHP is a server-side scripting language designed specifically for the web. Within an HTML page, you can embed PHP code that will be executed each time the page is visited. Your PHP code is interpreted at the web server and generates HTML or other output that the visitor will see.

1『PHP 是服务端的脚本语言，其代码是在服务器端解释完成的，然后以 HTML 的格式返回给客户端，比如浏览器。PHP 是开源的。』

PHP was conceived in 1994 and was originally the work of one man, Rasmus Lerdorf. It was adopted by other talented people and has gone through several major rewrites to bring us the broad, mature product we see today. According to Google’s Greg Michillie in May 2013, PHP ran more than three quarters of the world’s websites, and that number had grown to over 82% by July 2016. PHP is an open-source project, which means you have access to the source code and have the freedom to use, alter, and redistribute it. PHP originally stood for Personal Home Page but was changed in line with the GNU recursive naming convention (GNU = Gnu’s Not Unix) and now stands for PHP Hypertext Preprocessor.

The current major version of PHP is 7. This version saw a complete rewrite of the underlying Zend engine and some major improvements to the language. All of the code in this book has been tested and validated against the most recent release of PHP 7 at the time of writing, as well as the latest version in the PHP 5.6 family of releases, which is still officially supported.

What Is MySQL? MySQL (pronounced My-Ess-Que-Ell) is a very fast, robust, relational database management system (RDBMS). A database enables you to efficiently store, search, sort, and retrieve data. The MySQL server controls access to your data to ensure that multiple users can work with it concurrently, to provide fast access to it, and to ensure that only authorized users can obtain access. Hence, MySQL is a multiuser, multithreaded server. It uses Structured Query Language (SQL), the standard database query language. MySQL has been publicly available since 1996 but has a development history going back to 1979. It is the world’s most popular open-source database and has won the Linux Journal Readers’ Choice Award on a number of occasions.

1『数据库可以让我们非常有效的存储、搜索、排序和提取数据；数据能让很多人同访问数据，而且可以给让问的人设置不同的权限。』

Why Use PHP and MySQL? When setting out to build a website, you could use many different products. You need to choose the following: 1) Where to run your web servers: the cloud, virtual private servers, or actual hardware. 2) An operating system. 3) Web server software. 4) A database management system or other datastore. 5) A programming or scripting language.

You may end up with a hybrid architecture with multiple datastores. Some of these choices are dependent on the others. For example, not all operating systems run on all hardware, not all web servers support all programming languages, and so on. In this book, we do not pay much attention to hardware, operating systems, or web server software. We don’t need to. One of the best features of both PHP and MySQL is that they work with any major operating system and many of the minor ones.

The majority of PHP code can be written to be portable between operating systems and web servers. There are some PHP functions that specifically relate to the filesystem that are operating system dependent, but these are clearly marked as such in the manual and in this book. Whatever hardware, operating system, and web server you choose, we believe you should seriously consider using PHP and MySQL.

Some of PHP’s Strengths. Some of PHP’s main competitors are Python, Ruby (on Rails or otherwise), Node.js, Perl, Microsoft .NET, and Java. In comparison to these products, PHP has many strengths, including the following: 1) Performance. PHP is very fast. 2) Scalability. You can effectively and cheaply implement horizontal scaling with large numbers of commodity servers. 3) Database Integration. PHP has native connections available to many database systems. 4) Built-in Libraries. Because PHP was designed for use on the Web, it has many built-in functions for performing many useful web-related tasks. You can generate images on the fly, connect to web services and other network services, parse XML, send email, work with cookies, and generate PDF documents, all with just a few lines of code. 5) Cost. PHP is free. 6) Ease of Learning PHP. The syntax of PHP is based on other programming languages, primarily C and Perl. 7) Object-Oriented Support. 8) Portability. PHP is available for many different operating systems. 9) Flexibility of Development Approach. PHP allows you to implement simple tasks simply, and equally easily adapts to implementing large applications using a framework based on design patterns such as Model-View-Controller (MVC). 10) Source Code. 11) Availability of Support and Documentation. 

1『由于是针对 web 开发的语言，它内置的很多函数跟 web 相关，所以做这些任务就很方便，比如生成图片、连接网络服务、解析 XML、发送邮件、cookies 相关、生成 pdf 等。』

Key Features of PHP 7. In December 2015, the long-awaited PHP 7 release was made available to the public. As mentioned in this introduction, the book covers both PHP 5.6 and PHP 7, which might lead you to ask「what happened to PHP 6?」The short answer is: there is no PHP 6 and never was for the general public. There was a development effort around a codebase that was referred to as「PHP 6」but it never came to fruition; there were many ambitious plans and subsequent complications that made it difficult for the team to continue to pursue. PHP 7 is not PHP 6 and doesn’t include the features and code from that development effort; PHP 7 is its own release with its own focus — specifically a focus on performance.

Under the hood, PHP 7 includes a refactor of the Zend Engine that powers it, which resulted in a significant performance boost to many web applications — sometimes upwards of 100%! While increased performance and decreased memory use were key to the release of PHP 7, so was backward-compatibility. In fact, relatively few backward-incompatible language changes were introduced. These are discussed contextually throughout this book so that the chapters remain usable with PHP 5.6 or PHP 7, as widespread adoption of PHP 7 has not yet occurred by commercial web-hosting providers.

1『PHP6 没有实现，直接从 5.6 升级到了 7，7 对网页服务的性能提升很大。』

Some of MySQL’s Strengths. MySQL’s main competitors in the relational database space are PostgreSQL, Microsoft SQL Server, and Oracle. There is also a growing trend in the web application world toward use of NoSQL/non-relational databases such as MongoDB. Let’s take a look at why MySQL is still a good choice in many cases. MySQL has many strengths, including the following: 1) Performance. MySQL is undeniably fast. 2) Low Cost. 3) Ease of Use. 4) Portability. 5) Source Code. 6) Availability of Support. Not all open-source products have a parent company offering support, training, consulting, and certification, but you can get all of these benefits from Oracle.

1『非关系数据库的代表是 MongoDB；之前在书籍「2019025Learning_MySQL_and_MariaDB」里看到 MySQL 好像被谁收购了，怕会被限制商用，所以 Michael 开发了 MariaDB。』

How Is This Book Organized? This book is divided into five main parts:

Part I,「Using PHP」provides an overview of the main parts of the PHP language with examples. Each example is a real-world example used in building an e-commerce site rather than「toy」code. We kick off this section with Chapter 1,「PHP Crash Course.」If you’ve already used PHP, you can whiz through this chapter. If you are new to PHP or new to programming, you might want to spend a little more time on it.

Part II,「Using MySQL」discusses the concepts and design involved in using relational database systems such as MySQL, using SQL, connecting your MySQL database to the world with PHP, and advanced MySQL topics, such as security and optimization.

Part III,「Web Application Security」covers some of the general issues involved in developing a web application using any language. We then discuss how you can use PHP and MySQL to authenticate your users and securely gather, transmit, and store data.

Part IV,「Advanced PHP Techniques」offers detailed coverage of some of the major built-in functions in PHP. We have selected groups of functions that are likely to be useful when building a web application. You will learn about interaction with the server, interaction with the network, image generation, date and time manipulation, and session handling.

Part V,「Building Practical PHP and MySQL Projects」is our favorite section. It deals with practical real-world issues such as managing large projects and debugging, and provides sample projects that demonstrate the power and versatility of PHP and MySQL.

Finally. We hope you enjoy this book and enjoy learning about PHP and MySQL as much as we did when we first began using these products. They are really a pleasure to use. Soon, you’ll be able to join the many thousands of web developers who use these robust, powerful tools to easily build dynamic, real-time web applications.

## 01. PHP Crash Course

### 1. 逻辑脉络

用自己的话总结主题，梳理逻辑脉络，也就是这本书整个地图里这一章所在的节点。

### 2. 摘录及评论

This chapter gives you a quick overview of PHP syntax and language constructs. In this book, you’ll learn how to use PHP by working through lots of real-world examples taken from our experiences building real websites. Often, programming textbooks teach basic syntax with very simple examples. We have chosen not to do that. We recognize that what you do is get something up and running, and understand how the language is used, instead of plowing through yet another syntax and function reference that’s no better than the online manual.

Try the examples. Type them in or download them from the website, change them, break them, and learn how to fix them again. This chapter begins with the example of an online product order form to show how  variables, operators, and expressions are used in PHP. It also covers variable types and operator  precedence. You will learn how to access form variables and manipulate them by working out the total and tax on a customer order. You will then develop the online order form example by using a PHP script to validate the input data. You’ll examine the concept of Boolean values and look at examples using if, else, the ?: operator, and the switch statement. Finally, you’ll explore looping by writing some PHP to generate repetitive HTML tables.

### 02. Creating a Sample Application: Bob’s Auto Parts

One of the most common applications of any server-side scripting language is processing HTML forms. You’ll start learning PHP by implementing an order form for Bob’s Auto Parts, a fictional spare parts company. Creating the Order FormBob’s. HTML programmer has set up an order form for the parts that Bob sells. This relatively simple order form, shown in Figure 1.1, is similar to many you have probably seen while surfing. Bob would like to be able to know what his customers ordered, work out the total prices of their orders, and determine how much sales tax is payable on the orders.

Notice that the form’s action is set to the name of the PHP script that will process the customer’s order. (You’ll write this script next.) In general, the value of the action attribute is the URL that will be loaded when the user clicks the Submit button. The data the user has typed in the form will be sent to this URL via the HTTP method specified in the method attribute, either get (appended to the end of the URL) or post (sent as a separate message).

    <form action="processorder.php" method="post">

Also note the names of the form fields: tireqty, oilqty, and sparkqty. You’ll use these names again in the PHP script. Because the names will be reused, it’s important to give your form fields meaningful names that you can easily remember when you begin writing the PHP script. Some HTML editors generate field names like field23 by default. They are difficult to remember. Your life as a PHP programmer will be easier if the names you use reflect the data typed into the field.

You should consider adopting a coding standard for field names so that all field names throughout your site use the same format. This way, you can more easily remember whether, for example, you abbreviated a word in a field name or put in underscores as spaces.

1『form 即表单；又见这两种请求，get 和 post，get (appended to the end of the URL) or post (sent as a separate message)。』

3『

[\<tr> - HTML（超文本标记语言） | MDN](https://wiki.developer.mozilla.org/zh-CN/docs/Web/HTML/Element/tr)

源码里的 \<tr> 和 \<td> 元素，都是表格元素里的。\<tr> 元素定义表格中的行。 Those can be a mix of \<td> and \<th> elements. \<td> 元素定义了一个包含数据的表格单元格。

』

To process the form, you need to create the script mentioned in the action attribute of the form tag called processorder.php. Open your text editor and create this file. Then type in the following code:

```
<!DOCTYPE html>
<html>
  <head>
    <title>Bob's Auto Parts - Order Results</title>
  </head>
  <body>
    <h1>Bob's Auto Parts</h1>
    <h2>Order Results</h2> 
  </body>
</html>
```

### 03. Embedding PHP in HTML

Under the \<h2> heading in your file, add the following lines:

    <?php  echo '<p>Order processed.</p>';?>

Save the file and load it in your browser by filling out Bob’s form and clicking the Submit Order button. You should see something similar to the output shown in Figure 1.2. Notice how the PHP code you wrote was embedded inside a normal-looking HTML file. Try viewing the source from your browser. You should see this code \<!DOCTYPE html>

None of the raw PHP is visible because the PHP interpreter has run through the script and replaced it with the output from the script. This means that from PHP you can produce clean HTML viewable with any browser; in other words, the user’s browser does not need to understand PHP. This example illustrates the concept of server-side scripting in a nutshell. The PHP has been interpreted and executed on the web server, as distinct from JavaScript and other client-side technologies interpreted and executed within a web browser on a user’s machine.

3『例子解释了服务端脚本的概念，浏览器不需要理解 PHP 这种服务端脚本，那么联想到，浏览器需要理解 JavaScript 这种客户端脚本。』

The code that you now have in this file consists of four types of text: 1) HTML. 2) PHP tags. 3) PHP statements. 3) Whitespace. You can also add comments. Most of the lines in the example are just plain HTML.

PHP Tags. The PHP code in the preceding example began with \<?php and ended with ?>. This is similar to all HTML tags because they all begin with a less than (\<) symbol and end with a greater than (>) symbol. These symbols (\<?php and ?>) are called PHP tags. They tell the web server where the PHP code starts and finishes. Any text between the tags is interpreted as PHP. Any text outside these tags is treated as normal HTML. The PHP tags allow you to escape from HTML.

There are actually two styles of PHP tags; each of the following fragments of code is equivalent:

 ■ XML style

    <?php echo '<p>Order processed.</p>'; ?>

This is the tag style that we use in this book; it is the preferred PHP tag style. The server administrator cannot turn it off, so you can guarantee it will be available on all servers, which is especially important if you are writing applications that may be used on different installations. This tag style can be used with Extensible Markup Language (XML) documents. In general, we recommend you use this tag style.

 ■ Short style

    <? echo '<p>Order processed.</p>'; ?>

This tag style is the simplest and follows the style of a Standard Generalized Markup Language (SGML) processing instruction. To use this type of tag — which is the shortest to type — you either need to enable the short_open_tag setting in your conﬁgﬁle or  compile PHP with short tags enabled. You can ﬁnd more information on how to use this tag style in Appendix A. The use of this style is not recommended for use in code you plan to distribute. It will not work in many environments as it is no longer enabled by default.

PHP Statements. You tell the PHP interpreter what to do by including PHP statements between your opening and closing tags. The preceding example used only one type of statement:

    echo '<p>Order processed.</p>';

As you have probably guessed, using the echo construct has a very simple result: It prints (or echoes) the string passed to it to the browser. In Figure 1.2, you can see the result is that the text Order processed. appears in the browser window. Notice that there is a semicolon at the end of the echo statement. Semicolons separate statements in PHP much like periods separate sentences in English. If you have programmed in C or Java before, you will be familiar with using the semicolon in this way. Leaving off the semicolon is a common syntax error that is easily made. However, it’s equally easy to find and to correct.

Whitespace. Spacing characters such as newlines (carriage returns), spaces, and tabs are known as whitespace. As you probably already know, browsers ignore whitespace in HTML, and so does the PHP engine. Consider these two HTML fragments:

    <h1>Welcome to Bob's Auto Parts!</h1><p>What would you like to order today?</p>

and

```
<h1>Welcome             to Bob's
Auto Parts!</h1>
<p>What would you like
to order today?</p>
```

These two snippets of HTML code produce identical output because they appear the same to the browser. However, you can and are encouraged to use whitespace sensibly in your HTML as an aid to humans — to enhance the readability of your HTML code. The same is true for PHP. You don’t need to have any whitespace between PHP statements, but it makes the code much easier to read if you put each statement on a separate line. For example,

    echo 'hello ';
    echo 'world';

and

    echo 'hello ';echo 'world';

are equivalent, but the first version is easier to read.

1『HTML 和 PHP 都忽略 whitespace，whitespace 的概念：Spacing characters such as newlines (carriage returns), spaces, and tabs.』

Comments are exactly that: Comments in code act as notes to people reading the code. Comments can be used to explain the purpose of the script, who wrote it, why they wrote it the way they did, when it was last modified, and so on. You generally find comments in all but the simplest PHP scripts. The PHP interpreter ignores any text in comments. Essentially, the PHP parser skips over the comments, making them equivalent to whitespace.

PHP supports C, C++, and shell script–style comments. The following is a C-style, multiline comment that might appear at the start of a PHP script:

```
/* Author: Bob Smith   
Last modified: April 10   
This script processes the customer orders.
*/
```

Multiline comments should begin with a /* and end with */. As in C, multiline comments cannot be nested. You can also use single-line comments, either in the C++ style:

    echo '<p>Order processed.</p>'; // Start printing order

or in the shell script style:

    echo '<p>Order processed.</p>'; # Start printing order

With both of these styles, everything after the comment symbol (# or //) is a comment until you reach the end of the line or the ending PHP tag, whichever comes first. In the following line of code, the text before the closing tag, here is a comment, is part of a comment. The text after the closing tag, here is not, will be treated as HTML because it is outside the closing tag:

    // here is a comment ?> here is not

### 03. Adding Dynamic Content

So far, you haven’t used PHP to do anything you couldn’t have done with plain HTML. The main reason for using a server-side scripting language is to be able to provide dynamic content to a site’s users. This is an important application because content that changes according to users’ needs or over time will keep visitors coming back to a site. PHP allows you to do this easily. Let’s start with a simple example. Replace the PHP in processorder.php with the following code: 

You could also write this on one line, using the concatenation operator (.), as

```
<?php  
echo "<p>Order processed at ".date('H:i, jS F Y')."</p>";?>
```

In this code, PHP’s built-in date() function tells the customer the date and time when his order was processed. This information will be different each time the script is run. The output of running the script on one occasion is shown in Figure 1.3.

Calling Functions. Look at the call to date(). This is the general form that function calls take. PHP has an  extensive library of functions you can use when developing web applications. Most of these functions need to have some data passed to them and return some data. Now look at the function call again:

    date('H:i, jS F')

Notice that it passes a string (text data) to the function inside a pair of parentheses. The element within the parentheses is called the function’s argument or parameter. Such  arguments are the input the function uses to output some specific results.

Using the date() Function. The date() function expects the argument you pass it to be a format string, representing the style of output you would like. Each letter in the string represents one part of the date and time. H is the hour in a 24-hour format with leading zeros where required, i is the minutes with a leading zero where required, j is the day of the month without a leading zero, S  represents the ordinal suffix (in this case th), and F is the full name of the month. Note: If date() gives you a warning about not having set the timezone, you should add the date.timezone setting to your php.ini file. More information on this can be found in the sample php.ini file in Appendix A. For a full list of formats supported by date(), see Chapter 19,「Managing the Date and Time.」

Form Variables. Within your PHP script, you can access each form field as a PHP variable whose name relates to the name of the form field. You can recognize variable names in PHP because they all start with a dollar sign (\$). (Forgetting the dollar sign is a common programming error.)

Depending on your PHP version and setup, you can access the form data via variables in different ways.  In recent versions of PHP, all but one of these ways have been deprecated, so beware if you have used PHP in the past that this has changed. You may access the contents of the field tireqty in the following way:

    $_POST['tireqty']    

\$_POST is an array containing data submitted via an HTTP POST request — that is, the form method was set to POST. There are three of these arrays that may contain form data: 

\$POST, \$GET, and \$REQUEST. One of the \$GET or \$POST arrays holds the details of all the form variables. Which array is used depends on whether the method used to submit the form was GET or POST, respectively. In addition, a combination of all data submitted via GET or POST is also available through \$_REQUEST.

If the form was submitted via the POST method, the data entered in the tireqty box will be stored in \$POST['tireqty']. If the form was submitted via GET, the data will be in \$_GET['tireqty']. In either case, the data will also be available in \$REQUEST['tireqty']. These arrays are some of the superglobal arrays. We will revisit the superglobals when we discuss variable scope later in this chapter.

1『POST、GET 和 REQUEST 三个都是 superglobal（超级全局变量）。』

Let’s look at an example that creates easier-to-use copies of variables. To copy the value of one variable into another, you use the assignment operator, which in PHP is an equal sign (=). The following statement creates a new variable named \$tireqty and copies the contents of \$_POST['tireqty'] into the new variable:

    $tireqty = $_POST['tireqty'];

Place the following block of code at the start of the processing script. All other scripts in this book that handle data from a form contain a similar block at the start. Because this code will not produce any output, placing it above or below the \<html> and other HTML tags that start your page makes no difference. We generally place such blocks at the start of the script to make them easy to find.

```
<?php  // create short variable names  
$tireqty = $_POST['tireqty'];  
$oilqty = $_POST['oilqty'];  
$sparkqty = $_POST['sparkqty'];
?>
```

This code creates three new variables — \$tireqty, \$oilqty, and \$sparkqty — and sets them to contain the data sent via the POST method from the form. You can output the values of these variables to the browser by doing, for example:

    echo $tireqty.' tires<br />';

However, this approach is not recommended. At this stage, you have not checked the variable contents to make sure sensible data has been entered in each form field. Try entering deliberately wrong data and observe what happens. After you have read the rest of the chapter, you might want to try adding some data validation to this script.

Taking data directly from the user and outputting it to the browser like this is an extremely risky practice from a security perspective. We do not recommend this approach. You should filter input data. We will start to cover input filtering in Chapter 4,「String Manipulation and Regular Expressions,」and discuss security in depth in Chapter 14,「Web Application Security Risks.」

1『直接提取数据很不安全，超级不建议。』

For now, it’s enough to know that you should echo out user data to the browser after passing it through a function called htmlspecialchars(). For example, in this case, we would do the following:

To make the script start doing something visible, add the following lines to the bottom of your PHP script:   

```
<?php
echo '<p>Order processed at '.date('H:i, JS F Y').'</p>';;
echo '<p>your order is as follows: </p>';
echo htmlspecialchars($tireqty).' tires<br />';
echo htmlspecialchars($oilqty).' bottles of oil<br />';
echo htmlspecialchars($sparkqty).' spark plugs<br />';
?>   
```

If you now load this file in your browser, the script output should resemble what is shown in Figure 1.4. The actual values shown, of course, depend on what you typed into the form. The following sections describe a couple of interesting elements of this example.

String Concatenation. In the sample script, echo prints the value the user typed in each form field, followed by some explanatory text. If you look closely at the echo statements, you can see that the variable name and following text have a period (.) between them, such as this:

    echo htmlspecialchars($tireqty).' tires<br />';

This period is the string concatenation operator, which adds strings (pieces of text) together. You will often use it when sending output to the browser with echo. This way, you can avoid writing multiple echo commands. You can also place simple variables inside a double-quoted string to be echoed. (Arrays are somewhat more complicated, so we look at combining arrays and strings in Chapter 4.) Consider this example: 

```
$tireqty = htmlspecialchars($tireqty);  
echo "$tireqty tires<br />";
```

This is equivalent to the first statement shown in this section. Either format is valid, and which one you use is a matter of personal taste. This process, replacing a variable with its contents within a string, is known as interpolation. Note that interpolation is a feature of double-quoted strings only. You cannot place variable names inside a single-quoted string in this way. Running the following line of code:

    echo '$tireqty tires<br />';

simply sends \$tireqty tires\<br /> to the browser. Within double quotation marks, the variable name is replaced with its value. Within single quotation marks, the variable name or any other text is sent unaltered.

Variables and Literals. The variables and strings concatenated together in each of the echo statements in the sample script are different types of things. Variables are symbols for data. The strings are data themselves. When we use a piece of raw data in a program like this, we call it a literal to distinguish it from a variable. \$tireqty is a variable, a symbol that represents the data the customer typed in. On the other hand, ' tires\<br />' is a literal. You can take it at face value. Well, almost. Remember the second example in the preceding section? PHP replaced the variable name \$tireqty in the string with the value stored in the variable.

Remember the two kinds of strings mentioned already: ones with double quotation marks and ones with single quotation marks. PHP tries to evaluate strings in double quotation marks, resulting in the behavior shown earlier. Single-quoted strings are treated as true literals.

1『如要想在字符串里直接输出变量的值，必须用双引号，解释器识别不了单引号里的变量。PHP 里双引号字符串和单引号字符串语义不一样。双引号字符串是 interpolated 的，即自动识别里面变量的值，下面将的 Heredoc strings 也是。』

There is also a third way of specifying strings using the heredoc syntax (<<<), which will be familiar to Perl users. Heredoc syntax allows you to specify long strings tidily, by specifying an end marker that will be used to terminate the string. The following example creates a three-line string and echoes it:

```
echo <<<theEnd  
line 1  
line 2 
line 3
theEnd
```

The token theEnd is entirely arbitrary. It just needs to be guaranteed not to appear in the text. To close a heredoc string, place a closing token at the start of a line. Heredoc strings are interpolated, like double-quoted strings.

Understanding Identifiers. Identifiers are the names of variables. (The names of functions and classes are also identifiers; we look at functions and classes in Chapter 5,「Reusing Code and Writing Functions,」and Chapter 6,「Object-Oriented PHP.」) You need to be aware of the simple rules defining valid identifiers:

■ Identifiers can be of any length and can consist of letters, numbers, and underscores.

■ Identifiers cannot begin with a digit.

■ In PHP, identifiers are case sensitive. \$tireqty is not the same as \$TireQty. Trying to use them interchangeably is a common programming error. Function names are an exception to this rule: Their names can be used in any case.

■ A variable can have the same name as a function. This usage is confusing, however, and should be avoided. Also, you cannot create a function with the same name as another function.

1『识别码大小写敏感，但是函数名是个例外。』

You can declare and use your own variables in addition to the variables you are passed from the HTML form. One of the features of PHP is that it does not require you to declare variables before using them. A variable is created when you first assign a value to it. See the next section for details.You assign values to variables using the assignment operator (=) as you did when copying one variable’s value to another. On Bob’s site, you want to work out the total number of items ordered and the total amount payable. You can create two variables to store these numbers. To begin with, you need to initialize each of these variables to zero by adding these lines to the bottom of your PHP script. Each of these two lines creates a variable and assigns a literal value to it. You can also assign variable values to variables, as shown in this example:

```
$totalqty = 0;
$totalamount = 0.00;

$totalqty = 0;
$totalamount = $totalqty;
```

### 06. Examining Variable Types

A variable’s type refers to the kind of data stored in it. PHP provides a set of data types. Different data can be stored in different data types. 

PHP’s Data Types. PHP supports the following basic data types:

 ■ Integer — Used for whole numbers.

 ■ Float (also called double)—Used for real numbers.

 ■ String — Used for strings of characters.

 ■ Boolean — Used for true or false values.

 ■ Array — Used to store multiple data items (see Chapter 3,「Using Arrays」).

 ■ Object — Used for storing instances of classes (see Chapter 6).

Three special types are also available: NULL, resource, and callable.

Variables that have not been given a value, have been unset, or have been given the specific value NULL are of type NULL.

Certain built-in functions (such as database functions) return variables that have the type resource. They represent external resources (such as database connections). You will almost certainly not directly manipulate a resource variable, but frequently they are returned by functions and must be passed as parameters to other functions.

3『原来在 laravel-admin 里看到的 resources 是一种特殊的数据类型，它可以用来表示外部资源，比如数据库连接，注意通常不会直接操作 resource variable，而是作为参数在各个函数间调用。』

Callables are essentially functions that are passed to other functions.

2『回调函数，去深挖一下。』

Type Strength. PHP is called a weakly typed or dynamically typed language. In most programming languages, variables can hold only one type of data, and that type must be declared before the variable can be used, as in C. In PHP, the type of a variable is determined by the value assigned to it. For example, when you created \$totalqty and \$totalamount, their initial types were  determined as follows:

Because you assigned 0, an integer, to \$totalqty, this is now an integer type variable. Similarly, \$totalamount is now of type float. Strangely enough, you could now add a line to your script as follows. The variable \$totalamount would then be of type string. PHP changes the variable type according to what is stored in it at any given time. This ability to change types transparently on the fly can be extremely useful. Remember PHP「automagically」knows what data type you put into your variable. It returns the data with the same data type when you retrieve it from the variable.

Type Casting. You can pretend that a variable or value is of a different type by using a type cast. This feature works identically to the way it works in C. You simply put the temporary type in parentheses in front of the variable you want to cast. For example, you could have declared the two variables from the preceding section using a cast:

```
$totalqty = 0;
$totalamount = (float)$totalqty;
```

The second line means「Take the value stored in \$totalqty, interpret it as a float, and store it in \$totalamount.」The \$totalamount variable will be of type float. The cast variable does not change types, so \$totalqty remains of type integer.

Variable Variables. PHP provides one other type of variable: the variable variable. Variable variables enable you to change the name of a variable dynamically. As you can see, PHP allows a lot of freedom in this area. All languages enable you to change the value of a variable, but not many allow you to change the variable’s type, and even fewer allow you to change the variable’s name.  A variable variable works by using the value of one variable as the name of another. For example, you could set:

    $varname = 'tireqty';

You can then use \$\$varname in place of \$tireqty. For example, you can set the value of \$tireqty as follows:

    $$varname = 5;

This is equivalent to

    $tireqty = 5;

This approach might seem somewhat obscure, but we’ll revisit its use later. Instead of having to list and use each form variable separately, you can use a loop and variable variable to process them all automatically. You can find an example illustrating this in the section on for loops later in this chapter.













