凯德·梅茨.(2023.2021).2024013深度学习革命.(桂曙光译).中信出版社 => 0401 微软的尝试与谷歌的新突破

Cade Metz.(2007).2024013Genius-Makers => Preface

## 0401. 微软的尝试与谷歌的新突破

在谷歌，你要做自己想做的，而不是谷歌想让你做的。

2008 年 12 月 11 日，邓力走进加拿大不列颠哥伦比亚省惠斯勒的一家酒店，这个地方位于温哥华以北，在即将举办 2010 年冬奥会滑雪比赛的白雪覆盖的山峰脚下。他不是去滑雪的，而是为了科学而来。每年，数百名研究人员会前往温哥华参加年度人工智能会议 NIPS。大会结束后，大多数人都会前往惠斯勒参加更为私密的 NIPS 研讨会，内容包括为期两天的学术演讲、苏格拉底式辩论和非正式交流，研究人员共同探讨人工智能的近期前景。邓力出生于中国，在美国接受教育，他在整个职业生涯中都致力于开发语音识别软件，他起初担任加拿大滑铁卢大学的教授，后来成为微软位于西雅图附近的研发实验室的研究人员。10 多年来，像微软这样的公司一直在销售「语音记录」软件，将这项技术视为在个人电脑和笔记本电脑上进行自动听写的一种方式。但不可否认的事实是，这项技术并没有那么好用，当你对着长长的桌面麦克风清晰地说话时，在记录下来的单词中，错误的数量超过正确的。像当时大多数人工智能研究一样，这项技术的进步速度非常缓慢。在微软，邓力和他的团队花了 3 年的时间来打造他们最新的语音系统，该系统下一版的准确率可能仅比上一版提高 5%。然后，在惠斯勒的某个晚上，他见到了杰夫·辛顿。

邓力在加拿大的时候就认识辛顿。20 世纪 90 年代初，在连接主义研究的短暂复兴期间，邓力的一名学生写了一篇论文 1 ，探索神经网络作为语音识别的一种方式，当时多伦多大学教授辛顿也加入了论文委员会。在随后的几年里，随着连接主义在产业界和学术界失宠，这两位研究人员很少见面。尽管辛顿坚持神经网络的想法，但语音识别只是他在多伦多大学实验室的一个兴趣爱好，这意味着他和邓力在完全不同的圈子里活动。但当他们走进希尔顿惠斯勒度假村和温泉中心的同一个房间时，邓力和辛顿直接交流了起来。房间里没几个人，只有几名研究人员坐在桌旁，等待有人向他们询问关于他们最新研究的问题。邓力非常容易激动，而且更健谈一些，几乎跟所有人都能直接交流。

「有什么新鲜事吗？」邓力问道。

「深度学习。」辛顿回答。他说，神经网络开始在语音方面奏效了。

邓力并没有真的相信。辛顿不是一名语音研究人员，而且神经网络从未在任何事情上奏效过。在微软，邓力正在开发属于自己的一种新的语音识别方法，他实在没有时间再一次进入未知的算法领域。但辛顿很坚持，他说，他的研究没有受到太多的关注，但在过去几年里，他和自己的学生发表了一系列论文，相比于之前的技术，他的「深层信念网络」可以从更多的数据中进行学习，在性能上正在接近领先的语音识别方法。「你必须试一试。」辛顿不停地说。邓力说他会的，他们交换了电子邮件地址。然后，几个月的时间过去了。

到了夏天，在手头有点儿空余时间的时候，邓力开始阅读关于当时被称为「神经语音识别」的技术的文献。他对这项技术的性能印象深刻，于是给辛顿发了电子邮件，建议他们围绕这个想法组织一场新的惠斯勒研讨会，但对这项被全球语音界系统性忽视的技术的长期前景，他仍然表示怀疑。它在简单的测试中运行良好，但其他很多算法也是如此。然后，随着下一场惠斯勒研讨会的临近，辛顿又给邓力发了一封电子邮件，附上了一份研究论文的初稿 2 ，该论文将他的技术又推进了一步。结果表明，在分析了大约 3 个小时的口语词汇之后，神经网络的性能甚至可以与最好的语音方法相媲美。邓力还是不相信。多伦多大学的研究人员描述其技术的方式让人非常难以理解，他们的测试也仅基于实验室记录的声音数据库，而不是真实世界的语音。辛顿和他的学生进入了一个他们并不完全熟悉的研究领域，这是能看得出来的。「这篇论文存在一些问题，」邓力说，「但我简直不敢相信，他们得到了跟我一样的结果。」所以，他要求查看他们测试的原始数据。当他打开电子邮件，看着数据，亲眼看到这项技术能做什么的时候，他相信了。

### 01

那年夏天，邓力邀请辛顿到微软位于华盛顿州雷蒙德市的研究实验室待一段时间，辛顿答应了，但前提是，他必须能够到那里去。近年来，他的腰背问题越来越严重，已经到了他再次质疑自己的研究能否继续的地步。40 年前，他在给母亲搬取暖器时，腰椎间盘滑脱了，随着时间的推移，这个腰椎间盘变得越来越不稳定。这些天，当他弯腰或坐下时，腰椎间盘就可能滑脱。他说：「这是遗传、愚蠢和坏运气共同造成的，就像生活中其他所有糟糕的事情一样。」他认为，很明显，唯一的解决办法是不再坐下来（用他的话说，例外情况是生物学上的必然性导致的「每天坐下一两次，每次几分钟」）。在多伦多大学的实验室里与学生们见面时，他会平躺在办公桌上或隔着一张折叠床靠在墙上，以缓解疼痛。这也意味着他不能开车，也不能坐飞机。

于是，2009 年秋天，他坐地铁到多伦多市区的公交车站，早早就开始排队，这样他就可以占上开往布法罗的公交车后座，然后躺下并假装睡着了，这样就没有人会试图移动他。「在加拿大，这一招儿很有效。」他说。（从美国回加拿大时，这招儿不管用：「我躺在后座假装睡着了，有个家伙却走过来踢我。」）到达布法罗之后，他准备了去微软实验室工作所需的签证，然后乘了将近三天的火车贯穿全美国才来到西雅图。直到了解了旅行要花多长时间，邓力才意识到辛顿的腰背是个问题。在火车到达之前，他给办公室添置了一张站立式办公桌，这样他们就可以并肩工作了。

辛顿于 11 月中旬抵达，他躺在出租车的后座上，准备穿越横跨华盛顿湖的浮桥，这座浮桥将西雅图与它的东区连接起来，然后才到雷德蒙。雷德蒙是一个郊区小镇，这里的建筑主要是一些中型的办公楼，属于一家非常大的企业。辛顿和邓力一起工作的办公室位于微软 99 号楼的 3 楼，这是一栋花岗岩和玻璃建筑，是该公司研发实验室的核心。这就是让语言学家克里斯·布罗克特恐慌发作的那间实验室，该实验室偏学术风格，不像微软的其他部门那样关注市场和资金，而是关注未来的技术。在这间实验室 1991 年启动运营时，微软也开始主导国际软件市场，该实验室的主要目标之一是开发出能够识别口语词汇的技术。在接下来的 15 年里，微软支付了异常高额的工资，招募了该领域的很多顶尖研究人员，包括邓力。但是，当辛顿抵达雷德蒙时，微软在全世界的地位正在发生变化，权力平衡正从软件巨头转移到科技行业的其他领域。谷歌、苹果、亚马逊和 Facebook（脸书）正在崛起，抓住了新的市场和新的资金 —— 互联网搜索、智能手机、网络零售和社交网络。依靠运行在大多数台式电脑和笔记本电脑上的 Windows 操作系统，微软仍然统治着计算机软件领域，但是，在扩张为全球最大的公司之一并建立了与普通公司一样的官僚制度之后，微软调整方向的速度变慢了。

微软的 99 号楼是一栋 4 层小楼，其实验室、会议室和办公室环绕着一个大中庭和一个小咖啡厅。辛顿和邓力计划根据多伦多大学的研究成果打造一个原型，训练一个神经网络来识别口语词汇。这个项目只有他们两个人参与，但工作刚开始就遇到一点儿麻烦。辛顿需要密码才能登录微软的计算机网络，而获得密码的唯一途径是通过一部公司的电话，但公司电话又需要自己的密码。他们发了无数封电子邮件，试图获得一部电话的密码，但都没有成功，邓力只好带着辛顿来到 4 楼的技术支持台。微软有一个特殊的规定，即如果访客只停留一天的时间，微软就可以提供一个临时网络密码，在技术支持台工作的女士给了他们一个。但是，当辛顿问她第二天早上密码是否还有效时，她把密码拿了回来，说：「如果你停留一天以上，你就不能用这个密码。」

在他们最终找到了接入网络的方法之后，这个项目在几天之内就完成了。有一次，当辛顿在他的台式电脑上输入计算机代码时，邓力在他旁边用同一个键盘输入。对容易激动的邓力来说，这很正常，但辛顿从未见过这样的事情。「我习惯了大家在交流的时候互相打断，」他说，「但我不习惯在输入代码时被其他人在同一个键盘上输入代码打断。」他们用一种名为 MATLAB 的编程语言创建了原型，代码的篇幅不超过 10 页，大部分是辛顿编写的。尽管辛顿淡化了他作为数学家和计算机科学家的技能，但邓力还是被其代码的优雅简洁风格打动了。「一行一行，都太清晰了。」邓力想。但给他留下深刻印象的，不仅仅是代码的清晰度。在他们用微软的语音数据训练了这个系统后，它奏效了 —— 不是仅仅与当时领先的系统一样好，而是好到足以让邓力意识到，这才是语音识别的未来。商业系统使用其他的手工方法来识别语音，但那些方法并没有真正奏效。但邓力可以看出，他和辛顿已经打造了一个系统，随着它不断地从大量数据中进行学习，这个系统可能会变得更加强大。

他们的原型所欠缺的，是分析所有数据时所需的额外处理能力。在多伦多大学，辛顿采用了一种非常特殊的计算机芯片，叫 GPU。像英伟达这样的硅谷芯片制造商最初设计这些芯片是为了给《光环》和《侠盗猎车手》等热门的电子游戏快速渲染图形，但在这个过程中，深度学习的研究人员意识到，GPU 同样擅长运行支撑神经网络的数学。在邓力和辛顿打造其语音原型的同一间微软实验室里，有三名工程师曾在 2005 年对这个想法进行了修改完善。3 另外，斯坦福大学的一个团队也在同一时间偶然发现了同样的技术诀窍。4 基于这些芯片，神经网络能够在更短的时间内从更多的数据中进行学习。这与杨立昆 20 世纪 90 年代初在贝尔实验室的工作如出一辙，不同的是，GPU 是现成的硬件。研究人员不必制造新的芯片来加速深度学习的进程。多亏了像《侠盗猎车手》这样的游戏和 Xbox 这样的游戏机，他们才可以使用已经存在的芯片进行训练。在多伦多大学，辛顿和他的两名学生 —— 阿卜杜勒 —— 拉赫曼·穆罕默德（Abdel-rahman Mohamed）和英语教授的儿子乔治·达尔，利用这些专门的芯片训练了他们的语音系统，这就是推动该系统超越最先进技术的核心。

在辛顿结束在微软的短暂停留之后，邓力坚持让穆罕默德和达尔都来微软的 99 号楼做客，而且希望他们在不同的时间来，这样这个项目的进展在接下来的几个月里都不会停滞。辛顿和他的学生都同意这个延长的实验，并解释说，如果没有一套完全不同的硬件，包括一块价值一万美元的 GPU 显卡，这个项目就不会成功。起初，邓力对这一代价感到犹豫不决。他的上司亚历克斯·阿塞罗（Alex Acero）告诉他，这是一笔不必要的开支，阿塞罗后来去了苹果公司负责 iPhone（苹果手机）上的智能语音助手 Siri。GPU 是用来玩游戏的，而不是用来做人工智能研究的。「不要浪费钱。」他说，并且告诉邓力不用考虑昂贵的英伟达设备，在当地的弗莱电子商店购买通用显卡就行。但辛顿敦促邓力进行反驳，他解释说，廉价的硬件会破坏实验的目的。神经网络要连续几天分析微软的语音数据，如果这些通用显卡运行那么久，那么它们可能被烧毁。但他提出的一个更重要的观点是，神经网络要依靠额外的处理能力实现蓬勃发展。邓力不仅需要购买单价为一万美元的 GPU 显卡，而且可能需要不止一块，外加一台可以运行该显卡的专用服务器，服务器的价格与显卡的价格相当。辛顿在给邓力的一封电子邮件中说：「这将花费你大约一万美元。我们自己则要订购三套，但我们是一所资金雄厚的加拿大大学，不是一家资金短缺的软件销售商。」最终，邓力购买了必要的硬件。

那一年，微软聘请了彼得·李（Peter Lee）作为其雷德蒙研究实验室的新负责人。彼得·李是一名训练有素的研究人员，具有管理人员的气质，他曾在卡内基 —— 梅隆大学工作过 20 多年，最终成为计算机科学系主任。当他刚加入微软并开始审核实验室的研究预算时，他无意中发现了一张工作表单，上面列出了邓力语音项目的费用，包括支付给辛顿、穆罕默德和达尔的费用，在惠斯勒语音研讨会支出的费用，以及购买 GPU 的费用。彼得·李大吃一惊，他认为这整个安排是他看到的最愚蠢的想法之一。20 世纪 80 年代，他在卡内基 —— 梅隆大学认识了辛顿，当时他就认为神经网络很荒谬。现在，他甚至认为他们疯了。但是，当他来到雷德蒙的时候，这个项目已经启动。彼得·李说：「我有时会想，如果我一年前被微软聘用，那么这一切都不会发生。」

突破是在那年夏天发生的，当时乔治·达尔来拜访微软实验室。达尔是一个长着一张大脸却戴着一副小眼镜的高个子男人，他在大学二年级时就决定将研究机器学习作为自己一生的追求，他认为这是一种替代的计算机编程方式 —— 即使你不完全知道如何处理，它也能帮你解决问题，你只需要让机器进行学习即可。他沉浸在神经网络之中，但并不是一位真正的语音研究人员。「我开始研究语音的唯一原因，是杰夫团队中的其他人都在研究视觉。」他经常这么说。他想要证明，辛顿的实验室里酝酿出的想法不仅仅适用于图像。他做到了。「乔治不太懂语音，」邓力说，「但他懂 GPU。在微软，达尔利用这些单价一万美元的显卡，利用微软通过必应语音搜索服务收集的口语词汇，对神经网络进行了训练，他使辛顿的语音识别原型的性能超越了该公司正在开发的其他任何产品。达尔、穆罕默德和辛顿所展示的是，神经网络可以在一片嘈杂的语音海洋中筛选出重要的东西，发现人类工程师无法自行找到的模式，区分众多微妙的声音，识别不同的单词。这是人工智能漫长历史中的一个转折点。在几个月的时间里，一位教授和他的两名研究生的成果超越了世界上最大的公司之一已经研发了十几年的一个系统。」「辛顿是个天才，」邓力说，「他知道如何不断地制造影响力。」

### 02

几个月之后，站在多伦多大学的办公桌前，望着国王学院路的鹅卵石路面，杰夫·辛顿打开了一封陌生人发的电子邮件，发信人是威尔·内维特（Will Neveitt），他问辛顿能否派一名学生去北加州的谷歌总部。通过语音识别工作，辛顿和他的学生们在整个科技行业引发了连锁反应。在微软培育了一个新的语音项目并公布研究成果给所有人看到之后，辛顿和学生们将这个技巧应用在了第二家科技巨头 IBM 身上。2010 年秋天，在拜访微软 9 个月之后，阿卜杜勒 —— 拉赫曼·穆罕默德开始与 IBM 的托马斯·沃森研究中心合作，该中心所在的大楼是建筑师埃罗·萨里宁的另一个雄伟的作品，配有镜面窗户，隐藏在纽约市北部起伏的群山之中。现在，轮到谷歌了。

穆罕默德还在和 IBM 合作，而乔治·达尔忙于其他研究，所以辛顿向一个几乎与他们的语音工作没有关系的学生求助。这名学生就是纳夫迪普·贾特利，他的父亲是加拿大的印度裔移民，他在成为计算生物学家几年之后，最近才开始参与人工智能的研究。他是一位特别和䔽可亲的研究人员，剃着光头，跟达尔一起在辛顿办公室走廊尽头的供应室里工作，他还在市场上做行业实习。辛顿曾试图在黑莓智能手机制造商 RIM（移动研究公司）给他找一个职位，但这家加拿大公司表示对语音识别不感兴趣。就在几年前，RIM 配备键盘的设备还主导着手机市场，但它已经错过了触屏智能手机领域的飞跃。现在，下一次大飞跃即将被这家公司错过。当辛顿第一次向贾特利推荐谷歌的工作时，他拒绝了。他和妻子即将迎来一个孩子，另外，因为他已经在美国申请了绿卡，他知道自己无法获得在谷歌工作所需的签证。但几天之后，他重新考虑了一下，要求给辛顿发电子邮件的谷歌员工威尔·内维特购买一台装有 GPU 的机器。

当贾特利的谷歌实习开始时，内维特已经离开了谷歌，他的替代者是一位在法国出生的工程师，名叫文森特·万豪克（Vincent Vanhoucke）。万豪克发现自己拥有一台巨大的配备 GPU 的机器，但不太知道该怎么用，他还有一名加拿大的实习生，实习生知道如何使用这台机器，但因为没有签证，实习生不被允许在放置机器的办公室里工作。因此，万豪克给谷歌位于加拿大蒙特利尔小办事处的人打了电话，找到了一张空办公桌。那年夏天，贾特利就在这里工作，几乎完全靠着自己，通过互联网接入那台巨大的配备 GPU 的机器。但首先，他短暂地去了一趟北加州，这样他就可以见到万豪克，并让 GPU 机器开始运行。「没有其他人知道如何处理这些事，」万豪克说，「所以必须由他自己来做。」

当贾特利抵达时，这台机器被藏在走廊尽头的一个角落里，远离万豪克和语音识别团队的其他成员。「它在打印机后面嗡嗡作响。」万豪克说。他不想把机器放在别人的办公室里或者任何靠近别人工作地点的地方。每个 GPU 都配备了一个风扇，为了防止硬件过热，风扇会不停地运转，他担心有人会厌倦这种噪声，并在不知道机器在干什么的情况下就把它关了。他把机器放在打印机后面，这样任何听到风扇呼呼作响的人都会把所有的噪声归咎于打印机。这种机器在谷歌和微软都显得很奇怪，但原因不同。在打造其网络服务帝国的过程中，谷歌建立了一个覆盖数十万台计算机的全球数据中心网络。公司的工程师可以立即从任何一台谷歌个人电脑或笔记本电脑上获得巨大的计算能力。他们就是这样开发和测试新软件的，而不是靠把机器塞在打印机后面的角落里。「公司的文化是，每个人都在大数据中心运行他们的软件，」万豪克说，「我们有很多电脑，你为什么要去买一台自己的电脑呢？」问题是，谷歌数据中心的机器没有配备 GPU 芯片，而这正是贾特利所需要的。

他想在这里做穆罕默德和达尔在微软和 IBM 做过的事情：用神经网络重构公司现有的语音识别系统。但他还想走得更远。微软和 IBM 的部分系统仍然依赖于其他技术，贾特利的目标是拓展神经网络所学的知识，他希望最终打造一个通过分析口语词汇来学习一切的系统。在贾特利离开多伦多之前，达尔告诉他不要听大公司的话。达尔说：「在谷歌，你要做自己想做的事情，而不是谷歌想让你做的事情。」因此，当贾特利在加州见到万豪克和其他人时，他提出要开发一个更大的神经网络。起初，他们有点儿犹豫。即使训练一个较小的神经网络也需要几天时间，而如果贾特利用谷歌的数据训练一个网络，那么他可能需要几周时间，但他只在那里待一个夏天。有一个谷歌的人问贾特利能否用 2 000 个小时的口语词汇训练一个网络，贾特利犹豫了。在多伦多大学，穆罕默德和达尔用 3 个小时的数据训练过网络。在微软，他们用了 12 个小时的数据。谷歌所有的数据规模都更大，因为该公司通过其大规模通用的网络服务，包括从谷歌搜索到 YouTube（优兔）的所有服务，来收集文本、声音和视频。但贾特利坚持自己的立场，在会议结束后，他给辛顿发了电子邮件。

「有人做过 2 000 个小时的训练吗？」他问道。

「没有，」辛顿回答，「但我不知道这为什么行不通。」

到了蒙特利尔之后，通过互联网接入那台嗡嗡作响的配备 GPU 的机器，贾特利在不到一周的时间里训练了他的第一个神经网络。当他测试这个新系统时，仅有约 21% 的单词会被识别错误 —— 这是一个了不起的壮举。在全球安卓智能手机上运行的谷歌语音识别服务的错误率为 23%。又过了两周之后，他将系统的错误率降到了 18%。在贾特利开始测试之前，万豪克和他的团队认为这个项目是一个有趣的实验，他们从未想过它的性能会接近谷歌已经打造出来的东西。「我们原本认为自己处在一个不同级别的联盟，」万豪克说，「结果并非如此。」

这个系统运行得相当好、相当快，于是贾特利接着训练可以在 YouTube 视频中搜索特定口语词汇的第二个系统。（如果你让它找「惊喜」这个词，它就会指出视频中说出这个词的时刻。）谷歌已经推出了一项可以做同样事情的服务，但是它的错误率是 53%。在夏天结束之前，贾特利将他的系统的错误率降到了 48%，而且几乎完全是自己独立完成的。他想，能留在蒙特利尔工作是一件幸事，因为没有人会约束他。他忘记了自己的极限，每天晚上都工作到 11 点甚至午夜。当他回到家时，他的妻子会把孩子抱给他，孩子因为肠绞痛大半夜都没睡。但是，第二天重复同样的循环对他而言并不难。「这让人上瘾，」他说，「结果越来越好。」

在贾特利和他的家人回到多伦多之后，万豪克把他的整个团队都转移到了这个项目上。谷歌知道微软和 IBM 正在打造类似的技术，而它想第一个实现。问题是，贾特利的系统处理速度要提升 10 倍才能处理互联网上的实时查询。在目前这种速度下，没有人会使用它。当这个团队开始削减时，来自完全不同部门的另一个团队加入进来。碰巧的是，当贾特利在蒙特利尔埋头苦干时，其他几位研究人员，包括另一名辛顿的门徒，正在谷歌的加州总部创建一间专门的深度学习实验室。与万豪克的团队一起，这间新实验室在不到 6 个月的时间里，将这项技术推向了安卓智能手机。起初，谷歌并没有告诉全世界它的语音识别服务发生了变化，上线后不久，万豪克就接到了一家小公司的电话，这家公司为最新的安卓手机提供一种芯片。当你对着手机咆哮时，这种芯片可以消除背景噪声 —— 这是一种清理声音的方法，这样语音识别系统就可以更容易地识别用户说话的内容。但这家公司告诉万豪克，其芯片已经无效，它无法再提升语音识别服务的性能了。万豪克听到他说的话，没过多久就意识到发生了什么。

谷歌新的语音识别系统非常优秀，它使得消除噪声的芯片过时了。事实上，当芯片无法清理声音时，该系统尤其有效。谷歌的神经网络已经学会了如何处理噪声。