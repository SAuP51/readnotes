# 02 小程序环境搭建与开发工具介绍

小程序开发几乎不需要配置任何开发环境，只需要安装微信提供的一款名为微信 Web 开发者工具的 IDE 即可。本章我们将使用小程序开发工具新建一个官方提供的示例项目，并介绍开发工具的相关界面、功能与使用技巧。

## 2.1 微信 Web 开发者工具下载及安装

小程序的开发工具官方名称为：「微信 Web 开发者工具」，其中并不包含「小程序」3 个字。看来微信的这个 IDE 并不想仅仅只是用来开发小程序。事实上也确实如此，这款开发工具不仅仅可以用来开发小程序，还可以用来调试运行在微信上的网页以及微信 JS-SDK。

官方提供了 3 个版本的开发工具安装包：Windows64、Windows32 和 Mac。本书中的项目开发环境为 64 位的 Windows，所以这里选择 Windows 64 版本的安装包。这里要特别提醒的是，程序的开发工具不支持 Windows XP 系统，这一点官方文档没有明确指出。请使用 Windows7 或者 Windows7 以上的 Windows 操作系统或者 Mac 来安装开发工具。各位读者请根据自己计算机操作系统的实际情况下载对应版本的安装包。下载完成后，双击运行安装包出现如图 2-1 所示的界面。

按照安装向导提示，一直到安装完成。如图 2-2 所示。

## 2.2 新建第一个项目

开发工具安装完成后，我们来新建第一个小程序项目。双击打开微信 Web 开发者工具，如果你是第一次打开或者长时间未打开，开发工具都会弹出维码，如图 2-3 所示。请使用微信「扫一扫」功能扫描二维码。是的，开发工具也需要登录，而登录的身份就是你的微信号。

登录后可看到图 2-4 所示的开发者工具首选页面。

首选页面一共有 2 个工具，分别是「本地小程序项目」和「众号网页开发」。（本地小程序项目）用来开发、调试、发布微信小程序；而公众号网页开发用来开发和调试微信公众号、订阅号的网页应用。由于小程序和公众号是两个完全不同的平台和体系，公众号的开发不在本书的讨论范围之内，我们只关注【本地小程序项目】这个工具，有兴趣的读者可以自行去研究学习「公众号网页开发」工具。点击本地小程序项目，将出现如图 2-5 所示的页面。

页面中需要填入的选项有APPID、项目名称、项目目录这 3 个选项，我们重点看 APPID 这一项。

APPID 代表微信小程序的 ID 号，必须拥有微信小程序账号才可以申请这个 ID 号。读者可以到微信公众平台官网注册申请微信小程序账号，注册地址为：

遗憾的是截止本书完稿时，小程序账号并不对个人开发者开放，只对企业、政府和组织开放。没有 APPID 将无法在真机上运行小程序，但并不影响我们学习小程序开发，小程序开发工具提供了一个很好的模拟器，可以在 PC 或者 Mac 下模拟小程序的运行。本书中的绝大多数功能都可以在 PC 或者 Mac 下运行，少部分无法在模拟器下运行的功能，本书也会使用图片的方式向读者展示运行效果，不用担心没有 AplD 无法真机运行小程序的问题。

既然没有 APPID，那么我们就选择【无 APPID】这个选项。【无 APPID】主要用于方便开发者学习和调试。相比于有 APPID，无 APPID？模式的运行环境非常宽松，例如，无 APPID 环境下无须配置可信任访问域名、不会校验 TLS 版本等（这些特点将在本书的后面具体来讲解，读者现在无须搞懂这些内容）。现在，我们只需要选择「无 APPID」即可。

按照以下步骤创建第一个小程序项目。

步骤 

01 在【APPID）选项选择【无 APPID

02 填入一个项目名称，如 Hellolittleapple。建议使用英文，中文可能会引起一些未知错误。

03 选择一个空的文件夹用于存放小程序项目文件（注意，一定要选择一个没有任何文件的空白文件夹，最好是能够新建一个文件夹）。

成以上 3 步后，页面下方将出现一个【在当前目录中创建 quick start 项目】的复选框。如果没有这个复选框，绝大多数原因是因为在上面的第三步里，你选择的文件目录不是一个空文件夹，请重新选择一个空白文件夹。小程序没有显著区分「新建一个项目」和「打开ー个已存在的项目」。如果你选择的目录是一个空的文件夹，则小程序会认为你是想「新建项目」；而如果你选择的文件目录不是空文件夹，则小程序会认为你是要「打开一个已存在的项目」而不是要「新建一个项目」。所以，如果你想打开ー个已存在的小程序项目，那么直接选择这个项目的文件路径即可。

按照上述 3 步完成设置后，点击右下角的「添加项目」，将成功创建一个官方提供的示例项目。

## 2.3 微信 Web 开发者工具界面功能介绍

成功创建项目后，将进入到如图 2-6 所示的开发者工具主界面中。

在主界面最左侧垂直分布着 5 个选项卡：编辑、调试、项目、编译和关闭。当点击（调试后，左側下半部分还会出现「后台」和「缓存」这 2 个选项卡。下面依次来介绍这 7 个选项卡。

### 2.3.1 编辑选项卡

如图 2-6 所示的界面就是编辑选项卡的主界面。编辑界面分为左、中、右 3 部分。左边是模拟器的预览视图，中间是代码的树状目录，右边是代码编辑区（也就是写代码的地方）。

我们来看看左边模拟器的相关功能。左边的模拟器可以模拟微信小程序在客户端真实的逻辑表现，我们可以在这里预览到小程序的运行情况，如图 2-7 所示。

「Hello World」的这部分就是官方示例项目运行的实际效果。

在模拟器的顶部有如图 2-8 所示的一条工具栏。点击工具栏最左側的小图标可以将模拟器关闭，再次点击则会打开模拟器；中间的「iphone6」这一栏可以让开发者选择模拟器的机型用来模拟小程序在不同机型上的运行情况；最右侧的「wifi」一栏，可以让我们选择不同的网络环境。

中间部分是项目文件的树状管理器，这里可以整体预览我们的代码文件与组织关系。在这部分的顶部，如图 2-9 中，有 3 个较为重要的功能：最左侧的小图标点击后会隐藏树状文件管理器；中间部分显示了项目的项目名称；最右侧的。小图标用来执行一系列的文件相关操作。

点击图 2-9 中最右侧的「...」小图标将出现如图 2-10 中框选的区域。

图 2-10 文件操作功能选项卡

点击（硬盘打开）将可以在 Windows 中打开项目的文件目录，点击（查找）可以搜索包含相关关键字的内容，点击（新建）将打开如图 2-11 所示的菜单。

在新建菜单中可以新建文件夹与 4 种类型的小程序文件，关于这 4 种类型的小程序文件（js、json、wxml、wxss）将在文后具体介绍。除了可以在顶部打开新建菜单外，如果想在某个指定的文件夹内新建文件或者更改某个指定文件的文件名，可以将鼠标移动到相关文件夹或者文件上，这时同样会在鼠标悬停的位置出现「...」小图标，点击后即可打开类似如图 2-11 所示的新建菜单。

整个【编辑选项卡】的右半部分是代码编写区域，如图 2-12 所示。

代码编辑区域比较简单，这里就不再赘述了。

小程序开发工具目前功能比较简单，比如无法调整字体大小。这里介绍一个方法可以放大整个开发工具，从而间接实现放大字体：按住 CtrI，并滑动鼠标滚轮从而实现字体放大或者缩小。但是这种方法是通过放大整个开发工具来实现的字体放大，副作用就是左侧的（模拟器）会出现黑色的边框。希望微信尽快完善小程序开发工具的基本功能。

### 2.3.2 调试选项卡

图 2-13 展示了调试选项卡的界面。

区域 1）模拟器同编辑选顼卡功能一样，这里就不再赘述了。

区域 2) 展示了小程序经编译后生成的文件和文件结构。

区域 3) 是编译后的文件内容查看区，可以在这个区域的文件里设置调试断点。

区域 4) 调试功能区，可以在这里查看変量状态与数值、断点设置情况、变量作用域等。这个区域和 Chrome 浏览器里的调试工具几乎一样，调试的方法和快捷键也是相同的。

区域 5) 信息输出区域，这个区域会显示程序运行的错误信息、警告信息以及用户自己打印的相关信息（通过 console. Log 输出的信息）

如何在小程序中调试？

可以在（区域 3) 中点击每行代码前的行号设置断点。当代码运行到断点处后，将停止。常用快捷键有 F10 单步执行，F11 进入方法，F8 继续运行到下ー个断点。更多快捷键可自行在（区域 4) 中查看。

在整个调试选项卡中，最重要的部分还是（区域 2) 和（区域 3）顶部的 6 个功能模块，如图 2-14 所示。

我们逐一介绍这 6 个模块儿。

Sources Panel 是默认的 panel，用于显示当前项目的脚本文件。如图 2-13 所示区域 2、区域 3、区域 4 就是 Sources Panel 的内容。

Console Panell 用于调试和输出信息，开发者也可以在这里输入代码。这个 panel 在 Sources 模块中同样存在，如图 2-13 中的区域 5。当点击 Console 后，console Panel 将变大，使开发者可以浏览到更多信息，如图 2-15 所示。

Network Panel 主要用于观察和显示网络连接的相关情况。这里的 Network Panel 和 Chrome 浏览器里的 Network Panel 几乎一样。如图 2-16 所示。

Storage Panela 用于显示当前项目的数据缓存情况，如图 2-17 所示。关于数据缓存将在项目开发中具体讲解。

图 2-17 Storage Panel

Appdata Panel 用于显示项目中被激活的所有页面的数据情况，这些数据主要是用来做数据绑定，如图 2-18 所示，关于数据绑定我们同样放在项目开发中具体讲解。在这里不仅可以查看数据情况，还可以更改数据，小程序框架会实时地将数据的变更情况反馈到 U 界面上。

Wxml Panel 是非常重要的一个功能模块，如图 2-19 所示。这个模块类似于 Chrome 调试工具下的 Elements 模块，主要用于调试 wxml 标签和相关 CSS 样式，调试方法同 Chrome 一样。如果你是一个前端新手，那么建议好好地摸索一下这个功能模块的调试技巧，绝大多数和样式、标签相关的问题，都需要依靠这个 Panel 来调试。

以上的 6 个模块功能对我们开发非常有帮助。如果你在开发中遇到一些稀奇古怪的问题，那么最好的解决办法就是使用这 6 个 panel 来解決。我们在后面的章节中也会经常回过头来讲解这些 panel 的使用技巧，并使用这些 panel 解决我们的问题。

以上 6 个 panl 包含的功能非常多，不需要现在就把每个 panell 的细节了解的非常清楚。笔者的建议是知道以上 6 个 panel 是做什么的以及它们简单的使用方式即可，在后续的内容中将会用实际的数据来演示如何使用这些 panel，开发者无须担心，轻轻松松地继阅读本书吧。

### 2.3.3 项目选项卡

项目选项卡主要用来管理和设置项目，如图 2-20 所示。

项目选项卡主要有 3 大功能：显示当前项目细节、预览及上传项目以及项目配置。我们来具体看看每项功能的作用。

### 显示项目细节

阳图 2-20 所示的顶部显示了项目名称和 App ID。如果我们新建项目时选择的是「无 APPID」，则这里将会固定地显示一个「touristappid」；如果你设置了项目的 APPID，则这里会显示项目的 APPID。

### 预览及上传项目

预览按钮可以实现在真机上运行小程序，但前提条件是你必须有一个微信小程序账号。如果你有小程序账号，则可以得到一个 APPID，新建项目时，填入这个 APPID 即可。关于小程序账号的相关配置，我们将在本书的后面章节中详细介绍。由于我们在新建项目时选择的是「无 APPID」，这里的预览按钮将处于灰色不可点击的状态。上传按钮用于上传和发布项目，上传的项目将可以在小程序账号后台页面中査看到。同样，由于选择的是「无 APPID」，这里目前也是处于灰色不可点击状态。

### 项目配置

在目前版本中，总计有 5 个配置选顼，下面我们逐一介绍。

1）开启 ES6 转 ES5。小程序支持使用 ES6 来编写代码。如果使用 ES6 来编写代码，框架会默认使用 babel 将开发者的代码转化为 ES5 代码（这样做的主要原因是为了保持对三端：iOS、Androidi 和开发工具模拟器的良好兼容性）。开发者可以在项目中关闭这个选项。2）开启上传代码时样式自动补全。开启此选项，开发工具会自动检测并补全缺失样式，保证在 iOS 8 上的正常显示。3）开启代码压缩上传。开启此选项，开发工具在上传代码时将会帮助开发者压缩 Javascript 代码，减小代码包体积。

4）监听文件变化，自动刷新开发者工具。开启此选项后，如果代码发生了改变（需要 CtrI+S 先保存），小程序开发工具会自动帮助开发者刷新调试模拟器，从而提高开发效率。也就是说，开发者不再需要手动地点击编译按键即可实时预览小程序运行效果，这是非常好用的一个功能。5）开发环境不校验请求域名以及 TLS 版本。开启此选顼，开发工具将不会校验安全域名以及 TLS 版本，帮助在开发过程中更好地完成调试工作。我们前面提到过，在开发工具里如果选取了「无 APPID」模式，那么开发工具的安全限制级别非常低，不需要使用 https 访问服务器，也不会校验 TLS 版本。但如果我们填入了「APPID」，那么默认情况下开发工具的校验行为会和真机环境保持一致，比如，必须使用 https 访问服务器且服务器域名必须加入到微信小程序账号中的可信任域名列表中。如果我们不想接受这样的限制，又想使用「APPID模式」，那么需要把「开发环境不校验请求域名以及 TLS 版本」这一项给勾选上。

ES6 转 ES5 的转換，只会帮助开发者处理语法上的问题，新的 ES6 的 API 例如 Promise 等需要开发者自行引入 Polyfill 或者别的类库。同时，为了提高代码质量，在开启 ES6 转換功能的情況下，默认启用 Javascript 严格模式。开发者可以自己査阅资料了解什么是 Javascript 的严格模式。

### 2.3.4 编译选项

严格也说，「编译」选项不是一个选项卡，只是一个功能按键。编译选项分为两种：默认编译和自定义编译。特别注意编译按键有 2 个小图标，上面的图标是默认编译，下面的小图标是自定义编译。如图 2-21 所示。

编译快捷键 Ctr+B。最新版本中的小程序已经增加了实时预览的功能，在更改代码后只需要使用 Ctrl+S 保存，开发工具就会自动编译、更新代码。

但笔者在实际的开发过程中也发现，有时候 Ctrl+S 保存后代码运行会出现异常。这个时候，请手动点击执行一下编译。

关于自定义编译的设置，将放在项目文章详情页面一章中讲解。

### 2.3.5 后台选项

同「编译」选项，「后台」也是一个功能按键，可以在模拟器中模拟应用程序的前后台切換操作。以 iphone 为例，当我们运行一个应用程序时，点击 iphone 的「Home」键，应用程序将被切换到后台，但并没有关。具体的功能作用我们会在后面章节介绍小程序生命周期时讲解。

### 2.3.6 缓存选项

缓存是非常重要的一个功能选项。点击「缓存」会出现一个子菜单，包括 4 个选项：清除数据存储、清除文件存储、清除工具授权数据和清除手机授权数据。缓存选项是开发工具提供给我们用来进行数据存的小工具。关于数据缓存和文件缓存我们将在后面的项目章节中深入讲解。

### 2.3.7 关闭选项

「关闭」选项点击后将关闭开发工具，但开发工具并不会完全退出，而是会停留在项目选择页面。小程序现在还处于公测阶段，开发工具的 bug 还比较多。很多 bug 的暂时解決方法和我们经典的「重启电脑」类似，重启一下开发工具就好了。所以如果你遇到一些莫名其妙的现象，比如在早期的版本中，有时候某些事件会执行两次，这个 bug 当你重启开发工具后就不会再出现，你可以尝试完全关闭开发工具再开启。这里提醒一下大家，重启开发工具需要完全关闭开发工具，而点击「关闭」后并没有完全关闭开发工具，需要继续叉掉项目选择页面，才算完全退出。

### 2.3.8 快速打开官方 API 文档

作为一个开发者，官方 AP 文档的使用会非常频繁。不同于其他开发工具 F1 是帮助选项，小程序的 F1 给出的是（查看命令面板）这项功能。小程序提供了一个快速打开官方文档的方法，即点击开发工具左上角的「帮助」→「关于」，在弹出的「关于」对话框中点击【点击打开文档】，即可马上进入官方 API 文档。

官方 API 文档除了用于经常查阅 API 外，推荐大家在版本更新后第一时间去查看更新内容。最新的更新内容对我们开发者来说尤其重要，更新内容通常会出现在官方 API 文档的「工具」「下载」以及「历史更新日志」里。

### 2.3.9 开发工具的更新

微信小程序开发者工具将自动更新，无须开发者手动更新。每次启动开发工具后，如果有新版本则会自动提示下载。

在 Windows 下，如果开发者重启开发工具后依然没有自动更新，请退出开发工具，右键点击开发工具图标，选择「以管理员身份运行」。以上解决方案在 Windows 10 下测试可行。如果以上方案都不可用，请前往官网下载并安装最新版本的开发工具。

### 2.3.10 常用小程序快捷键

#### 01. 格式调整

Ctrl+S：保存文件

CtrI+[, Ctrl+]：代码行缩进

Ctr+ Shift+ [, Ctrl+Shif+]：折叠打开代码块

Ctrl+ C Ctrl+V：复制粘贴，如果没有选中任何文字则复制粘贴一行 

Shift+Alt+F：代码格式化 

Alt+Up, Alt+Down：上下移动一行

Shift+At+Up, Shift+ Alt+Down：向上向下复制一行 

Ctrl+ Shift+Enter：在当前行上方插入一行 

Ctrl+Shift+F：全局搜索 

#### 02. 光标相关

Ctrl+End：移动到文件结尾

ctrl+Home：移动到文件开头

Ctrl+i：选中当前行

Shift+End：选择从光标到行尾

Shift+Home：选择从行首到光标处

Ctrl+Shit+L：选中所有匹配

Ctrl+U：光标回退

#### 03. 界面相关

Ctrl+：隐藏側边栏

Ctrl+m：打开或者隐藏模拟器

本章我们主要预览了整个微信 Web 开发者工具的全貌。笔者一向认为，工具的使用需要用具体的案例来推动，我们会在后续的项目编写中经常使用这几个选项卡和工具来解决开发中遇到的各类问题。下一章，我们将正式开始小程序的编码之旅。
