# 01 微信小程序简介

本章我们将介绍小程序的一些基本概念及特性，让大家在正式学习小程序开发前，对小程序有个整体的认知。当然，本章你也可以完全跳过，因为它不会涉及任何「代码」方面的内容。但笔者还是建议各位读者能够耐心地看一下，技术在这个时代正在以目不暇接的速度日夜更替，尤其是 Web 技术，所以了解技术更迭的原因和意义也很重要。

## 1.1 什么是微信小程序

什么是微信小程序：小程序是一种不需要下载安装即可使用的应用，它实现了应用「触手可及」的梦想，用户扫一扫或者搜一下即可打开应用。也体现了「用完即走」的理念，用户不用关心是否安装太多应用的问题。应用将无处不在，随时可用，但又无须安装卸载。

张小龙

微信之父张小龙用这段略帯文艺气息的描述给小程序做了定义。但小程序无论从技术上还是从理念上都不是一个新事物：从技术上讲，它借用了 React Nativep 的一些概念，定义了一套微信自有的组件并根据运行环境的不同（PC、iOS、 Android）将这些组件编译 / 转化为对应平台的可运行组件；从理念上讲，百度早年的「轻应用」、QQ 右下角的「应用宝」还有支付宝里的各类小服务，早已是小程序的维形。

我们来直观地感受一下小程序，如图 1-1~ 图 1-4 所示。

我们本以为小程序确实就像张小龙所说的，只适合去做用完即走的服务。但事实是，各种类型的应用五花八门，早已超出了公测时大家都普遍认为的小程序只适合做低频类的应用（内容型应用是内侧时普遍认为最不适合做成小程序的一类应用），甚至腾讯官方直接首发了一款体验非常不错的腾讯视频小程序（这是哪门子的用完即走？）。

所以，只有你不敢做，没有你不能做（游戏类小程序目前是不能做的，直播类的有待商榷）。官方所谓的「用完即走」只是一个建议，并不是约束。但我们要清楚地认识到，能不能做和合不合适做是两个概念，这取決于小程序版本的各类应用相比原生 App 到底有哪些优势。可能是成本上有优势，可能是推广上有优势，也可能是同微信原生功能结合有优势，这需要开发者均衡考虑。本书还是以官方所谓的「用完即走的轻服务」为基本出发点进行论述。

有人会质疑，这和我们常用的 App 并没有什么区别。确实如此，小程序并没有逃脱 App 的范畴。事实上，小程序也只是 App 的一种。那小程序的优势在什么地方？

我们试想一下，如果上图中的这些应用并不是「寄生于」微信中，而是以原生 App 的形式存在于 Appstore 或谷歌的应用市场中，而我们每次使用都需要经历「打开 Appstore」→「搜索应用」→「点击下载应用」→「安装应用」→「使用应用」，这个过程是相当烦琐的。关键是，很多应用我们并不会经常使用，可能一个月甚至一年才会使用 1 到 2 次，而这些「低频」的应用却要长期地「驻扎在」我们的手机中，需要我们去管理这些应用的「生命周期」，这个体验是不太好的。小程序要的就是「随时可用，触手可及」，而现在的 App 太重了。

小程序的出现就是希望用户不用安装那么多的 App，你想用什么服务，只需要在微信中「扫一扫」或者「搜一下」即可享受到「触手可及」的服务，「无须下载安装」，用完后也不需要管理它，「即用即走」。

讲到这里，你可能对「小程序」有一些失望。并不是那么「惊天泣地」，不是吗？确突是这样，如果不是腾讯已经成为社交领域独一无二的寡头，「小程序」这样的开放平台很难付诸实现（我们之前提到过百度的轻应用，知道的人有多少？），也不会像现在这样引爆整个互联网圏儿。但在个超级 App 中做一个「应用市场」（虽然腾讯极力否认小程序是应用市场，但不可避免它拥有「应用市场」的特质），向着「操作系统」的概念「策马奔腾」，微信确实是开创了先河（至少是首先付诸行动的）。关于小程序商业模式上的讨论有些偏离了本书的主旨，这里就不再展开细讲了。

小程序还有以下若干「别具一格」的特性。

1. 小程序没有「官方的」应用市场，为什么强调是「官方」？因为截止到微信正式开放小程序不到一周的时间，不少第三方的小程序应用市场已经「亭亭玉立」。

2. 和微信公众号不同，小程序不能被关注。所以，在小程序中没有粉丝这个概念。

3. 小程序没有群发消息和主动推送消息的能力。

4. 微信中没有明显的小程序入口，但是发现有一个「小程序」栏，它会记录用户曾经用过的历史小程序。这些小程序的排序也没有所谓的排名，用户最近使用的小程序排在最前面。要注意，很多开发者找不到这个「小程序」栏，可能的原因有以下两个：一是必须在微信中使用过小程序，这个小程序栏才会出现；二是开发者使用的微信版本不支持小程序，建议升级到最新版本的微信。

5. 获取和使用小程序的途径只有以下几种：扫描二维码、有限能力的搜索、从发现中的小程序进入并打开曾经使用过的小程序以及来自于朋友或者群聊分享的小程序。注意只能扫描二维码，不能长按二维码。之前是可以支持二维码长按进入小程序的，这会造成大量的二维码被附加在公众号里用来传播，所以微信干脆将「长按二维码」进入小程序的功能给屏蔽了（未来微信可能会再次放开「长按二维码」这个限制）。

6. 小程序名称不能和公众号相同。

7. 有一定的分享能力，可以分享给朋友和群聊，但不能分享到朋友圏。

8. 同一个公司的公众号和小程序可以相互发现。公众号里可以看到该公司的小程序，同时，小程序里也可以看到该公司的公众号。点击后可相互进入到小程序或者公众号中，如图 1-5 ~ 图 1-7。

## 1.2 什么类型的应用适合用小程序开发

2016 年 1 月 11 日，张小龙在微信公开课中首次公布了「应用号」，而在 2016 年 9 月 21 日，微信正式开始了「应用号」的内测，但是却改称为「小程序」，据说是苹果不让叫「应用号」。「小程序」这个名字确实非常符合张小龙对于这类应用的定义。

再次强调，适合不适合只是相对的，除了游戏和直播，微信官方并没有明确限制你不能做什么类型的小程序。而且现在已上线的小程序已是「乱花渐欲迷人眼」，早就将张小龙的「用完即走」抛到了九霄云外。我们只能描述它本来应该是什么样子的，至于为什么那么多小程序都不是「用完即走」的，笔者只能说，一个刚起步的生态对创业者和开发者的诱惑力实在是大大了。

「简单的」、「低频的」、「对性能要求不高的」应用适合用小程序来开发。「简单」是指应用本身的业务逻辑并不复杂，比如外卖应用「饿了么」，业务逻辑就非常简单：挑选想吃的菜肴，下单、付款；再比如在线购买电影票应用「猫眼」，就是为用户提供在线购买电影票的服务，整个服务的时间是短暂的，「买完即走」。还有各类 O2O 家政服务、打车类应用、天气预报类应用，都符合「简单」这个特性。相反，一些游戏类、社交类、视频直播类应用则业务相对复杂很多，用户在应用里停留的时间也会较长，这类应用就不太符合「简单」这个特性。对于业务复杂的应用，小程序无论从性能上和体验上都没有办法满足这类应用。

「低频」是小程序使用场景的第二个特点。如果某种应用的使用频度很高，比如社交类的 QQ，金融类的支付宝、招商银行，社区类的百度贴吧、知乎等，由于使用的频度较高，以 iOS 或者 Android 的形式提供给用户会更好。当你使用小程序时，需要先打开微信再进入小程序，这对于高频的应用并不是太方便。小程序目前来看，还是适合做一些如手机充值、电影购票这类使用频度不高的服务。举个例子，当你正在微信中聊天，突然想起手机没话费了，那么就「顺手」点开小程序为你的手机充值。但是，如果你经常需要特意地去寻找某类应用，又长期需要这类应用，那么还是以原生 App 的形式提供给用户比较好，用户为这类应用去下载、安装和管理这个应用的系列操作是值得的。

「对性能要求不高」是因为小程序寄生于微信这个原生 App 中，又受限于 Web 技术的性能制约，注定它无法去开发对性能、体验要求很高的应用，比如「保卫萝ト」、「阴阳师」等这类游戏应用。此外，小程序还处于发展初期，没有太好的技术和工具去支持这类复杂度较高的游戏（没有类似于 Unity3D 这样的专业游戏开发工具）。

小程序特别适合做线下的场景化应用，官方的一切措施都是为了将小程序导向线下，关于这点，笔者已经在【我眼中的小程序】中详细描述过，这里就不再赘述了。

## 1.3 小程序与原生 App (iOS、Android）的优劣对比

前文讲过，小程序也属于 App 的一种，那么它和我们现在流行的原生 App (iOS、Android）相比，有什么区别和优势呢？

首先，从技术上来讲，目前 App 的主流开发方式有三种：Web App、Native App 和 Hybrid App。我们举几个例子来看看：

1、Web App。在微信「发现」里面有一个《购物」入口，点击进去打开的是京东的移动购物页面，这个页面实际上就是一个 Web App。支付宝的众多小服务也是 Web App，还有「海底捞」在微信中的排号应用，这类 App 其实就是我们经常在 PC 上浏览的网页，只不过加入了响应式的设计让它适合在移动端显示和运行，所采用的技术依然是 Javascript CSS 和 HTML。相对于其他两种 App，Web App 具有开发简单、高效，更新灵活、跨平台，大量的网页应用稍作调整即可放在移动端运行。但缺点与优点并存，Web App 性体验极差（对，是极差），无法使用照相机、系统通知、本地缓存等原生特性。

2、Native App。也称为原生 App。这种 App 不是采用 Javascript、CSS 及 HTML 开发，而是使用 Objective-C (iOS）或者 Java (Android）开发。微信、支付宝、斗鱼 TV 等都属于这类 App，是目前主流的开发方式。Native App 具有性能、体验非常良好，组件支持完善、接口丰富等特点。但 Native App 最大的缺点在于，不能跨平台，有多少个平台就要开发多少个版本，现在主要有 iOS 和 Android 两个主流平台，还好 Windows Phone 已没了踪影。

3、Hybrid App。也称为混合式 App。Hybrid Appa 看上去像一个 Native App，但实质上 Native 技术在这里只是作为一个容器，将 Web App 包裹了起来，在容器内部实质上运行的还是网页。Hybrid App 更像是 Web Apps 与 Native Appa 的混合体。与纯粹的 Web App 相比，Hybrid App 会有一部分访问原生组件（相机、加速器）的能力。事实上，目前主流的应用中，纯粹的原生 App 很少，绝大多数都属于混合式 App。比如，我们常见的京东、淘宝等电商类 App，由于商品及业务变化非常频繁，需要经常调整，所以这类 App 的主要页面都是采用 Web 技术来构建，只是用 Native 包装了ー下。那我们如何界定，哪些 App 属于「原生」，哪些 App 属于「混合」呢？答案是：看 Web 页面在 App 中所占的比例，如果绝大多数页面都采用 Web 技术构建，那么我们称为混合式 App；而如果只有少数页面采用 Web 技术，我们称为原生应用。举个例子，今日头条这类新闻应用中绝大多数页面都采用原生技术实现，笔者倾向于称它为 Native App；而对于淘宝、京东等 App，笔者更倾向于是 Hybrid App。Hybrid App 具有接近于 Native App 的体验、开发效率高、跨平台等特性。

有一些开发者认为微信服务号里的网页应用也属于 Hybrid App，这种说法也不无道理。因为这些网页应用也属于微信这个 Native 应用的一部分，同样运行在微信内置的浏览器中，但这是个 App 所有者的问题。对于微信，确实是 Native Appi 中加入了部分「网页」，具有 Hybrid App 的特点。但我们上面讲到，目前主流 App 里很少有纯粹的 Native App，是不是算作 Hybrid App，应该看 Web 页面在 App 中的所占比例。微信是一个以社交为主要业务的 App，微信中的绝大多数核心社交与聊天功能都是原生的，所以我们还是称微信为 Native App。但是，对于服务号应用的开发者，微信并不是开发者开发的，开发者只拥有其服务号。而且服务号应用所用到的所有技术都只局限在 Web 技术里，从这一点来讲，服务号的应用应该归属于 Web App 的范畴。

此外，我们说 Hybrid App 具有一部分可以访问原生设备组件的能力。微信的 JS-SDK 确实提供了一些如拍照、录音、扫一扫等功能的接口，但相比于其他 Hybrid App 能调用的原生功能，实在是有限。从这个角度来讲，也应该将这些服务号的应用归属到 Web App 中。其实，到底归属于什么并不重要。互联网技术中的概念层出不穷，对很多事物的定义本来就不是很明确。这里用一些篇幅解释 3 种主流类型的 App，是希望大家在对比小程序和其他类型 App 时，能有一个较完整的知识背景。

那么小程序属于以上 3 种的哪一种？严格意义上来说，它不属于以上 3 种中的任何一种，在实现技术上小程序同传统的 Hybrid 还是有很大的不同的。小程序采用 Javascript 和 CSS 这类常见的 Web 技术开发，但它又不使用 HTML，它同 Web 没有直接的联系。小程序实际上是将一系列自己定义的组件编译成了对应平台（iOS、Android、PC）的相应可运行组件，以提高运行性能。如果一定要将小程序归并到以上 3 类 App 中，可能 Hybrid Appe 更合适：非原生，但使用到了 Web 技术（Javascript 和 CSS）。

相比于 Native App，小程序具有 hybrid App 的一些优势：1）跨平台（对于 iOS 和 Android 两个平台只需要开发一套程序）。2）具备接近于 Native Appe 的体验（注意只是接近）。3）对原生组件有访问能力。4）具备缓存能力。5）上手容易，开发逻辑较为简单。

同时，小程序还具有一些它独有的特点：1）小程序在设计时就做了很多约定式的规范：比如简单的文件结构、默认的文件命名、内置好的 Tab 栏与导航栏等，这让小程序的初学者更容易上手和理解。2）开发环境很干净，你无须安装任何除开发工具外的其他软件。当然现在这个工具简陋的可怕，很多常见的 IDE 功能都不具备，但相比于其他 hybrid App 的环境要求，小程序这点真的很棒。3）发布和部署流程非常简单，几乎是「傻瓜式」，点击几下就可以将应用发布到腾讯云。4）小程序之所以在公布后引起了互联网圈儿和开发者们极高的关注度，原因并不在技术上，无数开发者、创业者看中的是微信天然的关系链与获客能力。这也是小程序最大的优势。

但是，世间没有完美的事物，计算机世界里也没有完美的技术，你以为的优势在另一方面却成了缺点。我们一起来看下：

1）小程序为了简化复杂性，做了一些 UI 上的设计规范，确实方便了很多对要求不高的应用。但这也限制了那些对 UI 要求极高的产品发挥。

2）小程序很遗憾地不支持现有的 HTML DOM 结构，而是自己给出了一系列的组件，造就了一个封闭的开发环境，这直接导致了现有的经典 Javascript 框架、类库都无法使用。小程序现在的生态几乎是荒芜一片，等待着开发者们去耕耘（挑战与机遇并存，正因为没有，才有机会）。如果你想用小程序实现一组图形来展现股票或者天气的曲线，目前来看，相当烦琐。你无法使用经典的 echart 或者 highchart，你只能自己用 Canvas 来一点点地绘制。

3）截止到笔者编写本书时，小程序还不支持 WebView，这是相当头疼的一个问题。现在很多新闻类型的应用，都是将文章数据静态化成 HTML 存储在服务器或者是 CDN 中，然后再利用 WebView 直接加载这个 HTML 来显示。不支持 WebView 直接导致了很多内容型应用没办法加载已存在的大量 HTML 页面。内容型应用现在大量的静态化页面需要被转化（已有一些第三方的组件实现了 HTML 转 WXML，基本思路是用正则表达式替换 HTML，但效果并不能让人满意）。至于微信会不会官方支持，这个很难抉择。不支持 Webview 对现在的静态化 HTML 页面是致命的打击；但兼容 Webview 就意味着在小程序里你还可以运行 Web App，而 Web App 很难去监管，性能体验也不够好，这对于小程序的发展是不利的。也许开放一个只解析 CSS 不允许运行 Javascript 的 Webview 可能是个不错的选择，微信如何平衡这个问题，我们拭目以待。

4）小程序只实现了模板化并没有实现自定义组件，这是最令人不满意的地方。如果我们想实现个自定义逻辑的组件，通常希望把这个组件的标签、样式以及业务逻辑打包在一起，然后可以放在项目中多个地方使用。外部客户端调用组件时，只需要传入组件所需要的参数，由组件自己来完成数据获取、转化、绑定并和层通信等操作。但小程序里的 template 只能将标签和样式（WXML 和 WXSS 文件）提取出来作为一个「模板」，却无法把组件的业务逻辑（js 文件）放在起。也就是说，组件的业务逻辑不能够写在组件的模块儿中，只能写在「调用」组件的业务代码中，这就无法很好地复用组件的业务代码。原因我们会在后面讲到模板「template」时再来详细讲解。

我们用表 1-1 来对比小程序和现在主流 App 的优劣势。

## 1.4 小程序会淘汰原生 App 吗

不会。连 Hybrid App 都无法撼动 Native App 的地位，又何况小程序本身只是 Hybrid App 的一个子集，运行在微信这个 Native App 之下呢？除了 Hybrid App 本身与 Native 技术的差距，微信对小程序还附加了诸多限制，比如安装包大小不能超过 1MB，不能做直播类和游戏类应用等。

小程序的定位也非常明确一一做低频和业务逻辑不复杂的应用，原生 App 与小程序之间更多地将是一种互补的关系，绝对谈不上取代。

预计小程序将是 MVP 产品的践行地，是一个快速试错和调整产品思路的平台；同时绝大多数的产品也将推出自己的小程序，将全部或部分功能移植到小程序上占领更多的入口。一个平台是否流行，真的不取决于技术本身是否优秀，更多的时候开发者需要一个「理由」，无论是技术上还是商业上的理由，而微信海量的用户、全新的应用市场就是微信给开发者的一个理由。公正的评价，小程序确实在技术上无创新，但也的确具备巨大的商业价值。

## 1.5 Web 前端的未来

相比于 iOS 和 Android，Web 前端对技术的需求度确实要高出很多。iOS 和 Android 是为移动端量身定做的系统，移动端的局限性本身就决定了它很难作为主要的生产力工具。虽然这些年有很多移动端 App 致力于将手机变成生产力工具，但诚实地讲，如果自然语言或者其他更先进的人机交互方式不出现，移动设备很难成为「名副其实」的生产力工具。「PC 已死论」、「微软已亡论」流传了好多年，可无论是 PC 还是微软现在都活得很好。这其中一个原因还是在于人类不能只消费，还需要生产，而 PC 作为信息化社会的主要生产力工具，这是移动端无可替代的。

我们在移动端更多的时候是去用眼晴「看」，而我们在 PC 端更多的是用手去「操作」。从信息的角度讲，移动端主要负责信息的输出，而 PC 端主要负责信息的输入。有过开发经验的朋友应该体会到，相对于纯粹的显示，有「输入」操作的应用开发难度和开发成本是要高很多的。目前市场上对于 iOS 和 Android 开发者的需求量已经接近饱和了，而 Web 前端由于其本身的特性，优秀的开发者相对偏少，市场的需求量是巨大的。即使一个公司的产品以 App 为主，也不可能缺少 Web 前端开发者。

1. 我们之前讲过，混合式 App 是现在的主流 App，一个 App 很难只用 Objective-C 或者 Java 来开发，必然会有 Web 技术介入。你只看几乎所有应用都有「分享到微信、QQ、微博」（分享的内容大多数都是一个网页）等功能就知道，Web 技术是必不可或缺的。

2. 大多数移动端应用也都有一个对应的 Web 网站。

3. 现在的公司做营销和推广都离不开做信，无论是 H5 页面还是做微信服务号、企业号都是纯粹的 Web 技术。

在小程序推出之前，Web 技术在移动端时代更像是一个「黏合剂」，无处不在却又不能够独立地承担移动端的开发。Web 技术和 Web 开发者一直处于移动时代的边缘，不能没有它们，却也无法自成一体。但以 React 为代表的 React Native 和微信小程序的出现，给了 Web 开发者希望。虽然在性能体验上依然不及原生应用，但已经相当地接近了。Web 开发者终于可以在主流的移动平台中占据一席之地了。

笔者常常惊収于 Javascript 顽强的生命力，作为最早的浏览器交互语言，当初仅仅被当作一个玩具。这个玩具却经历了漫长的 Web 时代，抗住了 Adobe 的 FIex 和微软 Silverlight 这些所谓「富客户端应用程序」技术的猛烈攻势，不仅在移动端时代没有消亡，反而「溜到」了「后台」，以 Nodes 的形式开始了自己的服务器之旅，现在又不「甘心」蜗居在 Web 的两端（浏览器和服务器），反而以混合式的技术形态强攻移动端。这个被 Brendan Eich 用了 10 天设计出来的脚本语言，以惊人的生命力横贯 Web 和移动时代，甚至还可以以「寄宿」的方式成为一个桌面应用程序。Javascript 在很长一段时间，由于设计时间太短，细节考虑的不够严谨，导致 Javascript 都是「程序混乱」的代名词，但即使这样，也无法阻挡它前进的脚步。

随着 ES2015 的普及，Javascript 変得更加完善与强大。而现在 Web 前端的发展呈现出的是一种百花齐放的姿态，发展与更新速度远超服务器技术的更迭速度。好事还是坏事，大家各抒己见，没有定论。但有一点可以确定，Web 前端开发将是一个非常具有挑战和想象力的工作，如果你刚好走在前端开发的路上，那么恭喜你，你正行走于时代的技术浪潮上。

## 1.6 Web 前端开发者与小程序

招聘网站上常见的技术类职位有：iOS、Android、Java、.Net、Web 前端、DBA、大数据等。

有没有可能未来会出现小程序开发者工程师这个职位？除了专业做微信开发的公司，小程序工程师这个职位在短期之内不会成为独立的一类职位，绝大多数的小程序将由 Web 前端工程师来开发。未来，你将看到的 Web 前端岗位要求会添加一句话：熟悉微信小程序开发者优先。正如现在的 Web 前端职位都要求应聘者精通 jquery、熟悉 AngularJS、Grunts 等一样，小程序也将是 Web 前端职位的一项加分项。

微信小程序更多的是 App 或者 Web 网页的另一个流量入口，但绝不会替代原生 App 或者 Web 网页（至少很长一段时间内是这样，未来小程序怎么发展还有待观察）。正如我们描述的微信对现在公司莒销的重要性，小程序也将成为 Web 前端开发者应该掌握的一门技术。

笔者认为，每个 Web 前端开发者都应该至少了解一下小程序，可以不精通，但至少应该写一个简单的 Demo，跑一跑，完善一下自己的技术栈和知识体系。你完全不需要把小程序当作一个平台或者是生态，你只需要把小程序当作和 jquery、AngularJS 一样的一个 Javascript 类库或者框架来学习即可。反正现在的前端框架多得泛滥，我们 Web 前端开发者也都在不断地开发和学习，多学一个体验接近于原生 App 的技术，何乐而不为呢？

## 1.7 MINA 框架与微信小程序

MINA 是官方小程序的内部开发代号，也是小程序运行框架的别名。据说 MINA 有 MINA s Not App 的意思。到目前为止，许多开发者并没有正确理解什么是微信小程序，它和我们在网页开发中常用的 Angularjs 和 vue 又有什么区别？

微信小程序并不是一项技术或者一个框架，微信小程序是一个生态，与之对应的应该是 iOS 生态和 Android 生态，其中微信小程序又与 iOS 生态极为相似，它们都非常封闭，而且审核非常严格微信小程序的审核比苹果还要严格。而 MINA 是小程序的一个框架，它提供了小程序运行所需要的接口、模型和机制。

## 1.8 微信小程序 beta 测试版

自 0.11.122100 版本后，微信官方开始引入测试版本的概念。微信会提前放出下一个版本的测试版，以供开发者提前对新版本进行测试并反馈 bug。比如，在 122100 版本后的一周内，微信就提供了下ー个版本的 beta 版。

测试版本的概念非常重要，可以让开发者预先知道下个版本的更新内容，建议开发者应该第一时间使用测试版本测试一下自己的小程序。

本章我们对小程序做了一个较为全面的介绍，让大家在开始开发前对小程序有一个较为全面的了解。

本章主要介绍了小程序的特性与商业价值，并没有涉及开发方面的知识。小程序是一个新的生态，开发者有必要充分了解小程序的优劣。现在的技术，条条大路通罗马，选择是多样性的，只 有充分了解一个技术 / 平台的特性，才能做出正确的选择。

除此之外，小程序的开发相对来说比较简单，至少笔者认为学习难度和学习曲线都在 Angularjs、Vue 和 React 之下。