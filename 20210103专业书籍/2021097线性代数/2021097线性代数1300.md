## 序

我很高兴你看到了「线性代数引论第五版」，这是我在 MIT 开放课程（ocw.mit.edu 以及 YouTube）的视屏演讲的文字版。我希望这些演讲对你有所帮助（或许也是愉悦的！）

上百所学院与大学已经选用这本教科书作为基础线性代数课程的教材，一个较长的假期给了我机会来准备关于概率与统计与理解性材料的两个新章节，其中也包含了只有作者可知的上千处改善.. 以下是关于学生与读者的新增论述：

每个段落以简要的摘录作为开头来说明段落内容，当你读到一个新段落，

以及当你重新复习个段落并且在心中整理时，这些条目是一个快速指引，

而且可以协助记忆。

另一个较大的变化来自本书的网址 math.mit. edu/linearalgebra，这个网址现在包含了书中问题集的解答。在无限的空间中，可以比印出简短解答更具弹性，我们有三个关键网址：

ocw.mit.edu 这个开放课程网址包含来自成千上万学生与组织的关于线性代数的信息。18.06 与 18.06SC 课程包含了一个完整课程学期的演讲视频，这些演讲提供基于本书整体主题的独立复习－- 教授的时间保持自由，学生时间固定在凌晨 2 点（读者完全不需要参与。）全世界六百万的观众看过这些视频（惊人！），我希望你觉得这些对你有帮助。

web.mit.edu/18.06 这个网址包含目前教授课程的作业与考试（附有解答），可以回溯到 1996 年。网站还包含复习问题，Java 展示，教学代码，以及短论文（以及演讲视频），我的目的是基于我们能够提供的课程材料，尽可能让本书对你有所帮助。math.mit.edu/linearalgebra 这个网址目前非常活跃，包含了习题解答，而且有观念说明。同时也包含来自许多不同课程的习题作为复习 — 实际问题，教科书范例的发展，MATLAB 代码，Julia，Python，以及考试集（18.06 与其他）。

请参访线性代数网站，发送建议到 linearalgebrabook@gmail.com 2

第五版

本书封面展示目四个基础子空间 —－左侧是行空间与零空间，右侧是列空间与 AT 的零空间，这样展示主题中心概念的方式并不多见！当你在第三章接触这四个空间时，你会了解为什么这张图是线性代数的中心思想。

本书把这些空间称为四个基础子空间，他们全部来自一个矩阵 A。A 的每一行都是 n 维空间中的向量，当矩阵具有 m 个行时，每一列都是 m 维空间中的向量。线性代数中最重要的运算是取得列向量的线性组合，这正是矩阵－向量乘积的结果，Ax 是 A 的列的一个组合。

当我们取得列向量的全部组合 Ax 时，我们就得到列空间，如果这个空间包含向量 b，我们可以求解方程式 Ax=b。

我会给予段落 1.3 更多的关注，段落中较早引进两个特殊范例，没有要求你在一天内了解向量空间的每个细节！但是你会在本书看到重要的矩阵，以及他们的列空间图形，这里甚至存在逆矩阵与微积分的关联，你将以最佳与最有效的方式学习线性代数的语言：用就对了！

基础课程的每个段落都会以大量的复习问题集作为结束，要求你使用该段落的观念－列空间的维度，空间的一组基，以及 A 的秩，逆，行列式与特征向量。很多问题需要你针对小型矩阵进行手算，这些都是获得盛赞的问题集合。挑战问题会更进一步，有些会更加深入。让我举个例子：

段落 2.1：数读矩阵的哪些行交换可以产生另一个数读矩阵？

段落 2.7：若 P 是一个交换矩阵，为什么某些幂次方 P 会等于 I?

段落 3.4：若 Ax=b 与 Cx=b，对于每个 b 具有相同的解，那么 A 会等于 C? 段落 4.1：四个向量 r，n，c，l 在什么条件下可以作为一个 2×2 矩阵的行空间，零空间，列空间与左零空间的基？

课程的开始

方程式 Ax=b 立即使用线性代数语言，向量 Ax 是 A 的列的一个组合，方程式的问题在于找出一个可以产生 b 的组合。解向量 x 来自三种层次，全部都很重要：1. 直接解，使用前向消元与反向代入求 x。

2. 矩阵解，使用逆矩阵：x=Ab（若 A 具有逆矩阵）。

3. 特解（对应 Ay=b）加零空间解（对应 Az=0）

本书封面展示了向量空间解 x=y+z。3

直接消元是科学计算中最常使用的演算法，矩阵 A 变成三角形－- 快速得到解。我们也看到四个子空间的基，但是不要一直练习消元法。好点子来了。

每个新的超级电脑都会在 Ax=b 进行测试：这是纯线性代数。但是纵使是超级电脑，也不想计算逆矩阵：太慢了。逆矩阵得到最简易的公式 x=A~1b，但是速度不是最快。每个人必须知道行列式的计算甚至更慢－- 任何的线性代数课程都不应该从 n×n 矩阵的行列式公式开始，这些公式有他们的地位，却不是第一位。

本书的结构

如同序言所述，你可以看到本书的形态与目的，这项目的是严肃的，用来说明数学中美丽与有用的部分，你会看到线性代数概念如何强化关键概念－- 每个层次自然而来，每个人都可以心领神会。

下列是本书关于学习与教学的 12 个重点：

1. 第一章从向量与点积开始，如果同学已经学过，就快速聚焦在线性组合。

段落 1.3 提供三个无关向量，他们的组合形成全部的 3 维空间；也提出了

在同一平面的三个相关向量。这两个例子就是线性代数的开始。

2. 第二章展示 Ax=b 的行图与列图，线性代数的中心是 A 的行与 A 的列的关

联：相同数目却是非常不同的图形。然后开始矩阵的代数：一个消元矩阵

乘 A 得到一个零，目的是捕获全部的程序 — 从 A 开始，用 E＇s 乘，最终得

到 U

从 A=LU 可以看出消元法的美妙，下三角 L 实现前向消元步骤，上三角 U

实现反向代入。

3. 第三章是线性代数的最佳层次：子空间。列空间包含所有列的组合，重要

问题是：需要多少列？答案告诉我们零空间的维度，以及 A 的关键信息。

我们接触了线性代数的基础定理。

4. 当方程式比未知数多的时候，几乎可以确认 Ax=b 无解。我们不能抛弃每

个接近但不是确切的量测值！当我们使用最小二乘法（也称最小平方法）求

解时，关键在于 AA。当 A 是矩形时（非方阵），这个美好的矩阵在应用数

学领域随处可见。

5. 行列式给出以前发明公式的解答 —－克拉默规则，逆矩阵，n 维中的体积。

我们不想计算这些公式，他们太花时间。但是 detA=0 告诉我们矩阵是奇

异的：这是特征值的关键。46. 段落 6.1 说明 2×2 矩阵的特征值，许多课程希望早一点看到特征值。因为 2×2 矩阵的行列式比较简单，直接从第三章的结果得到特征值是完全合理，关键方程式是 Ax=λx。

特征值与特征向量是了解方形矩阵的惊奇方法，他们不是用在 Ax=b，而是用在动态方程式 du/dt=Au。观念都是一样的：追随特征向量。在这些特别的反向中，A 的作用好像是一个数（特征值 2），变成一维的问题。

第六章的高光处是对角化一个对称矩阵，当所有的特征值都是正数，矩阵称为「正定」。这项关键概念联系整个课程－正主元与行列式与特征值与能量。我很认真的说明这项重点并且使用范例来解释。

7. 第七章是新的内容，介绍了奇异值与奇异向量。他们把所有的矩阵分割成简单片段，依据重要性进行排序。你会看到压缩图像的方法，特别的是你可以分析充满资料的矩阵。

8. 第八章说明线性变换，这是没有轴的几何与没有坐标的代数。当我们选择了一组基，我们得到最佳的可能矩阵。

9. 第九章从实数与向量转移到复数向量与矩阵，傅里叶矩阵 F 是我们看到的最重要的复数矩阵，而且快速傅里叶变换（用 F 与 F 快速乘）是革命性的。10. 第十章充满着比任何单一课程都要多的应用：

10.1 图形与网络－- 引入关于基尔霍夫法则的边－点矩阵。

10.2 工程用矩阵－- 平行于矩阵方程式的微分方程式。

10.3 马可夫矩阵－如同谷歌页序的演算法。

10.4 线性规划－一个新需求 x≥0，极小化成本。

10.5 傅里叶级数－函数的线性代数与数字信号处理。

10.6 电脑图形－- 利用矩阵移动、转、压缩图像。

10.7 密码学的线性代数－- 这个新段落很有趣，希尔密码不是很安全，它使

用模数算术：从 0 到 p-1 的整数。乘法得到 4×5≡1（mod19）。对于

解码而言得到 4~1≡5。

11. 线性代数课程如何包含计算？这个可以开启矩阵的新认识 — 每位个班级会找到新平衡。MATLAB 与 Maple 与 Mathematica 在许多方面非常强大，Julia 与 Python 是免费而且可以直接网络下载，这些新编程语言同样强大。12. 第十二章讨论的概率与统计是新内容，当随机变量与我们所得的协方差矩阵相关时，会有非常重要的应用。幸运的是他们是对称正定，此时需要第六章的线性代数。5

线性代数的多样性

微积分大多关注在一个特殊运算（导数）与它的逆运算（积分），当然我承认微积分很

重要。但是很多数学应用是离散而非连续，数字而非模拟，资料的世纪已经开始！

在我的网站你可以看到一篇轻松小论文「太多微积分」，事实是向量与矩阵已经

变成必知的语言。

语言的部分是矩阵的美妙多样性，让我举出三个例子：

对称矩阵

正交矩阵

三角矩阵

2-10

111

－1

0

0 0

0 0 0

关键目标是学习「读懂」矩阵，你需要看到数字的意义，这正是数学的中心 — 模

式与意义。

我使用了斜体与粗体字标示每页的关键字，我知道有时候读者想要快速阅读，

寻找重点。

请让我以关于教授的思维作为结束，你可能觉得方向是正确的，并且怀疑你

的学生准备好了没有，就是给他们一个机会！不夸张的说有成千上万的学生写信

给我，通常都是建议，令人惊喜的是感谢。他们知道这门课程的目的，因为教授

与这本书就在他们身旁。线性代数是难以置信的主题，享受它吧！本书的协助

最大的鼓励是你感觉到所做的事情在生命中是值得的，许多慷慨的读者发来本书

中的范例与修正（以及喜爱的矩阵），谢谢你们。

有一位协助本书的每个字词，他是 Ashley C. Fernandes，他处理本书的 LATEX 档案。经过他的书已经有六本，新写或重写，专注精确也专注生活，与好朋友共

同工作是快乐的生活方式。

在 MIT 数学系内或外的朋友更是美妙，Alan Edelman 处理 Julia（并且更多）。Alex Townsend 处理 7.1 的旗帜范例，Peter Kempthorne 处理 7.3 的金融范例：这些都非常杰出，Don Spickler 关于编码的网站特别优秀。我要感谢 Jon Bloom， Jack Dongarra， Hilary Finucane， Pavel Grinfield， Randy LeVeque， David Vogan， Liang Wang，以及 Karen Willcox。7.3 的特征脸孔来自 Matthew Turk 与 Jeff Jauregui，奇异值的进阶依靠 Raj Rao＇s 在密歇根的伟大课程得以加速。

本书得力于在牛津的快乐假期，谢谢你，Nick Trefethen 与每个人，特别是你，读者！祝你工作愉快。6

作者的背景

这是我的线性代数的第九本书，我还是犹豫要不要介绍自己，毕竟数学还有读者才是最重要的。下个段落有一些自我介绍，用来说明是人写的书！

我出生在芝加哥，在华盛顿与辛辛那提以及圣路易读书，我的学院是 MIT（我的线性代数课程超级抽象）。之后去了牛津与 UCLA，然后回到 MIT 非常长的时间。我不知道有多少万的学生参与了 18.06（超过 6 百万人访问了 ocw.mit.edu）。新鲜的尝试是正确的，因为惊奇的主题只是给数学家看的 —－我们要向全世界展示线性代数。

我感恩可以一辈子教数学，尽在不言中。

Gilbert Strang

PS 我希望下本书（2018?）引进「从资料学习」，这个主题快速成长，特别是「深度学习」。已知一个旧资料的训练集合，我们可以近似新资料，这项近似只使用简单的线性函数 f（x）=max（0，x）。它是 n 次的矩阵乘法的最佳化，得到深度学习：x1=f（A1x+b1），x2=f（A2x1+b2），..，xn=f（Anxn-1+bn）。在输入 x 与输出 xn 之间存在 n-1 隐藏层 — 可以近似训练集 F（x）。

矩阵表

A 任意矩阵

P 排列矩阵

B 基本矩阵

P 投影矩阵

C 余子式矩阵

Q 正交矩阵

D 对角矩阵

R 上三角矩阵

E 消元矩阵

R 简化阶梯矩阵

F 傅里叶矩阵

对称矩阵

H 哈达马德矩阵

T 线性变换

I 单位矩阵

上三角矩阵

J 若尔当矩阵

左奇异向量

K 刚度矩阵

右奇异向量

L 下三角矩阵

X 特征向量矩阵

M 马尔可夫矩阵

特征值矩阵

N 零空间矩阵

∑奇异值矩阵 1

第一章

向量引论

线性代数的中心是两个运算－— 都是针对向量。我们把向量相加得到 ν+w，我们用数字 c 与 d 乘向量得到 cv 与 dw，组合这两种运算（cv 加到 dw）得到线性组合 cv + dw.

线性组合

c+2d

Cv

范例

+w=

是 c=d=1 的组合。

线性组合是这个主题中最重要的概念！有时候我们需要一个特定的组合，选掻 c=2 与 d=1 产生 cv+dw=（4，5）。其他时候我们想要与 w 全部的组合（来自所有的 c 与 d）。

向量 cν 落在一条直线，当 w 不在这条线上时，组合 cv+dw 会形成整个二维平面。如果从 4 维空间的 4 个向量 u，v，w，z 开始，他们的组合 cu+dv+ew+fz 好像会形成一个空间－但不是绝对，向量以及他们的组合可以形成一个平面或是一条直线。

第一章说明建立所有事物的中心观念，我们从二维与三维向量开始，这些向量比较容易制图，之后再讨论更高的维度。线性代数最深刻的特征在于如何平顺的将这些步骤扩展到 n 维空间。纵使不可能画出 10 维的向量，你内心的蓝图依然完全正确。

这是本书的目的（推进到 n 维空间）。第一步是段落 1.1 与 1.2 的运算，段落 1.3 介绍三个基本概念。

1.1 向量加法 ν+w 与线性组合 cv+dw。

1.2 两个向量的点积（dot product）ν·w 与长度‖|=v·ν。

1.3 矩阵 A，线性方程组 Ax=b，解 x=A2b。

请尊重版权与译者的劳动成果，侵权必究！ 2

1.1 向量与线性组合

13v+5w 是向量 ν 与 w 的线性组合 cv+dw 的一个典型。

2 当 v-H 与 w-H 时，前述的组合是 3H+5H-EH-H｝

3 在 xy 平面，向量

4 组合 c 11 +d 23 形成整个 xy 平面，他们产生每个 x 戈

5 组合 c +d 234 形成 xyz 空间中的一个平面。111 345 形成相同的平面。

c+ 2d =1

6 但是 c+3d=0 无解，这是因为它的右侧

c+ 4d =0

100 不在那个平面上。

「你无法把苹果与橙子相加」，以奇特的方式来说，向量也是一样的理由。我们有两个个别的数字 v1 与 v2，这项配对产生二维向量 ν：

列向量 ν

v1=ν 的第一分量

V2=ν 的第二分量

我们把 ν 写成一列（column），而不是一行（row），重点在于单一的字母 ν（粗斜体字）代表这项配对数字 v1 与 v2（浅色斜体字）。

我们不是把 v1 与 V2 相加，我们是把向量相加。ν 与 w 的第一分量与第二分量仍然分开：

向量加法

］与＊ 相加得到 v+w=

减法追随相同的概念：v-w 的分量是 v1-w1 与 V2-W2。

另一个基础运算是纯量（scalar）乘法（也称为数乘），向量可以用 2 或－1 或任意数 c 去乘。要计算 2v，用 2 乘 ν 的每个分量：

纯量乘法 ＊··

cv 的分量是 cv1 与 cv2，数字 c 称为「纯量」。

注意－ν 与 ν 的总和（sum）是零向量，以粗体 0 表示，与一般的数字 0 不相同，向量 0 的分量是 0 与 0。请原谅我一直在反复谈论向量与分量的差别，线性代数就是建立在 ν+w 与 cv 与 dw 的运算－向量加法与纯量乘法。

网址：linear.neocities.org 箱：876152660@qq.com 3

线性组合

我们现在结合向量加法与纯量乘法产生 ν 与 w 的「线性组合」。用 c 乘 ν 以及 d 乘 w，然后相加得到 cv+dw。

cv 与 dw 的总和是线性组合 cv+dw。

四种特殊的线性组合是：和，差，零，纯量乘积 cv:

1v+1w= 向量的和，如图 1.1a

1v-1w= 向量的差，如图 1.1b

0v+0w = 零向量

cv+Ow= 沿着 ν 方向的向量 cv

零向量永远是可能的组合（它的系数为零），每次我们看到向量的「空间」都包含零向量。从大局来看，取得 ν 与 w 所有的线性组合就是线性代数的工作。

图形让你看到向量，对代数来说，我们只需要向量的分量（例如 4 与 2）。向量 ν 由箭头表示，箭头往右横跨 v1=4 个单位，再往上走 v2=2 个单位，终点的 x，y 坐标等于 4，2。这个点是向量的另外一种表示法 — 我们有三种方式来描述 v:

向量 ν 表示法两个数字由（0，0）出发的箭头平面上的点

我们用数字做加法，我们用箭头视觉化 v+w:

向量加法（头到尾），ν 的终点就是 w 的起点

4

w=

T

2

2

+w

5

2

0

HY++4

+»－［］+［］-［］

·－=［-［］-［l

图 1.1：向量加法 ν+w=（3，4）产生平行四边形的对角线，w 的反向是－w，右侧的线性组合是 v-w=（5，0）

我们先沿着 ν 再沿着 w 前进，或者我们沿着 ν+w 走对角捷径；我们也可以先沿着 w 再沿着 v。换言之，w+ν 与 ν+w 的答案相同。沿着平行四边形（本例题是矩形）存在不同的前进方向。

请尊重版权与译者的劳动成果，侵权必究！ 4

三维向量

具有两个分量的向量对应到 xy 平面上的一个点，ν 的分量就是点的坐标：x=v1 与 y=v2。向量从（0，0）出发，箭头在点（v1，v2）结束。我们现在允许向量有三个分量 （V1，V2，V3）。

xy 平面换成三维的 xyz 空间，以下是一些典型向量（依然是列向量，只是有 3 个分量）:

V= 1 与 W= 234 与 v+w= 343

向量 ν 对应到三维空间的一个箭头，通常箭头由原点出发，原点是 xyz 轴的交点，坐标为（0，0，0），箭头终点的坐标是 v1，v2，v3。列向量，原点出发的箭头与箭头的终点，这三种表示法之间有着完美的适配。

平面向量（x，y）与 3 维空间的（x，y，0）不相同！

y

0

2

（3，2）

2

1

+

3

2

1 y

+ +

2

3

X

2

0

从此以后

V=

也可以写成 ν=（1，1，－1）

写成行形式（在括号中）的理由是为了节省空间，但是 ν=（1，1，－1）不是行向量！实际上还是列向量，只是暂时横躺而已。行向量［11-1］是绝对不同的，虽然它有相同的三个分量。1×3 的行向量是 3×1 的列向量 ν 的「转置」（transpose）。

网址：linear.neocities.org 箱：876152660@qq.com 5

三维空间中，ν+w 仍然是每次计算一个分量，向量总和的分量是 V1+w1 与 v2+w2 与 v3+w3，你现在了解如何在 4 或 5 或 n 维空间中相加向量。当 w 从 ν 的终点出发，第三边是 ν+w，平行四边形的另一个环绕方向是 w+ν。问题：这四边是否在同一平面？答案：是。向量总和 + w - ー w 走完一圈产生二向量。三维空间中典型的三个向量的线性组合是 μ+4ν－2w:

1

2

分别用 1，4，－2 乘再相加的线性组合 0 +4 2 －2 3 2

3

9 重要问题

一个向量 u，唯一的线性组合是倍数 cu。对于两个向量，线性组合是 cu+dv。对于三个向量，线性组合是 cu+dv+ew。你可以由一个组合跨一大步到所有的组合吗？允许每个 c 与 d 与 e，假设 u，v，w 是三维空间中的向量：

1. 所有 cu 的组合，图形是什么？

2. 所有 cu+dv 的组合，图形是什么？

3. 所有 cu+dv+ew 的组合，图形是什么？

上述的答案与特定向量 u，v，w 有关，如果他们都是零向量（非常极端案例），所有的线性组合都是零。如果他们是典型的非零向量（随机选定分量），这里有三种答案，这是我们主题的关键：

1. 所有 cu 的组合形成一条通过（0，0，0）的直线。

2. 所有 cu+dv 的组合形成一个通过（0，0，0）的平面。

3. 所有 cu+dv+ew 的组合形成三维空间。

因为 c 可以是 0，零向量（0，0，0）会在直线上；当 c 与 d 都是 0，零向量会在平面上。向量 cu 形成的直线是无限长（正向与反向），我特别要求你去思考全部 cu+dv 形成的平面（三维空间中两个向量的组合）。

一条直线上的所有 cu 加到另一条直线上的所有 dν 会形成图 1.3 的平面。当我们引入第三向量 w 时，ew 的倍数得到第三条直线。假设第三条直线不在 u 与 ν 形成的平面上，则 ew 与 cu+dv 的组合可以形成整个三维空间。

这是典型的状况！线，平面，然后空间，但是还有其他可能性存在。当 w 恰好等于 cu+dv，第三向量 w 落在前两个向量形成的平面上，u，v，w 的组合无法离开 uν 平面，我们没有得到整个三维空间。请思考问题 1 的特殊例子。

请尊重版权与译者的劳动成果，侵权必究！ 6

直线包含

平面来自

所有的 cu

所有 cu+dv

и

и

cu

－u/2

（a）

（b）

图 1.3:（a）穿过 u 的直线。（b）包含穿过 u 与 v 直线的平面

主要观念复习

1. 二维空间的向量 ν 具有两个分量 ν1 与 v2。

2.v+w=（v1+w1，v2+w2）与 cv=（cv1，cv2），每次计算一个分量。

3. 三个向量 u，v，w 的线性组合是 cu+dv+ew。

4. 选取所有 u 或是 u，v 或是 u，v，w 的线性组合，在三维空间中，这些组

合典型的形成一条直线或是一个平面或是整个空间 R3。

已解范例

1.1Av=（1，1，0）与 w=（0，1，1）的线性组合会形成 R3 的一个平面，请描述这个平面，并且找出一个不是 ν 与 w 的线性组合的向量－不在该平面上。

解 ν 与 w 形成的平面包含所有组合 cv+dw，平面上的向量允许任意的 c 与 d。图 1.3 的平面形成两条线之间的区域。

这个平面的四个向量是（0，0，0）与（2，3，1）与（5，7，2）与（π，2π，π），第二分量 c+d 永远是第一与第三分量的总和。大部分的向量，例如（1，2，3）就不在这个平面上，因为 2≠1+3。

通过（0，0，0）平面的另一种描述方法是知道 n=（1，-1，1）与平面垂直，段落 1.2 测试点积来确认 90° 角：v·n=0 与 w·n=0。垂直向量具有零点积。

网址：linear.neocities.org 邮箱：876152660@qq.com 7

1.1Bv=（1，0）与 w=（0，1），描述所有 cv 的点，当（1）所有的数值 c。（2）非负数值 c≥0。将 c 加上所有 dw，描述所有的 cy+dw。

解

（1）当 c 是任意数时，向量 cv=（c，0）是沿着 x 轴（v 的方向）的等距点，他们包含（-2， 0），（-1，0），（0，0），（1，0），（2，0）。

（2）当 c≥0，向量 cv 形成一条半线，就是正 x 轴。这条半线从（0，0）开始，此时 c =0。它包含了点（100，0）与（π，0），但不包含（-100，0）。

（1＇）加上所有的向量 dw=（0，d），会在这些等距点 cv 上放置一条铅直（vertical）线，

我们得到无限多来自（全部数值 c，任意数值 d）的平行线

（2＇）加上所有的向量 dw=（0，d），会在半线上的每一个 cv 放置一条铅直线，现在

我们有一个半平面，xy 平面的右半部分有任意的 x≥0 与任意的 y。

1.1C 求出 c 与 d 的两个方程式，使得线性组合 cv+dw 等于 b:

H

解在应用数学中，很多问题都有两个部分：

1. 建模（modeling）部分：利用一些方程式来表示问题。

2. 计算部分：利用快速又正确的演绎法求解方程组。

在此我们只讨论第一部分（方程组），第二章会介绍第二部分（求解）。我们的范例适配一个线性代数的基础模型：

求 n 个数值 c1，…n 使得 c1v1.Cn=b

当 n=2 我们可以找到关于 c＇s 的公式，第二章介绍的「消元法」适用于远超过 n=1000 的系统。当 n 大于 10 亿时，参考第 11 章。此处 n=2:

向量方式 c+b［

c 与 d 所需要的方程组来自个别的两个分量：

2c- d=1

两个一般方程式

－c+2d=0

每个方程式产生一条直线，两条直线相交于解 c=2/3，d=1/3。也可以把这个问题视为矩阵方程式，这就是我们想要往下介绍的：

2×2 矩阵－

请尊重版权与译者的劳动成果，侵权必究！ 8

问题集 1.1

问题 1-9 有关向量加法与线性组合。

1 描述下列所有的线性组合的几何意义（线，面，或是整个 R3）:

（a） 23 与 369

（b）

023

（c） 200 与 022 与 223

2 在平上－y

3 若 v+w=［］与 v-w=［］，计算并画出向量 v 与 w，

4 从 =［与 w=｝. 计算 3+w 与 c+d 的分量。

5 计算 u+v+w 以及 2u+2v+w。你如何知道 u，v，w 在同一个平面上？

因为 w=cu+dv

这些直线在同一平面

求 c 与 d

6ν=（1，－2，1）与 w=（0，1，-1）的每个组合的分量总和是

。求 c 与 d 使得

cu+dw=（3，3，-6）。为什么不可能是（3，3，6）?

7 在 xy 平面上标示出九个线性组合的点:

+d 其中 c=0.1，2 与 d=0.1，2

8 图 1.1 的平行四边形的对角线是 vν+w，另一个对角线为何？这两个对角线向

量的总和是多少？画出向量的总和。

9 如果平行四边形的三个角点是（1，1），（4，2）与（1，3），则三个可能的第四点为何？

画出其中两个点。

问题 10-14 有关图 1.4 的立方体与时钟的特殊向量。

10 立方体上的哪个点是 i+j? 哪个点是向量 i=（1，0，0）与 j=（0，1，0）与 k=（0，0，

1）的总和？描述立方体上所有的点（x，y，z）。

11 单位立方体的四个角点是（0，0，0），（1，0，0），（0，1，0），（0，0，1），其他四个角点为

何？求出立方体的中心点坐标。六个面的中心点坐标是

。立方体有几

个边？

12 复习问题。在 xyz 空间中，i=（1，0，0）与 i+j=（1，1，0）的所有线性组合形成的

平面为何？

网址:linear.neocities.org 箱：876152660@qq.com 9

k= （0， 0， 1）

k

2:00

－+-

j=（0，1，0）

注意错觉：

（0，0，0）是顶角

或是底角

i=（1，0，0）

图 1.4:i，j，k 构成的单位立方体与 12 个时钟向量

13（a）考虑 12 个由中心点指向时钟 1:00，2:00，..，12:00 的向量，其总和 V 为何？（b）如果把 2:00 的向量移走，为什么其余 11 个时钟向量的总和指向 8:00? （c）在 2:00 的向量 v=（cos0，sinO），求出 x 与 y 的分量。

14 假设 12 个向量是由底部的 6:00 出发而不是由中心的（0，0）出发，指向 12:00 的向量变成两倍的（0，2），则全部 12 个新的时钟向量总和为何？

问题 15-19 深入讨论 ν 与 w 的线性组合（图 1.5a）。

15 图 1.5a 显示 v/2+w/2，请标示点 3v/4+w/4 与 v/4+w/4 与 v+w。

16 标示点－v+2w 以及当 c+d=1 时所有可能的 cv+dw。当 c+d=1 时，画出所有组合的直线。

17 标示点 v/3+w/3 与 2v/3+2w/3。cv+cw 会形成哪条直线？

18 限制 0≤c≤1 且 0≤d≤1，画出 cv+dw 所有的组合形成的区域。

19 只限制 c≥0 且 d≥0，画出 cv+dw 所有的组合形成的「锥形（cone）」。

u

u=+w

（a）

（b）

图 1.5：问题 15-19 的平面

问题 20-25 的三维空间

请尊重版权与译者的劳动成果，侵权必究！ 10

问题 20-25 处理三维空间向量 u，v，w。（见图 1.5b）。

20 标示图 1.5 中 u/3+v/3+w/3 以及 u/2+w/2 的位置。挑战问题：c，d，e 在什么

限制条件下，cu+dv+ew 会形成图上的虚线三角形？要想留在三角形内，一

个要求是 c≥0，d≥0，e≥0。

21 虚线三角形的三个边是 ν－u，w-v，u-w，他们的总和是＿__。画出环绕平

面三角形的「头至尾」的加法：（3，1）+（-1，1）+（-2，－2）。

22 当 c≥0，d≥0，e≥0 且 c+d+e≤1，画出 cu+dv+ew 覆盖的金字塔（pyramid）

区域。确认（u+v+w）/2 是否在金字塔之内？

23 如果考虑 u，v，w 所有的线性组合，有没有向量无法由 cu+dv+ew 得到？如

果 u，v，w 全部位于＿_____，会有不同的答案。

24 哪些向量是与 ν 的线性组合，同时也是 ν 与 w 的线性组合？

25 画出向量 u，v，w，使得他们的组合 cu+dv+ew 只形成一条直线。求出向量

u，v， w 使得组合 cu+dv+ew 只形成一个平面。

26 什么样的组合 c

+ 得到？将方程组表示成线性组合的系数 c 与 d

的两个方程式。

挑战问题

27 在 4 维空间的立方体会有几个角点？有几个 3 维的面？有几个边？一个典型

的角点在（0，0，1，0），一个典型的边会走到（0，1，0，0）。

28 求出向量 ν 与 w，使得 v+w=（4，5，6）且 v-w=（2，5，8）。这是一个有＿_个

未知数的方程组？要有相同数量的方程式才能求出这些数值。

29 三个向量 u=（1，3），v=（2，7），w=（1，5），找出两种不同的线性组合得到 b=（0，

1）。稍微变动一下题目：如果我随意选出三个平面上的向量 u，v，w，是不是

永远存在两种不同的线性组合可以得到 b=（0，1）?

30v=（a，b）与 w=（c，d）的线性组合可以得到一个平面，除非

。找出四

个 4 维空间的向量 u，v，w，z 使得他们的线性组合 cu+dv+ew+fz 产生 4 维空

间的所有向量（b1，b2，b3，b4）。

31 写下 c，d，e 的方程组，使得 cu+dv+ew=b。你可以找出满足 b 的 c，d，e 吗？

网址:linear.neocities.org 箱：876152660@qq.com 11

1.2 长度与点积

1.v = 与 w = 的「点积」是 v-w=（）4）+（2）x5）=4+10=14.

2.w 是零、用以。与 w 圣，（+ 号 +（2=

·음

5.v 与 w 之间的角度有 cs0=

62 间的年 0o）角 9

7. 所有的角都有 | cosθ|≤1，所以所有的向量都有 | v·w|≤‖v‖‖w‖。

第一个段落回避了向量乘法的问题，我们现在定义 ν 与 w 的点积（dot product）。这种乘法包含了个别的乘积 v1W1 与 v2w2，但是没有停在这里，这两个数字相加产生一个数字 ν·w。

这是几何的段落（向量的长度与两向量之间夹角的余弦）。

两个向量 v=（1，2）与 w=（w1，w2）的点秋或内移是数字 vW:

v·w=V1w1+V2w2

（1）

范例 1 向量 v=（4，2）与 w=（-1，2）有零点：

点积为零，垂直向量

［｝4+40

数学里面的 0 一直是特殊的数字。对于点积，它表示这两个向量垂直，夹角 90°。当我们在图 1.1 中作图，我们看到了矩形（不只是任意平行四边形）。垂直向量最明显的例子是沿着 x 轴的 i=（1，0）与沿着 y 轴的 j=（0，1），再一次点积是 i·j=0+0=0，这些向量 i 与 j 形成直角。

请尊重版权与译者的劳动成果，侵权必究！ 12 向量 v=（1，2）与 w=（3，1）的点积是 5，很快的 v·w 就会显示 ν 与 w 之间的夹角（不是 90°）。请验证 w·ν 也是 5。

点秋 w 与 w·相等，无关与的顺序。

范例 2 放一个重量 4 的东西在点 x=-1（零的左边），放一个重量 2 的东西在点 x=2（零的右边），x 轴会在中心点取得平衡（好像跷跷板），重量取得平衡是因为点积 （4）（-1）+（2）（2）=0。

这个例子是典型的科学工程，重量的向量是（w1，w2）=（4，2），距离中心点的距离向量是（v1，v2）=（-1，2）。重量乘距离 v1w1 与 v2w2 得到「矩（moments）」，跷跷板的平衡方程式是 v1w1+V2w2=0。

范例 3 点积在经济与商业都会用到，比如我们要买卖 3 个商品，他们的单价分别是（1，P2，P3）这是「价格向量」；我们买或卖的数量为（q1，92，93），卖的时候取正号，买的时候取负号。单价 p1 的商品卖出 q1 个得到 p1q1，全部收入（数量乘价格 p 就是在三维空间的点 qp:

收入 =（q1，92，93）·（P1，P2，P3）=91P1+92P2+93P3 = 点积

零点移表示目平衡。如果 qP=0，全部銷售額等于全部买进額，p 垂直 q（在三维空间）。一家超市有几千种货品，货物的维度会非常高。

小注释：电子表格在管理中非常重要，可以计算线性组合与点积，在屏幕上看到的是个矩阵。

重点对于 ν 与 w，每个 vi 乘 wi，则 νw=v1w1+.+vnWn。长度与单位向量

有个重要的案例就是向量自己与自己的点积，此时 ν=w。当向量 ν=（1，2，3），自己与自己的点积为 ν·ν=|v|2=14:

点积：＊是长屋的平方－-1419-14.

现在向量之间的角度不是 90° 而是 0°，ν 与自己不垂直所以点积不是 0。点积 ν·ν 给出 ν 的长度平方。

定义向量 ν 的长度‖v‖等于 ν·ν 的平方根：

长度 =『==（v2+2…n2

网址：linear.neocities.org 邮箱：876152660@qq.com 13

在二维的长度是√v2+v22，在三维的长度是√v2+v22+v32，这样的计算得到 ν=

（1，2，3）的长度是 ||=√14。

此处 |‖ν|‖=√ν·ν 是代表向量的箭头的一般长度。如果分量是 1 与 2，箭头就

是图 1.6 所示直角三角形的第三边，毕氏定理 a2+b2=c2 得到三边的关系是 12+22

=ll vll2.

对于 ν=（1，2，3）的长度来说，我们使用直角三角形的公式两次。位于基底的向量（1，2，0）的长度是√5，基底向量与直線向上的向量（0，0，3）垂直，所以盒子的

对角线长度‖ν‖=√5+9=√14。

四维向量的长度等于 v2+2++v，于是向量（1，1，1，1）的长度是√12+12+12+12=2，这是一个四维空间的单位立方体的对角线长度。n 维空间立

方体的对角长度是√n

（0， 0，3）

（0，2）

（1，2）

（1，2，3）

v.v=+ 哇 +

长度√14

/5 2

5=1²+2²

14=12+22+32

1 （1，0）

（0，2，0）

（1，2，0）

（1，0，0）

长度√5

图 1.6：二维与三维向量的长度√ν·ν

单位这个词通常用来表示某种测量值等于 1，单位价格是指一个物品的价格，

单位立方体的边长为 1，单位圆的半径为 1。现在讨论「单位向量」的意义。

定义

单位向量 u 是长度为 1 的向量，u·u=1。

举例来说四维的单位向量是 u=（1/2，1/2，1/2，1/2），则 u·u=1/4+1/4+1/4+1/4=1。向量 ν=（1，1，1，1），除以本身的长度 |ν‖=2 得到单位向量。

范例 4 沿着 x 轴与 y 轴的标准单位向量写成 i 与 j，在 xy 平面中，单位向量与 x

轴形成夹角 0，这个单位向量就是（cos0，sinθ）。

单位向量 ===

当 0=0，水平向量 u 就是 i；当 0=90°（或 π/2 弧度（radian），垂直向量就是 j。因

为 cos20+sin20=1，在任何角度下分量 cosθ 与 sin0 得到 u·u=1。这些向量往外

请尊重版权与译者的劳动成果，侵权必究！ 14

伸展得到图 1.7 的单位圆，单位圆上角度为 θ 的点坐标是 cosθ 与 sin0。

由于（2，2，1）的长度是 3，向量（2/3，2/3，1/3）长度是 1，检验得到 u·u=4/9+4/9

+1/9=1。任何非零向量 ν 除以本身的长度 | v | 就是单位向量。

单位向量

u=ν/‖ν‖是在 ν 方向的单位向量。

j=（0，1）v=（1，1）

j

cos θ

＃= sin θ

4=（方方）= 前

1 sin e

－i←

¿=（1，0）

0

i

cos θ

单位向量

单位圆

j

图 1.7：坐标向量 i 与 j。位于 45°（左图）的单位向量 μ 是 ν=（1，1）除以本身长度 v|

=√2。单位向量 u=（cosθ， sinθ）的角度是 0。

两个向量之间的夹角

我们说垂直向量有 v·w=0，当角度是 90° 时点积为 0。为了说明，我们将角度与

点积进行关联，展示如何利用 ν·w 求出两个非零向量 ν 与 w 的夹角。

直角

当 ν 与 w 垂直，点积 v·w=0。

证明当 ν 与 w 垂直，他们形成直角的两个边，第三边为 ν－w（斜边如图 1.8）。

毕氏定理说明直角三角形的边有 a2+b2=c2:

垂直向量

IvP+ wiP=llv-wf

（2）

以二维的方式写出上述长度的公式，方程式是：

毕氏定理（v12+v22）+（w12+w2）=（v1-w1）2+（v2-w2）2

（3）

右侧从 v12-2v1w1+w12 开始，两侧都有 v12 与 w12 可以对消，剩下－2v1w1。同理

v22 与 w22 可以对消，剩下－2v2w2。（如果是三维向量，还会有－2v3w3）。现在两边

同除－2 得到 v·w=0。【原文写成 ν－w=0 是错误】

0=-2v1w1-2v2w2 得到 v1w1+v2w2=0

（4）

结论直角產生 v·w=0。当角度 0=90°，点积为 0，此时 cosA=0。因为 0·w

永远为 0，所以零向量 0 与所有向量 w 垂直。

网址：linear.neocities.org 箱：876152660@qq.com 15

现在假设 v·w 不是零，可以为正也可以为负，v·w 的正负号可以立即知道是小于还是大于直角。当 v·w 为正，角度小于 90°；当 v·w 为负，角度大于 90°。图 1.8 的右侧展示典型向量 ν=（3，1），它与 w=（1，3）的夹角小于 90°，这是因为 ν·w=6 是正数。

4

=［

V25

·－［|］

v.w=0

v.w>0

U

5 t

V20

v·w<0

v.w=0

与 ν 的夹角小于 90°

5+20=25

与 ν 的夹角大于 90° 在这个半平面

在这个半平面

图 1.8：垂直向量有 vw=0，则 + I - ー｜P

边界线是向量与 ν 垂直的位置，（1，－3）位于正负之间的分界线，所以（1，－3）与（3，1）垂直，点积为零。

点积可以算出真正的角度 θ。对于两个单位向量 u 与 U 来说，u·U 的符号可以决定 0<90° 或是 0>90°。除此之外，点积 u·U 的值就是 cos0。对于 n 维空间而言，前面的观念也是正确的。

两个单位向量 u 与 U 的夹角为 θ，则 u·U=cosθ，当然 | u·U］≤1。

记得 cosθ 不会大于 1，也不会小于－1，单位向量之间的点积会落在－1 与 1 之间， u·U 的值就是 cos O。

图 1.9 清楚显示 u=（cosθ，sinθ）与 i=（1，0），点积 u·i=cos0，这是两个向量夹角的余弦。

旋转任何角度 α 之后，他们仍然是单位向量。向量 i=（1，0）旋转至（cosa，sina），向量 u 旋转至（cosβ，sinβ），其中 β=α+0。他们的点积是 cosα cosβ+sina sinβ， 由三角定理得到 cos（β－a）=cos0。

cos ß

－［］

sin ß

cos α

0

sin α

=［8］

BTa

u.i=cosθ

θ=β－α

图 1.19：单位向量:u·U 等于 θ（夹角）的余弦

请尊重版权与译者的劳动成果，侵权必究！ 16 如果 ν 与 w 不是单位向量会怎么样？除以个别的长度得到 u=v/|v|，U=w/|w|，则单位向量的点积得到 cosθ。

H cose

v.w

余弦公式若 ν 与 w 是非零向量，则

（5）

无论什么角度，u=v/|v | 与 U=w/|w|‖的点积不会超过 1，这就是「苏瓦兹不等式」：·wSI 更准确的说法是柯西苏瓦兹－布尼亚克斯基不等式，分别在法国、德国、俄罗斯发表（也许有其他地方，这是数学上最重要的不等式）。由于 | cosθ| 不会超过 1，余弦公式得到两个伟大的不等式：

苏瓦兹不等式

三角不等式

范例 5 对于 v=［与 w=［求 cos0，并且验证两个不等式。

解点积 v·w=4，两者的长度都是√5，余弦是 4/5。

c0s0=55=3

苏瓦兹不等式得到 ν·w=4 小于‖v|‖‖w|=5。使用三角不等式，第三边长是 | v+w | 会小于第一边长加第二边长。针对 ν+w=（3，3），三个边长是√18<√5+√5，两边平方得到 18<20。

范例 6v=（a，b）与 w=（b，a）的点积是 2ab，两者的长度都是√a2+b2，苏瓦兹不等式 v·w≤‖v‖|‖w | 得到 2ab≤a2+b2。

如果写成 x=a2 与 y=b2，会得到更著名的结果。「几何平均值」√y 不大于「算术（arithmetic）平均值」=（x+y）/2。

几何平均值≤算术平均值

absas

范例 5 的 a=2 与 b=1，所以 x=4 与 y=1，几何平均值 xy=2 小于算术平均值（1+4）/2=2.5。

计算上的注解

MATLAB，Python， Julia 可以直接进行整个向量的计算，不用透过向量的分量。当 v，w 定义完成后就可以直接得到 ν+w。以行的方式输入 v，w，利用符号 prime′可以转置成列向量。2v+3w 写成 2＊v+3＊w。除非结尾输入半分号符号「；」，否则结果会马上显示出来。

网址：linear.neocities.org 箱：876152660@qq.com 17

MATLAB v=［2 3 4］＇； w=［1 1 1］＇；u=2＊v+3＊w

点积 ν·w 是行向量乘列向量（使用＊而不是·）。

点通常号或 v＇＊w 而不是

在 MATLAB 中，ν 的长度写成 norm（v），也就是 sqrt（v＇＊v），然后利用点积 v＇＊w 求出余弦，再求出对应此余弦的角（单位是弧度 radian）。

余弦公式

cosine=v＇＊w/（norm（v）＊norm（w）

反余弦

angle=acos（cosine）

M - 档案可以建立新的函数 cosine（v，w）。Python 与 Julia 都是开放源（open source）。

主要观念的复习

1. 点积 ν·w 的计算：所有的 vw 先乘好再全部相加。

2. 长度 |ν| 是 ν·ν 的平方根，u=ν/‖ν| 是单位向量，长度等于 1。

3. 当 ν 与 w 垂直，点积 ν·w=0。

4.θ（任意两个非零向量 ν 与 w 的夹角）的余弦不超过 1:

v.w

余弦 cosθ=

苏瓦兹不等式 | v·w|≤|v|‖w|

已解范例

1.2A 向量 ν=（3，4）与 w=（4，3），针对 ν·w 验证苏瓦兹不等式，以及针对 |ν+w | 验证三角不等式。求出 ν 与 w 之间角度的 cosA。什么样的 ν 与 w 得到等式 |v·w| 解点积是 ν·w=（3）（4）+（4）（3）=24，ν 的长度 | v|=√9+16=5，|w | 也是 5。总和 ν+w=（7，7）的长度是 7√2<10。

苏瓦兹不等式

v·w|IIl|24<25

三角不等式

ll||+|| 得 7V2<5+5

角度的余弦

cos 0=24/25，这是 ν=（3，4）到 w=（4，3）的夹角等式：一个向量是另一个向量的倍数，如同 w=cv，角度是 0° 或是 180°。在此情形下，|cos θ|=1 且 |v·w|=|v||w|。如果角度是 0°，比如说 w=2v，则 | v+w|= |+|w|（两侧都是 3|v|），三边是 v，2v，3ν 的三角形是扁平的！

请尊重版权与译者的劳动成果，侵权必究！ 18

1.2B 求出在 ν=（3，4）方向的单位向量 u。求出垂直于的单位向量 U，U 有多少种可能性？

解将 ν 除以本身的长度 | v|=5 得到单位向量 u，选择垂直向量 V=（-4，3），这是因为（3）（-4）+（4）（3）=0。将 V 除以长度 | V | 得到与垂直的单位向量：

（）

u·U=0

另外还有一个垂直单位向量是－U=（4/5，-3/5）。

1.2C 给定两个向量 r=（2，-1）与 s=（-1，2），求出向量 x=（c，の使得内 x·r=1 以及 x·s=0，

解两个点积得到 c 与 d 的线性方程组，现在 x=（c，d）

x·r=1 则 2c-d=1

已解范例 1.1C

x·s=0 则－c+2d=0 的相同方程组

关于 n 维空间的 x=（x1，x2，.，xn）的 n 个方程式的注解

段落 1.1 从列 v 开始，目标是建立 x1v1+x2v2+.+xnvn=b。本段落从行 ri 开始，现在的目标是找到 x 使得 x·r1=b1。

很快的 v＇s 就是矩阵 A 的列，r＇s 就是 A 的行，（唯一的）问题就是求解 Ax=b。问题集 1.2

1 计算点积 u·v，u·w，u·（v+w）以及 w·v:

2 计算问题 1 的向量长度 | u | 与 | v | 与 | w|，验证苏瓦兹不等式 | u·v|≤|u‖‖v | 以及 v·wl|Ilo

3 求出问题 1 在 ν 与 w 方向的单位向量，求出夹角的余弦。选择向量 a，b，c 使得这些向量与 w 的夹角分别是 0°，90°，180°。

4 对于任意单位向量 ν 与 w，求出点积（实际数字）

（a）v 与－v（b）v+w 与 v-w（c）v-2w 与 v+2w

5 分别求出在向量 ν=（1，3）与 w=（2，1，2）方向的单位向量 u1 与 u2。再分别求出

垂直 u1 与 u2 的单位向量 U1 与 U2。

网址：linear.neocities.org 箱：876152660@qq.com 19

6（a）描述与向量 ν=（2，－1）垂直的每个向量 w=（w1，w2）。

（b）所有与向量 V=（1，1，1）垂直的向量落在三维空间的一个

（c）同时与向量（1，1，1）与（1，2，3）垂直的向量落在一个

7 求出两个向量之间夹角 θ（来自它的余弦）

（a）v-［］w-［］

（）-［］w-［］

8 是非题（如果正确，举出理由；如果错误，举出反例）：

（a）如果 u=（1，1，1）垂直 ν 也垂直 w，则 ν 平行 w。

（b）如果 u 垂直 ν 也垂直 w，则 u 垂直 v+2w。

（c）如果 u 与 ν 是互相垂直的单位向量，则 | u-v|=√2?Yes！

9 从（0，0）出发到（v1，v2）与（w1，w2）的斜率分别是 v2/v1 与 w2/w1，假设斜率的乘积

v2w2/v1w1 是－1，证明 v·w=0 且两个向量垂直。（直线 y=4x 与直线 y=-x/4

垂直。）

10 分别画出从（0，0）出发到点 v=（1，2）与点 w=（-2，1）的箭头，求出两个斜率的

乘积。答案会是 v·w=0 的信号，而且两个箭头

11 若 v·w 为负数，两者的夹角可以得到什么结论？画出一个三维向量 v（箭头），

然后说明如何找到所有的 w＇s 使得 vw<0。

12 若 v=（1，1）与 w=（1，5），求出 c 使得 w-cv 垂直于 v。若 ν 与 w 是任意的非

零向量，找出 c 的公式。

13 互相垂直的非零向量 ν 与 w 都与（1，0，1）垂直，求出 ν 与 w。

14 彼此垂直的非零向量 u，ν 与 w，他们都与（1，1，1，1）垂直，求出 u，ν 与 w。15x=2 与 y=8 的几何平均值是 xy=4，算术平均值会稍大：（x+y）/2=

这是来自范例 6 中有关 v=（v2，√8）与 w=（√8，V2）的苏瓦兹不等式，求与

w 的 cosθ。

169 维空间中的向量 ν=（1，1，.，1）的长度为何？求 ν 方向的单位向量 u，再求

一个单位向量 w 垂直 ν。

17 向量（1，0，－1）与坐标轴单位向量 i，j，k 的夹角分别是 a，B，0，求出三个角的余

弦值。验证公式 cos2a+cos2β+cos2θ =1。

请尊重版权与译者的劳动成果，侵权必究！ 20

问题 18-28 有关长度以及三角形的角的重要事实。

18v=（4，2）与 w=（-1，2）组成的平行四边形是个矩形，验证毕氏定理 a2+b2=c2 只有在直角三角形成立：（v 的长度）2+（w 的长度）2=（v+w 的长度）2

19（点积的规则）下列方程式简单又好用：

（1）v.w=w.v（2）u.（v+w）=u.v+u.w（3）（cv）·w=c（v.w）

利用（2），当 u=v+w，证明 |v+w|2=v·v+2v·w+w·w

20 余弦法则来自：（v-w）（v-w）=v·v-2v·w+w·w:

余法 Ilm-Il=l-IIl/cI

画出三边为 ν，w，ν－w 的三角形，哪一个角是 θ？

21 三角不等式说明:（v+w 的长度）≤（v 的长度）+（w 的长度），

19 出 Il+wl=I+2v·w+Ill，將 v·w 大成 Il，i 明 |‖边 3|‖不能超过‖边 1|‖+‖边 2|。

三角不等式 + wI2≤（vlI+｜D2 或者

v+w

w=（w1，w2）

wt

llwll

v=（U1，U2）

AB

0

己

a

이

x

22 苏瓦兹不等式 | v·w|≤|v|w|，从代数的角度（不从三角学）来看：

（a）两侧同乘本身得到（v1w1+v2w2）2≤（v12+v22）（w12+w22）。

（b）证明上式左右两侧的差（difference）为（v1w2-v2w1）2。

因为平方不能为负－所以不等式成立。

23 图形显示 cosa=v1/|v|，sina=v2/|v|，同理 cosβ=__，sinB=__。角度 θ=β－a，代入三角公式 cos βcos a+sin βsin a=cos（β－a），可以得到 cos θ=ν·w/|v||w|。

网址：linear.neocities.org 箱：876152660@qq.com 21

24 对于单位向量（u1，u2）与（U1，U2），利用一个式子证明 uU≤1:

将（u1，u2）=（0.6，0.8），（U1，U2）=（0.8，0.6）放在整条直线上，求 cos0。

25 为什么一开始就说 | cosθ| 不会大于 1?

26（推荐）画出一个平行四边形。

27 平行四边形的两个边是 ν 与 w，证明两条对角线的平方和会等于四个边的平

方和：I+tml+lmw=2l+2m?

28 若 v=（1，2），在 xy 平面画出使得·w=x+2y=5 的所有向量 w=（x，y），为

什么答案会是一条直线？最短的 w 为何？

29（推荐）若 | v|=5，|w|=3，则 | v-w | 的最小值与最大值为何？v·w 的最小值与

最大值为何？

挑战问题

30 在 xy 平面会不会存在三个向量，使得 u·v<0，v·w<0，u·w<0? 我不知道

在 xyz 平面有多少这样的向量，使得所有的点积是负数。（在平面绝对不存在

4 个向量有这样的性质。）

31 任意选取数值使得 x+y+z=0，求出向量 v=（x，y，z）与 w=（z，x，y）的夹角。

挑战问题：说明为什么 ν·w/|v‖‖w|‖永远是－1/2。

32 你如何证明 xyz≤x+y+2（几何平均值≤算术平均值）?

3 从向）中，利用正号选取 4 个互相垂直的单位向量

34 利用 MATLAB 的 ν=randn（3，1）指令，制造一个随机的单位向量 =ν||；

利用 V=randn（3，30）指令，制造 30 个以上的单位向量 U。点积 | u·U | 的平

均大小是多少？在微积分中，平均值是 | cos0|d01π=2。

请尊重版权与译者的劳动成果，侵权必究！ 22

1.3 矩阵

2

3Ax 的 3 个分量是 A 的 3 个行与向量 x 的点积：

1.7+2.8

每次处理一行

5.7+6·8 333

4 矩阵形式的方程式 Ax-b：使用取代－7=

5Ax=b 的解可以写成 x=A-1b，但是有些矩阵不允许 A-1。

本段落从三个向量 u，v，w 开始，我会使用矩阵来结合他们。

三个向量

001

在三维空间他们的线性组合是 x1u+x2v+x3w:

向量的组合

－a

（1）

重要事项：利用矩阵改写组合，u，v，w 变成矩阵 A 的列，矩阵乘向量（x1，x2，x3）：矩阵乘向量，列的组合

（2）

数值 x1，x2，x3 是向量 x 的分量，矩阵 A 乘向量 x 等同于方程式（1）的三个列的组合 x1u+x2v+x3w。

这不只是 Ax 的定义，因为改写带来了重要的不同观点，刚开始是三个数字 x1，x2，x3 是乘向量，现在是矩阵乘这些数字。矩阵 A 作用在向量 x，输出 Ax 是 A 的

网址：linear.neocities.org 箱：876152660@qq.com 23

列的组合 b。

为了观察作用，我把 b1，b2b3 写成 Ax 的分量：

（3）

输入是 x，输出是 b=Ax。这个 A 是一个差分矩阵（ difference matrix），因为 b 包含输入 x 的差，最上方的差是 x1-x0=x1-0。

这是一个展示 x=（1，4，9）的差的范例：平方数在 x 中，奇数在 b 中。

甲方数

（4）

这个模式可以延伸到 4×4 矩阵，下一个平方数是 16，下一个差是 x4-x3=16-9=7（下个奇数）。这个矩阵同时将所有的差 1，3，5，7 全部计算出来。

重要注解：每次乘一个行。你已经研读矩阵与向量的乘法 Ax，也许可以换一种方式来解释，我们使用行而不使用列。一般情形是计算每一行与 x 的点积：

Ax 同样也是

（1，0，0）（x1，x2，x3）

行的点积

（5）

0，-1，1）（x1，x2，x3）

这些点积与方程式（3）的结果 x1，x2-x1，x3-x2 完全相同。新的方法是每次处理 Ax 的一个列，线性组合是线性代数的关键，输出 Ax 是 A 的列的线性组合。

如果是数字，你可以用行来乘 Ax；如果是文字，用列处理比较好。第二章会再重复这些矩阵乘法的规则，并且解释这些概念。

线性方程组

观念的改变至关重要。目前为止数字 x1，x2，x3 是已知，右侧的 b 未知，我们利用 A 乘 x 得到差的向量。现在我们考虑 b 已知，要求解 x。

老问题：计算线性组合 x1u+x2v+x3w 求出 b。

新问题：什么样的 u，v，w 的线性组合产生特定的 b?

这是一个逆反问题－— 找出输入 x 得到想要的输出 b=Ax。你已经见过这个系统，这是 x1，X2，x3 的线性方程组。方程式右侧是 b1，b2，b3，我现在要求解 Ax=b 找出 x1，x2，x3:

请尊重版权与译者的劳动成果，侵权必究！ 24 方式加一

x=b

解 x=A-1b

x=b， +b，

（6）

x3=b1+b2+b3

我现在立刻承认 — 大部分的线性系统都不容易求解。这个范例中，第一个方程式决定 x1=b1，第二个方程式产生 x2=b1+b2。因为 A 是三角矩阵，这些方程式可以有序的求出解答（顶端至底部）。

检视两个特殊案例，右侧的 b1，b2，b3 设成 0，0，0 与 1，3，5:

第一个解（全部是 0）比看起来更重要。口头说法：如果输出 b=0，输入必须 x=0。对 A 来说，理论是成立的，但是对所有的矩阵而言却是不一定。第二个例子会说明（不同的矩阵 C），当 C≠0 且 x≠0 时，如何才能得到 Cx=0。

这个矩阵 A 是可逆，从 b 可以反推得到 x，写成 x=A-2b。

逆矩阵

让我重复一次方程式（6）的解 x，会出现一个总和矩阵！

求解 Ax=b

：. 非

（7）

如果 x 之间的差是 b，那么 b 之间的和就是 x。对于奇数 b=（1，3，5）与平方数 x=（1，4，9）来说，这是正确的，对于所有的向量都是正确的。方程式（7）的总和矩阵就是差分矩阵 A 的逆矩阵 A。

范例：x=（1，2，3）的差是 b=（1，1，1），所以 b=Ax 且 x=A1b:

方程式（7 的解 x=（1，2，3）告诉我们两件重要的事实：

1. 对每一个 b，存在一个 Ax=b 的解。2. 矩阵 A1 得到 x=A-1b。

下一章会询问其他方程式 Ax=b 有没有解？如何求解？

微积分的注解：将这些特殊矩阵与微积分产生关联，向量 x 变成函数 x（t），差分 Ax 变成导数 dx/dt=b（t）。反向来说，总和 A~b 变成 b（t）的积分。差的和就如同导数的积分。

网址：linear.neocities.org 箱：876152660@qq.com 25

微积分的基础定理告诉我们：积分是微分的逆反。

Ax=b 且 x=A-1b

－b 与 xb

（8）

平方数 0，1，4，9 的差是 1，3，5，x（t）=t2 的微分是 2t。当 t=1，2，3 时得到偶数 b=2，4，6，这会是一个完美的类比。但是差分与微分不同，我们的矩阵 A 得到的不是 2t，而是 2t-1:

反向 x（）-x（t-1）=-（-1）2=2-（-2t+1）=2t-1

（9）

问题集会继续说明前向差分（forward difference）得到 2t+1。最好的选择（在微积分课程中不常见）是中心差分（centered difference），形式是 x（t+1）-x（t-1）。将△x 除以距离△t，其中△t 是由 t-1 到 t+1，所以△t=2:

x（t）=t2 的中心差分

（1+1）2-（-12=2（（恰好）

（10）

差分矩阵很伟大，中心差分是最佳，我们的第二个范例是不可逆。

循环差分（cyclic difference）

这个范例保持同样的 u 与 v，只是把 w 换成 w＊:

第二个范例

w＊

0

现在 u，v，w＊的线性组合得到循环差分矩阵 C:

循环

（11）

矩阵 C 不是三角形，给定 b 时不是那么简单求解 x。事实上是不可能求得 Cx=b 的解，因为这三个方程式不是得到无限多解（偶尔），就是无解（经常）：

Cx=0 有无限多 x

的解是所有的向量

ooo

（12）

每一个常数向量，例如 x=（3，3，3）在循环时的差都是 0。未定常数 c 就如同求取积分时的 + C。循环差分使得第一分量变成 x1-x3，而不是从 x0=0 开始。

请尊重版权与译者的劳动成果，侵权必究！ 26Cx=b 更大的可能性是 x 完全无解：

x1-x3

135

左侧相加等于 0

Cx=b

x2-x1 =

右侧相加等于 9

（13）

x3-x2

x，x2，x3 无解

从几何的观点来看，不存在 u，v，w＊的线性组合可以得到向量 b=（1，3，5），这样的

线性组合无法形成全部的三维空间。右侧必须有 b1+b2+b3=0，才能允许 Cx=b

有一个解，这是因为左侧的 x1-x3，x2-x1，x3-x2 相加必定为 0。换言之：

所有的线性组合 xu+x2y+xw＊落在 b1+b2+b3=0 给定的平面。

这个主题突然把代数与几何结合在一起，线性组合可以形成整个空间，也可以只

形成一个平面。我们需要一个图形来展示 u，v，w（第一个例子）与 u，v，w＊（在同一个

平面）之间的重要差别： 3

3

0

0

0

1 2

2

1

u= －1

0

1

］

－［］

и 1＇

图 1.10：无关向量 u，v，w；落在同一平面的相关向量 u，v，w＊。

无关与相关

图 1.10 中第一个展示矩阵 A 的列向量，后面展示 C 的列向量。前两个列 u 与 v

在两个图形中完全相同，如果我们只检视这两个向量的组合，我们得到一个二维

平面，关键问题在于第三个向量是否在这个平面上。

无关（independence）w 不在与 ν 的平面上。

相关（dependence）

w＊在与 ν 的平面上。

重点是新向量 w＊是与 ν 的线性组合：

u+v+w＊=0

w＊= 0 =-u-ν

（14）

网址：linear.neocities.org 邮箱：876152660@qq.com 27

这三个向量 u，v，w＊的分量总和都是零，所有的线性组合会有 b1+b2+b3=0（如同我们前面说的，把三个方程式相加），这就是 u 与 v 的线性组合形成平面的方程式。现在引进 w＊，因为 w＊已经在这个平面上，我们没有得到新的向量。

原始 w=（0，0，1）不在平面上：0+0+1≠0，u，v，w 的线性组合形成整个三维空间。我们知道，因为方程式（6）的解 x=A~b 给出正确的组合产生任意 b。

前面两个矩阵 A 与 C，对应的第三个向量分别是 w 与 w＊，允许我提出两个线性代数的关键字：无关与相关。本课程的前半段会更深入探讨这些观念－如果你在前面两个例子中已经学会，我会很快乐的：

u，v，w 无关，除了 Ou+Ov+0w=0 之外，没有其他线性组合得到 b=0。

u，v，w＊相关，存在诸如 u+ν+w＊的其他组合得到 b=0。

你可以在三维空间作图，三个向量落在一个平面，或者不在同一个平面。第二章讨论 n 维空间中的 n 个向量，无关或相关是关键点，这些向量进入一个 n×n 矩阵的列：

无关列：Ax=0 有一个解，A 是可逆矩阵。

相关列：Cx=0 有很多解，A 是奇异矩阵。

最终我们会讨论 m 维空间中的 n 个向量，有 n 个列的矩阵 A 现在是矩形（m×n）。了解 Ax=b 是第三章的问题。主要观念的复习

1. 矩阵乘向量：Ax=A 的列的组合。

2. 当 A 是可逆矩阵，Ax=b 的解是 x=A-1b。

3. 循环矩阵 C 没有逆矩阵，它的三个列落在同一平面，这些相关的列相加

得到零向量，Cx=0 有很多解。

4. 本段落是关键概念的超前理解，还没有完全说明。

已解范例

1.3A 把 A 的西南角单元 a3（行 3，列 1）改成 a31=1:【 entry 翻译成单元，有别于元素 element】

Ax=b

对任意 b 求解 x。从 x=A-1b 看出逆矩阵 A-1。

请尊重版权与译者的劳动成果，侵权必究！ 28

解由上而下求解（线性三角形）系统 Ax=b:

首先 x1=b1

然后 x3=b2+b3

这是很好的习，可以看到逆矩阵的列乘 b1，b3A 的第一列是对应 b=（1，00）的解；第二列是对应 b=（0，1，0）的解；A 的第三列 x 是对应 Ax=b=（0，0，1）的解。

矩阵 A 的三个列仍然无关，他们不在同一个平面，这三个列的线性组合，使用正确的加权 x，2，x3，可以产生任意的三维向量 b=（b1，b2，b3），这些加权来自 x =A＇b.

1.3B E 是一个消元（elimination）矩阵，E 有一个减法，E1 有一个加法。

b=Ex

［］-［］-［¦］-［¦］

第一个方程式是 x1=b1，第二个方程式是 x2-lx1=b2。因为消元矩阵存在减法，逆矩阵会把 lb1 加到 b2:

x=E3b

［］-［］-［］-［］

1.3C 把 C 从循环差分变成中心差分产生 x3-x1:

0

Cx=b

（15）

Cx=b 只有在 b1+b3=x2-xX2=0 オ有解，这是三维空间中向量 b 的一个平面。C 的每一列都在这个平面上，这个矩阵没有逆矩阵，所以平面包含了这些列的全部组合（就是所有的向量 Cx）。

我将 0 包含进去，所以你看到 C 产生「中心差分」，Cx 的行 i 是 x1+1（中心的右）减去 x1-1（中心的左）。以下是 4×4 的例子：

0 1 00

Cx=b

中心差分

－1010

0-10 1 而而而

（16）

00-10

惊讶的是这个矩阵现在是可逆！第一行与最后一行告诉你 x2 与 x3，中间的行给出 x1 与 x4。可以继续往下写出逆矩阵 C1，但是 5×5 矩阵又变成奇异（不可逆）.

网址：linear.neocities.org 箱：876152660@qq.com 29

问题集 1.3

1 求线性组合 3s1+4s2+5s3=b，然后将 b 写成矩阵－向量的乘积 Sx，其中 3，4，5 在 x 里面。再计算三个点积：（S 的行）x:

s1= 111 S2= 011 S3= 001

进入 S 的列

2 求解 Sy=b，其中 S 的列是问题 1 的 s1，S2，s3:

1 0 0

以及

149

S 是一个总和矩阵。前五个奇数的总和是

3 求解以下三个方程式，使用 C1，C2，C3 表示 y1，y2，y3:

Sy=c

将 y 写成矩阵 A=S1 乘向量 c，请问 S 的列是无关或是相关？

4 当 x1=1 时，什么样的组合 x1w1+x2w2+x3w3 可以得到零向量：

W1= 123 W2= 456 W3= 789

这些向量是无关或是相关？这三个向量落在一个

上。这三个列向量构

成的矩阵 W 是不可逆。

5 矩阵 W 的行产生三个向量（我把他们写成列向量）：

n= 47 r2= 258 r3= 369

线性代数说这些向量必须落在同一平面，必定存在许多组合 y1r1+y2r2+y3r3=0，求出两组的 y＇s。

6 什么样的 c 会得到相关的列，使得列的一个组合等于零。

1

1 0 c

с с с

3 2 1

1 1 0

21 5

当 c≠0，可能永远无关吗？

74c

0 1 1

3 36

请尊重版权与译者的劳动成果，侵权必究！ 30

7 如果列组合得到 Ax=0，则每一行都有 r·x=0:

.

nx

以行来看 r2.x

00

r3x

0

这三个行也落在同一平面，为什么这个平面与 ⅹ 垂直？

8 现在讨论 4×4 的差分方程式 Ax=b，求出四个分量 x1，x2，x3，x4，再将解写成 x

=A1b，求出逆矩阵：

100 0

－I

10

0|

Ax=

古

=

b

0 －11

00-1

94×4 的循环差分矩阵 C 为何？它在每一行与每一列都会有 1 与－1。求出所有

的解 x=（x1，x2，x3，x4）使得 Cx=0。C 的四个列会落在四维空间的一个三维超平面上。

10 前向差分矩阵 Δ 是上三角形：

利用 b1，2，b3 求 z1，2，3z=△b 的逆矩阵为何？

11 证明前向差分（t+1）2-t2 是 2t+1 = 奇数。如同微积分所述，（t+1）」－t」会从 t＂的导数开始，就是＿___。

12 已解范例的最后一行显示方程式（16）里面的 4×4 中心差分矩阵是可逆，求解

Cx=（b1，b2，b3，b4），找出 x=C＇b 的逆矩阵。

挑战问题

13 前述说明 5×5 中心差分矩阵不可逆。请写出 5 个 Cx=b 的方程式，求出左侧

的线性组合得到零。b1，b2，b3，b4，b5 的何种组合必颁等于零？（这 5 列落在 5

维空间的 4 维超平面上，难以视觉化。）

14 若（a，b）是（c，の）的倍数且 abcd≠0，证明（a，c）是（b，の的倍数。这个结果非常重

要，这两列落在同一条直线上。你可以先用数字看看 a，b，c，d 之间的关系。方程组会得到：若［］有相关的行，必定有相关的列。

网址：linear.neocities.org 箱：876152660@qq.com 31

第二章

求解线性方程组

2.1 向量与线性方程组

1.Ax=b 的列图：（A 的 n 个列）的组合产生向量 b。

2. 这是向量方程式 Ax=x1a1+x2a2+.+xnan=b:A 的列是 a1，a2，.，an。3. 当 b=0，列的组合 Ax 是零：有一种可能是 x=（0，0，.，0）。

4.Ax=b 的行图：来自 m 个行的 m 个方程式，产生 m 个在 x 交会的平面。5. 点积得到每个平面的方程式：（行 1）·x=b1，..，（行 m）·x=bm。

6. 当 b=0，所有的平面（行 i）·x=0 会经过中心点 x=（0，0，.，0）。

线性代数的中心问题是求解一个方程组（或称方程式系统），这些方程式是线性

的，也就是说未知数只会乘数字 — 我们没有见过 x 乘 y。刚开始的线性系统比较

小，但是你看到他们是可以继续延伸的：

两个方程式

x-2y=1

（1）

两个未知数

3x+2y=11

我们一次处理一行，第一个方程式是 x-2y=1，在 xy 平面是一条直线，点 x=1，

y=0 在这条直线上，因为这个点坐标是方程组的解。点 x=3，y=1 也在这条直线

上，因为 3-2=1。如果选取 x=101，我们发现 y=50。

前述直线的斜率是 1/2，这是因为 x 改变 2 时，y 会增加 1。斜率在微积分课程

很重要，只是我们现在学的是线性代数！

图 2.1 显示第一条直线 x-2y=1。在「行图」的第二条直线来自第二个方程

式 3x+2y=11。你不要错过了两条直线的交会点 x=3，y=1，点（3，1）会同时落在

两条直线上，也是两个方程式的解。

请尊重版权与译者的劳动成果，侵权必究！ 32

y 3r+2y = 11

1

x-2y =1

=

1

2

3

图 2.1：行图：点（3，1）是两条直线的交点，也是两个方程式的解。

行

行图显示两条直线交于一点（解）。

现在转到列图，我想要把相同的线性系统写成「向量方程式」，我们需要观

察向量而不是数字。如果你把原始系统分割成列而不是行，你得到向量方程式：

组合等于 b

（2）

左侧有两个列向量，问题在于找到这些向量的组合能够等于右侧的向量。我们对

第一列乘 x，对第二列乘 y，然后相加。正确的选择是 x=3 与 y=1（与前述数字

相同），得到 3（列 1）+1（列 2）=b。

列列图组合左侧的列向量产生右侧的向量 b。

图 2.2 是两个方程式两个未知数的列图，第一部分展示两个不同的列，然后第一

列乘 3，纯量（数字）的乘法是线性代数中两个基本运算其中之一：

如果向量 ν 的分量是 V1 与 V2，则 Cv 的分量是 CV1 与 CV2。

另一个基础运算是向量加法，分别对第一分量与第二分量相加，向量总和是

（1，1），也就是想要的 b:

向量加法

图 2.2 的右侧显示这样的加法。两个向量以黑线表示，沿着对角线的总和就是线

性方程式右侧的向量 b=（1，11

网址：linear.neocities.org 邮箱：876152660@qq.com 33

39 =3（列 1）

39

3（列 1）+1（列 2）=b

= 列 2

= 列 1

22

13

22

图 2.2：列图：列的组合产生右侧的（1，11）。

重复说明：向量方程式的左侧是列的线性组合，问题在于找出正确的系数 x=3 与 y=1。我们把纯量乘法及向量加法组合成一个步骤，这个步骤非常重要，因为它包含了两个基础运算：乘 3 及 1，然后相加。

线性组合

解 x=3，y=1 必然与行图的解相同。我不知道你比较喜欢哪个图？我觉得一开始两条交会的直线会比较熟悉，你可能喜欢行图多一点，但是只能维持一天，我个人的偏好是组合列向量。在四维空间观察 4 个向量的组合会比起视觉化某些超平面交于一点来的更容易一些。（一个超平面就已经很难了..）

方程式左侧的系数矩阵是 2×2 矩阵 A:

系数矩阵

从行或是从列来观察矩阵，这是线性代数非常典型的做法。行可以得到行图，列可以得到列图，相同的数字，不同的图，相同的方程组。我们结合那些方程式成为矩阵问题 Ax=b:

矩阵方程式 Ax=b

B¯²］«］-

译者注：在英文中 Amultiplied byB 表示「A 被 B 乘 = B 乘 A」，如果 B 是纯量，就无所谓顺序。A multiplies B 或 A times B 表示 A 乘 B。原文的 Multiply A times B，意义就是执行「A 乘 B」。

请尊重版权与译者的劳动成果，侵权必究！ 34

行图处理 A 的两个行，列图组合列。数值 x=3 与 y=1 进入 x，以下是矩阵－向量乘法：

行的点积

Ax=

列的组合

展望未来：本章求解有 n 个未知数的 n 个方程式（任意 n），我不想极速前进，因为较小的系统会让范例与图形得到完全的了解。只要矩阵乘法与逆矩阵变得清晰，你可以自由的走快一些。这两个观念将是逆矩阵的关键。

我可以列出四个步骤来了解使用矩阵执行消元法。

1. 借由一系列的矩阵步骤 E，消元法把 A 变成三角 U。

2. 三角系统使用反向代入法求解：由底部往顶端工作。

3. 用矩阵语言来说，A 分解成 LU=（下三角）（上三角）

4. 若 A 可逆，消元法才能成功。（但是可能需要交换行。）

计算机科学里面最常使用的演绎法都是使用这些步骤（MATLAB 称为 lu），最快速的形式是反斜线（backslash）:x=A＼b。但是线性代数会超越方形逆矩阵！对 m×n 矩阵来说，Ax=b 可能会有很多解，这些解形成向量空间，A 的秩（rank）就是向量空间的维度。

这些会在第三章讨论，我不能急躁，但是我必须完成使命。

三个未知数的三个方程式

三个未知数是 x，y，z，我们有三个方程式：

x+2y+3z=6

Ax=b

2x+5y+2z=4

（3）

6x-3y+z=2

我们想要一次性找到 x，y，z 解答三个方程式，这些数值可能存在也可能不存在。本系统的解是存在的，当未知数的个数与方程式的个数相等时（本例题中 3=3），通常会有一个解。

在求解之前，我们从两个方面来观察：

行行图显示三个平面交会于一个点。

列列图组合三个列产生 b=（6，4，2）。

在行图中，每个方程式产生一个三维空间中的平面，图 2.3 的第一个平面来自第一个方程式 x+2y+3z=6，这个平面与 x 与 y 与 z 轴的交点是（6，0，0）与（0，3，0）与（0，0，2），这三个点满足方程组并且决定整个平面。

网址：linear.neocities.org 箱：876152660@qq.com 35

向量（x，y，z）=（0，0，0）不是 x+2y+3z=6 的解，因此这个平面不包含原点。平面 x+2y+3z=0 会通过原点，并且与 x+2y+3z=6 平行。当右侧从 0 增加到 6，平行平面会离开原点。

第二个平面由第二个方程式 2x+5y+2z=4 决定，它与第一个平面的交集是一条直线 L，三个未知数两个方程式的解通常是一条直线 L。（如果方程式是 x+2y +3z=6 以及 x+2y+3z=0，交集就不是直线）。

第三个方程式得到第三个平面，它把直线 L 切在一个点，这个点落在全部三个平面上，就是三个方程式的解。画出三个平面交于一点比较困难，用想象的会比较容易。这三个平面会在解的地方交会（我们还没有找到）。列形式可以马上说明为什么 z=2。

线 L

L

解

L

L

002

y

y

平面 x+2y+3z=6

第三平面 6x-3y+z=2

平面 2x+5y+2z=4

x

x

（0，0，2）在全部三个平面上

图 2.3：行图：两个平面交于直线 L，三个平面交于一点

列图从方程式 Ax=b 的向量形式开始：

组合列

（4）

未知数是系数 x，y，z，我们想要对三个列向量乘正确数字 x，y，z 产生 b=（6，4，2）图 2.4 展示本题的列图，这些列向量的线性组合可以产生任意的 b！产生 b=（6，4，2）的组合就是第三列乘 2，我们需要的系数是 x=0，y=0，z=2。

行图中的三个平面也交会在相同的解点（0，0，2）:

正确组合（x，y，z）=（0，0，2）

0 126 +0

+2 321 = 642

请尊重版权与译者的劳动成果，侵权必究！ 36

1

26 = 列 1

3

2

1

［］=2

2 乘（列 3）=b= 642

图 2.4：列图：组合列向量，其中（x，y，z）=（0，0，2）

方程组的矩阵形式

在行图我们有三个行，在列图有三个列（加上右侧），这三行与三列包含 9 个数字，

这 9 个数字形成一个 3×3 矩阵 A:

Ax=b 的系数矩阵为

大写字母 A 代表 9 个系数（形成方形阵列），字母 b 代表列向量，其分量是 6，4，

2。未知数 x 也是一个列向量，分量是 x，y，z。（因为是向量，我们用粗体字表示；

因为它是未知，用 x 表示）。以行来看方程式是（3），以列来看方程式是（4），以矩

阵来看方程式是（5）

Ax=b 的矩阵方程式

（5）

基础问题：A 乘 x 的意义是什么？我们可以被行乘或被列乘，不管哪一种方法，

Ax=b 必须是三个方程式的正确表述。你可以用两种方法做同样的 9 个乘法。

被行乘

Ax 来自点积，每个行乘列 x:

（行 1）·x

（6）

网址：linear.neocities.org 箱：876152660@qq.com 37

被列乘

Ax 是列向量的组合：

Ax=x（列 1）+y（列 2）+z（列 3）

（7）

当我们代入解 x=（0，0，2），乘法 Ax 产生 b:

来自第一行的点积是（1，2，3）·（0，0，2）=6，其他行的点积是 4 与 2。本书将 Ax 视为 A 的列的组合。

范例 1 给定 3×3 矩阵 A 与单位矩阵 I，I 有 3 个 1 与 6 个 0:

100［4 456

如果你喜欢行，（1，0，0）与（4，5，6）的点积是 4。如果你喜欢列，线性组合 Ax 是 4 乘第一列（1，1，1），矩阵 A 的第二与第三列都是零向量。

另一个矩阵 I 很特别，主对角线都是 1，这个矩阵乘任何向量都不会改变原来的向量，如同乘上 1 一样，差别只是现在是矩阵与向量而已。本例题的特殊矩阵称为 3×3 单位矩阵：

00

I=|0 1 0

永远存在乘法 Ix=x

001

矩阵表示法

一个 2×2 矩阵的第一行包含 a11 与 a12，第二行包含 a21 与 a22。第一个下标（index）表示行数，所以 a＃是第 i 行的单元。第二个下标 j 表示列数。但是这些下标在打字的时候不太方便，一般我们不写成 a 而是写成 A（i，j）。单元 A（5，7）就在第 5 行第 7 列的位置。

对于 m×n 矩阵来说，行的下标 i 由 1 到 m，列的下标 j 最多到 n，总共有 mn 个单元 a=A（i，j），一个 n 阶（order）的方形矩阵有 n2 个单元。

请尊重版权与译者的劳动成果，侵权必究！ 38

MATLAB 中的乘法

我想要使用 MATLAB 的指令表达 A 与 x 以及乘积 Ax，这是学习 MATLAB 语言（其他软件也是）的第一步。我们从定义 A 与 x 开始，R」的向量 x 是一个 n×1 的矩阵（本书也是这么描述），输入矩阵时每次输入一行，用分号（；）代表一行的结束，或者以列输入，然后利用＇代表转置：

A=［1 2 3； 2 5 2；6-3 1］；

x=［002］＇或 x=［0；0；2］

在 MATLAB 有三种方式得到 Ax，实际上 A＊x 是很好的方法。MATLAB 是高阶语言，可以处理矩阵：

矩阵乘法 b=A＊x

我们可以选出 A 的第一行（视为较小的矩阵！），这个 1×3 矩阵的表示法为 A（1，:）。此处的冒号：代表第一行的全部列。

【原文 3×3 是错误】

一次处理一行 b=［A（1，:）＊x；A（2，:）＊x；A（3，:）＊x］

b 的每一个单元都是一个点积，行乘列，1×3 矩阵乘 3×1 矩阵。

另一种方式是使用 A 的列来乘，第一列是 3×1 子矩阵 A（:，1），现在冒号放在前面，意思是第一列全部的行。第一列乘 x（1），其他两列乘 x（2）与 x（3）:

一次处理一列 b=A（:，1）＊x（1）+A（:，2）＊x（2）+A（:，3）＊x（3）

我认为矩阵是以列来存放，一次乘一个列应该会比较快速，所以 A＊x 实际上是用列来处理的。

数学与统计的程序语言

还有 5 种语言的指令可以处理 Ax:

Julia

A＊x

julialang，org

Python

dot（A，x）

python，org

R

A％＊％x

r-projice.org

Mathematica A.x

wolfram.com/mathematica

Maple

A＊x

maplesoft.com

Julia，Python，R 是免费的开源语言，R 是特别为了统计的应用。其他统计软件（SAS，JMP，.）在维基百科里有统计软件的比较。

Mathematica 与 Maple 允许符号式的单元 a， b，x，.，不一定需要实际的数字。如同 MATLAB 的符号工具箱一样，可以处理例如 x2-x 的符号表述。Mathemtica 的强大可以在 Wolfram Alpha 搜寻引擎中看到。

网址：linear.neocities.org 箱：876152660@qq.com 39

Julia 结合 SciPy 或 R 在科学计算的高性能，这是可以跟 C 或是 Fortran 相比拟的，也可以呼叫 Python 与 C/Fortran 的函数库，但是无法依赖向量式函数库来提升速度。Julia 是快速的。

我输入 juliabox.org，然后借由谷歌 gmail 邮件账号点击「signin」，点击右侧的 new，选择一个 Julia notebook。我选择 0.4.5 而不是选择开发中的项目，Julia 命令列就会马上显示出来。

对于新手而言，我想计算 1+1，键入 shift+enter 可以看到结果。我也想学习浮点计算 1.0+1.0，对于大型问题来说会快很多。

网址：math.mit.edu/linearalgebra 会看到 Julia，Python，R 的部分强大功能。

Python 是一个流行的通用程序语言，结合 Numpy 与 SciPy 的软件包，提供一个全方位的科学计算环境。NumPy 有具有基础的线性代数指令，可以从 https:/www.continuum.io 下载 AnacondaPython（包含 Python 的预包装集以及大部分重要的数学库，是一个图形的安装器）。

R 是统计的计算与图形的免费软件，请至 https:/r-projice.org 下载。指令的提示符号是 >，R 是一个脚本语言，主要是处理表列资料，可以扩展至矩阵与向量。

郑重的推荐 RStudio 在编辑与图形的功能，当你从 www.RStudio.com 下载，R 命令的视窗会出现，还有编辑、处理档案以及画图的视窗会出现。告诉 R 矩阵的形式以及内含的单元数字：

>A= matrix（c（1，2，3，2，5，2，6，-3，1），nrow=3， byrow = TRUE）

>x=matrix（c（0，0，2），nrow=3）

要查看 A 与 x，可以在 > 之后键入名字；乘法的表示：b=A％＊％x，转置以 t（A）代表，利用 as.matrix 将向量变成矩阵。

MATLAB 与 Julia 在矩阵计算的语法上比 R 来的清楚，但是 R 已经非常流行广泛使用。本书的网址有一些软件的 demo，包含 MATLAB，Julia， Python 以及 R。

主要观念的复习

1. 向量的基础运算是纯量乘法 c 与向量加法 v+w

2. 上述两者结合得到线性组合 cv+dw。

3. 矩阵 — 向量的乘法 Ax 可以由点积得到，一次处理一行。但是 Ax 必须理

解为 A 的列的线性组合。

4. 列图：Ax=b 在寻找列的组合产生 b。

5. 行图：Ax=b 的每个方程式得到一条直线（n=2），或一个平面（n=3）或是

一个超平面（n>3）。如果有解，交集会在一个解或是多个解。

请尊重版权与译者的劳动成果，侵权必究！ 40

已解范例

2.1A 描述三个方程式 Ax=b 的列图，仔细观察列（不用消元法）然后求解：

x+3y+2z=-3

132x

2x+2y+2z=-2 即为

222y=-2

3x+5y+6z =-5

356］［2］［-5

解列图在于寻找 A 的三个列的线性组合，这些线性组合产生 b。本题中 b 是第二列的负号，所以解是 x=0，y=-1，z=0。为了证明（0，－1，0）是唯一的解，我们必须确认 A 是可逆，三个列之间是无关，行列式不为 0。

这些名词还没有完全定义清楚，但是可以借由消元法得到证实。我们需要（对于本矩阵找到）一组三个非零主元（pivot）的集合。

假设右侧变成 b=（4，4，8）= 前两个列的和，正确的组合变成 x=1，y=1，z=0， 新的解是 x=（1，1，0）

2.1B 下列系统无解，行图中的平面没有交于一个点。不存在这三个列的线性组合产生 b，如何证明？

x+3y+5z=4

x+2y-3z=5

2x+5y+2z=8

概念：执行（方程式 1）+（方程式 2）－（方程式 3），结果是 0=1，这个系统不可能有解。我们可以说：向量（1，1，－1）与 A 的三个列全部正交，但是与 b 不正交。（1）三个平面中存在任意两个平行平面吗？什么样的方程式会与平面 x+3y+ 5z=4 平行？

（2）计算 A 的每一列与 y=（1，1，-1）的点积，也计算 b 与 y 的点积。这些点积

如何说明不存在列的线性组合等于 b?

（3）求出右侧三个不同的向量 b＊，b＊，b＊＊，使得方程式有解。

解（1）纵使没有两个平面平行，这些平面仍然没有交于一点。改变「4」就可

以得到与 x+3y+5z=4 平行的平面，平面 x+3y+5z=0 会经过原点（0，

0，0）。方程式乘任意非零常数得到相同的平面，如同 2x+6y+10z=8。（2）A 的每一列与 y=（1，1，-1）的点积为 0，y·b=（1，1，-1）·（4，5，8）=1 不

是零，Ax=b 变成 0=1：无解。

（3）当 b 是列的线性组合时，存在一个解。三种 b 的选择对应解 x＊=（1，0，0），

x＊=（1，1，1），x＊=（0，0，0）:

b＊= 112 = 第一列

= 列的和

b＊＊ 000

网址：linear.neocities.org 箱：876152660@qq.com 41

问题集 2.1

问题 1-8 有关 Ax=b 的行图与列图。

1 当 A=I（单位矩阵），在行图中画出以下平面。一个盒子的三边交集在解 x=（x， y，z）=（2，3，4）:

1x + 0y + 0z = 2

10

0

2

0x+ly + 0z = 3

或是

o 0

3

0x+0y+1z=4

0 0

4

画出列图中的向量。2 乘列 1 加 3 乘列 2 加 4 乘列 3 等于右侧的 b。

2 若问题 1 的方程式分别乘以 2，3，4，他们变成 DX=B:

2x+0y+0z =4

200x 4

0x+3y+0z=9

或是

DX= 030 2 9 = B

0x+0y+4z=16

004

16

为什么行图保持不变？解 X 与 x 是否相同？列图有什么变化－- 这些列或是正确的组合会产生 B 吗？

3 若方程式 1 加到方程式 2，何者会改变：行图中的平面？列图中的向量？系数矩阵？方程组的解？问题 1 的新方程组会变成 x=2，x+y=5，z=4。

4 当 z=2，找出两个平面 x+y+3z=6 与 x-y+z=4 交线上的点。找出当 z=0 的交点，找出第三点是两个点的中点。

5 第一式加第二式等于第三式： x+y+z=2

x+2y+z=3

2x+3y+2z=5

前两个平面交会在一条直线，第三个平面包含这条直线，这是因为如果 x，y，z 满足前两个方程式，他们也

。方程式有无限多解（整条直线 L）。

找出 L 上的三个解。

6 把问题 5 的第三个平面移到平行平面 2x+3y+2z=9，现在这三个方程式变成无解 — 为什么？前两个方程式的交集是直线 L，但是第三平面不＿那条直线。

7 问题 5 的列是（1，1，2），（1，2，3）与（1，1，2），因为第三列是，所以是奇异案例。找出两个列组合得到 b=（2，3，5）。若 c=_，只有当 b=（4，6，c）时オ 有解。

请尊重版权与译者的劳动成果，侵权必究！ 42

8 通常 4 维空间的 4 个平面会交会在一个

。通常 4 维空间的 4 个列向量

的组合可以得到 b，请问（1，0，0，0），（1，1，0，0），（1，1，1，0），（1，1，1，1）的什么组合产生 b=（3，3，3，3）? 对应上述问题的 x，y，z，t 的方程式为何？

问题 9-14 有关矩阵与向量的乘法。

9 利用行与列的点积，计算下列的 Ax?

2100］［1

223

10Ax 视为列的组合，计算问题 9 的答案：

9（a）变成

当矩阵是 3×3 时，计算 Ax 需要几次乘法？

11 利用行或是列，求出 Ax 的两个分量。

3］［4

与

12［-2 与

12 计算 A 乘 x 求出 Ax 的三个分量。

001

010

与

与

10 0 XAN

223

13（a）m 行 n 列的矩阵乘有

个分量的向量，会得到有

个分量的向量。

（b）由 Ax=b 的 m 个方程式构成的平面会落在

维空间。A 的列的组合会

在

维空间。

14 将 2x+3y+z+5t=8 写成矩阵 A（有几行？）乗列向量 x=（，y，2z）产生 b。请问解 x 是 4 维空间中的平面还是超平面？平面是三维的，且没有 4D 的体积。

问题 15-22 有关矩阵对于向量的特殊操作。

15（a）2×2 的单位矩阵为何？I 乘 xA 等于

（b）2×2 的交换矩阵为何？P 乘 xA 等于 x

网址:linear.neocities.org 邮箱：876152660@qq.com 43

16 什么样的 2 阵 R 会旋转每个向 9｜

（b）什么样的 2×2 矩阵 R 会旋转每一个向量 180°？

17 求矩阵 P 乘上（x，y，z）得到（y，z，x）? 求矩阵 Q 乘上（，z，x）回到（x，y，2）?

18 什么样的 2×2 矩阵 E 会从第二分量减去第一分量？什么样的 3×3 矩阵 E 会做同样的事情？

－

与

E 357 二 327

19 什么样的 3×3 矩阵 E 乘上（x，y，z）得到（y，z，z+x）? 什么样的矩阵 E~1 乘上（x，y，z）得到（y，z，z-x）? 如果你用 E 乘（3，4，5）再用 E1 乘前述结果，这两个结果是

与。

20 什么样的 2×2 矩阵 P1 把向量（x，y）投影在 x 轴得到（x，0）? 什么样的 2×2 矩阵 P2 把向量（x，y）投影在 y 轴得到（0，y）? 如果你用 P1 乘（5，7）再用 P 乘前述结果，你会得到与＿。

21 什么样的 2×2 矩阵 R 把每个向量旋转 45°？向量（1，0）走到 （2） ，向

量（0，1）走到 （2）这些可以决定一个矩阵。在 xy 平面画出这些

特殊向量并且求出 R。

22 利用矩阵乘法 Ax 的形式写出（1，4，5）与（x，y，z）的点积，矩阵 A 有一个行。Ax=0 的解是一个

垂直于向量

。A 的列只会落在维空间。

23 以 MATLAB 的方式，写出定义矩阵 A 与列向量 x 与 b 的指令。什么样的指令可以测试是否 Ax=b?

24 MATLAB 的指令 A=eye（3）以及 v=［3:5］'可以得到 3×3 单位矩阵以及向量（3，4，5）。请问 A＊v 以及 v＇＊v 的输出为何？（不需要电脑！），如果写成 v＊A 会发生什么？

25 假设 4×4 矩阵 A 的单元全部是 1 的 A=ones（4），列向量 v=ones（4，1），A＊v 为何？（需要电脑！）若 B=eye（4）+ones（4）且 w=zeros（4，1）+2＊ones（4，1），则 B＊w 为何？

请尊重版权与译者的劳动成果，侵权必究！ 44

问题 26-28 复习 2，3，4 维的行图与列图。

26 对于方程组 x-2y=0，x+y=6，画出行图与列图。

27 对于三个未知数 x，y，z 的两个方程式，行图会得到在（2 或 3）- 维空间中的（2 或 3）（线或平面）。列图会位于（2 或 3）- 维空间。方程组的解会落在

上。

28 对于两个未知数 x，y 的四个方程式，行图会得到 4 个

。列图会落在

－维空间。除非方程式右侧向量是

的组合，否则方程组无解。

29 从向量 u0=（1，0）开始，一直在左侧乘相同的「马可夫（Markov）矩阵」A=［.8.3；.2.7］，它的下三个向量是 u1，u2，u3:

－［³［］-［］

u2 = Au1 =

u3=Au2=

你注意到这四个向量有什么性质？挑战问题

30 继续问题 29，u0=（1，0）开始直到 u7，也从 v0=（0，1）开始直到 v7。你注意到 7 与 v7 有什么特质？下面是两个 MATLAB 的代码，while 以及 for，可以画出 u 到 u7 以及 v0 到 ν7。你也可以使用其他语言。

u=［1；0］； A=［.8.3；.2.7］

v=［0；1］；A=［.8.3；.2.7］

x=u； k=［0； 7］；

x=v； k=［0； 7］；

while size（x， 2）<=7

for j= 1 ： 7

u=A＊u； x=［x u］；

v=A＊v； x=［x v］；

end

end

plot（k，x）

plot（k， x）

这些 μ 与 ν 会趋向一个稳定状态向量 s，猜测一下 s? 并且检验 As=s。如果从 s 出发，就停在 s。

31 发明一个 3×3 魔术（magic）矩阵 M3，它的单元是 1，2，.，9。所有的行与列以及对角线加起来都是 15。第一行可以是 8，3，4，求 M3 乘（1，1，1）=?M4 乘（1，1，1，1）=? 其中 M4 是 4×4 矩阵，它的单元是 1，2，..，16。

32 假设 u 与 v 是 3×3 矩阵 A 的前两列，什么样的第三列 w 会使得矩阵为奇异？在奇异情形下，请描述 Ax=b 典型的列图以及典型的行图（随机的 b）。

网址：linear.neocities.org 箱：876152660@qq.com 45

33 被 A 乘可以视为一种线性变换（linear transform），意思是：

若 w 是 u 与 ν 的组合，则 Aw 也是 Au 与 Av 的相同组合。

Aw=cAu+dAv 称为线性，也就是线性代数的由来。

问题：若 u=（1，0）与 v=（0，1），则 Au 与 Av 是 A 的列。

组合 w=cu+dv，若 w=（5，7），Aw 与 Au 及 Av 的关系为何？

34 由四个方程式开始:－xi+1+2xi-x1-1=i（其中 i=1，2，3，4 且 x0=x5=0），将方

程式写成 Ax=b 的矩阵形式，你能够求解 x1，x2，x3，x4 吗？

35 一个 9×9 的数读（Sudoku）矩阵 S，在每行与每列都有 1 到 9 的数字，而且每

个 3×3 的方块也有 1 到 9 的数字。若全 1 向量 x=（1，..，1），求 Sx?

更好的问题：哪些行的交换会产生另一个数读矩阵？同理，哪些行方块的交

换会得到另一个数读矩阵？

段落 2.7 会检视所有可能的行的排列（permutation）情形（重新排序），我可以看

出前三行有六种顺序，这些都可以得到数读矩阵。同理，下三行也有六种排

序，最后三行也是一样。那么六个方块行的方块排列？

请尊重版权与译者的劳动成果，侵权必究！ 46

2.2 消元法的概念

1 对于 m=n=3，Ax=b 有三个方程式与三个未知数 x1，x2，x3。

2 前两个方程式是 a11x1+.=b1 与 a21x1+.=b2。

3 第一方程式乘 a21/a1，然后从第二式减去：x1 被消元。

4 角落单元 a11 是第一个主元（pivot），比值 a21/a11 是第一个乘数。

5 从每个剩下的方程式 i 减去 a1/a11 乘第一方程式，方程式 i 会消去 x1。

6 现在最后 n-1 个方程式包含 n-1 个未知数 x2，.，xn。重复步骤消去 x2。7 如果零出现在主元，消元法崩溃，交换两个方程式可能可以解救。

本章说明一个系统化的方法来求解线性方程组，称为消元法（elimination），在我们的 2×2 范例中可以立即看到。消元之前，x 与 y 出现在两个方程式，消元之后，第一个未知数 x 会从第二式消失得到 8y=8:

之前 x-2y=1

3x+2y=11 之后 x-2y=1（第一式乘 3）

81=8（相减消去 3x）

新方程式 8y=8 立刻得到 y=1。将 y=1 反向代入第一式得到 x-2=1，于是 x= 3，求得解（x，y）=（3，1）。

消元法得到一个上三角形系统－就是我们的目的。非零系数 1，－2，8 形成三角形，系统由底部往上求解。首先 y=1 然后 x=3。这项快速程序称为反向代入法，经由消元法得到三角形后，反向代入可以应用在任何大小（size）的上三角形。

【size 指的是行与列的数目，中文可以翻译成「大小」或「尺寸」】

重点：原始方程组有相同的解 x=3 与 y=1，图 2.5 各使用一对直线来表示两个系统，两个系统都交于点（3，1）。经过消元法，这些线还是交会于同样的点，每一个步骤都得到正确的方程式。

我们如何从第一对直线得到第二对直线？我们把第一式的 3 倍从第二式减去，从第二式消去 x 的步骤是本章的基础运算。我们会经常使用，所以我们仔细观察：

消去 x：从方程式 2 减去方程式 1 的倍数

3 倍的 x-2y=1 是 3x-6y=3，从 3x+2y=11 减去前述方程式，右侧得到 8。重点是 3x 与 3x 抵消，左侧剩下 2y-（-6y）=8y，x 被消去，系统变成三角形。

网址：linear.neocities.org 箱：876152660@qq.com 47

问问自己如何得到乘数 1=3? 第一方程式包含 1x，所以第一个主元是 1（x 的系数），第二方程式包含 3x，所以乘数是 3。减法 3x-3x 得到三角形的零。

如果把第一式变成 4x-8y=4（一样的直线，但是第一主元变成 4），你就会看到乘数的规则。现在正确的乘数变成 1=3/4。把要消去的系数 3 除以主元 4 就得到所需的乘数： 4x-8y=4

第一式乘 3/4

4x-8y =4

3x+2y=11

从第二式减去

8y=8

最终系统是三角形而且最后的方程式得到 y=1。反向代入得到 4x-8=4 与 4x=12 与 x=3。我们改变了数字，但是没有改变直线，也没有改变解。除以主元得到乘数 1=3/4:

主元 = 执行消去的行的第一个非零数

乘数 =（要消去的单元）/（主元）=3/4

新的第二式从新的第二主元开始，这个数字是 8。如果还要从第三式（如果有的话）消去 y，就会用到这个主元 8。要求解 n 个方程式，我们需要 n 个主元，在完成消元之后，这些主元会在三角形的对角线上。

没有读到本书之前你可能已经会求解这些方程式，这是一个很简单的问题，但是我们想要多停留一会。纵使是 2×2 系统，消元法也可能崩溃（breakdown）。了解可能的崩溃（无法找到整组的主元）之后，你就会了解消元法的全部程序。

y

y

3x + 2y = 11

消元后

消元前

8y = 8

1

x=3

x-2y=1

y= 1

（3， 1）

x-2y=1

x

2

3

2

3

图 2.5：消去 x 使得第二条直线变成水平，则 8y=8，y=1。

消元法的崩溃

正常情况下消元法产生主元带领我们找到解，但是也有可能失败。有时候我们会遇到除以 0 的情况，这个无法执行，程序必须停止。可能有办法调整顺序再继续 — 或者是遇到无法避免的失败。

范例 1 因为 0y=8，无解而失败。范例 2 因为 0y=0，太多解而失败。范例 3 借由交换方程式而成功。请尊重版权与译者的劳动成果，侵权必究！ 48

x-2y=1

平行线不相交

不能组合列得到 b

3x- 6y = 11

第二列

2

图 2.6：范例 1 的行图与列图：无解。

范例 1 无解而永久失败，消元之后变得清楚：

x-2y=1

从第二式减去

x- 2y =1

3x-6у=11

3 乘第一式

0y = 8

因为 0y=8 所以无解。通常我们会让右侧的 8 除以第二个主元，但是这个系统没有第二个主元。（零永远不允许成为主元！）行图与列图如图 2.6 所示，图形可以看出为什么无法避免失败。如果不存在解，消元法的过程就会出现如同 0y=8 这样的方程式。

失败的行图显示两条平行线 — 永远无法交会，解必须同时落在两条直线上。因为没有交点，方程式无解。

列图显示两个列（1，3）与（-2，－6）位于同一个方向，所有列的组合在一条直线上，但是右侧的列却是不同方向的（1，11），我们找不到列的组合可以得到正确的右侧－- 因此无解。

如果我们把右侧改成（1，3），会因为一整条直线都是解而失败。下个例子不是无解的类型，而是有无限多解。

范例 2 无限多解而失败，把 b 从（1，11）变成（1，3）。

x-2y=1 第二式减去

x-2y=1

仍然只有

3x-6y=33 乘第一式

0y = 0

一个主元

所有的 y 都满足 0y=0，实际上只有一个方程式 x-2y=1。未知数 y 是自由的，选取 y 之后就可以从 x=1+2y 得到 x。

在行图中，平行线变成同一条线，线上的每一点都满足两个方程式，图 2.7 显示一整条线都是解的情形。

在列图中，现在 b=（1，3）与列 1 相同，所以可以选取 x=1 及 y=0。我们也可以选取 x=0 及 y=-1/2；列 2 乘－1/2 等于 b。每一个行问题的解（x，y），也会是列问题的解。

网址：linear.neocities.org 箱：876152660@qq.com 49

右侧

x-2y=1 3x- 6y=3

位于列的直线

来自两个方程式的相同直线

解全部沿着这条直线

（2y2 －

图 2.7：范例 2 的行图与列图：无限多解。

失败 n 个方程式找不到 n 个主元。

消元法得到方程式 0≠0（无解），或是 0=0（无限多解）。

得到 n 个主元代表成功，但是可能需要交换这 n 个方程式。

消元法失败的第三种形式是可以修正的。假设第一个主元位置是 0，我们拒绝允许 0 做为主元。当第一式没有 x 项时，我们可以把它与下方的方程式交换：范例 3 暂时性失败（主元出现 0），交换行得到两个主元：

排列 0x+2y=4

3x-2y=5 两个方程式交换

3x-2y=5

2y=4

新系统已经是三角形，这个小例子已经可以执行反向代入。最后一个方程式得到 y=2，从第一式可以得到 x=3。行图是正常的（两条相交直线），列图也是正常的（列向量不在同一个方向。）主元 3 与 2 是正常的 — 只是需要一次的行交换。

范例 1 与 2 是奇异 — 没有第二个主元。范例 3 是非奇异 — 有完整的主元集合，以及确切一个解，奇异方程式无解或是无限多解。因为主元要当做除数，主元必须不是零。

三个方程式三个未知数

要了解高斯消元法，你必须要超越 2×2 系统，3×3 系统足够看出模式。现在方程式是方形 — 行数与列数相等。以下是一个特殊建构的 3×3 系统，所有的消元过程得到整数而不是分数：请尊重版权与译者的劳动成果，侵权必究！ 50

2x + 4y- 2z = 2

4x+9y-3z=8

（1）

－ 2x-3y+ 7z =10

步骤为何？第一主元是粗体字 2（左上角），在这个主元下方要消去的是 4，第一个乘数就是比值 4/2=2。主元方程式乘 l21=2 然后被减去，把 4x 从第二式中消除：步骤 1 从方程式 2 减去 2 乘方程式 1，得到 y+z=4。

使用第一个主元也可以消去第三式的－2x，最快的方法是将第一式加到第三式，2x 会抵消－2x。本书一直强调是先乘后减，而不是加，其实是因为乘数 l31=-2/2=-1，减去第一式的－1 倍就如同加法。

步骤 2 方程式 3 减去－1 乘方程式 1，得到 y+5z=12。新的两个方程式只与 y 及 z 有关，第二个主元（粗体字）是 1：1y+1z =4

x 已经被消去

ly+5z=12

我们已经得到 2×2 系统，最后的步骤是消去 y 得到 1×1 系统：

步骤 3 从方程式 3new 减去方程式 2new，乘数是 1/1=1，得到 4z=8。原始系统 Ax=b 已经变换成上三角形 Ux=c:

2x+ 4y-2z=2

Ax=b

2x+ 4y-2z=2

4x+9y-3z =8

已经变成

1y+1z=4

（2）

－2x-3y+7z=10

Ux=c

4z=8

目的达成－从 A 到 U 完成前向消元。注意在 U 的对角线的主元 2，1，4，主元 1 与 4 隐藏在原始系统，消元法使得他们出现。Ux=c 已经可以使用快速的反向代入法：

（4z=8 得到 z=2）

（y+z=4 得到 y=2）

（方程式 1 给出 x=-1）

系统的解是（x，y，z）=（-1，2，2）。行图有三个方程式构成的三个平面，这三个平面都会经过解。原始平面都是斜的，最后一个平面经过消元法之后变成水平。

列图显示列向量的组合 Ax 产生右侧的 b，组合的系数是－1，2，2（解）：

（3）

在 Ax=b 中，数字 x，y，z 乘列 1，2，3，在三角 Ux=c 中也是如此。

网址：linear.neocities.org 箱：876152660@qq.com 51

从 A 到 U 的消元法

对于 4×4 的问题，或是 n×n 的问题，消元法的程序都是一样。以下是全部的概念，

当高斯消元法成功时，一列接着一列的从 A 变成 U。

列 1. 利用第一式使得第一主元以下都变成 0。

列 2. 利用新的第二式使得第二主元以下都变成 0。

列 3 到 n. 持续进行，找到 n 个主元以及上三角矩阵 U。

xxxx

xxxx

0xxx

列 2 之后我们有

，我们想要

x xx

0 0 x x

（4）

xx

0 0 x x

x

前向消元法的结果是一个上三角系统，如果存在一整组 n 个主元（非零数字！）的集

合，矩阵是非奇异。问题：因为主元已知，左侧的哪些 x 在消元过程中不会被改

变？下面是最后一个展示原始系统 Ax=b，三角系统 Ux=c 以及反向代入得到解

（x，y，z）的例子：

x+y+z=6

x+y+z=6

反向

x+2y+2z=9 前向

y+z =3

XN

32

反向

x+2y+3z=10 前向

z=1

所有的乘数都是 1，所有的主元都是 1，所有的平面交会于（3，2，1）。A 的列使用

3，2，1 的组合得到 b=（6，9，10），三角形显示 Ux=c=（6，3，1）。

主要观念的复习

1. 线性系统（Ax=b）在消元之后变成上三角（Ux=c）

2. 我们从方程式 i 减去乗方程式 j 使得（，）单元为 0。3. 乘数 l = 第 i 行中要消去的单元，主元不能为 0！

第 j 行的枢轴

4. 当 0 出现在主元的位置，如果下方有非零单元，交换行。5. 上三角 Ux=c 可以使用反向代入求解（从底部开始）。6. 当崩溃一直出现，Ax=b 无解或是无限多解。

请尊重版权与译者的劳动成果，侵权必究！ 52

已解范例

2.2A 对矩阵 A 执行消元法，第一与第二主元为何？第一步骤的乘数 21 为何（行 2

减去 21 乘行 1）?

在 2，2 的位置上出现什么数字（不是原始的 2）会使得行 2 与行 3 必须交换？

为什么左下角的乘数 l31=0，我们要从行 3 减去 0 乘行 1?

如果把角落单元 a33=2 变成 a33=1，为什么消元法会失败？

解第一个主元是 1，乘数 / 21=1/1【原文 1，1 有误】。当从行 2 减去 1 乘行 1 时，

第二主元也是 1。如果原始中间位置的单元不是 2 而是 1，就要处理行交换。

因为 a31=0，乘数 l31 是零，某一行的开始单元是零就不需要消元。现在得到

A 是一个带状矩阵（band matrix），在中心带之外的单元都是零。

最后一个主元也是 1，如果原始的角落单元 a33=2 减少 1，消元法会产生 0，

没有第三主元，消元法失败。

2.2B 假设 A 已经是三角形矩阵（上三角或是下三角），主元会在哪些位置？当 b

为任意时，什么时候 Ax=b 会确切有一个解？

解矩阵的对角线单元就是现成的主元，这些主元全部不是零，可以成功执行消

元法。当 A 是上三角时，使用反向代入；当 A 是下三角时，使用前向代入。

2.2C 利用消元法得到上三角形矩阵 U，使用反向代入求解，或者解释为什么无

法执行？主元（不是 0）为何？必要时可以交换方程式的顺序。范例中两个系统唯一

的差别是最后一个方程式是－x。

x+y+z=7

x+y+z=7

成功 x+y-z=5

失败 x+y-z=5

x-y+z=3

－x-y+z=3

解对于系统 1，方程式 2 与方程式 3 分别减去方程式 1（乘数 l21=1，31=1，），单

元 2，2 变成 0，所以交换方程式 2 与 3:

x+y+z=7

x+y+z=7

成功 0y-2z=-2 交换后变成－2y+0z=-4 －2y+0z=-4

－2z=-2

反向代入得到 z=1 与 y=2 与 x=4。主元是 1，－2，－2。

网址：linear.neocities.org 箱：876152660@qq.com 53

对于系统 2，一样执行方程式 2 减去方程式 1，然后方程式 1 加到方程式 3，使得 2，2 单元变成零，2，2 单元的下方也是零：

x+y+z=7 列 2 没有主元（列 2 原来就是列 1）

失败 0y-2z=-2 进一步消元得到 0z=8

0y+2z=10 三个平面不相交

平面 1 与 2 交于一条直线，平面 1 与 3 的交线与前面的直线平行，无解。

如果我们把原来第三方程式的「3」换成「－5」，消元法得到 0=0，有无限多解！三个平面的交集是一整条直线。

把 3 换成－5 使得第三平面与前面两个平面相交，第二方程式得到 z=1，第一个方程式变成 x+y=6。第二列不存在主元使得 y 变成自由（自由变数可以是任意数），则 x=6-y。

问题集 2.2

问题 1-10 有关 2×2 系统的消元。

1 从方程式 2 减去方程式 1 所需要的乘数 21 为何？

2x+3y=1

10x+9y=11

消元之后，写出上三角矩阵并且圈出两个主元。数字 1 与 11 不会影响主元－- 使用他们完成反向代入。

2 求解问题 1 的三角形系统，反向代入先求 y 再求 x。验证 x 乘（2，10）加上 y 乘 （3，9）得到（1，11）。如果右侧变成（4，44），新的解为何？

3 从方程式 2 减去方程式 1 所需要的乘数为何？

2x-4y=6

－x+5y=0

消元步骤之后，求解三角系统。如果右侧变成（-6，0），新的解为何？

4 从方程式 2 减去方程式 1 所需要的乘数 1 为何才能消除 c?

ax+by=f

cx+dy=g

假设 a 不为 0，第一个主元就是 a。消元法得到第二个主元的公式为何？当 ad=bc，第二个主元消失：奇异。

请尊重版权与译者的劳动成果，侵权必究！ 54

5 下列方程式的空白处为何值使得系统无解？空白处为何值使得系统无限多解？

写出两个解。

奇异系统 3x+2y=10

6x+4y=

6 选系数 b 使得系统成为奇异，再选右侧的 g 使得系统有解，写出两个解。

2x+by=16

4x+8y=g

7 哪些数值 a 使得消元法崩溃，（1）永久崩溃（2）暂时崩溃。

ax+3y=-3

4x+6y=6

借由行的交换修正消元法的崩溃，然后求解 x 与 y。

8 哪三个数值 k 使得消元法崩溃，哪一种情形可以利用行交换修正？三种情形

下，解的个数分别是 0 或 1 或∞？

жx+3y=6

3x+ky=-6

9 探索 b1 与 b2 的条件，使得下列方程式有解。

3x-2y=b1

6x-4y = b2

10 在 xy 平面中，画出直线 x+y=5 与 x+2y=6，经过消元之后得到方程式

y=

？若 c=

，直线 5x-4y=c 会通过前述方程式的解。

问题 11-20 研究 3×3 系统的消元（可能会失败）。

11（推荐）线性方程组不可能恰好有两个解，为什么？

（a）若（x，y，z）与（X，Y，Z）是两个解，其他解为何？

（b）若 25 个平面的交集在两个点，其他交集在哪儿？

网址:linear.neocities.org 箱：876152660@qq.com 55

12 利用两个行运算简化系统成为上三角。

2x+3y+z =8

4x + 7y+5z = 20

－2y+2z=0

圈出主元，利用反向代入求解 z，y，x。

13 利用消元法（圈出主元）以及反向代入求解

2x-3y=3

4x-5y+ z=7

2x-y-3z=5

列出三个行运算：从行减去乘行。

14 什么数值 d 会强制一个行交换？此时三角系统（非奇异）为何？什么数值 d 会使得系统奇异（没有第三个主元）？

2x+5y+ z =0

4x + dy+ z = 2

y-z =3

15 什么数值 b 会产生强制的行交换？什么数值 b 会使得主元不存在？在奇异情形下找出非零解 x，y，z。

x+by=0

x-2y- z = 0

y+z = （

16（a）建立一个 3×3 系统，需要两次行交换得到三角矩阵以及一个解。

（b）建立一个 3×3 系统，需要一次行交换才能继续执行，但是稍后会崩溃。17 如果行 1 与行 2 相同，你可以使用消元法到哪个地步（允许行交换）？如果列 1 与列 2 相同，哪个主元会消失？

相等行

2x-y+ z=0

2x+ 2y+ z = 0

相等列

2x-y+ z=0

4x+ 4y+ z=0

4x + y+ z =2

6x + 6y+ z = 2

18 建立一个 3×3 范例，左侧的 9 个系数都不相同，但是行 2 与行 3 在消元法之后都变成 0。当 b=（1，10，100）时，你的系统有多少解？当 b=（0，0，0）时，你的系统有多少解？请尊重版权与译者的劳动成果，侵权必究！ 56

l9 什么数字 q 使得系统奇异？什么样的右侧 t 使得系统有无限多解？当 z=1 时， 求解？

x+4y-2z=1

x+7y-6z=6

3y+qz=t

20 纵使没有平面是平行，三个平面也可能无法交于一点。若 A 的行 3 是前两行的，则系统为奇异。给定方程式 x+y+z=0 与 x-2y-z=1，求出第三个方程式使得系统无解。

21 求出以下两个系统的主元与解（Ax=b 与 Kx=b）:

=0

=0

=0

y+2z+ t =0

－y+2z- t =0

z+2t=5

－z+2t=5

22 如果你延伸问题 21 的 1，2，1 模式，或是－1，2，－1 的模式，第五个主元是多少？第 n 个主元是多少？K 矩阵是我最喜欢的矩阵。

23 若消元法得到 x+y=1 与 2y=3，求三个可能的原来问题。

2 动

25a 的哪三个数值使得消元法无法得到三个主元？

26 找出一个矩阵使得行的总和是 4 与 8，列的总和是 2 与 s:

姐阵－［

a+b= 4 a+c=2

c+d=8 b+d=s

只有 s=

，四个方程式才有解。找出两个不同的矩阵满足正确的行总和与列总和。额外积分：写下 4×4 系统 Ax=b，其中 x=（a，b，c，d），在消元法之后 A 变成三角形。

27 使用正常顺序的消元法得到什么矩阵 U 并且求解下列的下三角系统。事实上我们做的是前向代入：

3x

=3

6x+2y+ =8

9x-2y+z=9

网址：linear.neocities.org:876152660@qq.com 57

28 若矩阵 A 已知，建立 MATLAB 指令 A（2，:）=. 得到新的行 2，从现存的行 2 减去 3 乘行 1。

挑战问题

29 假设 MATLAB 指令为［L，U］=lu（rand（3），找出第一主元，第二主元，第三主元的平均大小。平均大小 abs（U（1，1）大于 1/2，这是因为 lu 会选取列 1 最大可能的主元。此处 A=rand（3，3）具有 0 至 1 的随机数。

30 若最右下角单元为 A（5，5）=11，A 的最后一个主元为 U（5，5）=4。当 A（5，5）是多少时，系统是奇异？

31 假设消元法使得 A 到 U，而且没有任何的行交换。U 的行 j 是 A 的哪些行的线性组合？若 Ax=0，Ux 会等于 0? 若 Ax=b，Ux 会等于 b? 若 A 是下三角矩阵，则上三角矩阵 U=

32 若 Ax=0 是 100 个方程式 100 个未知数的系统，其中 x=（x1，.，x100）。假设消元法使得第 100 个方程式变成 0=0，所有系统是奇异：

（a）消元法取得行的线性组合，所以奇异系统有以下的奇异性质：这 100 行的

某一个线性组合等于

（b）奇异系统 Ax=0 有无限多解，表示这 100 列的某一个线性组合等于

（c）找出一个没有单元是零的 100×100 奇异矩阵。

（d）针对你的矩阵用文字描述 Ax=0 的行图与列图。不需要画出 100 维空间。

请尊重版权与译者的劳动成果，侵权必究！ 58

2.3 使用矩阵消元

1 第一步用矩阵 E21 乘 Ax=b 产生 E21Ax=E21b。

2 矩阵 E21A 在行 2，列 1 有一个零，这是因为方程式 2 的 x1 被消去。

3 把单位矩阵（对角线都是 1＇s）在行 2，列 1 减去乘数 a21/a11 得到 E21。

4 矩阵－矩阵乘法包含 n 个矩阵－向量乘法：EA=［Ea1.Ean］。

5 我们也必须乘 Eb。所以是 E 乘增广矩阵［Ab］=［a1.anb］。

6 消元矩阵乘 Ax=b 的顺序 E21，E31，..，En1，然后 E32，E42，..，En2，持续下去。7 行交换矩阵不是 E 而是 P，将 I 的第 i 行与第 j 行交换得到 P。

本段落介绍第一个矩阵乘法的例子，很自然的我们会从包含很多零的矩阵开始。

我们的目标是想了解矩阵能够做什么？E 作用在向量 b 或是矩阵 A 得到新的向量 Eb 或是新的矩阵 EA。

我们的第一个例子是消元矩阵，他们可以执行消元的步骤。从第 í 个方程式减去 l 乘第 j 个方程式（把 x 从方程式 i 消除），我们需要很多个简单矩阵 E，每一个对应一个主对角线下方要消除的非零数字。

很幸运的，在后面章节不会看到全部的 E，他们是开始学习时很好的例子，但是数量太多了。他们可以结合成为一个整体矩阵 E，一次性完成所有步骤。最简洁的方法是结合所有的逆矩阵（E）1，变成一个整体矩阵 L=E1。下列是后续页面的内容。

1. 了解每个步骤都是一次矩阵乘法。

2. 组合所有的步骤 E 变成一个消元矩阵 E。

3. 了解每个 E 如何变成逆矩阵 E1。

4. 组合所有的逆矩阵 E1（右序）变成 L。

L 的特殊性质是所有的乘数 l1 都会井然有序，这些数字在 E 中弄得混乱不堪（从 A 到 U 的前向消元），在 L 中（撤销消元，反向从 U 到 A）却是非常完美。反向会让这些步骤与矩阵 E 落在反向序列中，并且可以防止混乱。

本段落求取矩阵 E，段落 2.4 介绍四种矩阵相乘的方法，段落 2.5 介绍逆反操作，（我们已经在这里看到消元矩阵以及 E。）这些逆反操作进入 L。

网址：linear.neocities.org 箱：876152660@qq.com 59

矩阵乘向量与 Ax=b

前一个段落介绍 3×3 矩阵时，有这样的缩写 Ax=b:

2x1+4x2-2x3=2

4x1+9x2-3x3=8 等同于

（1）

－2x1-3x2+7x3=10

－2-3

左侧的九个数字组成矩阵 A，矩阵不是静坐在 x 旁边而已，矩阵 A 还要乘 x，A

乘 x 的规则要能够得到三个方程式。

A 乘 x 的复习矩阵乘向量得到向量，当方程式的数目（3 个）与未知数的数目（3

个）相等时，矩阵是方阵，我们的矩阵是 3×3。方阵一般表示成 n×n，向量 x 在 n

维空间中。

未知数是 x=

解是 x= 122

关键点：Ax=b 可以代表方程式的行形式，也可以是列形式：

·

列形式 Ax=（-1）

（2）

Ax 是 A 的列的线性组合，要计算 Ax 的分量时，我们使用矩阵乘法的行形式，Ax

的分量就是 x 与（A 的行）的点积。与 x 点积的短公式使用「累加表示」：

Ax 的第一分量为（-1）（2）+（2）（4）+（2）（-2）。

Ax 的第 i 分量为（行 i）·x=ailx1+a2x2+.+ainxn。

有时候写成累加符号的形式： ∑

j-1@yxj

∑的意思是累加，从 j=1 开始直到 j=n 停止，总和从 ax1 开始一直到 ainxn，可

以得到点积（行 i）·x。

重复说明矩阵的表示法：行 1，列 1 的单元（左上角）是 a11，行 1，列 3 的单元

是 a1，行 3，列 1 的单元是 a31，（行数目在前，列数目在后）。单元这个词相对于

矩阵就如同分量相对于向量。一般规则：a＃=A（i，j），位置在行 i，列 j。

范例 1 矩阵的 ay=2i+j，则 a11=3，a12=4，a21=5。以下是由行得到 Ax，分

别以数字与字母表示：

一行乘一列得到一个点积。

1 爱因斯坦删去∑得到更简短的形式，ax 的重复 j 自动代表总和。他也写过 a/xj。

我们不是爱因斯坦，我们使用∑。

请尊重版权与译者的劳动成果，侵权必究！ 60

一个消元步骤的矩阵形式

Ax=b 是原始方程式的便利形式，消元步骤又是如何？本范例中，从第二式减去

2 乘第一式，在右侧 b 的第二分量减去第一分量的 2 倍：

第一步 b= 280 变成 bnew 4

10

我们想用矩阵完成刚才的动作！目的在找到消元矩阵 E 乘 b 得到相同的效果 bnew

=Eb，也就是从 b2 减去 2b1:

1 0 0

消元矩阵

E = －210

0 0 1

用 E 乘的效果是从行 2 减去 2 乘行 1，行 1 与行 3 保持不变： 100］［2

24

100］［b

－2108=4

0011010

E 的第一与第三行来自单位矩阵 I，没有改变第一与第三个的数字（2 与 10），新的

第二分量在消元步骤之后变成 4，就是 b2-2b1。

很容易描述「基础矩阵」或是「消元矩阵」的 E，从单位矩阵 I 开始，把其中

的一个 0 变成乘数－1:

单位矩阵在对角线的单元都是 1，其余单元都是 0。对于所有的 b 存在 Ib=b。

「基础矩阵」或是「消元矩阵」E 在位置 i，j 多了一个非零单元－I，则 E＃会得到

从行 i 减去行 j 的 1 倍。

范例 2 矩阵 E31 在位置 3，1 是－l:

1 0 0

单位矩阵 I= 0 1 0

0 0 1

当你用 I 乘 b 得到 b，但是当 E31 乘 b 得到第三分量减去 l 乘第一分量。当 1=4，这

个例子给出 9-4=5:

【下方原文的 E 是错误】

10 0

E3ib=

0

135

网址：linear.neocities.org 箱：876152660@qq.com 61

Ax=b 的左侧会怎么样？两侧都会被 E31 乘，E31 的目的是在矩阵的（3，1）位置产生一个 0。

表示式满足它的目的。从 A 开始，应用数个 Es 使得在主元下方的位置产生零（第一个 E 是 E21），最终得到三角形 U。现在我们关注详细的步骤。

从小处开始，向量 x 不变。解 x 不会因为消元法而改变（这就不是小处了！），只有系数矩阵会改变。当我们从 Ax=b 开始，然后被 E 乘，结果是 EAx=Eb，新的矩阵 EA 是 E 乘 A 的结果。

坦白消元矩阵 E 是伟大的例子，但是后面就见不到了。他们展示矩阵如何影响行。经过几次消元之后，我们了解如何乘矩阵（这些 E 矩阵的顺序变得非常重要。）乘积与逆矩阵对于 E 来说特别清晰。以下是本书会看到的两个观念。矩阵乘法

最大的问题：两个矩阵如何乘？当第一个矩阵是 E，我们预期的是 EA，这个特殊的 E 使得 A 从行 2 减去 2 乘行 1，乘数为 2:

（3）

001-2-37［-2-37

这个步骤没有影响 A 的行 1 与行 3，这些行在 EA 中保持不变，只有行 2 不同，行 2 已经减去行 1 的 2 倍。矩阵乘法与消元法一致－新系统变成 EAx=Eb。

EAx 很简单但是有一个巧妙的概念。从 Ax=b 开始，两侧同时用 E 乘给出 E（Ax）=Eb。使用矩阵乘法，这也是（EA）x=Eb。

第一个是 E 乘 Ax，第二个是 EA 乘 x，两者相同。

括号就不需要了，我们直接写成 EAx。

这个规则扩展至具有数个列向量的矩阵 C，计算 EAC 时可以先做 AC，也可以先做 EA，这就是所谓的结合律，好像 3×（4×5）=（3×4）×5 一样。3 乘 20 或者 12 乘 5，两者的答案都是 60。这个定律看起来很清楚，很难想象它也有可能错误。交换律 3×4=4×3 看起来更明显，但是 EA 通常不会等于 AE。当 E 在右乘，它作用的是 A 的列而不是行。AE 会使得列 1 减去 2 乘列 2，所以 EA≠AE。

结合律为真

A（BC）=（AB）C

交换律为假

通常 AB≠BA

请尊重版权与译者的劳动成果，侵权必究！ 62 矩阵乘法还有另一个要求，假设 B 只有一列（就是列 b），针对 EB 的矩阵矩阵

法则必须与矩阵－向量的法则一致，甚至我们能够使得矩阵乘法 EB 可以一次乘一

个列：

若 B 具有数个列 b1，b2，b3，则 EB 的列是 Eb1，Eb2， Eb3。

EB=E［b1， b2， bs］=［Eb1， Eb， Ebs

（4）

【依据上下文关系，原文的 A 应该是 E 才合理】

对于（3）的矩阵乘法来说，这项性质也适用。如果你用 E 乘 A 的列 3，你会正

确得到 EA 的列 3:

E（A 的列 j）=EA 的列 j

当消元法应用到行时，这个要求在于处理列。下个段落会介绍每个乘积 AB 的每

个单元，矩阵乘法的美在于三种处理方法（行，列，整个矩阵）都有正确的结果。

行交换矩阵 P

我们使用 E 从行 i 减去行 j。要交换或是排列这些行，我们使用另一种矩阵 P（排

列矩阵）。当零出现在主元位置时，我们要做交换行的动作。往下方看，主元这一

列可能包含一个非零数，两行交换就有了主元，消元法可以继续执行。

什么样的矩阵 P23 可以交换行 2 与行 3? 我们可以把单位矩阵的行 2 与行 3 交

换，就得到 P23:

100

排列矩阵

这是行交换矩阵。P23 乘任意列向量，会使得向量的第二分量与第三分量交换，

因此也可以交换矩阵的行 2 与行 3:

100］［241］［241

与

001003=065

0 1 00 6 50 0 3

在右侧，P23 做了该做的事情。因为 0 出现在第二主元的位置而且下方有个「6」，

交换后 6 出现在主元的位置。

网址：linear.neocities.org 箱：876152660@qq.com 63

矩阵是有作用的，不是枯坐在旁边。我们很快会看到其他排列矩阵，这些矩阵可以改变行的顺序。行 1，2，3 可以变成 3，1，2，刚才的 P23 是一个特殊排列矩阵－它交换行 2 与 3。

行交换矩阵单位矩阵的行 i 与 j 反序得到 P。当排列矩阵 P 乘一个矩阵时，它交换行 í 与行 j。

通常行交换不太用得到，很好的机会下用消元矩阵 E 已经足够。有时候为了把主元移动至对角线，P 还是可以用的。

增广矩阵

本书最终会离开消元法很远，矩阵相乘有很多实际的应用，最佳的出发点是方阵 E 乘方阵 A。我们在介绍消元法的时候已经见过，我们也知道 EA 的预期答案是什么。下个步骤允许出现矩形（长方形）矩阵，他们还是一样来自原始方程式，只是现在多加了 b。

关键观念：消元法对于 A 与 b 有相同的行运算，我们可以把 b 引入一个額外列，然后一样执行消元法。加入 b 之后矩阵 A 变大了，或是增广了（augmented）:

増广矩阵 иы

消元法作用在矩阵的整个行，用 E 同时乘左侧与右侧，得到方程式 2 减去 2 乘方程式 1，消元步骤同时作用在［Ab］:

新的第二行包含 0，1，1，4，新的第二方程式是 x2+x3=4。行与列同时参与矩阵乘法的工作：

行：E 的每一行作用在［A b］得到［EA Eb］的一个行。

列：E 作用在［Ab］的每一列得到［EA Eb］的列。

请尊重版权与译者的劳动成果，侵权必究！ 64 再次注意这个字「作用（act）」，这个很重要，矩阵的确做了事情！矩阵 A 作用在 x 得到 b，矩阵 E 作用在 A 得到 EA。消元的整体过程就是一系列的行运算，也就是矩阵乘法。A 走到 E21A，然后是 E31E21A，最终 E32E31E21A 是个三角矩阵。方程式右侧被引入到增广矩阵，最后的结果是方程式的三角系统。在写下所有的矩阵乘法规则前（包含方块计算），我们将停止左乘 E 的练习。

主要观念的复习

1.Ax=（x1 乘列 1）+.+（xn 乘列 n），（Ax）1=∑=1ax。

2. 单位矩阵 = I，消元矩阵 = E 使用 l，交换矩阵 = P。

3. 用 E21 乘 Ax=b，得到方程式 2 减去 l21 乘方程式 1。数字－21 是消元矩阵

E21 在位置（2，1）的单元。

4. 对于增广矩阵［Ab］，消元步骤得到［E21AE21b］。

5. 当 A 乘任意矩阵 B，等于 A 分别乘 B 的每一列。

已解范例

2.3A 什么样的 3×3 矩阵 E21 使得第二行减去 4 乘第一行？什么样的矩阵 P32 使得第二行与第三行交换？如果对 A 进行右乘而不是原来的左乘，请描述 AE21 与 AP32 的结果？

解对于单位矩阵 I 执行所需的运算，得到

10

0 1

E21 乘在右侧得到从列 1 减去 4 乘列 2，P32 乘在右侧得到列 2 与列 3 交换。

2.3B 引入额外的列，写下系统的增广矩阵［Ab］:

x+2y+2z=1

4x+8y+9z=3

3y+2z=1

应用 E21，再应用 P32 可以得到三角系统。应用反向代入求解。组合矩阵 P32E21 可以同时完成什么工作？

网址:linear.neocities.org 箱：876152660@qq.com 65

解 E21 移除列 1 的 4，但是 0 出现在列 2:

现在 P32 交换行 2 与 3，反向代入产生 z 然后 y 与 x。

组合矩阵 P32E21 可以同时执行两个步骤，应用 P32 到 E21。

一个矩阵，两个步骤

：一交换的行－［

2.3C 矩阵乘法有两种方式，第一，A 的行乘 B 的列。第二，A 的列乘 B 的行，这个不寻常的方法产生两个矩阵，相加之后得到 AB。两个方法各需要多少次正常的乘法？

两种方法

解（A 的行）乘（B 的列）是向量的点积：

（行 1）（列 1）=34=10 是 AB 的（1.1）单元

是 AB 的（2，1）单元

我们需要 6 个点积，每个有 2 个乘法，全部是（3·2·2）=12。同样的 AB 来自 A 的列乘 B 的行，一个列乘一个行得到一个矩阵：

请尊重版权与译者的劳动成果，侵权必究！ 66

问题集 2.3

问题 1-15 有关消元矩阵。

1 写下产生下列消元步骤的 3×3 矩阵：

（a）E21 从行 2 减去 5 乘行 1。

（b）E32 从行 3 减去－7 乘行 2。

（c）P 交换行 1 与 2，然后交换行 2 与 3。

2 问题 1 中，应用 E21 然后 E32 至 b=（1，0，0）得到 E32E21b=___。在 E21 之

前应用 E32 得到 E21E32b=_____。当 E32 先使用时，行＿_无法感受来自行

的效应。

3 哪三个矩阵 E21，E31，E32 使得 A 变成三角形 U?

这些 E＇s 矩阵乘在一起得到整体消元矩阵 M:MA=U。

4 引入 b=（1，0，0）作为问题 3 的第四列得到［Ab］，应用消元步骤至增广矩阵， 求解 Ax=b。

5 假设 a33=7 且第三主元是 5，如果你把 a33 改成 11，第三主元变成？如

果你把 a33 改成＿，就不存在第三主元。

6 如果 A 的每一列都是（1，1，1）的倍数，则 Ax 永远是（1，1，1）的倍数。制造一个

3×3 范例，消元步骤会得到几个主元？

7 假设 E 从行 3 减去 7 乘行 1。

（a）想要逆反这个步骤，你必须 7 乘行，然后

到行

（b）什么样的逆矩阵 E1 会执行这个逆反步骤（所以 E1E=I）?

（c）如果先应用逆反步骤（然后才是 E），证明 EE-1=I。

8 - 行列是 M 行 21 行」新的 M

证明任意 l，detM＊=detM。当 1=c/a，主元乘积等于行列式：（a）（d-lb）等 Fad-bc.

9（a）E21 从行 2 减去行 1，然后 P23 交换行 2 与 3。什么样的矩阵 M=P23E21

同时执行这两个步骤？

（b）P23 交换行 2 与 3，然后 E31 从行 3 减去行 1，什么样的矩阵 M=E31P23 同

时执行这两个步骤？说明为什么 E＇s 不一样，M 却是相同？

网址:linear.neocities.org 箱：876152660@qq.com 67

10（a）什么样的 3×3 矩阵 E13 会把行 3 加到行 1?

（b）什么样的矩阵把行 1 加到行 3，同时行 3 加到行 1?

（c）什么样的矩阵把行 1 加到行 3，然后行 3 加到行 1?

11 创建一个矩阵使得 a11=a22=a33=1，但是消元法在没有行交换的情形下，产

生两个负的主元。（第一主元是 1。）

12 矩阵相乘：

001123001

10 0

010

一

100789 100

－10

13 解释下列事实。如果 B 的第三列全部是零，则 EB 的第三列也全部是零（任意

的 E）。如果 B 的第三行全部是零，则 EB 的第三行可能不是零。

14 下列的 4×4 矩阵需要 E21 与 E32 与 E43 的消元矩阵，这些矩阵为何？

2-100

－12-10

A=|

0-12-1

00-12

15 写下 3×3 矩阵，其中 a=2i-3j。矩阵的 a32=0，但是消元法还是需要 E32

使得 3，2 位置得到 0。前面哪个步骤破坏了原始的 0，且 E32 为何？

问题 16-23 有关建立矩阵与乘矩阵。

16 将这些古老的问题写成 2×2 矩阵形式 Ax=b 并求解。

（a）X 的年纪是 Y 的两倍，两者的年纪相加等于 33。

（b）（x，y）=（2，5）与（3，7）在直线 y=mx+c 上，求 m 与 c。

17 抛物线 y=a+bx+cx2 会通过（x，y）=（1，4）与（2，8）与（3，14）。找出矩阵方程式并求解未知数（a，b，c）

18 分别以顺序 EF 及 FE 执行矩阵乘法：

001

［1 0 0

E= a

1

F=0 1 0

b 0 0

0 c 1

同时计算 E2=EE 与 F3=FFF，你可以猜猜 F100。

请尊重版权与译者的劳动成果，侵权必究！ 68

19 分别以顺序 PQ 与 QP 与 P2 计算行交换矩阵的乘积：

0 1 0

0 0 1

P= 1 0 0

Q= 010

0 0 1

1 0 0

找出另一个非对角矩阵 M，使得 M2=I。

20（a）假设 B 的所有的列都相同，则 EB 的所有的列也相同。这是因为每个都是

E 乘

（b）假设 B 所有的行都是［124］，以例子说明 EB 所有的行都不是［124］。

所有的行是

是真实的。

21 如果 E 把行 1 加到行 2 以及 F 把行 2 加到行 1，请问 EF=FE?

22A 的单元是 aj，x 的单元是 x，所以 Ax 的第一分量是∑a1xj=a11x1+.+a1nxn。若 E21 从行 2 减去行 1，针对下列写出公式：

（a）Ax 的第三分量。

（b）E21A 的（2，1）单元。

（c）E21（E21A）的（2，1）单元。

（d）E21Ax 的第一分量。

2 元 A2 去 2 行结果是 E 请 E

的效应是什么？对于反序 AE 来说，我们是从

减去 2 乘 A 的

（以例

子说明。）

问题 24-27 列 b 引入增广矩阵［Ab］。

24 应用消元法到 2×3 的增广矩阵［Ab］，会得到什么样的三角系统 Ux=c? 解 x

为何？

－［L

25 应用消元法到 3×4 的增广矩阵［Ab］，你如何知道系统无解？将最后的数字 6

改变使得存在一个解。

26 方程式 Ax=b 与 Ax＊=b＊有相同的矩阵 A，如果想用消元法同时求解两个方程式，你会使用怎样的双重增广矩阵？在 2×4 矩阵上运算，同时求解下列方程式：

网址:linear.neocities.org 箱：876152660@qq.com 69

27 选抒増广矩阵中的数字 a，b，c，d 使得（a）无解（b）无限多解。a，b，c，d 中哪个数字不影响有没有解？

28 若 AB=I 且 BC=I，利用结合律证明 A=C。

挑战问题

29 求出三角矩阵 E 使得帕斯卡（Pascal）矩阵简化到较小的帕斯卡：

10 0 0］［10 0 0

对列 1 消元

E 1 10 0

0100

12100110

1 3 3 1］ ［0 1 2 1

哪个矩阵 M（等于数个 E＇s 相乘）将帕斯卡一路简化到 I? 帕斯卡三角矩阵是例

外，所有的乘数都是 l=1。

30 M-

（a）什么矩阵 E 从行 2 减去行 1，使得 EM 的行 2 变小？

（b）什么矩阵 F 从行 1 减去 EM 的行 2 来简化 FEM 的行 1?（c）持续 E＇s 与 F°s，直到（许多 E＇s 与 F」s）乘（M）等于（A 或 B）。（d）E 与 F 是 A 与 B 的逆矩阵！把所有的 E°s 与 F°s 移动到右侧，可以得到想

要的结果 M=A＇s 与 B＇s 的乘积。

对数是可能中－

31 求消元矩阵 E21 然后 E32 然后 E43 使得 K 变成 U:

0 0 0

－c

应用这三个步骤到单位矩阵 I，求 E43E32E21 的乘积。

请尊重版权与译者的劳动成果，侵权必究！ 70

2.4 矩阵运算规则

1 有 n 个列的矩阵 A 乘有 n 个行的矩阵 B:AmxnBnxp=Cmxp。

2AB=C 的每个单元都是一个点积：C=（A 的行 i）·（B 的列 j）。

3 规则设定 AB 乘 C 等于 A 乘 BC，且（AB）x=A（Bx）。

4 更多计算 AB 的方法：（A 乘 B 的列），（A 的行乘 B），（列乘行）。

5AB=BA 通常不会成立，大部分情形下 A 与 B 不能交换。

B

6 矩阵也可以方块相乘：A=［A1A2］乘 B=1=A1B1+A2B2。

B2

我从基础事实开始，矩阵是数字或是单元的矩形阵列。当 A 有 m 行 n 列，它是一个 m×n 的矩阵。如果矩阵的形状一样，矩阵可以相加，矩阵可以乘上任意常数 c。以下是 3x2 矩阵的例子，包含 A+B，2A:

12］［22］［34

［12］［24

34+44=78

34=68

009999

0000

矩阵加法与向量加法相同，一次处理一个单元。我们也可以把列向量视为只有一列的矩阵（n=1）。矩阵的负数（-A）视为矩阵乘 c=-1（全部单元的符号都相反）。A

加上－A 得到零矩阵，全部单元都是 0。这些都只是常识而已。

行 i 列 j 的单元称为 aj 或 A（i，j），第一行的 n 个单元是 a11，a12，.，a1n。左下角的单元为 aml，右下角的单元为 amn。行的数字 i 从 1 到 m，列的数字 j 从 1 到 n。矩阵加法很容易，比较严重的问题是乘法。当 A 与 B 可乘时，乘积 AB 是多少？本段落给定 4 种方法求 AB，但是当 A 与 B 都是 3×2 时，我们无法计算 AB，他们无法通过下列的测试：

AB 可乘：若 A 有 n 列，B 必须有 n 行

当 A 是 3×2 时，B 可以是 2×1（向量）或是 2×2（方阵）或是 2×20，A 乘 B 的每一列。我想从点积开始矩阵的乘法，再回到刚才的列方法：A 乘 B 的列。这两种方法都会遵守下列规则：

矩阵乘法的基础法则

AB 乘 C 等于 A 乘 BC

（1）

括号在（AB）C=A（BC）可以安全的移动，线性代数依靠这个法则运行。

网址：linear.neocities.org 箱：876152660@qq.com 71

假设 A 是 mxn，B 是 nxp，我们可以乘，乘积 AB 是 mxp。

（m×n）×（n×p）=（m×p）

一个行乘一个列是极端的例子，也就是 1×n 乘 n×1，结果是 1×1，这个单一数字就是点积。

任何情况下 AB 都是点积，AB 的左上角（1，1）单元是（A 的行 1）·（B 的列 1），这是第一种常见计算矩阵乘法的方法，计算 A 的每一行与 B 的每一列的点积。1.AB 的行 i 列 j 的单元是（A 的行 i）（B 的列 j）

图 2.8 选出 4×5 矩阵 A 的第二行（i=2），也选出 5×6 矩阵 B 的第三列（j=3），他们的点积位于 AB 的行 2 列 3。矩阵 AB 的行个数与 A（4 行）相同，列个数与 B 相同。

bij

b2j

ais

bsj

A 是 4×5

B 是 5×6

AB 是（4×5）（5×6）=4×6

图 2.8:i=2，j=3，则（AB）23 等于（行 2）·（列 3）=a2kbk3 的总和

范例 1 方形矩阵可以相乘，当且仅当（ifand only if）他们有相同的大小：

第一个点积是 1·2+1·3=5，另外三个点积是 6，1，0。每个点积需要两次乘法 — 总共是 8 次。

若 A 与 B 都是 n×n，那么 AB 也是 n×n，就会有 n2 次点积，等于 A 的行数乘 B 的列数。每一个点积需要 n 个乘法，计算 AB 就需要 n3 的乘法运算。当 n=100，我们需要乘 100 万次，当 n=2，需要 n3=8 次。

直到最近数学家还是认为绝对需要 8 次的乘法，有人找到只需要 7 次（额外有加法）的方法。把 n×n 的矩阵分割成 2×2 方块，这个想法也可以降低大型矩阵乘法的运算次数，现在乘法量 n3 变成 n2.376。那么有可能变成 n2 吗？这个演算法有点难以处理，目前还是认为正常的科学计算需要 n3。

【原文的 2 by 2 blocks 意思是每个方块都是 2×2 矩阵】

请尊重版权与译者的劳动成果，侵权必究！ 72

范例 2

2 假设 A 是一个行向量（1×3），B 是一个列向量（3×1），则 AB 是 1×1（因为点

积只有一个单元）。反过来说，BA（一个列乘一个行）会是一个完整的 3×3 矩阵，这

样的相乘是允许的！

列乘行

（nx1）x（1xn）=（nxn）

一个行乘一个列是内积，这是点积的另外一个名称。一个列乘一个行是外积（outer

product），这些是矩阵乘法的极端例子。

第二与第三种方法：行与列

在大图中，A 乘（B 的每一列），结果是 AB 的一个列，在这个列我们组合 A 的列。

（AB）的每个列都是 A 的列的线性组合，这就是矩阵乘法的列图：

2. 矩阵 A 乘（B 的每一列）

A［b1... bp］=［Ab1...Abp］

行图恰好相反，是（A 的每一行）乘整个 B，结果就是 AB 的一个行。AB 的每一

行都是（B 的行）的组合：

ua-oe uaa iiun

我们在消元法看到行运算（E 乘 A），很快的我们会看到 AA~1=I 的列。「行－列图」

有行与列的点积，手算矩阵乘法时经常使用点积：mnp 次个别乘法 / 加法的步骤。

AB=（m×n）（n×p）=（m×p）mp 次点积，每次点积需要 n 个步骤

（2）

第四种方法：列乘行

矩阵乘法有第四个方法，没有很多人了解它的重要性。我觉得像魔术师一样在解

说戏法，魔术师不会做这种事，但是数学家一直在尝试。第四个方法在本书前一

版本有介绍，但是我的强调好像不够。

4.A 的列 1 至 n，乘 B 的行 1 至 n，全部矩阵相加。

A 的列 1 乘 B 的行 1，A 的列 2，3 乘 B 的行 2，3，然后相加：

列 1 列 2 列 3］［行 1

=（列 1）（行 1）+（列 2）（行 2）+（列 3）（行 3）

网址：linear.neocities.org 箱：876152660@qq.com 73

如果我使用列－行的方法处理 2×2 矩阵的乘法，你会了解 AB 是正确的：

4-

A 的列乘 B 的行，相加

AB=［］EF］+［］［GH］

（3）

A 的列 k 乘 B 的行 k 会得到一个矩阵（不是一个数），令 k=1，2，.，n，然后全部相加可以得到 AB。

若 AB 是（m×n）（n×p），则 n 个矩阵会是（列）（行），他们全部是 m×p 矩阵。这个方法同样使用与点积相同的 mnp 个步骤－但是顺序不同。

矩阵运算法则

我可以立案列出六个矩阵必须遵守的法则，却只是强调一个不遵守的法则吗？矩阵可以是方形或是矩形，与 A+B 有关的法则都很单纯并且遵守，以下是三个加法法则：

A+B=B+A

（交换律）

c（A+B）=CA+cB

（分配律）

A+（B+C）=（A+B）+C

（结合律）

另外三个法则对于乘法成立，但是 AB=BA 通常不在其中：

AB＃ BA

（交换律通常不成立）

A（B+C）=AB+AC

（左侧分配律）

（A+B）C=AC+BC

（右侧分配律）

A（BC）=（AB）C

（ABC 的结合律）（不需要括号）

当 A 与 B 不是方形，AB 的大小与 BA 的大小不同，这些矩阵无法相等－纵使两个乘法都是被允许的。对于方阵而言，几乎任意例子都会显示 AB≠BA:

AI=IA 永远成立，所有的方形矩阵可以与 I 交换乘，也可以与 cI 交换乘，只有矩阵 cI 可以与其他所有矩阵交换乘。

法则 A（B+C）=AB+AC 可以一次证明一个列，对于第一列从 A（b+c）=Ab+Ac 开始，这是所有事物的关键 — 线性。不再说了。

法则 A（BC）=（AB）C 表示可以先乘 BC 也可以先乘 AB，直接的证明有点无趣（问题 37），但是这个法则非常有用，我们特意加高亮，它是矩阵乘法的关键。

请尊重版权与译者的劳动成果，侵权必究！ 74 检视特殊情况 A=B=C = 方形矩阵，（A 乘 A2）等于（A2 乘 A），两者的乘积都

是 A3。矩阵的次方（power）AP 遵循如同数字的规则：

AP=A4..A（个因子）（）（＂）=A1（4＂）=AP

这些是指数的一般法则，A3 乘 A4=A7（7 个因子），但是 A3 的 4 次方是 A12（12

个 A）。假设 A 存在－1 次方一代表逆矩阵 A，当 p 与 q 是零或是数时，这些法

则仍然成立。A0=I 是单位矩阵，如同 20=1。

一个数 a-1=1/a，对矩阵来说，逆矩阵写成 A-。（不是 I/A，除了在 MATLAE。）

除了 a=0 以外，所有的数都有倒数。【数的 inverse 翻译成「倒数」】要决定 A

是否有逆矩阵是线性代数的中心问题，段落 2.5 会讨论这个答案。本段落是矩阵

的「人权法案」，只是在说明当 A 与 B 可以乘时，该如何乘。

方块矩阵与方块乘法

我们必须再多说一个关于矩阵的事情，他们可以分割成数个方块（blocks，比较小

的矩阵），这个经常发生。下列是一个 4×6 的矩阵，分割成 2×2 的方块，本例题中

每个方块都是单位矩阵 I:

4×6 矩阵

10|10|10

2×2 方块得到

2×3 的方块矩阵

若 B 也是 4×6，且方块的大小适配，可以对 A+B 一次执行一个方块相加。在之前你就看了过方块矩阵，右侧的 b 放在 A 的旁边变成增广矩阵，那么［Ab］

就有两个不同大小的方块，左乘一个消元矩阵得到［EAEb］。左乘或是右乘方块

都没有问题，只要形状合适即可。【2by3 block matrix 是 2×3=6 个方块】方块乘法若 A 的方块可以乘 B 的方块，则允许 AB 的方块乘法，A 的列切割必

须适配 B 的行切割。4， 4.］［B.］-［4B，t4.B

（4）

这个方程式与方块是数字（每个方块是 1×1）时是一样，我们注意所有的 A 要放在 B

之前，因为 AB 与 BA 不同。

重点：当矩阵分割成方块时，会比较容易看出他们是如何作用。上述由 Is 组成

的方块矩阵就会比 4×6 矩阵 A 简洁许多。

网址：linear.neocities.org 箱：876152660@qq.com 75

范例 3（重要的特殊情形）令矩阵 A 的方块有 n 列，矩阵 B 的方块有 n 行，则 AB 的方块乘积等于列乘行的总和：

列乘行

（5）

这是矩阵乘法的规则 4。以下是数字的例子：

小结：通常会用行乘列求矩阵乘积，需要 4 次点积（8 个乘法）。新的方法用列乘行，得到两个完整的矩阵（一样是 8 次乘法）。

范例 4（利用方块执行消元法）假设 A 的第一列包含 1，3，4，要把 3，4 变成 0，0，需要减去主元行的 3 与 4 倍，这些行运算就是消元矩阵 E21 与 E31:

＊·＊＊4

100

「方块概念」就是希望用一个矩阵 E 同时做两件事情，这个矩阵把第一列的主元 a=1 下方的数字一次性变成 0:

利用逆矩阵，方块矩阵 E 可以对于整个（方块）列做消元。假设矩阵有 4 个方块 A，B，C，D，观察 E 如何借由方块消去 C:

方块消元 ［-q［ B］-［ »－c^］

（6）

消元法对于第一行［AB］左乘 CA（之前是 c/a），使得原来 C 的方块变成 0 方块，原来 D 的方块变成 S=D-CA1B。

这是一般的消元法，一次执行一列 — 现在是利用方块进行。此处主元方块是 A，最后的方块是 D-CA~1B，如同 d-cb/a，称为舒尔补充（Schur complement）。

请尊重版权与译者的劳动成果，侵权必究！ 76

主要观念的复习

1.AB 的（i，j）单元是（A 的行 i）·（B 的列 j）。

2.m×n 矩阵乘 nxp 矩阵会使用 mnp 次乘法。

3.A 乘 BC 等于 AB 乘 C（非常重要）。

4.AB 也是 n 个矩阵的总和：（A 的列 i）乘（B 的行 j）的总和。

5. 当方块的形状适配时，方块乘法是允许的。

6. 方块消元法可以得到舒尔补充 D-CA1B。

已解范例

2.4A 一个图形（或网络）有 n 个节点（node），它的邻接矩阵（adjacency matrix）S 是 n×n，这是一个非 0 即 1 的矩阵，当节点 i 与节点 j 有边（edge）相连时 s=1。

0 1 1 0

1 0 1 1

2

3S= 110 1

i

0 1 10

对于无向图而言，邻接矩阵是方形而且对称，边的两个方向都可以行走。矩阵 S2 有一个很有用的解释，（S2）可以算出节点 i 与节点 j 之间长度 2 的路径个数。举例说明，上图中节点 2 与 3 之间长度 2 的路径有 2 个：经过 1 或经过 4。节点 1 到节点 1 的长度 2 路径也有 2 个：1-2-1 与 1-3-1。

21 1

255

S²=

S³=

2

554

2552

你可以找出 5 条节点 1 与 2 之间长度 3 的路径吗？【参考答案：1-2-1-2，1-3-4-2， 1-2-3-2， 1-3-1-2， 1-3-4-2） ］

真正的问题在于为什么 S 可以算出在两个节点之间长度 N 的路径数目？从 S2 开始，检视点积得到的矩阵：

（S2）=（S 的行 i）.（S 的列 j）=S181j+S12S2j+SB83j+Si484j

（7）

若存在两步路径 i→1→j，第一个乘法得到 snsy=（1）（1）=1，如果 i→1→j 不是路径，那么不是 i→1 丢失就是 1→j 丢失，这种情形会得到 SHS1j=0。

网址：linear.neocities.org 箱：876152660@qq.com 77

（S2）会把所有的两步路径 i→k→j 的 1 累加，得到总路径数。同样的方法，SN-1S 可以计算 N 步路径数，SN1 代表从 i 到 k 的（N-1）步的路径数目，接着 S 代表 k 到 j 的一步路径。矩阵乘法非常适合计算图形的路径，也可以视为公司内两个雇员之间的通信频道数。

2.4B 下列三个矩阵，何时会有 AB=BA? 何时会有 BC=CB? 何时会有 A 乘 BC=AB 乘 C? 给出矩阵单元 p，q，r，z 的条件：

若 p，q，r，1，z 是 4×4 的方块而不是数字，答案会改变吗？

解首先 A 乘 BC 永远等于 AB 乘 C，在 A（BC）=（AB）C=ABC 中括号不需要存在，但是矩阵的顺序必须保持：

通常来说 AB≠BA

碰巧会有 BC=CB

B 与 C 只是碰巧可以交换，一部分的解释是 B 的对角线是 I，可以跟 2×2 矩阵交换。当 p，q，r，z 是 4×4 的方块，1 变成 I，所有的乘积维持正确，答案还是一样。问题集 2.4

问题 1-16 有关矩阵乘法的法则。

1A 是 3×5，B 是 5×3，C 是 5×1，D 是 3×1，所有的单元都是 1。下列的矩阵运算哪些是允许的？结果为何？

BA AB ABD DC A（B+C）

2 什么样的行或列或矩阵乘在一起，会得到

（a）AB 的第二列。

（b）AB 的第一行。

（c）AB 的行 3 列 5 单元。

（d）CDE 的行 1 列 1 单元。

3 把 AB 加到 AC，然后比较 A（B+C）:

4 问题 3 中，计算 A 乘 BC，然后计算 AB 乘 C。

请尊重版权与译者的劳动成果，侵权必究！ 78

5 计算 A2 与 A3，对 A5 与 A」进行预测。

4-|4-

6 证明（A+B）2 与 A2+2AB+B2 不同，当

4-|158-|

写下正确的规则：（A+B）（A+B）=A2+__+B2。

7 是非题，如果是错误的，举出一个特定的例子。

（a）若 B 的列 1 与列 3 相同，AB 的列 1 与列 3 也会相同。

（b）若 B 的行 1 与行 3 相同，AB 的行 1 与行 3 也会相同。

（c）若 A 的行 1 与行 3 相同，ABC 的行 1 与行 3 也会相同。

（d）（AB）2=A2B2。

8DA 与 EA 的每个行如何与 A 的行产生关联，当

0|5E-|｝54

9A 的行 1 加到行 2，得到的 EA 如下列所示。然后 EA 的列 1 加到列 2 得到（EA）F:

4- ［e a］-［a 6dl

与 （EAF-（A） －ae ae］

（a）以反向顺序执行这些步骤，首先借由 AF 把 A 的列 1 加到列 2，然后借由

E（AF）把 AF 的行 1 加到行 2。

（b）比较（EA）F 与 E（AF），结果会遵守矩阵乘法哪个法则？

10A 的行 1 再次加到行 2 得到 EA，然后 F 把 EA 的行 2 加到行 1，结果是 F（EA）。

（a）以反向顺序执行这些步骤，首先借由 FA 把 A 的行 2 加到行 1，然后 FA

的行 1 加到行 2。

（b）矩阵乘法的哪个法则有遵守或是没有遵守？

11 这个事实让我很惊奇，如果你对 A 执行一个行运算，然后再执行一个列运算，

得到的结果与你先做列运算是相同的。（试试看）为什么这是真的？

网址:linear.neocities.org 箱：876152660@qq.com 79

12（3×3 矩阵）选择唯一的 B 使得每一个矩阵 A 都有：

（a） BA= 4A.

（b） BA= 4B.

（c）BA 把 A 的行 1 与行 3 交换，且行 2 没变。

（d）BA 所有的行与 A 的行 1 相同。

13 假设 AB=BA 且 AC=CA，其中两个特定矩阵 B 与 C:

与 B，C 交换乘 －［8］¢－［］

B=

证明 a=d 且 b=c=0，然后 A 是 I 的倍数。唯一可以与 B 及 C 及其他 2×2

矩阵进行交换乘的矩阵是 A=I 的倍数。

14 哪些矩阵确定等于（A-B）2:A2-B2，（B-A）2，A2-2AB+B2， A（A-B）-B（A-B），A2-AB-BA+B2?

15 是非题：

（a）若 A2 有定义，则 A 必须是方形。

（b）若 AB 与 BA 有定义，则 A 与 B 是方形。

（c）若 AB 与 BA 有定义，则 AB 与 BA 是方形。

（d）若 AB=B，则 A=I。

16 若 A 是 m×n，下列步骤会牵涉到多少的个别乘法？

（a）A 乘具有 n 个分量的向量 x。

（b）A 乘 nxp 矩阵 B。

（c）A 乘自己得到 A2? 此处 m=n。

174=［］且 B=［］，计算下列答案：

（a）AB 的列 2。

（b）AB 的行 2。

（c）AA=A2 的行 2。

（d）AAA=A3 的行 2。

问题 18-20 使用 a 作为 A 的行 i 列 j 单元。

18 写出 3×3 矩阵 A，它的单元如下：

请尊重版权与译者的劳动成果，侵权必究！ 80（a）ay=i 与 j 的较小者。

（b）a=（-1）。

（c）aj=ilj。

19 你会用那些字来描述矩阵的分类？在每一类给定 3×3 的例子，哪个矩阵属于

全部 4 类？

（a）aj=0，若 i≠j。

（b）aj=0，若 i<j。

（c）aj=aji。

（d）aj=a1j。

20A 的单元是 a，假设全部单元都不是 0，请问

（a）第一主元 =?

（b）从列 3 减去列 1 所需的乘数 =?

（c）减去之后，取代原来 a32 的新单元 =?

（d）第二主元 =?

问题 21-24 与 A 的次方有关。

21 计算 A2，A3，A4 以及 Av，A2v，A3v，A4v:

020 0

002 0

A=

以及 ν xA

000 2

0000

22 利用尝试错误法求实际的 2×2 矩阵，使得

A2=-IBC=0DE=-ED（不允许 DE=0）。

23（a）求非零矩阵 A 使得 A2=0。

（b）找出矩阵有 A2≠0 但是 A3=0

24 利用 n=2 与 n=3 的实验结果，对于下列矩阵预测 A」：

4-｝5-｝5-|

问题 25-31 使用列－行乘法以及方块乘法。

25 使用 A（3×3）的列乘 I 的行，计算 A 乘 I。

网址：linear.neocities.org 箱：876152660@qq.com 81

26 使用列乘行，计算 AB:

：1

27 证明上三角矩阵的乘积永远是上三角。

排.

xxx

利用点积（行乘列）证明

（A 的行 2）（B 的列 1）=0

哪些其他的点积也等于零？

利用整个矩阵（列乘行）证明

画出（A 的列 2）乘（B 的行 2）的 x＇s 与 0＇s，也展示（A 的列 3）乘（B 的行 3）。

28 画出 A（2×3）与 B（3×4）与 AB 中的切割，展示 4 种乘法规则每一种实际上都是方块乘法：

（1）（A 矩阵）乘（B 的列）

AB 的列

（2）（A 的行）乘（B 矩阵）

AB 的行

（3）（A 的行）乘（B 的列）

内积（AB 的数字）

（4）（A 的列）乘（B 的行）

外积（矩阵相加得到 AB）

29 哪个矩阵 E21 与 E31 产生 E21A 与 E31A 在位置（2，1）与位置（3，1）的零？

210

853

求出单一矩阵 E=E21E31 同时产生两个 0，计算 EA。

30 方块乘法说：列 1 被消元，借由

EA--le e －o p-we］

问题 29 中，什么数字进到 c 与 D?D-cb/a=?【a：数字，b 与 c：向量】31 令 i2=-1，则（A+iB）与（x+iy）的乘积是 Ax+iBx+iAy-By。利用方块把没有 i 的实部与有 i 的虚部进行分离：

［?］］-［］实数部分

虚数部分

32（非常重要）假设你针对三个特殊的右侧 b 求解方程式 Ax=b:

请尊重版权与译者的劳动成果，侵权必究！ 82

Ax1=

Ax2 010

Ax3 001

如果三个解 x1，x2，x3 是一个矩阵 X 的列，计算 A 乘 X?

33 若问题 32 的三个解是 x1=（1，1，1），x2=（0，1，1），x3=（0，0，1）。当 b=（3，5，8）

时，求解 Ax=b。挑战问题：A 是什么？

34 求出满足 A

A 的所有矩阵 A=

｛｝

35 假设一个「圆形图」有 4 个节点，点与点之间有边（双向）连接。参考已解范例

2.4A，求图形的邻接矩阵 S? 求 S2? 找出由 S2 预测的所有 2 步路径。

挑战问题

36 实际问题：假设 A 是 m×n，B 是 nxp，C 是 pxq，则 AB 需要 mnp 的乘法个数，

（AB）C 需要 mnp+mpq 个乘法；来自 A 乘（BC）的相同矩阵需要 mnq+npq 个乘

法。注意 BC 需要 npq 个乘法。

（a）若 A 是 2×4，B 是 4×7，C 是 7×10，你会偏好（AB）C 还是 A（BC）?

（b）如果是 N - 分量向量，你会选择（uTv）wT 还是 uT（vwT）?

（c）当 n+ql<m+p 时，借由除以 mpq 证明（AB）C 会比較快速。

37 利用 B 的列 b1，..，bn 证明（AB）C=A（BC）。首先假设 C 只有一个列 c，其中 c

的分量是 C1，.，Cn:

AB 的列是 Ab1，.，Abn，则（AB）c 等于 C1Ab1+.+CnAbn。

Bc 有一个列 c1b1+.+Cnbn，则 A（Bc）等于 A（c1b1+.+Cnbn）。

线性的性质使得两个和（sum）相等，证明了（AB）c 等于 A（Bc）。对于 C 的其他的

也是一样，因此（AB）C=A（BC）。应用到逆反：若 BA=I 且 AC=I，证

明左逆反 B 等于右逆反 C。

38（a）假设 A 的行是 a1T，.，amT，为什么 ATA 等于 a1a1T+..+amamT?

（b）假设 C 是对角矩阵且 c1，.，cm 在对角线，对于 ATCA，求出一个类似列乘

行的总和。首先做一个 m=n=2 的例子。

网址：linear.neocities.org 箱：876152660@qq.com 83

2.5 逆矩阵

1 若矩阵 A 有逆矩阵，则 A-1A=I 且 AA-1=I。

2 用来测试可逆性质的演绎法是消元法：A 必须具有 n 个（非零）主元。

3 用来测试可逆性质的代数法是 A 的行列式：detA≠0。

4 用来测试可逆性质的方程式是 Ax=0:x=0 必须是唯一解。

5 若 A 与 B（相同大小）都是可逆，则 AB 也是可逆：（AB）1=B1A1。

6AA-1=I 是 A-1 的 n 个列的 n 个方程式，高斯－乔丹消元法使得［AI］到［IA-1］。7 本书的最后一页描述了方形矩阵 A 可逆的 14 种等效条件。

假设 A 是方形矩阵，我们寻找具有相同大小的逆矩阵 A，使得 A 乘 A 等于 I。A 可以做的事情，A~ 都会反着来，他们的乘积是单位矩阵－单位矩阵对于向量毫无影响，所以 A~`Ax=x，但是 A~1 有可能不存在。

矩阵最常做的事情就是乘一个向量 x，A-1 乘（Ax=b），得到 A-`Ax=A-1b，所以 x=A1b。乘积 AA 很像乘一个数再除一个数。若一个数不为 0，必然存在倒数 — 矩阵的情形比较复杂却更有趣，A~` 称为 A 的逆矩阵。

定义如果存在一个矩阵 A1「逆反」A，则矩阵 A 可逆：

双边逆反 AA=1 且 AA1=1

（1）

不是所有的矩阵都有逆矩阵，关于方形矩阵的第一个问题：A 是否可逆？我们不是说要马上计算 A，在大部分的问题中，我们都没有去计算逆矩阵。以下有 6 个关于 A1 的注释。

注释 1 矩阵存在逆矩阵，当且仅当消元法得到 n 个主元（允许行交换）。消元法求解 Ax=b 时，不需要明确使用 A~1。

注释 2 矩阵 A 不可能存在两个不同的逆矩阵。假设 BA=I 且 AC=I，依据「括号证明法」可以得到 B=C:

B（AC）=（BA）C 得到 BI=IC 或是 B=C

（2）

上式证明了「左逆矩阵」B（从左乘）与「右逆矩阵」C（从右乘 A 得到 AC=I）必须是相同的矩阵。

注释 3 若矩阵 A 可逆，Ax=b 的唯一解是 x=A-1b:

A 乘 Ax=b 得到 x=AAx=Ab

请尊重版权与译者的劳动成果，侵权必究！ 84

注释 4（重要）假设有一个非零向量 x 使得 Ax=0，则 A 不存在逆矩阵，没有这

样的矩阵可以从 0 反推到 x。

若 A 可逆，则 Ax=0 只存在零的解 x=A~10=0。

注释 5 一个 2×2 矩阵可逆，当且仅当 ad-bc≠0:

2×2 逆矩阵

［e at sel-e

（3）

其中 ad-bc 是 A 的行列式，若矩阵的行列式不为零（第五章），则矩阵可逆。通常

在行列式出现之前已经完成 n 个主元的测试。

注释 6 若对角线单元全部不是零，则对角线矩阵可逆：

dì

1/d

若 A=

则 A-1=

dn

1/d，

范例 1 一个 2×2 矩阵 A = 不可逆，因为 ad-bc=2-2=0，注释 5 的测

试失败。当 x=（2，-1）时 Ax=0，注释 3 的测试失败。找不到两个主元，注释 1

的测试失败。

消元法使得矩阵 A 的第二行变成零行。

乘积 AB 的逆矩阵

两个非零数 a 与 b，两者的总和不一定可逆。当 a=3 与 b=-3，两者的倒数是 a=

1/3 与 b=-1/3，两者的总和是零，所以没有倒数。但是乘积 ab=-9 存在倒数，

倒数 1/3 乘（-1/3）。

对两个矩阵而言情形与上述差不多，我们很难去讨论 A+B 的可逆性质。但是

两者的乘积 AB 有逆矩阵，当且仅当两个矩阵 A 与 B 个别都是可逆（相同大小）。

重点在于 A 与 B 呈现反序：

若 A 与 B 都是可逆，则 AB 也是可逆。AB 的逆矩阵是：

（AB）＇=B＇A¹

（4）

要了解为什么是相反顺序，计算 AB 乘 B~1A-1，中间有 BB-1=I:

AB 的逆矩阵（AB）（B-1A-1）=AIA-1=AA-1=I

我们移去括号先求 BB1，同理 B-1A-1 乘 AB 等于 I。

网址：linear.neocities.org 邮箱：876152660@qq.com 85

B~A1 说明了一个数学的法则，逆矩阵是相反顺序。这也是常识：如果你先穿袜子再穿鞋子，反过来要先脱去

？相同的反序性质可以应用到三个或更多

的矩阵： 反序

（ABC）=CB-A-I

（5）

范例 2 消元矩阵的逆矩阵。若 E 从行 2 减 5 乘行 1，则 E 会把 5 乘行 1 加到行 2:

100

E 减去

E-1 加回

EE1 得到单位矩阵 I，E1E 也得到 I。我们是先加再减第一行的 5 倍，若 AC=I，则自动得到 CA=I。

对于方形矩阵而言，在一侧的逆矩阵会自动成为另一侧的逆矩阵。

范例 3 若 F 从行 3 减去 4 乘行 2，那么 F 会反加回去：

00

1 00

F=

10

F-1=0 1 0

0 4 1

现在用 F 乘范例 2 的 E，求 FE? 也计算 E1 乘 F1 求出（FE）1。注意 FE 与 E1F1 的顺序！

（6）

得到的结果既美丽又正确，乘积 FE 包含 20，但是它的逆矩阵却没有。E 从行 2 减去 5 乘行 1，然后 F 从行 3 减去 4 乘新的行 2（因为行 1 而变化），依据这个顺序，行 3 会感受到行 1 带来的变化。

依据 EF1 的顺序，效应没有发生。首先 F 使得 4 乘行 2 加到行 3，然后 E 使得 5 乘行 1 加到行 2，这里就没有 20，因为行 3 没有再改变。在 E1F1 的顺序下，行 3 没有感受到行 1 带来的效应。

这就是为什么下个段落要选取 A=LU，可以从三角矩阵 U 回到 A，乘数会很自然又完美的出现在下三角矩阵 L。

消元顺序先 E 后 F；反向顺序先 F1 再 E1。

E1F1 是快速的，乘数 5，4 落在对角线单元 1＇s 的下方。

请尊重版权与译者的劳动成果，侵权必究！ 86

高斯－乔丹消元法计算 A`

我提示过 A 不一定明确需要。方程式 Ax=b 的解是 x=A~b，但是没必要也没效率去计算 A 再乘 b。消元法直接得到 x，同时消元法也是计算 A 的方法，如同我们展示的。高斯－乔丹的概念在于求解 AA~1=I，找出 A1 的每一列。

A 乘上 A1 的第一列（称为 x1），得到 I 的第一列（称为 e1），我们的方程式是 Ax1=e1=（1，0，0），后面还有两个方程式。A1 的每一列表示成 x1，x2，x3，用 A 乘后产生 I 的列：

A1 的三个列

AA-I= A［x1x2x3］=［e1e2

e3l =l

（7）

要逆反 3×3 矩阵，我们必须求解三个方程式：Ax1=e1 与 Ax2=e2=（0，1，0）与 Ax3=e3=（0，0，1），高斯－乔丹消元法利用这个方法求 A-1。

高斯－乔丹消元法同时求解 n 个方程式来计算 A~，一般来说增广矩阵多了一列 b，现在我们有三个右侧 e1，e2，e3（当 A 是 3x3），他们是 I 的列，所以増广矩阵就是方块矩阵［A］。我冒险来逆反我最爱的矩阵 K，它的对角线单元都是 2，然后 2 的旁边都是－1，其他单元都是 0:

2-10100 开始对 K 执行高斯－乔丹法

［K e e² e3］=|-1 2 －1 |0 1 0

0-12001

2-10100

→0％-1％10 y2（行 1）+ 行 2

0-12001

2-10100

→0％-110

00⅓⅓ 为 1 （行 2）+ 行 3

我们完成 K1 的一半，矩阵的前三列是 U（上三角），主元是对角线的 2，3/2，4/3。高斯想用反向代入法，乔丹的贡献在于继续消元！他一路走到简化阶梯形式 （reduced echelon form）R=I，行被加到在上方的行，使得主元上方都是零。

2-10100

第三主元以上都是 0→00 ⅓（行 3）+ 行 2

00 为为 1

2001 ％（行 2）+ 行 1

第二主元以上都是 0→ 00

00 为为为 1

网址：linear.neocities.org 箱：876152660@qq.com 87

高斯－乔丹的最后一个步骤是把每行除以本身的主元，新的主元全部是 1。

因为 K 可逆，矩阵的左半部变成 I，K1 的三个列就在［IK~1］的第二部分：

除以 2

100

除以 ½

010

=［I x1 x1x3］=［I K1］

除以为

001

从 3×6 矩阵［KI］开始，最终得到［IK］。对于任意可逆矩阵 A，以下是整个高斯－乔丹消元法的程序（以简单一行来描述）：

高斯－乔丹

A1 乘［A］得到［IA1］

消元步骤把 A 变成 I 得到逆矩阵，对于大型矩阵，我们大概一点都不想要 A1。但是对小矩阵来说，还是值得知道这个技巧。对于 K 我们加上三个观察：一个重要范例。

1.K 是对称，则 K` 也是对称的。

2.K 是三对角（tridiagonal）矩阵（只有 3 个非零对角线），但是 K~1 是一个没有 0 的浓密（dense）矩阵，这是另一个我们不常计算逆矩阵的原因。带状矩阵的逆矩阵通常都是浓密矩阵。

3. 主元的乘积是 2（3/2）（4/3）=4，这个 4 就是 K 的行列式。

21

K1 与除以 K 的行列式有关

（8）

这就是为什么可逆矩阵的行列式不能是零：因为要除以它。

范例 4 A=

｝应用高斯－乔丹消元法求 A-1。

这是

［v］

－|-| 这是

范例 5 若 A 可逆的上三角矩阵，则 A1 也是。从 AA1=I 开始。

1.A 乘（A~1 的列 j）等于 Ⅰ 的列 j，这个列 j 末端有 n-j 个零。

2. 反向代入，保持这些 n-j 个零在 A 的列 j 的末端。

3. 把这些列［＊..＊0.0］T 放进 A~1，这个矩阵就是上三角矩阵！

请尊重版权与译者的劳动成果，侵权必究！ 88

－

列 1 与列 2 的末端

0

=＼ 01

00

有 3-j=2 与 1 个 0

0

代码 X=inv（A）利用 rref：reduced row echelon form（简化行阶梯形式），见第三章。

I=eye（n）；

％定义 n×n 单位矩阵

R=rref（［A I］；

％在矩阵［AI］上执行消元法

X=R（:，n+1:n+n）；％在 R 后面 n 列就是 X=A-1

A 必须可逆，否则消元法就不能将 A 简化至 I（R 的左半部。）

高斯－乔丹说明了为什么计算 A` 的成本很高，我们对于它的 n 个列求解 n 个方程式，然而所有的方程式都跟左侧的同一个矩阵 A 有关（最大的工作量），A 的整体成本为 n3 次乘法与减法，要求解一个 Ax=b 的成本为 n3/3（见下一个段落）。

不用 A` 去求解 Ax=b，我们处理一个列 b 去找一个列 x。

奇异对比可逆

我们回到中心问题，哪些矩阵有逆矩阵？本段落的开始介绍了主元测试：当 A 有一整组的主元（允许行交换）时，A~ 存在。我们可以用高斯－乔丹消元法来证明：

1. 利用 n 个主元，消元法可以求解全部的方程式 Ax1=e1，列 x 会进入 A1，

则 AA~1=I 且 A1 至少是个「右逆矩阵」。

2. 消元法事实上就是一系列矩阵的乘法：E＇s，P＇s，及 D1。

左逆矩阵 C

CA=（D1..E.P.E）A=I

（9）

D1 除以主元，矩阵 E 产生在主元上方以及下方的零，P 在需要的时候交换行（见段落 2.7）。方程式（9）里面的乘积很明显就是 A 的左逆矩阵，利用 n 个主元，我们得到 A~A=I。

右逆矩阵等于左逆矩阵，这就是本段落开头提到的注释 2。所以具有一整组主元的方形矩阵永远有双边逆矩阵。

现在反过来证明若 AC=I，则 A 必定有 n 个主元。

1. 若 A 没有 n 个主元，消元法会得到一个零行。

2. 这些消元步骤由可逆矩阵 M 取得，所以 MA 的一行是零。

3. 若 AC=I，则 MAC=M，MA 的零行乘 C 得到 M 本身的零行。

4. 可逆矩阵 M 不可能有零行！若 AC=I，则 A 必定有 n 个主元。

上述的理论需要 4 个步骤，但是结果很短很重要。C 就是 A~1。

网址：linear.neocities.org 箱：876152660@qq.com 89

消元法提供方形矩阵可逆性的完整试验，当 A 有 n 个主元时，A 确实存在（高斯－乔丹可以找到），以上的论点更说明了：

若 AC=I 则 CA=I 且 C=A1

（10）

范例 6 若 L 是下三角且对角线都是 1，则 L~1 也是。

三角矩阵可逆当且仅当没有对角线单元是 0

此处 L 有单元 1＇s，所以 L~1 也有 1＇s。利用高斯－乔丹方法从 E32，E31，E21 创建 L-1。注意 L1 是如何包含奇特的单元 11，11 来自 3×5-4。

10 0 10 0

应用高斯－乔丹在三角 L

45 1 0 01

100100 行 2 减去 3 乘行 1

→010-310 行 3 减去 4 乘行 1

→［051-401 行 3 减去 5 乘行 2

逆矩阵仍然是三角形

辨识逆矩阵

正常来说，需要一些功夫来决定矩阵是否可逆，常见的方法是在消元过程中找到一整组的非零主元。（非零行列式来自这些主元的乘积。）但是对于某些矩阵，你可以快速看出是否可逆，因为每个对角线数字 a 对于该行其他非对角线单元，具有支配（dominate）的效应。

对角式支配（diagonally dominant）矩阵为可逆。每个 a＃比行 i 其他单元的总和还要大很多，对于每一行：

（11）

范例 A 是对角式支配（3>2），B 不是（但是仍然可逆），C 是奇异。

请尊重版权与译者的劳动成果，侵权必究！ 90

推论选取任意非零向量 x，假设它的最大分量是 | x1|，当 A 是对角支配矩阵时，

不可能有 Ax=0。因为如果 Ax 的行 i 为零，需要有

ailx+...+aiix； +...+ainxn =0

这些项的总和不可能是零！|a＃xi|（某个特定项）的大小比其他组合项要大很多：

所有 | x；|<|xi|

eoris elel ka lak

因为 a＃是支配项

上述说明只有在 x=0 时，才有可能 Ax=0，所以 A 是可逆。范例 B 也是可逆，

但不是对角式支配矩阵：2 没有大于 1+1。

主要观念的复习

1. 逆矩阵得到 AA-1=I 且 A~1A=I。

2. 矩阵 A 有逆矩阵，当且仅当 A 有 n 个主元（允许交换行）。

3. 重要。若有非零向量 x 使得 Ax=0，则 A 没有逆矩阵。

4.AB 的逆矩阵是反序乘积 B-1A1，且（ABC）1=C1B-1A1。

5. 高斯－乔丹方法求解 AA-1=I 得到 A1 的 n 个列。增广矩阵［AI］可以使用行

简化得到［IA-1］。

6. 对角式支配矩阵是可逆矩阵，每个 | a | 支配它所在的行。

已解范例

2.5A 三角形差分矩阵 A 的逆矩阵，是三角形总和矩阵 S:

100100］100100

［A1］=-110010→010110

0-110010-11001

100|10 0

→010110

=［1A2］=［1 总和矩阵

001 111

如果我把 a13 变成－1，则 A 的所有的行加起来都是 0，方程式 Ax=0 现在会有非

零解 x=（1，1，1）。一个明显的信号：新的矩阵 A 不可逆。

网址：linear.neocities.org 箱：876152660@qq.com 91

2.5B 下列矩阵有三个可逆矩阵，三个不可逆矩阵。当逆矩阵存在时，求出逆矩

阵。其他三个不可逆矩阵，请给出理由（零行列式，主元太少，Ax=0 有非零解。）

下列矩阵的顺序是 A，B，C，D，S，E。

1 0 0］［1 1 1

解

A 不可逆，因为行列式值 = 4×6-3×8=24-24=0。D 不可逆，因为只有一个主

元；第二行减第一行变成零。E 有两个相等的行（且第二列减去第一列是零），换

言之，Ex=0 的解可以是 x=（-1，1，1）。

当然全部三个不可逆的理由都可以应用到 A，D，E。

2.5C 应用高斯－乔丹方法求三角帕斯卡矩阵 L 的逆矩阵。你可以看到帕斯卡三角

形 — 每个单元加上自身左侧的单元放在该单元的下方。L 的单元是二项式系数

（binomial coefficients），第五行会变成 1，4，6，4，1。

1 0 0 0

三角帕斯卡矩阵 L= 1 10 0 =abs（pascal（4， 1）

3

解高斯－乔丹从［LI］开始，借由减去行 1 得到想要的 0:

10001000］［10001000］

=110001000100-1100

［11］=

=121000100210-1010

133100010331-1001

下个阶段产生第二主元下方的 0，使用的乘数是 2 与 3。最后一个阶段从新行 4

减去 3 乘新行 3:

10001000］［10001000

所有的主元都是 1！所以每个行不需要除以主元得到 I。逆矩阵 L 跟 L 很像，除

了奇数对角线有负号。

同样模式可以扩展到 n×n 的帕斯卡矩阵，L~ 具有交替（alternative）对角。

请尊重版权与译者的劳动成果，侵权必究！ 92

问题集 2.5

1 求出 A，B，C 的逆矩阵。（直接或用 2×2 公式）。

2 借由尝试错误法（利用 1＇s 与 0＇s），求出排列矩阵的逆矩阵 P1:

与 P=

3 求解 A1 的第一列（x，y）与第二列（t，z）:

20 30［］-［0

与

30-H

4 解到列可

如果是不同的 A，有没有可能

A-1 的列 1 有解，列 2 却无解？

5 求一个上三角 U 不是对角矩阵），使得 U2=1，也就是 U=。

6（a）若 A 可逆且 AB=BC，快速证明 B=C。

若我不同 E 得

7（重要）若 A 有行 1 + 行 2 = 行 3，证明 A 不可逆。

（a）解释为什么 Ax=（0，0，1）不可能有解。执行方程式 1 + 方程式 2。

（b）哪些右侧（b1，b2b3）可能允许 Ax=b 有一个解？

（c）在消元过程中，方程式 3 发生什么？

8 若 A 有列 1 + 列 2 = 列 3，证明 A 不可逆。

（a）对于 Ax=0 找出一个非零解 x，矩阵是 3×3。

（b）消元法保持列 1 + 列 2 = 列 3，解释为什么没有第三主元？

9 假设 A 可逆，你可以交换前两个行得到 B，请问 B 可逆吗？你要如何从 A

得到 B1?

网址：linear.neocities.org 箱：876152660@qq.com 93

10 求逆矩阵（任意合法的方法都可以）：

0002

3200

0030

4300

A=

与 B=

0400

0065

5000

0 0 7 6

11（a）找出可逆矩阵 A 与 B，使得 A+B 不可逆。

（b）找出奇异矩阵 A 与 B，使得 A+B 可逆。

12 若乘积 C=AB 是可逆（A 与 B 是方形），则 A 本身是可逆。求出 A~1 的公式，

这个公式与 C1 与 B 有关。

13 若乘积 M=ABC 是可逆（A 与 B 与 C 是方形），则 B 是可逆（A 与 C 也是）。找

出 B~1 的公式，这个公式与 M1 与 A 与 C 有关。

14 如果你把 A 的行 1 加到行 2 得到 B，你如何从 A1 求得 B1?

注意顺序。B=［］［A］，则 B 的逆矩阵是

15 证明有一个列都是 0 的矩阵没有逆矩阵。

16［- 若求年个阵的年阵

17（a）什么样的矩阵 E 有相同的三个步骤的效应？从行 2 减去行 1，从行 3 减

去行 1，然后从行 3 减去行 2。

（b）什么样的单一矩阵 L 有相同的三个反向步骤的效应？把行 2 加到行 3，

把行 1 加到行 3，然后把行 1 加到行 2。

18 若 B 是 A2 的逆矩阵，证明 AB 是 A 的逆矩阵。

19 求数值 a 与 b 得到 5＊eye（4）-ones（4，4）的逆矩阵：

4-1-1-1］＇ a b bb

－14-1-1_babb

－1-14-1ˉbbab

－1-1-14［b bb a

求数值 a 与 b 得到 6＊eye（5）-ones（5，5）的逆矩阵？

20 证明 A=4＊eye（4）-ones（4，4）不可逆。执行乘法 A＊ ones（4，1）。212×2 矩阵的单元可以是 1 或 0 的矩阵有 16 个，其中有几个矩阵是可逆？

请尊重版权与译者的劳动成果，侵权必究！ 94

问题 22-28 有关计算 A 的高斯－乔丹方法。

22 如同 A 简化至 I 一样，把 I 变成 A1（借由行运算）:

［-）-］

23 追随教科书上的 3×3 例子，但是 A 的单元都变成正号。消去主元的上方与下

方，简化［AI］成为［IA~1］:

24 对［UI］应用高斯－乔丹法，求出上三角 U1:

UU-= I

25 对［AI］与［BI］应用消元法，求出 A-1 与 B-1（如果存在）:

26 什么样的矩阵与与可以化 A=2 到单位降计算

D=1E12E21 求 A-1。

27 利用高斯－乔丹法至［AI］，求出 A 的逆矩阵：

28 交换行之后继续使用高斯－乔丹法，求出 A1:

29 是非题（如果错，举出一个反例；如果对，说明理由）：

（a）一个 4×4 矩阵有一个零行，则不可逆。

（b）主对角线单元都是 1 的矩阵必定可逆。

（c）若 A 可逆，则 A1 及 A2 都是可逆。

网址：linear.neocities.org 箱：876152660@qq.com 95

30（推荐）若 a≠0 且 a≠b，证明 A 是可逆（求主元或是 A），然后找出 3 个数值 c 使得 C 不可逆。

abb

2 c c］

A= aa b

a a a

31 这个矩阵有非凡的逆矩阵，应用消元法至［A］，求出 A~。延伸至 5×5 的「交

替矩阵」，猜测逆矩阵；然后执行乘法进行确认。

1-11-1

逆反 A=

以及求解 Ax=（1，1，1，1）。

32 假设矩阵 P 与 Q 有与单位矩阵相同的行，只是顺序不同，他们是「排列矩阵」。

求解（P-Q）x=0 证明 P-Q 是奇异。

33 针对下列的方块矩阵，求出并验证逆矩阵（假设存在）：

［］［¢］［］

34 如果一个 4×4 矩阵 A 的每一行都包含某种顺序的数字 0，1，2，3，请问这个矩

阵可逆吗？如果 B 的每一行都包含某种顺序的数字 0，1，2，－3，请问可逆吗？35 在已解范例 2.5C 中，三角帕斯卡矩阵 L 有 L1=DLD，其中对角矩阵 D 有交

替单元 1，－1，1，－1，则 LDLD=I，求 LD=pascal（4，1）的逆矩阵。

36 希尔伯特矩阵有 H=1/（i+j-1），从 MATLAB 求 6×6 的逆矩阵 invhilb（6）。

然后计算 inv（hilb（6），电脑是不会错误的，但是这两个为什么会有不同？ 37（a）在 MATLAB 使用 inv（P）求 4×4 对称矩阵 P=pascal（4）的逆矩阵。

（b）创建帕斯卡下三角 L=abs（pascal（4，1），并测试 P=LLT。

38 若 A=ones（4）且 b=rand（4，1），MATLAB 会怎么告诉你 Ax=b 无解？对于特

殊的 b=ones（4，1），Ax=b 的哪个解可以由 A＼b 得到？

挑战问题

39（推荐）A 是一个 4×4 矩阵，其中对角线都是 1，对角线上方是－a，-b，-c。求此

双对角（bidiagonal）矩阵的逆矩阵 A~1。

请尊重版权与译者的劳动成果，侵权必究！ 96

40 假设 E1，E2，E3 都是 4×4 单位矩阵，除了 E1 的第一列有 a，b，c；E2 的第二列有 d，e；E3 的第三列有 f（数字都在 1＇s 的下方）。执行 L=E1E2E3 证明这些非零数字都会进入 L。

E1E2E3 是消元法的反向序列（E3 先作用），但是 E1E2E3=L 是正确的顺序，可以逆反消元法以及回复 A。

41 如果第二差分矩阵从 T11=1（不是 K11=2）开始，他们会有美丽的逆矩阵。下列是 3×3「三对角矩阵」T 与它的逆矩阵：

一个方法是对［TI］执行高斯－乔丹消元法，我偏好将 T 写成第一差分 L 乘 U 的乘积。在已解范例 2.5A 中，L 与 U 的逆矩阵就是总和矩阵，所以 T=LU 以及 T1=U1L-1:

差

差

和和

问题（4×4）T 的主元是什么？它的 4×4 逆矩阵是什么？反向顺序 Z 可以得到什么矩阵 T? 矩阵 T 的逆矩阵是什么？

42 此处还有两个差分矩阵，都很重要，但是他们可逆吗？

2-10-1

1-100

循环 C= －12-10

0-12-1

－10-12

43 对方块矩阵执行消元法。当你从第二方块行［CD］减去 CA 乘第一方块行［AB］时，「舒尔补充」S 变成：

－c］［é B］-［ s］

A 与 D 是方形

S=D-CA-B

从方块列 2 减去方块列 1 右乘 AB:

方块主元是 A 与 S。如果他们可逆，那么［AB；C D］也是。

44 等式 A（I+BA）=（I+AB）A 如何与 I+BA 以及 I+AB 产生关联？两个都是可逆或是两个都是奇异：不明显。

网址：linear.neocities.org 箱：876152660@qq.com 97

2.6 消元 = 分解：A=LU

1 每个消元步骤 E 被 L 逆反，非对角线的－l 变成 + lj。

2 整体前向消元程序（没有行交换）被 L 逆反：

L=（L21L31.Ln1）（L32.Ln2）（L43..Ln3）.（Lnn-1）

3 乘积矩阵 L 仍然是下三角，每个乘数 l 位于行 i 列 j。

4 从 U 回复到原始矩阵 A:A=LU=（下三角）（上三角）。

5 作用在 Ax=b 的消元法，得到 Ux=c，使用反向代入求解 Ux=C

6 求解三角系统需要 n2/2 次乘法 / 减法，消元法得到 U 需要 n3/3。

学生通常会说数学课程太理论了，好吧，本段落绝对不是，大部分都是纯应用，目标是以最有用的方法来描述高斯消元法。当你仔细观察线性代数的许多关键概念时，实际上就是矩阵的分解（factorization），原始矩阵 A 变成两个或是三个特殊矩阵的乘积。第一个分解－- 也是实际上最重要的分解－- 来自消元法。因子 L 与 U 都是三角矩阵，来自消元法的分解是 A=LU。

我们已经知道 U 是上三角矩阵，主元位于对角线，消元步骤使得 A 变成 U。我们会说明如何利用下三角矩阵 L 来逆反这些步骤（U 回复到 A），L 的单元恰好是乘数 l— 从行 í 减去乘数乘主元行 j。

从 2×2 的例子开始，矩阵 A 包含 2，1，6，8，要消去的数字是 6。从行 2 减去 3 乘行 1，这个前向步骤就是乘数 l21=3 的消元矩阵 E21。从 U 回复到 A 的逆反步骤是 L-1=E211（变成加法，乘数为 + 3）:

前向 A 到 U:

E214 = ［-］［］-［5］-

反向 U 到 A:E211U= B 96 3J-［B =A

第二行就是我们的分解 LU=A，我们写成 L 代替 E21~。较大的矩阵需要更多的 E＇s，L 包含他们所有的逆矩阵。

A 到 U 的每个步骤就是左乘一个矩阵 E，使得位置（i，j）变成 0。为了要保持清晰，我们采用最常见的案例 — 没有交换行的行为。若 A 是 3×3，我们左乘 E21，E31， E32，乘数 l 使得（2，1），（3，1），（3，2）位置变成 0 - 都在对角线下方，消元法得到上三角 U 时停止。

请尊重版权与译者的劳动成果，侵权必究！ 98 现在把 E＇s 移到另一边，变成逆矩阵乘 U:

（E32 E31E21）A= U 变成 A=（E211E311E321）U 得到 A=LU

逆反的顺序必须与前向相反，三个逆矩阵的乘积等于 L。我们得到 A=LU，现在

我们停止这个主题。

说明与范例

第一点：每个逆矩阵 E1 是下三角，非对角线单元是 l，用来恢复－l 的减法效应。

E 与的主对角线都是 L 面的例子 = 3=

第二点：方程式（2）展示下三角矩阵（E 的乘积）乘 A，也展示所有 E1 乘 U 回复 A，

逆矩阵乘积得到的下三角矩阵就是 L。【方程式（2）指的是上方蓝底的公式）】

处理这些逆矩阵的一个理由，是我们想要分解 A 而不是分解 U。「逆反形式」

得到 A=LU。另一个理由是我们好像额外获得了一些超过我们应得的东西，这就

是第三点原因，显示 L 非常完美（exactly right）。

第三点：每个 l 都会落在位置 i，j，在逆矩阵的乘积 L 也是一样。通常矩阵乘法会

把数字的位置弄乱，在这里却没有发生。逆矩阵的顺序是正确的，使得 1 不变。

这个理由会在后面的方程式（2）说明。【这里指的是下一页的方程式（2）】

每个 E1 的对角线都是 1，最后的优点是 L 也具备这个的性质。

A=LU 这是没有交换行的消元法，上三角 U 的主元在对角线上，下三角

L 的对角线都是 1，乘数 l 在 L 的对角线下方。

范例 1 消元法从行 2 减去 1/2 乘行 1，最后的步骤是从行 3 减去 2/3 乘行 2。下

三角 L 的 l21=1/2 及 132=2/3。LU 乘积产生 A:

210

00］［210］

因为 A（3，1）位置的单元是 0，所以（3，1）位置的乘数是 0，不需要操作。

范例 2 把 A 的左上角单元从 2 变成 1 得到 B，所有的主元全部变成 1，所有的

乘数都是 1。持续这样的模式，当 B 是 4×4 时：

1 1 0 0 1

1 1 0 0

特殊模式 B= 1 2 1 0

1 1

1 1 0

=

0 1 2 1

01 1

1 1

0 0 1 2

00 1 1

1

网址:linear.neocities.org 箱：876152660@qq.com 99

这些 LU 范例说明了额外的东西，在实际上非常有用。假设没有交换行，什么时候我们可以预测 L 与 U 中的 0?

当 A 的某一行从 0 开始，L 对应的那一行也是一样。

当 A 的某一列从 0 开始，U 对应的那一列也是一样。

若某一行从 0 开始，我们不需要消元步骤。L 有 0，可以节省电脑时间，同样的从 0 开始的列也在 U 发生。但是请了解：当消元法前向清除时，矩阵中间区域的 0 好像会被填满数字。我们现在说明为什么 L 有乘数 l 在相应位置，不会混乱。为什么 A=LU 的关键理由：问问自己关于主元行被下方行减去时，他们是不是 A 的原始行？不是！消元的过程可能会改变他们。那么他们是 U 的行吗？是的！主元行不会再改变。计算 U 的第三行时，我们减去 U 的较早行的乘积（不是 A 的行）：

U 的行 3=（A 的行 3）-l31（U 的行 1）-l32（U 的行 2）

（1）

改写上述方程式，观察行［l31l321］如何乘 U:

A 的行 3=l3（U 的行 1）+l2（U 的行 2）+1（U 的行 3）

（2）

恰好就是（A=LU）的行 3。L 的行 3 也有分量 l31，l32，1。不论 A 是任何大小，所有的行看起来都像这样。没有交换行，我们有 A=LU。

来自 LDU 较好的平衡因为 U 有主元在对角线而 L 的对角线都是 1，所以 A=LU「不是对称」，这个是容易改变的。U 除以一个对角矩阵 D，它的对角线包含所有 U 的主元。U 会变成新的三角矩阵，它的对角线都是 1＇s:

di

U 分割成

dì

dn

新的三角矩阵使用相同的字母 U 很方便（有一些混淆），它的 1＇s 都在对角线上（像 L）。与正常的 LU 不同，新形式有 D 在中间：（下三角 L）乘（对角 D）乘（上三角 U）。

三角分解可以写成 A=LU 或 A=LDU

你只要看到 LDU，就知道 U 的对角线都是 1，每一行都除以第一个非零单元－- 主元，然后 L 与 U 在 LDU 被同等对待。

B 918 3

进一步分解成

［B 9［ J6 1］

（3）

主元 2 与 5 进入 D。把行除以 2 与 5，在新的 U 留下了［14］与［01］而且 U 的对角线都是 1。乘数 3 仍然在 L 里面。

请尊重版权与译者的劳动成果，侵权必究！ 100

我自己的课程有时候到这里会直接跳到 2.7，下面的内容展示如何组织消元代

码，以及需要多长时间。如果手边有 MATLAB（或其他软件），你可以以秒计来测

量所需的电脑时间。

一个方形系统 = 两个三角系统

矩阵 L 包含高斯消元法的记忆，它保存从下方行减去乘主元行的乘数，我们何时

需要这项记录，又该如何在求解 Ax=b 时使用？

当存在右侧的 b 时，我们需要 L。因子 L 与 U 完全由左侧（矩阵 A）决定，在

Ax=b 的右侧，我们使用 L1，然后是 U1。这个求解步骤处理两个三角矩阵。

1 分解（对左侧的矩阵 A 执行消元法，得到 L 与 U）。

2 求解（利用 L 对 b 执行前向消元法，利用 U 反向代入得到 x）。

较早时我们同时处理 A 与 x，这个没有问题－就是增广成矩阵［Ab］。但是更多

的电脑代码会把两侧分开。L 与 U 有消元法的记忆，只要我们想就可以处理 b。

LAPACK 的使用手册注明「这种情况很普通，节省非常重要，求解一个单一系统

只需要一个子程序就够了，不需要其他供应。」

「求解」如何对 b 工作？首先应用前向消元法至右侧（乘数儲存在 L，现在可以使

用），会把原来的 b 变成新右侧 c，现在是求解 Lc=b，然后反向代入求解 Ux=C，

原始系统被分解成两个三角系统：

前向与反向

求解 Lc=b，然后求解 Ux=c

（4）

要检验 x 是正确的，令 L 乘 Ux=c，LUx=Lc 就是 Ax=b。

强调：这些步骤没有新的东西，这些只是我们一直在做的事情，前向消元时，

我们就是在求解三角系统 Lx=b，然后反向代入得到 x。下面的例子说明我们实

际上在做什么。

范例 3 对 Ax=b 执行前向消元（往下），在 Ux=c 结束：

Ax=b u+2v=5 变成 u+2v=5 Ux=c

4u+9v=21

v=1

乘数是 4，储存在 L，右侧使用这个 4 使得 21 变成 1:

网址:linear.neocities.org 箱：876152660@qq.com 101

Lc=b 下三角系统

得到 C= 5

1

Ux=c 上三角系统 ［］得到 x= 31

L 与 U 用去 n2 的储存位置，这是原来 A 所用的（现在可以遗忘）。消元法的成本

一个非常实际的问题是成本－- 或是计算时间，我们可以在个人电脑上求解 1000 个方程式，如果 n=100，000 呢？（A 是稀疏还是浓密呢？）科学计算常常会遇到大型系统，其中三维空间的问题很容易会有一百万个未知数。我们可以让计算不分昼夜的运行，但是我们没办法等待 100 年。

消元法的第一个阶段得到列 1 的第一主元下方的 0，要得到主元行下方的新单元值，需要一个乘法与一个减法，我们算出第一阶段需要 n2 个乘法与 n2 个减法，实际上会小一点，n2-n，因为行 1 不需要改变。

下个阶段会把第二列位于第二主元下方的单元清除，工作矩阵的大小变成 n-1，估计这个阶段需要（n-1）2 个乘法与减法。得到 U 所需要的粗估计算将是一串平方的总和 n2+（n-1）2+.+22+12。

上面的平方和有一个确切的公式 n（n+（n+1），当 n 很大时，1/2 与 1 就不重要了，关键数值就是 n3/3。平方和好像 x2 的积分，积分由 0 到 n 等于 n3/3:

对 A 执行消元法大概需要 n3/3 次乘法与 n3/3 次减法

右侧的 b 又会如何？継纹往前看，我们从下方的分量 b2，..bn 减去 b1 的倍数，需要 n-1 步，因为 b1 没有参与。所以第二阶段需要 n-2 步，前向消元的最后一个阶段需要 1 步。

现在开始反向代入，计算 xn 需要 1 步（除以最后一个主元），求得下个未知数需要 2 步。当我们求得 x1 时需要 n 步（n-1 个其他未知数的代入，以及除以第一主元）。右侧从 b 到 c 到 x 的全部计算次数－前向到底部，反向到顶部－恰好是 n2。

［（n-1）+（n-2）+..+1］+［1+2+.+（n-1）+n］=n2

（5）

要得到总和，把（n-1）与 1 配对，（n-2）与 2 配对，这样的配对全部有 n 个，每项都等于 n，得到 n2。右侧的成本比左侧小很多。

求解每个右侧需要 n2 个乘法与 n2 个减法

一个带状矩阵 B 的主对角线的上方或下方只有个非零对角线，位于带状之外的 0 单元在消元过程中都保持 0（在 L 与 U 都是 0）。

请尊重版权与译者的劳动成果，侵权必究！ 102

清除第一列需要 2 次的乘法与减法（在主元下产生の个 0，每个 0 使用一个长度为 ω 的主元行）。清除全部 n 个列得到 U，刚好需要 nω2，可以节省很多时间。

带状矩阵

A 到 Un3/3 简化至 nw2

求解 n2 简化至 2nω

一个三对角矩阵（带宽 ω=1）允许非常快速的运算，不必须要储存 0！

本书的网址有「教学代码」，可以将 A 分解成 LU 以及求解 Ax=b。职业等级的代码会往下观察每个列，找到最大可用的主元，完成行的交换，降低数值的舍去误差。

MATLAB 的反斜线指令 x=A＼b 结合分解与求解得到 x。

求解 Ax=b 需要多长时间？对于阶数为 n=1000 的随机矩阵而言，个人电脑上的典型时间大概是 1 秒，当 n 放大两倍，时间就要放大 8 倍。职业性代码请查看 netlib.org。

依据 n3 的规则，矩阵放大 10 倍（阶数 10，000），需要 1000 秒；阶数 100，000 的矩阵需要一百万秒，如果没有超级电脑，时间成本太高了，但是不要忘了这些矩阵是当做满矩阵来看，实际上大部分矩阵都是稀疏矩阵（有很多 0），这种情形下 A=LU 会快速许多。

主要观念的复习

1. 高斯消元法（没有交换行）分解 A 变成 L 乘 U。

2. 下三角 L 包含用来乘主元行的乘数 l，这些乘数使得 A 变成 U。乘积 LU 反加这些行回复 A。

3. 在右侧，我们求解 Lc=b（前向），以及 Ux=c（反向）。

4. 分解：在左侧，有（n3-n）/3 个乘法与减法。

5. 求解：在右侧，有 n2 个乘法与减法。

6. 对于带状矩阵来说，会把 n3/3 简化至 no2 以及 n2 简化至 2nw。

已解范例

2.6A 下三角帕斯卡矩阵 L 包含著名的「帕斯卡三角形」。在范例 2.5C 中，高斯－乔丹将 L 逆反，在此我们分解帕斯卡。

网址：linear.neocities.org 箱：876152660@qq.com 103

对称帕斯卡矩阵 P 是三角帕斯卡矩阵 L 与 U 的乘积。对称 P 矩阵冠名帕斯卡三角，所以每个单元都是上方单元与左方单元的和。在 MATLAB 中，n×n 的对称 P 写成 pascal（n）。

问题：建立惊奇的下－上三角分解 P=LU。

1 1 1 1

1 0 0 0］［1 1 1 1

pascal（4）= 12 3 411 0001 23

1361012100013 =LU

141020［13310001

请预测并检验 5×5 的帕斯卡矩阵的下一行与下一列。

解你可以计算 LU 得到 P，最好是从对称 P 开始，利用消元法得到上三角 U:

1 1 1 1

1 1 1 1

1 1 1 1

1 2 3 4

0123

0 1 2 3

0 1 2 3

P= 13610 → 0259 →

→

=U

141020

03919

00310

前述步骤用到的乘数 l 会完美的进入 L，则 P=LU 是一个特别整洁有序的例子。注意 U 对角线上的主元都是 1。

下个段落会说明对称性质如何在三角 L 与 U 之间产生特殊关系，对于帕斯卡来说，U 是 L 的转置。

你可以预期 MATLAB 的指令 lu（pascal（4）可以得到这些 L 与 U，可惜这个不会发生，因为 lu 子程序会在每一列选取最大的主元，因此第二个主元会从 1 变成 3，但是乔里斯基（Cholesky）分解不会产生行交换：U=chol（pascal）。

对于所有大小的帕斯卡矩阵来说，P=LU 的完整证明是相当迷人的。论文「PascalMatrices」在课程网页 web.mit.edu/18.06 可以查阅，在 MIT 的公开课程集－ocw.mit.edu 可以看到。这些帕斯卡矩阵具有如此非凡的性质－后面还会见到。2.6B 问题：求解 Px=b=（1，0，0，0），方程式右侧 = I 的列，表示 x 会是 P1 的第一列。这就是高斯－乔丹消元法，会适配 PP~1=I 的列。我们已经知道帕斯卡矩阵 L 与 U 是 P 的因子：

两个三角系统 Lc=b（前向）

Ux=c（反向）

解：下三角系统 Lc=b 由上至下求解:

C1

=1

C1=+1

C1+ C2

=0 得到 C2=-1

G1+2C2+C3

=0

c3 =+1

+3c2+3c3+4=0

C4=-1

请尊重版权与译者的劳动成果，侵权必究！ 104

左乘 L 执行前向消元，得到上三角系统 Ux=c，一直都是利用反向代入求解 x，

由底部至顶端：

x1+x2+x3+x4=1

x1=+4

x2+2x3+3x4=-1

+ 得到

x4=-1

x4=-1

我看到了 x 的模式，但是我不知道来自何处。试试 inv（pascal（4）。

问题集 2.6

问题 1-14 计算 A=LU 的分解（也计算 A=LDU）。

1（取要）前向消元法把｝x = 变成三角［｝=c

2=3¦

这个步骤从行 2 减去 21=___乘行 1，反向步骤把 21 乘行 1 加到行 2。反向

步罪的矩阵是 = 二乗三角系统 1x-2 得到 — 以

字母表示，L 乘 Ux=c 得到

2 写下问题 1 中 2×2 三角系统 Lc=b 与 Ux=c。检验 c=（5，2）是第一方程式的

解，再求第二方程式的解 x。

3（现在是 3×3）前向消元法把 Ax=b 变成三角 Ux=c:

x+y+z=5

x+y+z=5

x+y+z=5

x+2y+3z=7

y+2z=2

y+2z=2

x+3y+6z=11

2y+5z =6

z=2

Ux=c 中的方程式 z=2 来自原始系统 Ax=b 中的 x+3y+6z=11，步骤是减

去 l31=__乘方程式 1，以及 132=__乘最后的方程式 2。反向运算回复 A

与 b 的最后一行的［13611］，以及来自 U 与 c 最终的［1115］，［01

22］，［0012］:

［Ab］的行 3=［Uc］的（l31 行 1+32 行 2+1 行 3）

写成矩阵形式就是被 L 乘，所以 A=LU 以及 b=Lc。

4 问题 3 的 3×3 三角系统 Lc=b 与 Ux=c 为何？检验 c=（5，2，2）满足第一个方

程式，再求解第二个的 x。

网址：linear.neocities.org 箱：876152660@qq.com 105

5 什么样的矩阵 E 使得 A 变成三角形式 EA=U? 左乘 E1=L 把 A 分解成 LU:

210

A=|0 4 2

6 3 5

6 哪两个矩阵 E21 与 E32 使得 A 变成上三角形式 E32E21A=U? 左乘 E32-1 与 E21-1 把 A 分解成 LU=E211E321U:

1 1 1

7 哪三个矩阵 E21 与 E31 与 E32 使得 A 变成上三角形式 E32E31E21A=U? 左乘 E321， E311，E211 把 A 分解成 LU:

8 这是展示逆矩阵 E 如何相乘得到 L 的问题。当 A 已经是下三角且对角线都是 1 时，你看到了最佳案例，此时 U=:

消元矩阵 E21 与 E31 与 E32 包含－a，然后－b，然后－c。

（a）执行乘法 E32E31E21 找出单一矩阵 E 使得 EA=I。

（b）执行乘法 E21-1E31-1E32-1 找回 L。

乘数 a，b，c 在 E 中是混合的，但是在 L 中是完美的。

9 当 0 出现在主元，A=LU 就不可能出现。（我们需要 U 的非零主元。）直接证

明为什么两组方程式都不可能：

H::『

1 1 0］［1

这些矩阵需要行交换，可以利用交换矩阵 P。

10 哪个数字 c 使得第二主元位置变成零？需要一次的行交换，否则不可能得到 A=LU。哪个数字 c 使得第三主元变成零？此时行交换已经不能帮忙且消元法失败:【原文 andA=LU. 应该是 otherwiseA=LU..】

1 c 0

A=|2 4 1

3 5 1

请尊重版权与译者的劳动成果，侵权必究！ 106

11 矩阵 A 的 L 与 D（对角主元矩阵）为何？A=LU 的 U 为何？A=LDU 的新 U 为

何？

12A 与 B 是横跨对角线的对称矩阵（因为 4=4），求出他们的三重分解 LDU，并

且说明 U 如何与 L 产生关联。

13（推荐）计算对称矩阵 A 的 L 与 U:

а a a a

a b bb

A=abec

a b cd

求 a，b，c，d 的 4 个条件，使得 A=LU 有 4 个主元。

14 非对称矩阵会有与问题 13 一样的 L:

..

arrr

a b c d

求 a，b，c，d，r，s，t 的 4 个条件，使得 A=LU 有 4 个主元。

问题 15-16 使用 L 与 U（不需要 A）求解 Ax=b。

15 求解三角系统 Lc=b 得到 c，然后求解 Ux=c 得到 x。

－||50-||5-R

安全起见，如同一般的计算 LU 以及求解 Ax=b。当你看到 c 时，圈起来。

16 求解 Lc=b 的 c，然后求解 Ux=c 的 x。A 是什么？

网址:linear.neocities.org 箱：876152660@qq.com 107

17（a）当你使用正常的消元步骤至 L 时，你会得到什么矩阵？

00

1321

（b）当你使用相同的步骤到 I 时，你会得到什么矩阵？

（c）当你使用相同的步骤到 LU 时，你会得到什么矩阵？

18 若 A=LDU 同时 A=L1D1U1，所有的因子都是可逆，则 L=L1 与 D=D1 与 U=U1，「这个三个因子是唯一的。」

推导方程式 L11LD=D1U1U11，方程式的两侧是三角形还是对角线？

推论：L=L1 且 U=U1（他们都有 1＇s 在对角线），则 D=D1。

19 三对角矩阵除了在主对角线以及两个相邻对角线有非零单元，其他位置都是 0。分解三对角矩阵得到 A=LU 及 A=LDLT。

a a

0

A= 2

与 A= a a b b

0 b b +

20 当 T 是三对角，它的因子 L 与 U 只有两个非零的对角单元，你会如何利用已知 T 的零，作为高斯消元法的暗码。求 L 与 U。

1 2 0

三对角 T= 2310

0 1 2 3

0034

21 若 A 与 B 在标示 x 的位置有非零单元，哪些标示 0 的单元在因子 L 与 U 中保持是 0?

x xxx

xxx0

xxx0

xx0x

A=

B=

0xxx

x0xx

0 0 x x

0xxx

22 假设你往上消元（基本没听过），使用最后一行产生最后一列的零（主元是 1），然后使用第二行产生第二主元上方的零。求非正常顺序的因子 A=UL。

上三角乘下三角 4-

23 简单却重要。若 A 有主元 5，9，3 且没有行交换，左上方 2×2 子矩阵 A2（去除行 3 与列 3）的主元为何？

请尊重版权与译者的劳动成果，侵权必究！ 108

挑战问题

24 哪些可逆矩阵允许 A=LU（消元法没有行交换）? 好问题！检视每个 A 的左上

角的方形子矩阵 Ak。

所有左上角的 k×k 子矩阵 Ak 必须可逆（大小 k=1，2，..，n）。

解释这个答案：Ak 分解成

，因为 LU=［］

25 对于 6×6 的第二差分常数－对角矩阵 K 而言，将主元与乘数引入 K=LU，（L

与 U 只有两个非零对角单元，因为 K 有三个。）求出 L1 的 i，j 单元的公式，

再利用好像 MATLAB 软件的 inv（L）或运用检视法得到良好的模式。

2 －1

－1

－1，2，-1 矩阵 K=

=toeplitz（［2-10000］

－1

－1 2

26 如果你印出 K，它看起来没有那么好看（6×6）。但是如果你印出 7K~1，矩阵

看起来是多么美妙。依据下列的模式用手算写下 7K:

1 行 1 与列 1 是（6，5，4，3，2，1）。

2 主对角线及对角线之上，行 i 是 i 乘行 1。

3 主对角线及对角线之下，列 j 是 j 乘列 1。

执行 K 乘 7K1 得到 7I，下列是 n=3 的 4K1:

3×3 案例

4

K 的

行列式是 4

4

【原文写的不清楚，K 是对称，K` 也是对称，忽略第 3 点。以下是 7K~1:】

6 5 4 3 2 1

6 5 4 3

65 4 3 2 1

2:5 2.4 2:3 2.2 2:1

10 8 6

510864

3:4 3.3 3.2 3:1

12 9

481296

4.3 4.2

12 24680

5:2 5:1

123456

123456

3691284

2 4 6 8 10 5

6·1

12 3 4 5 6

网址：linear.neocities.org 箱：876152660@qq.com 109

2.7 转置与排列

1Ax 与 AB 与 A1 的转置分别是 xTAT 与 BTAT 与（AT）1。

2 点积（内积）为 x·y=xTy，这是（1×n）（n×1）=（1×1）。

外积是 xyT= 列乘行 =（n×1）（1×n）=n×n 矩阵。

3AT 的潜在意义是 Ax·y=x·ATy，因为（Ax）Ty=xTATy=xT（ATy）。4 对称矩阵有 ST=S，（乘积 ATA 永远对称）。

5 正交矩阵有 QT=Q1，Q 的列是正交单位向量 1。

6 排列矩阵有与 I 相同的行（任意顺序），会有 n！的不同排序。7Px 会把分量 x1，x2，.，xn 变成新的顺序，且 PT=P1。

我们还需要一个矩阵，幸运的是它比逆矩阵简单多了，它是 A 的转置，写成

AT，AT 的列就是 A 的行。

当 A 是 m×n 的矩阵，它的转置就是 n×m:

转置

2 3

若 A=

则 AT=

04

123 004

你可以把 A 的行写成 AT 的列，或者可以把 A 的列写成 AT 的行。对称矩阵沿着主

对角线「翻转」，A 的（行 i 列）的单元来自原始矩阵 A 的（行 j 列）的单元：

交换行与列

（AT）=Aj

下三角矩阵的转置是上三角矩阵，（但是逆矩阵还是下三角。）AT 的转置是 A。

注解：MATLAB 中 A 的转置符号是 A＇，键入［123］得到行向量，列向量是 v=

［123］＇。矩阵 M 的第二列是 w=［456］＇，可以定义 M=［v w］。也可以快

速键入行，然后整个矩阵做转置：M=［123；456］＇。

转置的规则非常直接，我们可以转置 A+B 得到（A+B）T，或者我们可以分别

转置 A 与 B，然后 AT+BT-— 答案相同。

1 译者注：本书「正交矩阵」的定义已经是「正交单位矩阵」。

请尊重版权与译者的劳动成果，侵权必究！ 110

比较严肃的问题是乘积 AB 以及逆矩阵 A1 的转置：

和

（A+B）T=AT+BT

（1）

乘积

（AB）T=BTAT

（2）

逆矩阵

（A）=（）

（3）

特别注意 BTAT 的顺序是如何反序。对于逆矩阵而言，反向顺序很快得到检验：B-1A-1 乘 AB 得到 I。要了解（AB）T=BTAT，可以从（Ax）T=xTAT 开始，此时 B 只是一个向量：

当 xTAT 组合 AT 的行，则有 Ax 组合 A 的列

它是相同向量的相同组合！在 A 中是列，在 AT 则是行，所以列 Ax 的转置就是行 xTAT，满足我们的公式（Ax）T=xTAT。现在我们可以证明公式（AB）T=BTAT，其中 B 有数个列。

若 B=［x1，x2］有两个列，应用相同的观念在每个列，AB 的列就是 Ax1 与 Ax2，他们的转置会正确的出现在 BTAT 的行：

就是 BTAT

（4）

正确的答案 BTAT 一次出现一个行，下面是（AB）T=BTAT 的数字：

AB-］［］-［B＇^＂-［］［°¦］-［?］

反序规则可以扩展到三个或以上的乘积：（ABC）T=CTBTAT。

若 A=LDU 则 A=UDZ。主元矩阵有 D=D

现在应用上述的乘积规则来转置 A~`A=I。在右侧 1=I，我们确认这项规则：（A1）T 是 AT 的逆矩阵，他们的乘积得到 I:

逆矩阵的转置 A-1A=I 转置得到 AT（A-1）T=I

（5）

同理 AA-1=I，得到（A-1）TAT=I。我们可以对转置矩阵取逆矩阵，也可以转置逆矩阵。特别注意：当 A 为可逆矩阵，AT 也是可逆。

范例 1

网址：linear.neocities.org 箱：876152660@qq.com 111

内积的意义

我们知道 x 与 y 的点积（内积），它是数字 x1y1 的累加。现在我们有更好的方式来表示 x·y，不再需要不职业的点符号，而是使用矩阵表示：

T 在内点积或内积是 xTy

（1xn） （nx1）

T 在外秩一的乘积或是外积 xyT

（nx1） （1xn）

xTy 是一个数字，xyT 是一个矩阵。量子力学会写成 <x［y>（内积）与 | x><y|（外积）。宇宙可能是被线性代数管理的，下面三个例子对于内积有不同的意义：

来自力学

功（work）=（位移）（力）=xTf

来自电路

热损失 =（压降）（电流）=ey

来自经济

收入 =（数量）（价格）=qTp

我们非常接近应用数学的中心了，还有一个重点要强调，内积与 A 的转置有很深的关联。

我们定义 AT 是把矩阵横跨主对角线翻转，这个不是数学，有一个更好的方法来说明转置。AT 是使得下列两个内积相等的矩阵，其中 x 与 y 是任意向量：

（dx）＇y=x＇（4＇y）

Ax 与 y 的内积 = x 与 A①y 的内积

一侧是 Ax 乘 y:（x2-x1）y1+（x3-x2）y2，这个与 x1（-y1）+x2（y1-y2）+x3（y2）相同，现在 x 乘 ATy。

对称矩阵

对称矩阵从 A 变成 AT 没有变化，AT=A。它的（j，i）单元横跨对角线等于（i，j）单元。依据我的观点，这些是最重要的矩阵，我们给定特殊字母 S 表示对称矩阵。

定义

对称矩阵有 ST=S，

表示 Sji=Sij

请尊重版权与译者的劳动成果，侵权必究！ 112 对称矩阵 S-|｝=SīD=|=D

对称矩阵的逆矩阵也是对称，S1 的转置是（S-1）T=（ST）1=S1，说明 S1 也是对称（当 S 可逆）：

对称逆矩阵 8 - 且 D-

现在我们用任意矩阵 AT 乘 A 产生一个对称矩阵 S。

对称的乘积 ATA，AAT，LDLT

选取任意矩阵 A，有可能是矩形，乘积 S=ATA 自动成为方形对称矩阵：

ATA 的转置是 AT（AT）T=ATA

（6）

这是 ATA 的对称性的快速证明，我们可以检视 ATA 的（i，j）单元，它是 AT 的行 i（A 的列 i）与 A 的列 j 的点。（，i 单元有相同的点，也是列 j 与列 i，所以 AA 是对称。

矩阵 AAT 也是对称（A 与 AT 的形状允许乘法），但是 AAT 与 ATA 不同。在我们的经验，大部分的科学问题会从矩形矩阵 A 开始，然后在 ATA 或是 AAT 或是两者都有时结束，如同最小二乘（least squares）。

范例 2 以两原［以及－-

］以及者是对阵

乘积 ATA 是 n×n，反序时 AAT 是 m×m，两者都是对称，其中对角线都是正数（为什么？）。纵使 m=n，也很可能会有 ATA≠AAT，也许等号会成立，却是不正常的。对称矩阵的消元 ST=S 使得消元法更加快速，因为我们只需要处理半边的矩阵就可以（加上对角线）。上三角矩阵不太可能是对称的，对称性会出现在三重乘积 S=LDU。还记得主元对角矩阵 D 如何利用除法，使得 L 与 U 的对角线都是 1＇s:

［］［°］

LU 失去 S 的对称性

LDLT 捕捉对称性

现在 U 是 L 的转置

网址：linear.neocities.org 箱：876152660@qq.com 113

当 S 是对称，通常的形式 A=LDU 变成 S=LDLT。最后的 U（对角线都是 1）是 L 的转置（对角线也都是 1）。包含主元的对角矩阵 D，本身也是对称。

若 S=ST 分解成 LDU，其中没有出现行交换，则 U 就是 LT。

对称矩阵的对称分解是 S=LDLT

注意 LDLT 的转置自动变成（LT）TDTLT=LDLT。消元法的工作量减去一半，从 n3/3 乘法变成 n3/6，储存位置也基本少了一半。我们只需要保存 L 与 D，不需要储存 U，因为 U 就是 LT。

排列矩阵

转置对于排列矩阵来说扮演特殊的角色，矩阵 P 有单一的「1」在每一行与每一列，PT 也是排列矩阵－可能与 P 相同也可能不同。任何乘积 P1P2 再次是个排列矩阵。

我们现在重新排列 I 的行的顺序，得到来自单位矩阵的每个 P。

最简单的排列矩阵是 P=I（无交换），下一个最简单的排列矩阵应该是行交换 P。这些矩阵可以通过交换 I 的两个行 i 与 j 而创建，其他排列矩阵重组更多的行的顺序。对于 I 执行所有可能的行交换，我们得到全部可能的排列矩阵。

定义

排列矩阵 P 具有单位矩阵 I 的任意顺序的行

范例 3 下列是 6 个 3×3 排列矩阵，隐藏 0 后得到

1

1

I=

1

P21= 1

P2P1 =

1

1

1

1

1

1

1

P31=

P32 =

1

P21P32= 1

1

1

1

阶数 n 会有 n！的排列矩阵，符号 n！表示 n 阶层，就是数字（1）（2）.（n），于是 3！ =（1）（2）（3）=6。若阶数 n=4 会有 24 种排列矩阵，阶数 5 会有 120 种排列矩阵。阶数 2 时只有两种排列矩阵，即为［］与［

重要：P1 也是排列矩阵。前述 6 个 3×3 的 P 矩阵中，左边的 4 个矩阵就是自己的逆矩阵，右边的两个互为逆矩阵。所有单一的行交换都是自己的逆矩阵，如果再次重复相同的交换会回复到 I。但是对于 P32P21 来说，逆矩阵总是变成相反的顺序，逆矩阵是 P21P32。

请尊重版权与译者的劳动成果，侵权必究！ 114

更为重要：P1 永远等于 PT。在右边的两个矩阵互为逆矩阵，也互为转置矩

阵。当我们计算乘积 PPT 时，P 的第一行里面的 1，会碰上 PT 的第一列里面的 1（由

于 P 的第一行是 P 的第一列），其他列都不会有 1 存在，所以 PPT=I。

PT=P1 的另一个证明，将 P 视为行交换矩阵的乘积，每个行交换都是自己的

转置，也是自己的逆矩阵，PT 与 P1 都是来自反序的行交换矩阵的乘积，所以 PT

与 P` 相同。

排列（消元前先交换）得到 PA=LU

利用行交换的 PA=LU 分解

我们当然希望你还记得 A=LU，从 A=（E211..E1.）U 开始，执行一个 E 代表

一个消元步骤，然后取逆矩阵 E1。这些逆矩阵压缩后变成一个矩阵 L，下三角

L 的对角线都是 1，结果就是 A=LU。

这是一个伟大的分解，但是不一定能够行得通。有时候需要交换行得到主元，

然后 A=（E1..P1..E1.P1.）U。每个行交换由 P 执行，再取 P 的逆矩阵。

我们现在把这些行交换矩阵压缩变成一个单一的排列矩阵 P，可以得到每一个可

逆矩阵 A 的分解－这是我们想要的。

主要的问题是去哪儿收集 P。有两个良好的可能性－在消元之前做好所有的

交换，或是在 E＃之后再做交换。第一个方法得到 PA=LU，第二个方法会在中间

有一个交换矩阵 P。

1. 行交换可以事先执行。他们的乘积 P 把 A 的行放在正确的顺序，对于 PA 来

说就不需要执行交换，则 PA=LU。

2. 如果在全部消元步骤执行完成后再交换行，主元行的排列会是非常奇怪的顺

序。P1 将主元行放在 U1，而且呈现正确的三角顺序，则 A=L1P1U1。

PA=LU 在所有的计算中经常使用，我们会聚焦在这个形式。

分解 A=L1P1U1 可能可以更优雅，如果两者并论，之间的差别不是广为人知。你

可能不会花长时间在这两个方法，请不要，最重要的情形是当 A=LU，而且不存

在行交换时，P=I。

下列的矩阵 A 从 a11=0 开始，交换行 1 与行 2 使得第一主元进入惯常位置，

然后持续对 PA 执行消元法：

0

2

2 l

2

0

0

7

3

A

PA

l31=2

l32=3

矩阵 PA 的行有良好的顺序，如往常一般分解成 LU:

010

100121

P= 10

PA=0 100 11=LU

（7）

001

231004

网址：linear.neocities.org 箱：876152660@qq.com 115

我们从 A 开始到 U 结束，唯一的要求是 A 的可逆性。

若 A 可逆，排列矩阵 P 会把 A 的行放在正确的顺序来分解 PA=LU. 在行交换

之后，必定存在一整组的主元使得 A 是可逆。

在 MATLAB 中，A（［r k］，:）=A（［kr］，:）会交换行 k 以及在其下方的行 r（其中第 k 主元已经存在。）则 lu 代码会更新 L 与 P 以及 P 的符号：

A［rk］，:）=A（［k r］，:；

这是部分的［L，U，P］=lu（A）

L（［r k］，1:k-1）=L（［k r］，1:k-1）；

P（［r k］，:）=P［k r］，:；

sign =-sign

P 的「sign」可以分辨行交换的数目是否为偶数（sign=+1），奇数的行交换会得到 sign=-1。开始的时候，P 是 I 且 sign=+1，出现一个行交换，sing 就会变换符号。sign 的最终值就是 P 的行列式，行列式与行交换的顺序无关。

对 PA 来说，我们回到熟悉的 LU。实际上诸如 lu（A）的代码通常不会用在第一个可用的主元上，从数学来说我们可以接受小的主元 — 除了 0 以外，所有良好的代码会往下寻找最大主元的列。

段落 11.1 说明为什么「部分主元（partial pivoting）」可以降低舍去误差，则 P 可以包含行交换，虽然这个不是代数上的必需，仍然有 PA=LU。

我们的建议是了解排列，却是让电脑去执行工作，A=LU 的计算在没有 P 时可以手算。教学代码 splu（A）会分解 PA=LU，splv（A，b）可以求解 Ax=b，其中 A 是可逆。如果在列 k 找不到主元，网址上的程序 splu 会终止，A 就不是可逆。

主要观念的复习

1. 转置使得 A 的行变成 AT 的列，则（AT）=Aji。

2.AB 的转置是 BTAT，A-1 的转置是 AT 的逆矩阵。

3. 点积是 x·y=xTy，（Ax）Ty 等于点积 xT（ATy）。

4. 当 S 对称（ST=S），它的 LDU 分解是对称：S=LDLT。

5. 排列矩阵 P 有一个 1 在每一行以及每一列，PT=P1。

6. 阶数为 n 时会有 n！个排列矩阵，半偶，半奇。【参考习题 10】

7 若 A 可逆，排列矩阵 P 会重新排列 A 的行，使得 PA=LU。

请尊重版权与译者的劳动成果，侵权必究！ 116

已解范例

2.7A 应用排列矩阵 P 至 S 的行，会摧毁 S 的对称性。

14 5

什么样的排列 Q 应用至 PS 的列，会使得 PSQ 恢复对称性？数字 1，2，3 必须回到主对角线（不一定要原来顺序）。证明 Q=PT 使得 PSPT 恢复对称性。

解要恢复对称性，2 要回到对角线，所以 PS 的列 2 要移动列 1。PS 的列 3（包含 3 的数字）必须移到列 2，然后「1」移到 3，3 的位置。可以操作列交换的排列矩阵 Q 为

矩阵 Q 就是 PT，这个选择永远可以恢复对称性，因为 PSPT 可以确保对称性。（它的转置依然是 PSPT。）矩阵 Q 同时也是 P1，因为每一个排列矩阵的逆矩阵是自己的转置。

若 D 是对角矩阵，得到的 PDPT 也是对角矩阵。当 P 把行 1 往下移到行 3，在右侧的 P 会把列 1 移到列 3，（1，1）单元就会往下移动到（3，1）然后到（3，3）。2.7B 给定上述的矩阵 S，求 S=LDLT 的对称分解。

解要将 S 分解成为 LDLT，我们也要使用消元法得到 U:

乘数是 l21=4，l31=5，l32=1。主元 1，－14，－8 进到 D 里面。当我们把 U 的行除以主元，LT 应该变成：

当 S=ST

对称分解

S 有 3 个主元，S 可逆，它的逆矩阵是（）D，且 s1 也是对称。数字 14 与 8 会出现在 S1 的分母，S 的行列式是主元的乘积（1）（-14）（-8）=112。

网址：linear.neocities.org 箱：876152660@qq.com 117

2.7CA 是矩形矩阵，鞍点（saddle point）矩阵 S 是对称而且重要：

米自最小一乗的方年 s--s 它大小足 m

应用方块消元法得到方块分解 S=LDLT，然后测试可逆性质：

S 可逆 ATA 可逆当 x≠0 则 Ax≠0

解第一个方块主元是 I，从行 2 减去 AT 乘行 1:

方块消元 S=［］变成［］这是 U

方块主元矩阵 D 包含 I 与－ATA，则 L 与 LT 包含 AT 与 A:

方块分解 S=LDL=［］［+A］［07］

L 必然是可逆且对角线都是 1。中间矩阵的逆矩阵与（ATA）1 有关，段落 4.2 会回答有关矩阵 AA 的一个关键问题。

何时 A①A 可逆？答案：A 必须有无关的列。

只有 x=0 时才有 Ax=0，否则 Ax=0 会得到 ATAx=0。

问题集 2.7

问题 1-7 有关转置矩阵的规则。

1 求 A 与 A 与（4）与（4）:

4=［］以及 4=［］

2 验证（AB）T=BTAT，但是会与 ATBT 不同。

4-||8-||4-|

证明 AAT 与 ATA 不同，但是两个矩阵是

3（a）矩阵（AB）-1）T 来自（A-1）T 与（B-1）T，顺序为何？

（b）若 U 是上三角，则（U-1）T 是＿三角。

4 证明 A2=0 是可能的，但是 ATA=0 是不可能的（除非 A = 零矩阵）。

请尊重版权与译者的劳动成果，侵权必究！ 118

5（a）行向量 xT 乘 A 乘列向量 y 得到什么数字？

（b）这就是行 xTA = 乘列 y=（0，1，0）。

（c）这就是行 xT=［01］乘列 Ay=

。测试一个例子。A，B，C，D 在什

么条件下，这个方块矩阵是对称的？

7 是非题:

（b）若 A 与 B 都是对称，则他们的乘积 AB 也是对称。

（c）若 A 不是对称，则 A-1 不是对称。

（d）当 A，B，C 都是对称，则 ABC 的转置是 CBA。

问题 8-15 有关排列矩阵。

8 矩阵的阶数为 n，为什么会有 n！个排列矩阵？

9 若 P1 与 P2 是排列矩阵，乘积 P1P2 也是排列矩阵，这个仍然有 I 的行依据某种顺序排列。举例说明 P1P2≠P2P1 以及 P3P4=P4P3。

10（1，2，3，4）存在 12 种「偶（even）」排序，其中交换次数是偶数。其中两种是（1，2，3，4）没有交换以及（4，3，2，1）交换两次，请列出其他 10 种，不需要写出每个 4×4 矩阵，只要数字排序即可。

11 何种排列矩阵使得 PA 是上三角？何种排列矩阵使得 P1AP2 是下三角？在 A 的右侧乘 P2 会交换 A 的 0 0 6

A=

2 3

0 45

12 解释为什么 x 与 y 的点积等于 Px 与 Py 的点积？则（Px）T（Py）=xTy 告诉我们对于任何排列矩阵都有 PTP=I。当 x=（1，2，3）与 y=（1，4，2）时，选取 P 证明（Px）·y 不一定等于 x·（Py）。

13（a）求一个 3×3 的排列矩阵，其中 P3=I（但是 P≠I）。

（b）求一个 4×4 的排列矩阵 P，其中 P4≠I。

14 若 P 在反对角线从（1，n）到（n，1）有 1＇s 存在，描述 PAP。注意 P=PT。

【对角线是左上到右下，反对角线（antidiagonal）是右上到左下】

网址：linear.neocities.org 箱：876152660@qq.com 119

15 所有的行交换矩阵都是对称：PT=P，则 PTP=I 变成 P2=I。其他排列矩阵可能是也可能不是对称。

（a）若 P 把行 1 送到行 4，则 PT 把行＿送到＿_。当 PT=P 时，行交换会

成对（pair）出现，而且没有重叠。

（b）求一个 4×4 矩阵，其中 PT=P，会移动全部 4 个行。

问题 16-21 有关对称矩阵与分解。

16 若 AT=A 与 BT=B，下列哪些矩阵一定是对称：

（a）A2-B2 （b）（A+B）（A-B）（c）ABA （d）ABAB

17 求一个 2×2 对称矩阵 S=ST，其中 S 分别具有下列 3 个性质。

（a）S 不可逆。

（b）S 可逆但是不能分解成 LU（需要行交换）。

（c）S 可以分解成 LDLT，但是不能分解成 LLT（因为负的 D）。

18（a）若 S=ST 且为 5×5，S 有多少单元可以无关的选取？

（b）L 与 D（仍然是 5×5）如何在 LDLT 中得到相同的选取数值？

（c）若 A 是反对称矩阵，A 有多少单元可以选取？（AT=-A）。

19 假设 A 是矩形（m×n），S 是对称（m×m）。

（a）转置 ATSA 展示对称性，矩阵的形状为何？

（b）说明为什么 AA 对角线没有负数。

20 分解下列矩阵得到 S=LDLT，主元矩阵 D 是对角矩阵：

21 在消元法清除列 1 在第一主元的下方后，求出现在右下角的 2×2 对称矩阵：

请尊重版权与译者的劳动成果，侵权必究！ 120

问题 22-24 有关分解 PA=LU 与 A=L1P1U1。

22 求出 PA=LU 分解（并验证）：

小

23 找出一个 4×4 排列矩阵（称为 A），需要 3 次交换完成消元。对矩阵来说它的 P，L，U 为何？

24 分解下列矩阵得到 PA=LU，也分解成 A=L1P1U1（行 3 先不交换，直到完成从行 2 减去 3 乘行 1）:

25 证明单位矩阵不可能是 3 个行交换（或 5 个）的乘积，它可以是 2 个（或 4 个）行交换的乘积。

26（a）选择 E21 移除第一主元下方的 3，然后执行乘法 E21SE21T 消去两个 3:

［1 30

10 0

S= 3 11 4 走向目标 D= 020

049

001

（b）选择 E32 移除第二主元下方的 4，然后利用 E32E21SE21TE32T 简化 S 成为 D， 逆反 E＇s 求出 S=LDLT 的 L。

27 若 4×4 矩阵的每一行都包含某种顺序的数字 0，1，2，3，这个矩阵可能对称吗？

28 证明：不存在行的重排序与列的重排序可以转置一个典型矩阵。（注意对角线的单元）。

下面 3 个问题有关等式（Ax）Ty=xT（ATy）的应用。

29 在波士顿，芝加哥，西雅图之间铺设电缆，这些城市所在的电压是 xB，xC，xs。如果城市之间都是单位电阻，则城市之间的电流在 γ 中：

УвС

y=Ax 是

切而

（a）求出离开三个城市的总电流 Ay。

（b）验证（Ax）Ty 与 xT（ATy）具有一致性－两者都有 6 项。

网址：linear.neocities.org 箱：876152660@qq.com 121

30 制造 x1 辆卡车与 x2 架飞机需要 x1+50x2 吨的钢材，40x1+1000x2 磅的橡胶以

及 2x1+50x2 个月的人力。如果单位成本 y1，y2，y3 是每吨 $700，每磅 $3，每个

月 $3000，请问一辆卡车与一架飞机的价值各是多少？这些是 Ay 的分量。31Ax 得到钢材，橡胶，人力的量，然后产生问题 31 的 x，求出 A。当 x·Ay 是＿__的价值时，Ax·y 是输入的＿___。

32 矩阵 P 乘（x，y，z）得到（z，x，y）也是一种旋转矩阵，求 P 与 P3。旋转轴 a=（1，1，

1）不会移动，它等于 Pa。请问从 v=（2，3，-5）到 Pv=（-5，2，3）的旋转角为何？33 将 4-

写成 ES 的乘积，其中 E 是基础行运算矩阵，S 是对称矩阵。34 此处是 A 的新分解得到 LS：三角矩阵（有 1＇s）乘对称矩阵：

从 A=LDU 开始，则 A 等于 L（UT）-1 乘（S=UTDU）。

为什么 L（UT）1 是三角形？它的对角都是 1。为什么 UTDU 是对称？

35 如果一个矩阵群组包含 A 与 B，则 AB 与 A 也在这个矩阵群组中。「乘积与

逆矩阵保留在群组」。下列哪些集合是矩阵群组？

对角线都是 1 的下三角矩阵 L，对称矩阵 S，正矩阵 M，对角可逆矩阵 D，排列矩阵 P，QT=Q1 的矩阵。再找出两个矩阵群组。

挑战问题

36 方形西北矩阵 B 在反对角线（连接（1，n）与（n，1）下方的东南角单元都是 0，BT

与 B2 也是西北矩阵？B1 是西北或东南矩阵？BC = 西北乘东南的形状？

37 如果你对排列矩阵取幂次方，为什么某些 P 最终会等于 I? 找出一个 5×5 排列矩阵 P，使得最小的幂次方等于 I 的数字是 6。

38（a）写下任意的 3×3 矩阵 M，分割 M 变成 S+A，其中 S=ST 是对称，

A=-AT 是反对称。

（b）写出 S 与 A 的公式，这个公式与 M 及 MT 有关。我们希望 M=S+A。39 假设 QT=Q1（转置等于逆，所以 QTQ=I）。

（a）证明列 q1，..，qn 都是单位矩阵：‖qi|‖2=1。

（b）证明 Q 的任意两个列互相垂直：q1Tq2=0。

（c）求出一个 2×2 的例子，其中第一个单元是 q11=cosθ。

请尊重版权与译者的劳动成果，侵权必究！ 122

导数的转置

你会允许我讲一些微积分吗？这个非常重要或者是我不想离开线性代数。（这真的是函数 x（）的线性代数。）矩阵变成微分，因此 A=ddt。要求出这个不寻常 A 的转置，我们需要定义两个函数 x（）与 y（）的内移：

函数的内积

xTy=（x，y）=x（t）y（t）dn

从内积来看，我们知道对于 AT 的要求。当我们处理微分时，用「伴随（adjoint）」这个词语会比「转置」来的正确。

矩阵的转置有（Ax）Ty=xT（ATy），A=d/dt 的伴随有

（=（）

我希望你了解部分分（ （integration by parts）。微分从第一个函数 x（移到第二个函数 y（t），在移动时出现了一个负号，这个告诉我们微分的转置是微分加负号。微分是反对称，A=d/dt 且 AT=-d/dt。对称矩阵有 ST=S，反对称矩阵有 AT=-A。第八章会介绍线性代数包含微分与积分，因为它们两者都是线性的。

微分的反对称也可以应用到中心差分矩阵：

0

0 0

－1 0

－1 0 10

A= 0 －1 0

0 0 －1 0

0

前向差分矩阵的转置会变成反向差分矩阵，相当于乘－1。在微分方程式中，第二导数（加速度）是对称的，第一导数（正比于速度的阻尼）是反对称的。

网址：linear.neocities.org 箱：876152660@qq.com 123

第三章

向量空间与子空间

3.1 向量空间

1 标准 n 维空间 Rn 包含全部具有 n 个分量的实数列向量。

2 若 ν 与 w 在向量空间 S 中，则所有的组合 cv+dw 也必须在 S 中。

3S 中的「向量」可以是矩阵或是 x 的函数。「一个点」空间 Z 由 x=0 构成。4Rn 的子空间是 Rn 里面的一个向量空间，例如：直线 y=3x 在 R2 里面。

5A 的列空间包含 A 的列的所有组合：Rm 的子空间。

6 列空间包含所有的向量 Ax，所以当 b 在 C（A）中，Ax=b 有解。

对新手而言，矩阵计算包含很多数字，对你来说，他们与向量有关。Ax 与 AB 的列都是 n 个向量的线性组合 — 这些向量就是 A 的列。本章从数字与向量转移到第三层次的了解（最高层次），我们检视向量的空间，而不仅仅看着个别的向量。如果不了解空间，特别是他们的子空间，你就无法了解 Ax=b 的全部面貌。由于本章走得有点深入，可能会有一点难度，这个很正常。我们检视的是计算的内在，是在发现数学，作者的工作就是让他们清晰。本章在「线性代数的基础定理」结束。

我们从最重要的向量空间开始，他们标示成 R1，R2，R3，R4，.，每个空间 Rn 包含一整个向量的集合。R5 包含全部具有 5 个分量的列向量，称为 5 维空间。定义空间 R」包含全部具有 n 个分量的列向量 ν。

请尊重版权与译者的劳动成果，侵权必究！ 124

向量 ν 的分量是实数，这是使用字母 R 的理由。具有 n 个复数分量的向量会落在空间 C」中。

向量空间 R2 就是平常的 xy 平面，每个 R2 里面的向量有两个分量。词语「空间」要我们思考全部的向量－整个平面，每个向量给出平面的一个点的 x 与 y 坐标： v=（x，y）。

相似的情形，R3 的向量对应三维空间的点（x，y，z），一维空间 R1 是一条直线（如同 x 轴）。跟以前一样，我们把向量写成在括号中的列，或是在水平行用逗号与括号表示：

在 R2，（1，1，0，1，1）在 R5，

线性代数最伟大的地方就是它很容易处理 5 维空间，我们不必画出向量，我们只需要 5 个数字（或 n 个数字）。

ν 乘 7 是把每个分量乘 7，此处的 7 是纯量。要在 R5 中计算向量加法，就是将对应分量相加。向量空间一样有两个重要的向量运算，他们产生了线性组合。

我们可以在 R＂中任意相加向量，也可以对任意向量 ν 乘任意纯量 c。

「在向量空间中」表示「结果」还停留在空间里面。若 ν 是 R4 的向量，分量是 1，0，0，1，则 2v 是 R4 的向量，分量是 2，0，0，2。（本范例中 2 是纯量。）一整个系列性质可以在 R」中验证，交换律是 ν+w=w+v；分配律是 c（v+w）=cv+cw；存在唯一的「零向量」满足 0+ν=v；这些是问题集开头叙述的八个条件中的三个。每个向量空间都要满足这八个条件，他们是向量而不是列向量，在 R」之外还存在其他向量空间，所有的向量空间都必须遵守这八个规则。

一个实数向量空间是一个向量的集合，遵循实数向量加法与实数纯量乘法的规则，加法与乘法得到的向量还必须留在原来的空间中，同样要满足这八个条件（通常是没有问题）。下列是三个 R」之外的向量空间：

M 所有实数 2×2 矩阵组成的向量空间

F

所有实数函数 f（x）组成的向量空间

Z

只有一个零向量的向量空间

在 M 中的「向量」实际上是矩阵，在 F 中的向量是函数，在 Z 中唯一的加法是 0+0=0。每种案例都可以加：矩阵加矩阵，函数加函数，零向量加零向量。我们可以用 4 乘矩阵，或用 4 乘函数，或用 4 乘零向量，得到的结果仍然在 M 或 F 或 Z 中，而且这八个条件很容易检验。

函数空间 F 是无限维度，比较小的空间是 P 或 P，包含所有的 n 次多项式 （polynomial）ao+a1x+.a，x」。

网址：linear.neocities.org 箱：876152660@qq.com 125

空间 Z 是一个零维空间（合理的维度定义），Z 是最小可能的向量空间，我们有点顾虑的称它为 R，表示没有分量－你可以想象成没有向量，向量空间 Z 确实具有一个向量（零）。每个向量都有自己的零向量－零矩阵，零函数，R3 中的向量 （0，0，0）。

e =M

［R 8］

［8 8］

最小的向量空间

只有零向量

图 3.1:「四维」矩阵空间 M，「零维度空间」Z。

子空间

在不同的时间，我们要求你把矩阵与函数想象成向量，但是不管什么时候，我们最需要的还是正常的列向量，他们是具有 n 个分量的向量 — 但是可能不是具有 n 个分量的全部向量。在 R」中存在重要的向量空间，他们是 R」的子空间。

从平常的三维空间 R3 开始，选择一个通过原点（0，0，0）的平面，这个平面本身就是一个向量空间。如果我们把两个在平面上的向量相加，他们的总和也会在这个平面上。如果我们把平面上的向量乘 2 或－5，得到的向量还在这个平面上。三维空间中的平面不是 R2（虽然看起来像 R2），三维向量具有三个分量，向量属于 R3，平面是 R3 中的向量空间。

现在说明线性代数中最重要的基础概念其中之一：通过（0，0，0）的平面，是整个向量空间 R3 中的子空间。

定义向量空间的子空间是一个向量的集合（包含零向量），这些向量满足两个要求：若 ν 与 w 是子空间中的向量且 c 是任意纯量，则

（i）v+w 在子空间中

（ii）cv 在子空间中

请尊重版权与译者的劳动成果，侵权必究！ 126

换言之，向量集合中的加法 v+w 及乘法 cv（与 d の）是封闭的（ closed），这些运算的结果仍然在子空间中。我们也可以执行减法，因为－w 在子空间中，且－w 与 ν 的总和是 y ー w。简单的说，所有的线性组合仍然在子空间中。

这些运算遵循主空间（host space）的规则，所以自动遵守八个必须条件，我们只需要检验子空间的线性组合的要求即可。

第一个事实：每个子空间都有零向量，R3 中的平面必须通过（0，0，0），我们会再个别讨论，再次额外强调，但是它直接遵循规则（ii），选取 c=0，所需要的 0v 就会在子空间中

不包含原点的平面无法通过试验，这些平面不是子空间。

通过原点的直线也是子空间，当我们对直线上的向量乘 5 或是直线上的两个向量相加，仍然会留在直线上，但是直线必须通过（0，0，0）。

另一个子空间是全部的 R3，整个空间是自己的子空间。下列是 R3 里面可能的子空间：

（L）任意通过（0，0，0）的直线

（R3）整个空间

（P）任意通过（0，0，0）的平面

（Z）单一向量（0，0，0）

如果我们尝试只保留一条直线或是一个平面的一部分，此时就无法满足子空间的要求。检视下列 R2 的例子－- 他们不是子空间。

范例 1 只保留大或等于零的分量的向量（x，y）（这是一个四分之一平面），包含向量（2，3），却不包含（-2，－3）。当我们尝试乘 c=-1 时，会违反规则（ii），所以四分之一平面不是子空间。

范例 2 范例 1 的条件再加上两个分量同时为负数的向量，现在有两个四分之一平面。规则（ii）满足，因为我们可以乘任意的 c。但是规则（i）失败，v=（2，3）与 w=（-3，-2）的总和是（-1，1），不在我们的两个四分之一平面上，所以不是子空间。

规则（i）及（i）与向量加法 ν+w 以及纯量 c 与 d 的乘法有关，这两个规则可以合并成为单一的要求 — 子空间的规则：

一个包含 v 与 w 的子空间，必颁包含所有的线性组合 cy+dw

范例 3 若 M 是 2×2 矩阵形成的向量空间，下列是两个子空间：

（U）所有的上三角矩阵 ［］

（D）所有的对角矩阵 ［:］

任意两个 U 的矩阵相加，总和还在 U 中。对角矩阵相加，总和还是对角。此处的 D 也是 U 的子空间。当 a，b，d 都是 0，这些子空间当然都包含零矩阵。

单位矩阵的倍数也会形成一个子空间，2I+3I 在子空间中，3 乘 4I 也在子空间中。矩阵 cI 在 M 与 U 与 D 中形成「矩阵线（line of matrix）」。

网址：linear.neocities.org 箱：876152660@qq.com 127

单位矩阵 I 是自己的子空间吗？当然不是，只有零矩阵才是。你的心里应该想到更多 2×2 矩阵的子空间了－针对问题 5 写出答案。

A 的列空间

最重要的子空间直接与矩阵 A 有关。我们尝试求解 Ax=b。若 A 不可逆，对于某些 b，系统有解；对于某些 b，系统却是无解。我们想要描述正确的右侧向量 b 可以写成 A 乘某个向量 x 的向量，这些 b＇s 形成 A 的「列空间」。

记得 Ax 是 A 的列的组合，要想得到任何可能的 b，我们使用任何有可能的 x。从 A 的列开始，取得他们所有的线性组合，就会得到 A 的列空间，这是由列向量组成的向量空间。

C（A）不仅包含 A 的 n 个列，而是包含所有列的组合 Ax。

定义列空间包含列的所有线性组合，这些组合就就是所有可能的 Ax，他们构成列空间 C（A）。

列空间对于整本书来说非常重要，我们来说明理由。求解 Ax=b 就是把 b 表示成列的组合，正确的右侧 b 必须位于左侧 A 的列空间中，否则就是无解。

系统 Ax=b 有解当且仅当 b 在 A 的列空间中。

当 b 在列空间中，它是列的组合，这个组合的系数得到系统 Ax=b 的解 x。假设 A 是 m×n 矩阵，它的列有 m 个分量（不是 n），所以列属于 Rm，A 的列空间是 Rm（不是 R」）的子空间。所有列的组合 Ax 组成的集合，满足子空间的规则（i）与（ii）：当我们把两个线性组合相加，或乘纯量时，得到的结果仍然是列的线性组合。单词「子空间」是借由取得所有的线性组合得到验证。

假设 A 是 3×2 矩阵，它的列空间是 R3 的子空间，A 的列空间是如图 3.2 所示的平面。因为只有两个列，C（A）不可能是全部的 R3。

范例 4 假设

Ax 是 142 033 省而就是 x1 142 +x2 033

这两列的所有组合（就是列空间）形成 R3 的平面。我们画出一个特别的 b（列的组合），b=Ax 落在这个平面。平面没有厚度，所以大部分 R3 中的右侧 b 不在这个列空间。因为是三个方程式与两个未知数，对于大部分的 b 来说系统都是无解。

请尊重版权与译者的劳动成果，侵权必究！ 128

+

0

A=

33

2 033

；

b

一

142

b=x1 142 +x2 033

0

+

00

Plane=C（A）= 所有向量 Ax

图 3.2：列空间 C（A）是一个包含两个列的平面，当 b 落在这个平面时，Ax=b 有

解，此时 b 是列的组合。

当然（0，0，0）会在列空间中，平面会通过原点，Ax=0 有一个当然解，这个解

一直存在，就是 x=___。

重复一次，有解的右侧 b 确实在列空间中。一种可能的解就是第一列本身，

此时 x1=1，x2=0。另一种可能的解就是第二列，此时 x1=0，x2=1。认知的新高

度在于看见所有的组合 — 整个子空间是由这两个列创建而成。

表示法 C（A）代表 A 的列空间，从这些列开始取得所有列的线性组合，我们可以

得到整个 Rm，或是一个子空间。

重要我们不从 Rm 的列开始，我们从向量空间 V 的任意向量集合 S 开始。要想

得到 V 的子空间 SS，我们选取集合内向量的所有线性组合：

S=V 的向量集合（可能不是子空间）

SS=S 的向量的所有组合（一定是子空间）

SS = 所有的 C1v1+.+CNVN=S 生成的（V 的子空间）

当 S 是列的集合，SS 就是列空间。当 S 只有一个非零向量 v，子空间 SS 就是穿

过 ν 的直线。SS 永远是包含 S 的最小子空间，这是创建子空间的基础方法，我们

还会再回来讨论。

子空间 SS 是 S 的生成（span），包含 S 中向量的所有组合。

网址：linear.neocities.org 邮箱：876152660@qq.com 129

范例 5 描述下列矩阵的列空间（他们是 R2 的子空间）：

－|4-|8-|

解 I 的列空间是整个空间 R2，每一个向量都是 I 的列的组合，以向量空间语言来说，C（I）是 R2。

A 的列空间只是一条直线，第二列（2，4）是第一列（1，2）的倍数。向量虽然不一样，但是我们着重在向量空间。这个列空间包含（2，4）与（1，2），以及其他向量（c，2c），这些向量都在同一条直线上。当 b 在这条直线时，Ax=b 才有解。

第三个矩阵（有三个列）的列空间 C（B）是整个 R2，每个向量 b 都有解。向量 b=（5，4）是列 2 加列 3，所以 x 可以是（0，1，1）。同样的向量（5，4）也是 2（列 1）+ 列 3，所以另一个可能的 x 是（2，0，1）。这个矩阵的列空间与 I 的列空间相同－任意 b 都是允许的，但是现在 x 有额外的分量，有更多的解 — 更多的组合可以得到 b。下个段落会创造一个向量空间 N（A），用来描述 Ax=0 的所有解。本段落创造了列空间 C（A），用来描述所有存在解的右侧 b。

主要观念的复习

1.R」包含所有具有实数分量的列向量。

2.M（2×2 矩阵），F（函数），Z（单一零向量）都是向量空间。

3. 包含 v，w 的子空间必须包含所有的线性组合 cv+dw。

4.A 的列的组合形成列空间 C（A），列空间是列的生成。

5. 当 b 在 A 的列空间中，Ax=b 有解。

C（A）= 列的所有组合 = 所有向量 Ax

已解范例

31A 给定 3 个不同向量 b1，2，b3，创建一个矩阵使得方程式 Ax=b1 与 Ax=b2 有解，但是 Ax=b3 无解。你如何判断这是可能的？你要如何创建 A?

请尊重版权与译者的劳动成果，侵权必究！ 130

解我们想要 b1，b2 在 A 的列空间中，则 Ax=b1 与 Ax=b2 有解。最快的方法是让 b1 与 b2 变成 A 的两个列，解就是 x=（1，0）与 x=（0，1）。

同样的，我们不希望 Ax=b3 有解，所以不再变大列空间，只留下列 b1 与 b2，问题是：是有解？是与的的

如果答案是「否」，就得到想要的矩阵 A。如果答案是「是」，就无法建立 A。当列空间包含 b1 与 b2 时，必然会包含他们所有的线性组合，如果 b3 在这个列空间中，此时 Ax=b3 必然有解。

3.1B 描述每个向量空间 V 的子空间 S，以及 S 的子空间 SS。

V1=（1，1，0，0），（1，1，1，0），（1，1，1，1）的所有组合。

V2 = 所有与 u=（1，2，1）垂直的向量，所以 u·v=0。

V3 = 所有的 2×2 对称矩阵（M 的子空间）。

V4 = 方程式 d4y/dx4=0 的解（F 的子空间）。

使用两个方式描述每个 V:「.. 的所有组合」「方程式.. 的所有解」

解 V1 从三个向量开始，一个子空间 S 来自前两个向量（1，1，0，0）与（1，1，1，0）的所有组合。S 中存在一个子空间 SS 来自第一个向量的所有倍数（c，c，0，0）。有很多可能性。

V2 的一个子空间是穿过（1，－1，1）的直线，这条直线与垂直。向量 x=（0，0，0）在 S 中，并且所有的倍数 cx 得到最小子空间 SS=Z。

对角矩阵是对称矩阵的一个子空间 S，倍数 cI 是对角矩阵的一个子空间 SS。V4 包含所有的三次多项式 y=a+bx+cx2+dx3，使得 d4y/dx4=0。二次多项式是一个子空间 S，线性多项式可以是 SS 的一个选择，常数可以是 SSS。

全部四个部分都可以选择 S=V 本身，以及 SS = 零子空间 Z。

描述每个 V:「.. 的所有组合」

「方程式.. 的所有解」

V1=3 个向量的所有组合

V1= 所有 V1-V2=0 的解。

V2=（1，0，-1）与（1，－1，1）的所有组合 V2 = 所有 u·v=0 的解。

V4=1，x，x2，x3 的所有组合

V4 = 所有 d4y/dx4=0 的解。

网址：linear.neocities.org 箱：876152660@qq.com 131

问题集 3.1

前 8 个问题 1-8 有关向量空间的一般性质，空间中的向量不需要一定是列向量。在向量空间的定义中，向量加法 x+y 与纯量乘法 cx 必须遵守 8 个规则：

（1） x+y=y+x

（2）x+（y+z）=（x+y）+z

（3）对于所有的 x 存在唯一的零向量使得 x+0=x

（4）对于每个 x 存在唯一的向量－x 使得 x+（-x）=0

（5）1 乘 x=x

（6（C1C2）x=C1（C2x）

（1）到（4）与 x+y 有关

（7）c（x+y）=cx+cy

（5）到（6）与 cx 有关

（8）（C1+C2）x=C1x+C2x

（7）到（8）产生关联

1 假设（x1，x2）+（y1，y2）定义成（x1+y2，x2+y1），伴随正常的纯量乘法 Cx=（Cx1，Cx2），

前面 8 个条件有哪些不满足？

2. 假设乘法 cx 定义成（Cx1，0）而不是（Cx1，cx2），伴随正常的 R2 加法，前面 8 个条

件有哪些满足？

3（a）如果 R1 只保留正数 x>0，前面 8 个条件有哪些崩溃？必须允许每个 c，

这条半线不是空间。

（b）对于正数来说，把 x+y 与 cx 的定义改成一般的 xy 与 x2，还是满足这 8

个条件。测试规则 7：当 c=3，x=2，y=1。（则 x+y=2，cx=8）。哪个

数字扮演零向量的角色？

4 矩降 A=［］

是所有 2×2 矩阵形成的 M 空间的一个向量，写出此空间的

零向量，向量 A/2，向量－A。哪些矩阵会在包含 A 的最小子空间中？

5 指述 M 的－个子全间包 A-

（b）若 M 的子空间确实包含 A 与 B，就一定包含 I 吗？

（c）描述 M 的一个子空间，这个子空间包含所有对角线都是 0 的矩阵。

6 函数 f（x）=x2 与 g（x）=5x 是 F 中的「向量」，这是所有实数函数的空间。（函

数定义在－∞<x<∞。）组合 3f（x）-4g（x）就是函数 h（x）=_____。

请尊重版权与译者的劳动成果，侵权必究！ 132

7 如果 f（x）乘 c 得到 f（cx），哪些规则会被破坏？保持正常的加法 f（x）+g（x）。8 如果向量 f（x）与 g（x）的总和定义成 f（g（x），则零向量就是 g（x）=x。保持正常的纯量乘法 cf（x），并且找出两个崩溃的规则。

问题 9-18 有关「子空间的要求」：x+y 与 cx（以及所有的线性组合 cx+dy）保持在空间中。

9 一个要求满足，另一个不能满足。找出例子证明：

（a）R2 的一组向量集合，其中 x+y 还在其中，但是 x/2 已经超出。

（b）R2 的一组向量集合（不是两个四分之一平面），其中 cx 还在其中，但是

x+y 已经超出。

10 哪些 R3 的集合实际上是子空间？

（a）向量（b1，b2，b3）的平面，其中 b1=b2

（b）向量（b1，b2，b3）的平面，其中 b1=1。

（c）向量（b1，b2，b3）的平面，其中 b1b2b3=0

（d）v=（1，4，0）与 w=（2，2，2）的所有线性组合。

（e）所有满足 b1+b2+b3=0 的向量。

（f）所有满足 b1≤b2≤b3 的向量。

11 描述矩阵空间 M 的最小子空间，这个最小子空间包含：

@与 O］与］

12 令 P 是 R3 的平面，方程式是 x+2y-2z=4，原点（0，0，0）不在 P 中。找出 P 的两个向量，验证他们的总和不在 P 中。

13 令 P 是通过（0，0，0）的平面，而且与前面的平面 P 平行。P 的方程式是什么？找出 Po 的两个向量，验证他们的总和在 P0 中。

14R3 的子空间是平面，直线，R3 本身，或是 Z 只包含（0，0，0）:

（a）描述 R2 的子空间的三个形式。

（b）给定 2×2 的对角矩阵形成的空间 D，请描述 D 的所有子空间。

网址：linear.neocities.org 箱：876152660@qq.com 133

15（a）两个通过（0，0，0）的平面的交集可能是 R3 的

，也可能是

，只

是不可能是 Z。

（b）一个通过（0，0，0）的平面与一条通过（0，0，0）的直线，两者的交集可能是

，也可能是

（c）若 S 与 T 是 R5 的子空间，证明他们的交集 S∩T 是 R5 的子空间。此处的

S∩T 包含同时在两个子空间中的向量。若 x 与 y 同时在两个空间中，验

证 x+y 与 cx 也在 S∩T 中。

16 假设 P 是一个通过（0，0，0）的平面，L 是一条通过（0，0，0）的直线。同时包含 P 与 L 的最小的向量空间不是

就是

17（a）证明在 M 中的可逆矩阵的集合不是子空间。

（b）证明在 M 中的奇异矩阵的集合不是子空间。

18 是非题（利用一个例子检验每个案例的加法）

（a）在 M 中的对称矩阵（AT=A）形成一个子空间。

（b）在 M 中的反对称矩阵（AT=-A）形成一个子空间。

（c）在 M 中的非对称矩阵（AT≠A）形成一个子空间。

问题 19-27 有关列空间 C（A）与方程式 Ax=b。

19 描述下列矩阵的列空间（直线或平面）：

…·용

20 哪些正确的右侧（找出 b1，b2，b3 的条件），使得系统有解？

21A 的行 1 加到行 2 得到 B，列 1 加到列 2 得到 C。（B 或 C）的列的组合也是 A 的列的组合？哪两个矩阵有相同的列

－|｝5-|5C-

22 哪些向量（1，b2，b3）使得下列系统有解？

请尊重版权与译者的劳动成果，侵权必究！ 134

23（推荐）引进额外的列向量 b 进入矩阵 A，除非，列空间会变大。各举一

个例子来说明列空间变大与列空间不变的情形。为什么只有当列空间不会变

大 —A 的列空间与［Ab］的列空间相同时，Ax=b 才有解？

24AB 的列是 A 的列的组合，意思是：AB 的列空间被包含在（有可能相等）A 的列

空间中。举例说明 A 的列空间与 AB 的列空间不相等的情形。

25 假设 Ax=b 与 Ay=b＊都有解，则 Az=b+b＊有解，求 z? 也可以表示成：若 b 与 b＊在列空间 C（A）中，则 b+b＊也在 C（A）中。

26 若 A 是任意 5×5 的可逆矩阵，则它的列空间是

，为什么？

27 是非题（如果错误，举出反例）：

（a）不在列空间 C（A）中的向量 b 形成一个子空间。

（b）若 C（A）只包含零向量，则 A 是一个零矩阵。

（c）2A 的列空间等于 A 的列空间。

（d）（A-I）的列空间等于 A 的列空间（请测试）。

28 创建一个 3×3 矩阵，它的列空间包含（1，1，0）与（1，0，1），但不包含（1，1，1）。创

建一个 3×3 矩阵，它的列空间只是一条直线。

29 若一个 9×12 的系统，给定任意的 b，Ax=b 都有解，则 C（A）=。

挑战问题

30 假设 S 与 T 是向量空间 V 的两个子空间。

（a）定义：总和 S+T 包含所有的 s+t，其中 s 来自 S 且 t 来自 T。证明

S+T 满足向量空间的要求（加法与纯量乘法）。

（b）若 S 与 T 是 R5 中的线，则 S+T 与 SUT 之间有何不同？联集（union）包

含所有来自 S 或 T 或同时来自两者的向量。说明下列的叙述：SUT 的生

成是 S+T。（段落 3.5 再出现 span 的字词）。

31 若 S 是 A 的列空间，T 是 B 的列空间 C（B），则 S+T 是哪个矩阵 M 的列空间？A 与 B 与 M 的列空间都在 Rm 中。（我不认为 A+B 永远是正确的 M）。

32 证明矩阵 A 与［AAB］（多了额外的列）有相同的列空间。但是请找出一个方形

矩阵，这个矩阵的 C（A2）比 C（A）小。重点：

只有当 n×n 矩阵 A 是一个＿_矩阵，才有 C（A）= Rn。

网址：linear.neocities.org 箱：876152660@qq.com 135

3.2A 的零空间：求解 Ax=0 与 Rx=0

1.R」中的零空间 N（A）包含所有 Ax=0 的解 x，也包含 x=0。

2. 消元法（从 A 到 U 到 R）不会改变零空间：N（A）=N（U）=N（R）。

3. 简化行阶梯形式 R=rref（A）的所有主元都是 1，上方及下方都是 0。

4. 若 R 的列 j 是自由（没有主元），则 Ax=0 会有一个 x=1 的特殊解 1。

5. 主元的数目 = R 的非零行的数目 = 秩 r，会有 n-r 个自由列。

6. 每个 m<n 的矩阵，Ax=0 的零空间中存在非零解。

本段落是有关包含所有 Ax=0 的解的子空间。一个 m×n 矩阵 A 可以是方形也

可以是矩形，右侧的 b 是零，一个立即的解就是 x=0。对于可逆矩阵而言，这是

唯一解。其他不可逆矩阵就有 Ax=0 的非零解，这些解都属于 A 的零空间。

消元法可以找到所有的解，并且鉴别这个非常重要的子空间。

零空间 N（A）包含所有 Ax=0 的解，这些向量 x 都在 R」中。

验证这些解可以形成子空间，假设 x 与 y 在零空间中（意思是 Ax=0，Ay=0），矩

阵乘法规则会得到 A（x+y）=0+0，而且 A（cx）=c0，右侧仍然都是零，因此 x+y

与 cx 都在零空间 N（A）中。我们可以在不离开零空间的情形下，完成向量加法与

纯量乘法，所以它是一个零空间。

重复说明：解 x 有 n 个分量，他们是 R」中的向量，所以零空间是 R」的一个子

空间，列空间 C（A）是 Rm 的一个子空间。

范例 1 描述 4=

的零空间，这个矩阵是奇异的：

解应用消元法至线性方程式 Ax=0:

实际上只有一个方程式，第二个方程式是第一个方程式的 3 倍。在行图中，直线

x1+2x2=0 与 3x1+6x2=0 完全相同，这条直线就是零空间 N（A），它包含所有的

解（x1，x2）。

要描述 Ax=0 的解，有一个很有效率的方法。选取一个直线上的点（一个特殊

解），所有直线上的点都是这个点的倍数。选取第二个分量 x2=1（特殊选择），依

据方程式 x1+2x，=0，第一分量必须是 x1=-2，这个特殊解是 s=（-2，1）。

1 译者注：原文的 special solution 翻译成特殊解。下个段落出现的 particular solution 翻译

成「特解」，用来区分「特殊解」。】

请尊重版权与译者的劳动成果，侵权必究！ 136

特殊解 As=0

4 = 的零空间包含 x = 的所有倍数。

借由计算 Ax=0 的特殊解，这是描述零空间最好的方法。因为我们令自由变量 x2=1，解是特殊解。

A 的零空间包含 Ax=0 的特殊解的所有组合。

范例 2x+2y+3z=0 来自 1×3 矩阵 A=［123］，Ax=0 产生一个平面，平面上所有的向量都与（1，2，3）垂直，这个平面是 A 的零空间。此处有两个自由变量 y 与 z：设成 0 与 1:

这些向量 S1 与 S2 位于平面 x+2y+3z=0，平面上所有的向量都是 s1 与 s2 的组合。注意 S1 与 S2 有何特殊，最后两个分量是自由的，我们特意选成 1，0 与 0，1，则第一分量的－2 与－3 可以由方程式 Ax=0 求得。

x+2y+3z=6 的解也是一个平面，但是这个平面不是子空间，只有 b=0 时向量 x=0 才是解。段落 3.3 会说明 Ax=b 的解（如果有解）会如何借由一个特殊解而离开零。

本段落的两个关键步骤：

（1）简化 A 得到行阶梯形式 R

（2）求 Ax=0 的特殊解

138 页所示 4×5 矩阵 A 与 R，有 3 个主元

方程式 Ax=0 以及 Rx=0 都有 5-3=2 个特殊解 s1 与 s2。主元列与自由列

A=［123］的第一列包含唯一的主元，所以 x 的第一分量不是自由，自由分量是对应到没有主元的列。特殊选择（1 或 0）只能应用在特殊解的自由变量。

范例 3 求 A，B，C 的零空间，以及 Cx=0 的两个特殊解。

C=［ 24）-3316］

网址：linear.neocities.org 箱：876152660@qq.com 137

解方程式 Ax=0 只有一个解 x=0，零空间就是 Z，它只包含 R2 的单一点 x=0。这个事实来自消元法：

A 是可逆，没有特殊解，矩阵的两个列都有主元。

矩形矩阵 B 有相同的零空间 Z。Bx=0 的前两个方程式再次需要 x=0，最后两个方程式也会强制 x=0。当我们加入额外的方程式（给了额外的行），零空间当然不能变大，多出来的行会增加零空间中的 x 更多的条件。

矩形矩阵 C 就不一样了，它有额外的列而不是额外的行，解 x 有 4 个分量。消元法会在 C 的前两列产生主元，但是 C 与 U 的后两列都是自由的，他们没有主元：

从 C 的行 2 减去 3 倍的行 1

c-38 6 16v-02

不不不不

主元列自由列

对自由变量 x3 与 x4，我们选取特殊的 1 与 0。首先 x3=1 与 x4=0，第二个是 x3=0 与 x4=1，主元变量 x1 与 x2 由方程式 Ux=0（或 Cx=0 或等效的 Rx=0）决定。我们得到 C 的零空间的两个特殊解，这个也是 U 的零空间：消元法不会改变解。

0 ←主元

－2←变量

Cs=0 与 Us=0 的特殊解 s1= 2010 s1= 0 ←自由

1」←变量

简化行阶梯形式 R

当 A 是矩形时，消元法不会在上三角 U 停止，我们可以继续使得矩阵更简化 — 有两个方法，这些步骤会得到最佳矩阵 R:

1. 在主元上方产生 0

在 R 中，利用主元行往上消元

2. 在主元产生 1

整个主元行除以自己的主元

这些步骤不会改变方程式右侧的零向量，零空间仍然保持相同：N（A）=N（U）=N（R）。当我们得到简化行阶梯形式 R=rref（A），零空间会变得更加容易观察，R 的主元列会包含 I。

请尊重版权与译者的劳动成果，侵权必究！ 138 简化形式 R

22

↑↑

我从 U 的行 1 减去行 2，然后对行 2 乘 1/2 得到主元 = 1。现在（自由列 3）=2（主元列 1），所以－2 会出现在 s1=（-2，0，1，0）。从简化系统 Rx=0 找出特殊解就容易多了。对于 R 的每个自由列，我会改变全部的符号得到 s，第二个特殊解 s2=（0，-2， 0， 1）.

转移到 m×n 矩阵与他们的零空间 N（A）以及特殊解之前，请允许我再重复一个注解。对于很多矩阵而言，Ax=0 唯一的解是 x=0，零空间 N（A）=Z（只有一个零向量）而且没有特殊解。唯一可以得到 b=0 的列组合就是「零组合」，Ax=0 的解就是平凡（trivial）解（只有 x=0），但是这个概念却不平凡。

零的零空间（zero nullspace）Z 的案例非常重要，它说明了 A 的列是无关。没有任何列的组合可以得到零向量（除了零组合），所有的列都有主元，没有自由列。你会一再的看到无关的概念。

阶梯矩阵 R 的主元变量与自由变量

p p f

0 a 0 C

A=

R= 0 1 b 0 d

0 0 0 1 e 51

a ろ 100 S2

0 0 0 0

9d0-1

3 个主元列 p

I 在主元列

特殊解 Rs1=0，Rs2=0

2 个自由列 f

F 在自由列

从 R 选取－a 到－e

由 R 显示

3 个主元：秩 = 3

Rs=0 就是 As=0

R 明确显示：列 3=a（列 1）+b（列 2），A 也必须有同样结果。

特殊解 s1 重复前述组合，使得（-a，-b，1，0，0）有 Rs1=0。

A 的零空间 = R 的零空间 = S1 与 S2 的所有组合。

下列是具有 3 个主元的 4×7 简化行阶梯矩阵 R 的步骤：

10xxx0x3 个主元变数 x1，x2，x6

01 x x x 0x

R=

4 个自由变数 x3，x4，x5，x7

00 0 001 x4 个特殊解 s 在 N（R）中

0 00 0000 主元行与主元列包含 I

问题：上述矩阵 R 的列空间是什么？零空间是什么？

网址:linear.neocities.org 箱：876152660@qq.com 139

解 R 的列有 4 个分量，所以他们在 R4 中（不是 R3！）。每个列的第四分量是 0，列的每个组合－列空间的每个向量－第四个分量都会是 0。列空间 C（R）包含所有具有（b1，b2，b3，の）形式的向量，对于这些向量可以求解 Rx=b。

零空间 N（R）是 R7 的子空间，Rx=0 的解是 4 个特殊解的所有组合－- 每个特殊解对应一个自由变量：

1. 列 3，4，5，7 没有主元，所以四个自由变量是 x3，x4，x5，x7。

2. 令一个自由变量为 1，再令其他三个自由变量为 0。

3. 求解 Rx=0 得到主元变量 x1，x2，x6，就可以求得 5。

计算主元的个数得到一个非常重要的定理。假设 A 的列数比行数多，当 n>m 时，最少存在一个自由变量，系统 Ax=0 最少有一个特殊解，这个解不是零。假设 Ax=0 的未知数的个数比方程式的个数多（n>m，列数比行数多），则至少存在一个自由列，Ax=0 有非零解。

一个矮宽矩阵（n>m 在它的零空间中必然有非零向量，由于主元的数量不可能超过 m，所以最少会有 n-m 个自由变量。（矩阵只有 m 个行，一个行不可能有 2 个主元。）当然一个行可能没有主元 — 表示存在额外的自由变量，但是重点在这里：当存在自由变量时，它就可以被设成 1，则方程式 Ax=0 最少有一个非零解。零空间是一个子空间，它的维度与自由变量的维度相等。这个中心思想 — 子空间的维度－- 本章会给与定义与说明。

矩阵的秩

数字 m 与 n 决定了矩阵的大小－但是不一定是线性系统真正的大小。比如 0=0 的方程式就不能算在里面。如果 A 有两个完全相同的行，那么第二个行在消元之后会消失。同理若行 3 是行 1 与行 2 的组合，在三角 U 中行 3 会变成都是 0，而且在简化阶梯形式 R 中也是相同情形。我们不想计算零的行，A 的真正大小是由秩（rank）来决定。

秩的定义

A 的秩是主元的数量，数值为 r。

这个定义是计算上的定义，我想要说更多有关秩 r 的事情，最后的矩阵 R 会有 r 个非零行。从一个 3×4 矩阵开始，它的秩 r=2:

4 个列，2 个主元

A 的前两个列是（1，1，1）与（1，2，3），分处不同的方向，这些是主元列（R 会显示）。第三列（2，2，2）是第一列的 2 倍，我们在第三列看不到主元。第四列（4，5，6）是前三

请尊重版权与译者的劳动成果，侵权必究！ 140

列的总和，第四列也没有主元，所以 A 与 R 的秩就是 2。

每一个自由列都是较早的主元列的组合，特殊解 s 会告诉我们这些组合： 列 3=2（列 1）+0（列 2）

S1 =（-2， －0， 1， 0）

列 4=3（列 1）+1（列 2）

S2=（-3，-1， 0， 1）

R 的第三列的数字 2 与 0 在 s1 中出现（符号相反）；R 的第四列的数字 3 与 1 在 s2 中出现（符号相反，变成－3 与－1）。

秩一

秩一的矩阵只有一个主元，当消元法在第一列产生零时，其他列也会得到零。每个行都是主元行的倍数，同时每个列都是主元列的倍数。

秩一矩阵 A=

秩一矩阵的列空间是「一维」，此处所有的列都会通过 u=（1，2，3）的直线。A 的列分别是 u，3u，10u，把这些数字放在一个行 vT=［1310］，你就可以得到特殊的秩一形式 A=uvT:

A = 列乘行 = uvT

A 是秩一时，Ax=0 很容易了解，方程式 u（vTx）=0，让我们得到 vTx=0。所有零空间中的向量 x，都必须与行空间中的 ν 垂直。当 r=1 的几何意义是：行空间 = 直线，零空间 = 垂直平面。

范例 4 当所有的行都是主元行的倍数时，秩是 r=1:

都是秩一矩阵

对这些矩阵而言，简化行阶梯 R=rref（A）可以用眼睛检验：

R = 与与与都只有一个主元

我们关于秩的第二个定义会比较高阶，它处理整个行以及整个列 — 向量而且不只是数字。全部三个矩阵 A 与 U 与 R 都有 r 个无关行。

网址：linear.neocities.org 箱：876152660@qq.com 141

A 与 U 与 R 同样也有 r 个无关列（主元列），段落 3.4 会说明无关行或是无关列的意义。

秩的第三个定义，在线性代数的顶级层次会牵涉到向量空间。秩 r 就是列空间的维度，也是行空间的维度。伟大的地方在于 n-r 就是零空间的维度。

主要观念的复习

1. 零空间 N（A）是 Rn 的子空间，包含所有 Ax=0 的解。

2. 对 A 执行消元法得到一个行简化 R，具有主元列及自由列。

3. 每个自由列得到一个特殊解，令一个自由变量为 1，其他为 0。

4. A 的秩 r 是主元的数目，R=rref（A）的所有主元都是 1＇s。

5.Ax=0 的完整解是 n-r 个特殊解的组合。

6. 若 n>m，A 总是有一个自由列，得到一个 Ax=0 的非零解。

已解范例

3.2A 若 EA=R 且 E 是可逆，为什么 A 与 R 有相同的零空间？

解

若 Ax=0 则 Rx=EAx=E0=0

若 Rx=0 则 Ax=E1Rx=E10=0

A 与 R 有同样的行空间及同样的秩。

3.2B 建立一个 3×4 矩阵 R，且 Rx=0 的特殊解是 S1 与 S2:

－3

s1=

S2= 2061

主元列 1 与 3，自由变量 x2 与 x4。

0

0

描述所有可能的矩阵 A，其中零空间 N（A）=s1 与 s2 的所有组合。

解简化矩阵 R 有主元 = 1 在列 1 与 3，没有第三个主元，所以 R 的行 3 全部是零。自由列 2 与 4 是主元列的组合：R 的 3，0，2，6 来自 s1 与 s2 的－3，－0，－2，－6。每个 A=ER。

每一个 3×4 矩阵至少有一个特殊解，这个矩阵有两个特殊解：

－0-

请尊重版权与译者的劳动成果，侵权必究！ 142

3.2C 求行简化形式 R 以及 A 与 B 个别的秩（与 c 有关）。哪些是 A 的主元列？特

殊解为何？

求特殊解

解矩阵 A 有行 2=3（行 1），如果 c 不是 4，则 A 的秩就是 2。行 3-4（行 1）的末

端得到 c-4，此时主元在列 1 与列 3，第二个变量 x2 是自由的。注意 R 的形式：

行 3 已经移到行 2。

【原文 4 是错误】

c≠4

两个主元留下一个自由变量 x2。但是当 c=4，只有列 1 有一个主元（秩 1），第二

与第三变量是自由，得到两个特殊解。

c≠4 特殊解（-2，1，0）

c=4 另一个特殊解（-1，0，1）

2c2 外它的如 c 它的是

c≠0R=［］

c=0R=［］且零空间 = R2

问题集 3.2

1 简化 A 与 B 至他们的三角阶梯形式 U。哪个变量是自由？

·

.

2 对于问题 1 的矩阵，找出每个自由变量的特殊解。（令自由变量为 1，其他自

由变量为 0）。

3 对于问题 1 的 U 执行更深入的行运算，求出简化阶梯形式 R。回答对或错，

并给出理由：R 的零空间等于 U 的零空间。

4 对于相同的 A 与 B，找出 Ax=0 与 Bx=0 的特殊解。对于 m×n 矩阵而言，

主元变量的个数加上自由变量的个数等于

。这就是「计数定理」：

r+（n-r）=n。【原文多了「same」】

@4=

（）B-

网址：linear.neocities.org 箱：876152660@qq.com 143

问题 5-14 有关自由变量与主元变量。

5 是非题（如果正确，给出理由；如果错误，给出反例）

（a）方形矩阵没有自由变量。

（b）可逆矩阵没有自由变量。

（c）m×n 矩阵最多有 n 个主元变量。

（d）m×n 矩阵最多有 m 个主元变量。

6 在 4×7 的阶梯矩阵 U 中放置最多可能的 1，使得 U 的主元列分别是

（a）2，4，5

（b）1，3，6，7 （c）4 与 6

7 在 4×8 的简化阶梯矩阵 R 中放置最多可能的 1，使得 R 的自由列分别是

（a）2，4，5，6（b）1，3，6，7，8

8 假设 3×5 矩阵的列 4 全部是 0，则 x4 必然是

变量。这个变量的特殊解是

向量 x=

9 假设 3×5 矩阵的第一列与最后一列相同（不是 0），则

是自由变量。求出

这个变量的特殊解。

10 假设 m×n 矩阵有 r 个主元，特殊解的个数是

。当 r=

时，零空间只

包含 x=0。当 r=

时，列空间是全部的 Rm。

11 当 5×5 矩阵的主元个数是

，则零空间只包含 x=0。当主元个数是

，

列空间是全部的 R5。解释为什么？

12 方程式 x-3y-z=0 决定了 R3 的一个平面，这个方程式的矩阵 A 为何？哪些是自由变量？特殊解是

与

13（推荐）平面 x-3y-z=12 与 x-3y-z=0 平行，第一个平面有一个特解是（12，0，0），所有平面上的点具有下列形式：

【填空题】

x =

+z

14 假设 4×5 矩阵有 4 个主元，且列 1 + 列 3 + 列 5=0，哪个列没有主元？特殊解为何？描述 N（A）。

问题 15-22 在特定性质下寻找矩阵（如果有的话）。

15 创建一个矩阵使得 N（A）=（2，2，1，0）与（3，1，0，1）的所有组合。

16 创建 A 使得 N（A）=（4，3，2，1）的所有组合，它的秩是

请尊重版权与译者的劳动成果，侵权必究！ 144

17 创建一个矩阵使得列空间包含（1，1，5）与（0，3，1），而且零空间包含（1，1，2）。18 创建一个矩阵使得列空间包含（1，1，0）与（0，1，1），而且零空间包含（1，0，1）与（0， 0， 1）.

19 创建一个矩阵使得列空间包含（1，1，1），零空间是（1，1，1，1）的倍数的直线。20 创建一个 2×2 矩阵使得零空间等于列空间。这是可能的。

21 为什么没有一个 3×3 矩阵的零空间等于列空间？

22 若 AB=0，则 B 的列空间被 A 的

包含。为什么？

23 一个随机选取单元的 3×3 矩阵的简化形式 R，几乎可以确定是

。若随机

的 A 是 4×3，什么样的 R 是几乎确定的？

24 举例证明这三个叙述大概率是错的:

（a）A 与 AT 有相同的零空间。

（b）A 与 AT 有相同的自由变量。

（c）若 R 是简化形式 rref（A），则 RT 就是 rref（AT）。

25 若 N（A）= 所有 x=（2，1，0，1）的倍数，R 是什么？秩是多少？

26 若 Rx=0 的特殊解在下列零空间矩阵 N 的列里面，反向回去求出简化矩阵 R 的非零行。

＊- 与＊- 与＊-| （空的 3×1）

27（a）写出 5 个 2×2 简化矩阵 R，它的单元全部是 0 或 1。

（b）写出 8 个 1×3 矩阵，它的单元全部是 0 或 1。这 8 个矩阵全部是简化阶梯

形式矩阵 R 吗？

28 解释为什么 A 与－A 有相同的简化阶梯形式 R。

29 若 A 是 4×4 且可逆，描述 4×8 矩阵［AA］的零空间。

30 若 c 男零空 X 空 NN 的关系是如何？

31 求出简化行阶梯形式 R 以及矩阵的秩:

（a）3×4 矩阵，所有的单元都是 4。

（b）3×4 矩阵，其中 aj=i+j-1

（c）3×4 矩阵，其中 a=（-1）。

网址：linear.neocities.org 箱：876152660@qq.com 145

32 基尔霍夫电流定律 Ay=0 说明在每一个节点都有「流进的电流 = 流出的电流」。在点 1，这是 y3=y1+y4。写出 4 个节点的 4 个基尔霍夫方程式（箭头的方向表示每个 y 的正方向）。简化 AT 变成 R，然后在 A（4×6 矩阵）的零空间中找出三个特殊解

y1

1

2

y4

y5

－1100

0-1 10

4

A= 10-10

y3

y2

－1001

y6

0-10 1

00-1 1

3

33 下列哪些结果是 A 的秩的正确定义？

（a）R 的非零行的个数。

（b）列的个数减去全部的行数。

（c）列的个数减去自由列的个数。

（d）矩阵 R 的 1＇s 的总数。

34 对每个（方块矩阵求出简化 R:

35 假设所有的主元变量不是一开始而是在最后才出现，描述简化阶梯形式中的所有 4 个方块（方块 B 必须是 rxr）:

36（笨问题）描述所有的 2×3 矩阵 A1 与 A2，他们的行阶梯形式是 R1 与 R2，使得 R1+R2 是 A1+A2 的行阶梯形式。在本案例中，R1=A1 且 R2=A2 正确吗？R1-R2 等于 rref（A1-A2）吗？

37 若 A 有 r 个主元列，你如何知道 AT 有 r 个主元列？举一个 3×3 例子，其中 A 与 AT 的主元列码（pivcol，意思是所在列的编号）不相同。

38 Rx=0 以及 yTR=0 的特殊解是什么？R 在下方:

请尊重版权与译者的劳动成果，侵权必究！ 146

39 空格填充使得他们的秩都是 1:

40 若 A 是 m×n 矩阵且 r=1，它的列都是某一列的倍数，它的行都是某一行的

倍数。列空间是 Rm 的

，零空间是 R」的

，零空间矩阵 N 的形状

是

41 选择向量 u 与 ν 使得 A=uvT = 列乘行：

A=uvT 是每一个秩 r=1 矩阵的自然形式。

42 若 A 是秩一矩阵，R 的第二行是

。举个例子。

问题 43-45 有关在 A 中的 rxr 可逆矩阵。

43 若 A 有秩 r，则它有 rxr 的子矩阵 S，其中 S 可逆。移除 m-r 个行及 n-r 个

列，求出分别在 A，B，C 中的可逆子矩阵 S。你可以保持主元行与主元列。

010

44 假设 P 是 m×n 矩阵中只包含 r 个主元列的子矩阵，解释为什么这个 m×r 的子

矩阵有秩 r。

45 对问题 44 的 P 取转置，求 P（这是 rxm）的 r 个主元列。反转置回来，得到在

P 与 A 中的一个 rxr 可逆子矩阵 S:

当 A - 我 PO=2 以及可题的 5=2）

问题 46-51 展示 AB 的秩不大于 A 的秩，也不大于 B 的秩。

46 求 AB 与 AC 的秩（秩一矩阵乘秩一矩阵）：

－［2］³－B156］-［！b］

47 秩一矩阵 uvT 乘秩一矩阵 wzT 等于 uzT 乘数字＿__。除非＿__=0，否则

乘积 uvTwzT 也是秩一。

网址：linear.neocities.org 箱：876152660@qq.com 147

48（a）假设 B 的列 j 是前面列的组合，证明 AB 的列 j 也是 AB 前面列的相同组

合。AB 不可能有新的主元，所以秩（AB）≤秩（B）。

求与 1 中－

49 问题 48 证明了秩（AB）≤秩（B）。同样的理由也得到秩（BTAT）≤秩（AT）。你如何推论秩（AB）≤秩（A）?

50（重要）假设 A 与 B 是 n×n 矩阵且 AB=I。由秩（AB）≤秩（A），证明 A 的秩是 n，所以 A 是可逆且 B 必须是它的双边逆矩阵（段落 2.5），因此 BA=I。（这个不是显而易见的）

51 若 A 是 2×3，B 是 3×2，且 AB=I，由秩证明 BA≠I。给出一个 A 与 B 的例子使得 AB=I。当 m<n，右侧逆矩阵不等于左侧逆矩阵。

52 假设 A 与 B 有相同的简化行阶梯形式 R。

（a）证明 A 与 B 有相同的零空间以及相同的行空间。

（b）我们知道 E1A=R 与 E2B=R，所以 A 等于一个＿_矩阵乘 B。

53 把 A 与 B 表示成两个秩一矩阵的总和：

秩 = 2

54 回答已解范例 3.2C 的相同问题：

55A，B，C 的零空间矩阵 N（包含特殊解）为何？

方块矩阵 A=［U］B=6C=［］

56 简洁的事实每一个秩 r 的 m×n 矩阵可以简化成（m×r）乘（r×n）。

A=（A 的主元列）（R 的前 r 行）=（列）（行）

写出一个全部单元都是 1 的 3×4 矩阵 A，且 A 等于（来自主元列的 3×1 矩阵）乘（来自 R 的 1×4 矩阵）的乘积。

请尊重版权与译者的劳动成果，侵权必究！ 148

挑战问题

57 假设 A 是秩 r 的 m×n 矩阵，它的简化阶梯形式是 R。精确描述矩阵 Z（它的形

状以及全部的单元），其中 Z 来自简化阶梯形式矩阵的转置 RT：R=rref（A） Z=（rref（AT）T

58（推荐）假设 R 是秩 r 的 m×n 矩阵，其中主元列放在最前面：

R=

（a）这 4 个方块的形状是什么？

（b）若 r=m，求出右逆矩阵 B，其中 RB=I。零方块消失。

（c）若 r=n，求出左逆矩阵 C，其中 CR=I。F 与 0 列消失。

（d）RT 的简化阶梯形式为何？（要有形状）

（e）RTR 的简化阶梯形式为何？（要有形状）

59 我想 RTR 的简化阶梯形式永远是 R（除了额外的零行），当 R 是 2×3，你可以举

个例子吗？稍后会展示 ATA 与 A 永远有相同的零空间（重要的事实）。

60 假设你允许对 A 操作基础列运算以及基础行运算（都得到 R），一个秩 r 的 m×n

矩阵，它的「行与列简化形式」为何？

网址:linear.neocities.org 箱：876152660@qq.com 149

消元法：大局观

本页在向量层次以及子空间层次说明消元法，其中 A 简化至 R。你知道这些步骤，我就不再重复。消元法从第一主元开始，一次移动一个列（左到右），以及一次一个行（顶到底）。当它移动时，消元法回答了两个问题：

问题 1 这一列会是前面列的组合吗？

如果这一列具有主元，答案是 no，主元列与前面的列是无关的。若列 4 没有主元，它会是列 1，2，3 的组合。

问题 2 这一行会是前面行的组合吗？

如果这一行具有主元，答案是 no，主元行与前面的行是无关的。若行 3 最终没有主元，它是一个零行，会被移动到 R 的底部。

对我来说，通过矩阵的一个动作，可以同时回答这两个问题是惊奇的。事实上这个动作得到的是三角形阶梯矩阵 U，而不是简化阶梯矩阵 R。从 U 到 R 的简化是由底部往顶端前进，U 可以分辨哪些列是较早列的组合（丢失主元），而 R 会告诉我们是什么样的组合。

换言之，R 告诉我们 Ax=0 的特殊解，我们可以借由不同的行交换以及消元步骤从 A 得到 R，但是得到的永远是同一个 R（因为特殊解是由 A 决定）。后面的术语会很快来到，R 显露了三个基础子空间的「基底（base）」：

A 的列空间－选择 A 的主元列作为基底。

A 的行空间－选择 R 的非零行作为基底。

A 的零空间－选择 Rx=0（与 Ax=0）的特殊解。

我们从消元法学到了单一个最重要的数值－秩（rank）r，这个数值就是主元列以及主元行的个数，则 n-r 就是自由列与特殊解的个数。

我曾经提过简化［AI］得到［RE］会告诉你更多关于 A 的事情－事实上是几乎全部的事情（包含 EA=R）。矩阵 E 会保存从 A 到 R 的消元记录，否则会遗失。当 A 是方形而且可逆时，R 就是 I，E 就是 A1。

请尊重版权与译者的劳动成果，侵权必究！ 150

3.3Ax=b 的完整解

1.Ax=b 的完整解：x=（一个特解 xp）+（零空间的任意 xn）。

2.［Ab］通过消元法得到［Rd］，则 Ax=b 等效于 Rx=d。

3.Ax=b 与 Rx=d 有解的条件：R 的全零行在 d 也必须是 0。

4. 当 Rx=d 有解，存在一个自由变量全部为 0 的特解（particular solution）x。5. 当零空间 N（A）= 零向量时，A 具有满列秩 r=n：没有自由变量。

6. 当列空间 C（A）=Rm 时，A 具有满行秩 r=m:Ax=b 永远有解。

7. 四种情形分别是 r=m=n（A 可逆），r=m<n（每个 Ax=b 有解），r=n<m

（Ax=b 有一个或零个解），r<m，r<n（0 或∞解）。

上个段落都在求解 Ax=0，消元法把问题转换成 Rx=0。自由变量给定特殊的值

（0 或 1），再由反向代入求得主元变量。我们没有关注右侧的 b，这是因为它一直

停留在零，解 x 在 A 的零空间中。

现在 b 不是零，作用在左侧的行运算也要作用在右侧。Ax=b 简化成比较简

单的系统 Rx=d。一种方法是将 b 加入原始矩阵作为领外列，我会加入（b，b2b3）

=（1，6，7）去制造一个增广矩阵［Ab］:

1 3 02

0014

1 3 1 6

167

1 3 0 2 1

得到増广矩阵

当我们对 A 执行正常的消元法得到 R 时，我们也对 b 执行同样的操作。

在这个范例中，我们从行 3 减去行 1，然后从行 3 减去行 2，这样在 R 得到一

整行的 0，然后把 b 变成新的右侧 d=（1，6，0）:

13 0 2

001 4

160

［1 3 021］

得到増广矩阵

001 4 6 =［R d］

0 0 0 0 0

x4

最后一个 0 非常重要，第三方程式变成 0=0，所以方程式有解。在原始的矩阵 A

中，第一行加第二行等于第三行，如果方程式是一致，方程式的右侧也要有这样

的性质。右侧 b 最重要的性质就是 1+6=7，引导至 0=0。

网址：linear.neocities.org 箱：876152660@qq.com 151

下列是对于一般 b=（b1，b2b3）的増广矩阵，其中 A 不变：

1302b1

1302b

=［R d］

1316b3

0 0 0 0 bz-b-b2

只有在 b3-b1 ー b2=0 时，第三方程式得到 0=0，就是 b1+b2=b3

一个特解 Axp=b

要想得到一个简单的解 x2，我们选择自由变量为 0:x2=x4=0，则两个非零方程式得到两个主元变量 x1=1 与 x3=6。对于 Ax=b（也是 Rx=d）的一个特解就是 x2=（1，0，6，0）。这个特解是我的最爱：自由变量 = 0，主元变量来自 d，这个方法永远有效。

若存在解，R 的零行在 d 也必须是 0。由于 I 在 R 的主元行与主元列，

则 ⅹ 特解的主元变量来自 d:

13 02

主元变量 1，6

自由变量 0，0

解 x=（1，0，6，0）

注意我们是如何选取自由变量（设成 0）与求解主元变量。行简化至 R 后，这些步骤就很快速了。当自由变量是 0，x 的主元变量已经可以在右侧的向量 d 中看见。

x 特解

特解是求解

Axp=b

X 零空间

n-r 个特殊解是求解 Ax=0

特解是（1，0，6，0），Rx=0 的两个特殊解（零空间）来自 R 的两个自由列，借由反转 3，2，4 的符号得到解。请注意我是如何把 Ax=b 的完整解写成 xp+xn:

完整解

－3

－2

0

一个 xp

x=xp+xn= +x2

+x4 －4

许多 xn

1060

3100

1

问题假设 A 是方形可逆矩阵，m=n=r，xp 与 xn 为何？

答案特解是 x2=A~`b 的唯一解，不存在特殊解或是自由变量。R=I 没有零行，零空间中只有一个向量 xn=0。完整解就是 xp+xn=A1b+0。

请尊重版权与译者的劳动成果，侵权必究！ 152

在第二章我们没有提到零空间，因为 A 是可逆，N（A）只包含零向量。从［Ab］到

［IA~b］的简化，矩阵 A 利用各种方法简化到 I，Ax=b 就变成 x=A-b 就是 d。

这是一个特殊例子，但是方形矩阵是实际上最常看到的矩阵，所以他们在本书的

开头拥有自己的章节。

对于小型的范例，我们进行［Ab］到［Rd］的简化，对于大型矩阵来说，

MATLAB 做得更好。一个特解（不一定是我们想要的）就是 x=Ab 的反斜线而已。

下列是满列秩的例子，两个列都有主元。

范例 1 求 b1，2，b 的条件，使得 Ax=b 有解，若

条件就是 b 必须在 A 的列空间中，求完整的 x=xp+xn。

解加入额外的 b 得到增广矩阵，对［Ab］执行从行 2 减去行 1，然后 2 倍的行 1

加到行 3，得到［Rd］:

如果 b1+b2+b3=0，最后的方程式是 0=0，这就是 b 进入列空间的条件，则 Ax

=b 有解。A 的三个行相加产生零行，这是为了一致性（他们是方程式！），b 的分

量相加也要是零。

因为 n-r=2-2，这个范例没有自由变量，所以没有特殊解，零空间的解是

xn=0。Ax=b 与 Rx=d 的特解就是最后一列 d 的顶端：

Ax=b 的唯一解

x=x，+x=［］+［8］

如果 b1+b2+b3≠0，则 Ax=b 无解（xp 与 x 不存在）。

这个例子是典型的重要案例：A 具有满列秩，每个列都有一个主元，秩 r=n，

矩阵是高且瘦（m≥n）。当 A 简化至 R 且秩 = n 时，行简化会把 I 放在最顶端：

R-6-］

（1）

此时没有自由列或是自由变量，零空间是 Z=｛零向量｝。

我们会收集不同的方法来辨识矩阵的形式。

网址：linear.neocities.org 箱：876152660@qq.com 153

具有满列秩（r=n）的矩阵 A 都有下列性质：

1. 所有的列都是主元列。

2. 没有自由变量或是特殊解。

3. 零空间 N（A）只包含零向量 x=0。

4. 若 Ax=b 有一个解（可能没有），则只能有一个唯一解。

下个段落的重要语言：这个 A 有无关列，只有当 x=0 才有 Ax=0。在第四章我们会对上表再加入一个事实：若方形矩阵 AA 的秩等于 n，则为可逆矩阵。在这个案例中，A（或 R）的零空间萎缩至零向量，Ax=b 的解是唯一解（如果存在的话），在 R 会有 m-n 个零行。为了在这些行得到 0=0，会存在 m-n 个条件加在 b 上，此时 b 在列空间中。

满列秩 r=n 时，Ax=b 有一个解或是无解（m>n 是过度决定）。完整解

另一个极端例子是满行秩，现在 Ax=b 有一个解或是无限多解，这种情形下 A 必须是矮宽形（m≤n）。若一个矩阵的 r=m，则矩阵有满行秩。「这些行是无关」，每个行有一个主元，以下是一个例子：

范例 2 系统 Ax=b 有 3 个未知数但是只有 2 个方程式:

满行秩

x+y+z=3

（秩 r=m=2）

x+2y- z=4

这些是 xyz 空间的两个平面，两个平面不平行，所以交会于一条直线，这条直线就是解，经过消元法之后可以看到。特解会是直线上的一个点，再加上零空间向量 x2，使得点在图 3.3 的直线上移动，则 x=xn+xn 得到整条线的解。

x=xp+xn

Ax=b 的解的直线 xp

Ax=b+0

Xn

0

Ax=0 的解的直线

图 3.3：完整解 = 一个特解 + 所有的零空间解

请尊重版权与译者的劳动成果，侵权必究！ 154 我们对［Ab］执行消元法可以得到 x 与 x，从行 2 减去行 1，然后再从行 1

减去行 2:

特解有自由变量 x3=0，特殊解有 x3=1:

x 特解直接来自右侧的 d:xp=（2，1，0）

x 特殊来自 R 的第三列（自由列）：s=（-3，2，1）

检验 xp 与 s 是否满足原始方程式 Axp=b 以及 As=0 是聪明的：

2+1=3

－3+2+1=0

2+2=4

－3+4-1=0

零空间解 xn 是 5 的任意倍数，沿着解的直线移动，起点就是 x 特解。请再次注意如

何写出答案：

完整解

解的直线画在图 3.3 中，直线的任意点都可以选成特定点，我们选的点是 x3=0。

特解不能乘任意常数，特殊解才需要常数，现在你知道为什么要得到所有零

空间的 xn。

我们现在总结满行秩的矮宽矩阵，若 m<n，方程式 Ax=b 是欠决定（很多解）。

具有满行秩（r=m）的矩阵 A 有下列性质：

1. 所有的行都有主元，R 没有零行。

2. 对于所有的右侧 b，Ax=b 一定有解。

3. 列空间是整个 Rm 空间。

4. 在 A 的零空间中有 n-r=n-m 个特殊解。

这个案例有 m 个主元，这些行是线性无关，所以 AT 的列是线性无关，AT 的零

空间是零向量。网址：linear.neocities.org 箱：876152660@qq.com 155

在总结 4 个可能性之后－与秩有关，我们已经准备好介绍线性无关的定义。请注意 m，r，n 如何成为重要数字：

线性方程式与秩 r 相关的 4 种可能性

r=m 且 r=n

方形可逆

Ax=b 有 1 个解

r=m 且 r<n

矮且宽

Ax=b 有无限多解

r<m 且 r=n

高且瘦

Ax=b 有 0 个或 1 个解

r<m 且 r<n

非满秩

Ax=b 有 0 个或无限多解

简化后的 R 与矩阵 A 是相同的种类，如果主元列碰巧在第一个出现，我们可以展示 R 的 4 个可能性。Rx=d（以及原始的 Ax=b）要有解，d 必须在尾端有 m-r 个零。F 表示 R 的自由部分。

R 的 4 种形式

［1］

［IF］

I

0

他们的秩 r=m=n r=m<n r=n<m r<m，r<n

案例 1 与 2 有满行秩 r=m，案例 1 与 3 有满列秩 r=n，案例 4 在理论上是最常见的，但是在实际上却是少见。

主要观念的复习

1. 秩 r 是主元的数目，矩阵 R 有 m-r 个零行。

2.Ax=b 有解，当且仅当最后 m-r 个方程式可以简化成 0=0。

2.

3. 一个特解 x2 的所有自由变量都是 0。

4. 主元变量是在选定自由变量后才决定。

5. 满列秩 r=n 表示没有自由变量：一个或零个解。

6. 满行秩 r=m 下，若 m=n 表示有一个解；若 m<n 表示有无限多解。

已解范例

3.3A 下面的问题把消元法（主元列与反向代入）与列空间－零空间－秩－可解性（较高层次的图）产生关联。A 的秩是 2:

1+2x2+3x3+5x4 =b

Ax=b 是 2x1+4x2+8x3+12x4=b2

3x1 +6x2 +7x3 +13x4 =b3

请尊重版权与译者的劳动成果，侵权必究！ 1561. 简化［A b］得到［U c］，使得 Ax=b 变成三角系统 Ux=c。

2. 找出 b1，b2，b3 的条件使得 Ax=b 有解。

3. 描述 A 的列空间，是 R3 的哪个平面？

4. 描述 A 的零空间，哪些是在 R4 的特殊解？

5. 简化［U c］得到［R d］：写出来自 R 的特殊解，来自 d 的特解。

6. 求出 Ax=（0，6，-6）的一个特解，然后写出完整解。

解 1. 消元法的乘数是 2，3，－1，会将［Ab］变成［Uc］。

2. 最后的方程式示有解的条件是 b3+b2-5b1=0，则 0=0

3. 第一描述：列空间是包含主元列（1，2，3）与（3，8，7）所有的线性组合的平面，主元在列 1 与 3。第二描述：列空间包含所有 b3+b2-5b1=0 的向量，使得 Ax=b 有解，所以 b 在列空间中，这是第一描述中的平面方程式。4. 特殊解有自由变量 x2=1，x4=0 然后是 x2=0，x4=1:

Ax=0 的特殊解

在 Ux=0 反向代入

s1= 2100

S2 =

或改变 R 中 2，2，1 的符号

201-1

在 R4 的零空间 N（A）包含所有 xn=C1S1+C2S2。

5.U 的第三列是（3，2，0），简化后的 R 的第三列变成（0，1，0），右侧的 c=（0，6，0）变成 d=（-9，3，0），说明了－9 与 3 在 xp 中：

6. 一个特解 x2 的自由变量都是 0，在 Ux=c 中反向代入：

Ax，=b 的特解

－9

从向量 d 得到－9 与 3 xp=

自由变量 x2 与 x4 为 0

030

Ax=（0，6，-6）的完整解就是 x=xp+xn=xp+C1S1+C2S2。

网址：linear.neocities.org 箱：876152660@qq.com 157

3.3B 假设你已经有了 Ax=b 的解的信息，其中 b 是个特定值。下列的描述会告诉你有关 m，n，r（以及 A 本身）的什么信息？以及可能关于 b 的信息？

1. 恰好有一个解。

2.Ax=b 所有的解具有 x

的形式。

3. 无解。

4.Ax=b 所有的解具有 x=

的形式

5. 有无限多解。

解案例 1 恰好有一个解，A 必颁有满列秩 r=n，A 的零空间只包含零向量。当然必须 m≥n。

案例 2 中，A 必须有 n=2 个列（m 任意），其中（1，1）在 A 的零空间中，列 2 是列 1 的负号，此外 A≠0：秩等于 1。x=（2，1）是一个解，b=2（列 1）+（列 2），我对于 xp 的选择会是（1，0）。

案例 3 中，我们只知道 b 不在 A 的列空间中，A 的秩必须小于 m。我猜我们知道 b≠0，否则 x=0 就会是一个解。

案例 4 中，A 必须有 n=3 个列，（1，0，1）在 A 的零空间中，列 3 就是列 1 的负号，列 2 不可以是列 1 的倍数，否则零空间会包含另外一个特殊解，因此 A 的秩就是 3-1=2。A 必须有 n≥2 个行，右侧 b 是列 1 + 列 2。

案例 5 有无限多解，零空间必须包含非零向量，秩 r 必须小于 n（不是满列秩），且 b 必须在 A 的列空间中。我们不知道是否每个 b 都在列空间中，所以我们不知道是否 r=m。

3.3B 针对［Ab］执行前向消元法，求出完整解 x=xp+xn:

.8 6

求出数值 y1，y2，y3 使得 y1（行 1）+y2（行 2）+y3（行 3）= 零行。验证 b=（4，2，10）满足条件 y1b1+y2b2+y3b3=0，为什么这个是方程式有解以及 b 在列空间的条件？解对于［Ab］执行前向消元法，在［Uc］中会得到一个零行，第三个方程式变成 0=0，方程式具有一致性（有解）：

12 1 0

4 1210

2

2448

02 8 6

486810

0028-6

0

列 1 与 3 包含主元，x2 与 x4 是自由变量。如果把自由变量设成 0，我们可以利用反向代入求出特解，或者我们继续操作得到 R。

请尊重版权与译者的劳动成果，侵权必究！ 158

令自由变量 = 0，Rx=d 显示特解是 xp=（7，0，-3，0）:

对于 b=0 的零空间部分 xn 来说，设定自由变量 x2 与 x4 分别是 1，0 与 0，1:

特殊解

s1=（-2，1，0，0）与 s2=（4，0，-4，1）

则 Ax=b（以及 Rx=d）的完整解就是 x 完整 = xp+C1S1+C2S2。

对 A 来说，2（行 1）+（行 2）－（行 3）=（0，0，0，0）得到 A 的零行，于是 y=（2，1， －1）。对 b=（4，2，10）而言，就是 2（4）+1（2）-1（10）=0。

如果行的组合（左侧）得到零行，则同样的组合也必须在右侧得到 0。当然，如果没有得到 0 就是无解。

稍后我们会再重复用不同的语句来说明：若 A 的每一列都与 y=（2，1，-1）垂直，这些列的任意组合 b 也必须与 y 垂直，否则 b 就不在列空间中，Ax=b 就会无解。再次重复：若 y 在 AT 的零空间中，则 y 必须垂直于所有在 A 的列空间中的 b。再往前看看..

问题集 3.3

1（推荐）执行已解范例 3.3A 的 6 个步骤，描述 A 的列空间与零空间，以及 Ax=b 的完整解：

2 对秩一的矩阵 A 执行相同的 6 个步驟，你会发现 b1，b2，b3 的两个条件使得 Ax=b 有解。这两个条件会把 b 带入

空间（两个平面得到一条线）：

问题 3-15 有关 Ax=b 的解。依据书上的步驟得到 x 与 xn，从引入 b 作为最后一列的增广矩阵开始。

3 写出 x 加上零空间中 s 的任意倍数得到完整解：

x+ 3y+ 3z= 1

2x + 6y + 9z=5

－x- 3y+ 3z=5

网址：linear.neocities.org 箱：876152660@qq.com 159

4 求出完整解（也称为通解）：

284 R>N

131

5 在 b1，b2，b3 的什么条件下系统有解？引进 b 作为第四列执行消元法，当满足

条件时，求出所有的解。x+2y-2z=b1

2x+5y-4z=b2

4x+9y-8z=b3

6 在 b1，b2，b3，b4 的什么条件下系统有解？当满足条件时，求出所有的解 x。

123

1223 2459

246

2 57

3912

7 利用消元法证明：若 b3-2b2+4b1=0，则（b1，b2，b3）在列空间中。

A 的行的什么组合得到零行？

8 哪些向量（b1，b2，b3）在 A 的列空间中？A 的行的什么组合得到零行？

··

9（a）已解范例 3.3A 中从［Ab］变成［Uc］，把乘数放进 L 并验证 LU 等于 A，

以及 Lc=b。

（b）组合 A 的主元列且数字－9 与 3 在特解 x 中，这是怎么样的线性组合？

为什么？

10 建立一个 2×3 系统 Ax=b 且特解 x2=（2，4，0）与齐性（homogeneous）解 x2=（1，1，

1）的任意倍数。

11 为什么一个 1×3 系统不能有特解 xp=（2，4，0）以及齐性解 xn=（1，1，1）的任意倍

数。

请尊重版权与译者的劳动成果，侵权必究！ 160

12（a）若 Ax=b 有两个解 x1 与 x2，求 Ax=0 的两个解。

（b）再求另一个 Ax=0 的解，以及另一个 Ax=b 的解。

13 解释为什么这些是错的：

（a）完整解是 x2 与 xn 的任意线性组合。

（b）系统 Ax=b 最多有一个特解。

（c）解 xp 设定全部自由变量为 0，是最短的解（极小长度 | x|‖）。求一个 2×2

的反例。

（d）若 A 是可逆，则零空间中不存在 xn 的解。

14 假设 U 的列 5 没有主元，则 x5 是

变量。零向量（是）（或不是）Ax=0 的

唯一解。若 Ax=b 有一个解，则它是

解。

15 假设 U 的行 3 没有主元，则此行是

。方程式 Ux=c 只有在

时，

才有解。方程式 Ax=b（有解）（无解）（可能无解）。

问题 16-20 有关「满秩」矩阵 r=m 或 r=n。

16 一个 3×5 矩阵最大可能的秩是

？在 U 与 R 的

存在主元。Ax=b

的解（永远存在）（唯一解）。A 的零空间是

。一个例子是 A=

17 一个 6×4 矩阵最大可能的秩是

？在 U 与 R 的每一个

存在一个主

元。Ax=b 的解（永远存在）（唯一解）。A 的零空间是

。一个例子是 A=

18 利用消元法求 A 的秩以及 AT 的秩：

＊‖＊＊

19 求 A 的秩，ATA 的秩以及 AAT 的秩：

与

20 简化 A 至阶梯形式 U，求三角 L 使得 A=LU。

网址：linear.neocities.org 箱：876152660@qq.com 161

21 对于下列满秩系统，求 xp+xn 的完整解形式：

）x+y+=4+2=4

22 若 Ax=b 有无限多解，为什么 Ax=B（新的右侧）不可能只有一个解？Ax=B 可能是无解吗？

23 选抒数字 q 使得（可能的话秩是（a）1，（b）2，（）3:

［³

24 给出矩阵 A 的例子，使得 Ax=b 的解的个数为：

（a）0 或 1，与 b 有关。

（b）∞，与 b 无关。

（c）0 或∞，与 b 有关。

（d）1，与 b 无关。

25 若 Ax=b 有下列的解的情形，写下所有在 r 与 m 与 n 之间已知关系：

（a）对某些 b，无解。

（b）对每个 b，无限多解。

（c）对某些 b，恰好唯一解；对其他 b 无解。

（d）对每个 b，恰好唯一解。

问题 26-33 有关高斯－乔丹消元法（向上也向下）以及简化阶梯矩阵 R。

26 从 U 到 R 继续使用消元法，每个行除以自身的主元使得新主元都是 1，然后产生主元上方的 0 得到 R:

27 若 A 是三角矩阵，什么时候 R=rref（A）=I?

28 应用高斯－乔丹消元法至 Ux=0 以及 Ux=c，得到 Rx=0 与 Rx=d:

［uo）-］［ ¢－s］

请尊重版权与译者的劳动成果，侵权必究！ 162

29 应用高斯－乔丹消元法简化至 Rx=0 以及 Rx=d:

求解 Ux=0 或 Rx=0 得到 xn（自由变量 = 1）。Rx=d 的解为何？

30 简化至 Ux=c（高斯消元法），然后至 Rx=d（高斯－乔丹）:

224 309

250 =b

求出特解 xp 以及所有的齐性解 xn。

31 给定下列的性质，求出矩阵 A 与 B。如果无法求解，给出理由：

Ax = 的解是 x-

0x - 的唯 M 是 x-

32 求 A 的 LU 分解，以及 Ax=b 的完整解。然后 b= 1000

3Ax = 的完整解是 x=+c，求 A.

网址：linear.neocities.org 箱：876152660@qq.com 163

挑战问题

34（推荐）假设你知道 3×4 矩阵 A 有向量 s=（2，3，1，0）作为 Ax=0 的唯一特殊解：

（a）A 的秩为何？Ax=0 的完整解为何？

（b）A 的确切的行简化阶梯形式 R 为何？

（c）你如何知道对于所有的 b，Ax=b 有解？

35 假设 K 是 9×9 的第二差分矩阵（2＇s 在对角线，－1 在对角线的上方及下方），求解方程式 Kx=b=（10，..，10）。如果在 x 轴的点 1，..，9 的上方画出对应的点画出 x1，.，x9，我想这 9 个点会是一个抛物线。

36 假设对于每一个 b，Ax=b 与 Cx=b 都有相同（完整）的解，则 A 等于 C 是对的吗？

37 描述简化阶梯形式 R 的列空间。

请尊重版权与译者的劳动成果，侵权必究！ 164

3.4 无关，基底与维度

1.A 的无关列：Ax=0 的唯一解是 x=0，零空间是 Z。

2. 无关向量：组合 C1v1+.+CkVk=0 时，必然所有的 C＇s 都是 0。

3. 矩阵的 m<n 时，会有相关的列：最少 n-m 个自由变量 / 特殊解。

4. 若 S 是所有向量 v＇s 的组合，则 v1，..，v 生成空间 S。

5. 若向量 ν1，.，是无关而且生成 S，则他们是 S 的一组基底 1。

6. 空间 S 的维度是 S 的每一组基底的向量个数。

7. 若 A 是 4×4 的可逆矩阵，则 A 的列是 R4 的一组基底，R4 的维度是 4。

这个重要段落是关于子空间的真实大小，m×n 的矩阵有 n 个列，但是列空间

的真实维度不一定是 n。维度的量测是依据无关列的个数 — 我们必须说明它的意

义，我们会看到列空间的真实维度就是秩 r。

在任意的向量空间中，都可以针对向量 ν1，..，5 使用无关的概念。本段落大部

分聚焦在我们知道且常用的子空间 — 特别是 A 的列空间与零空间。前个部分我们

学习了「向量」不一定是列向量，他们可以是矩阵与函数，他们可以是线性无关

（或是相关）。第一个关键范例使用列向量。

我们的目标是了解基底：生成空间的无关向量。

空间中的每一个向量都是基底向量唯一的组合。

我们位于主题的中心，没有基底就不能继续前进。本段落（第一个实际意义的暗

示）4 个重要的观念是：

1. 无关向量

（没有额外向量）

2. 生成一个空间

（足够的向量去产生剩余的向量）

3. 空间的基底

（不太多也不太少）

4. 空间的维度

（基底中向量的个数）

线性无关

无关的第一个定义不是那么传统，但是你应该准备充分了。

定义当 Ax=0 的唯一解是 x=0，A 的列是线性无关。没有其他的列组合 Ax

是零向量。

` 译者注：基底会包含数个向量，所以用「组」当做基底的单位。网址：linear.neocities.org 邮箱：876152660@qq.com 165

当零空间 N（A）只有一个零向量时，A 的列是线性无关。让我们用 R3 的 3 个向量来说明线性无关（与相关）：

1. 若 3 个向量不在同一个平面，他们是无关的。除了 0v1+0v2+0v3 得到零向量之外，不存在 ν1，V2，V3 的组合可以得到零向量，如图 3.4 所示。

2. 若 3 个向量 w1，w2，w3 在同一个平面，他们是相关的。

U1

同一个平面

不同一

0

个平面

02

W3

03

W2

W1

图 3.4：无关向量 V1，v2，v3，只有在 0v1+0v2+0v3 得到零向量。相关向量 w1，w2，w3， 组合 w1-w2+w3=（0，0，0）。

把无关的观念应用到 12 维空间的 7 个向量，如果他们是 A 的列，而且是无关，则零空间只包含零向量。7 个向量中没有任何一个是其他 6 个向量的组合。

现在我们用不同的词语来表达同样的概念，下列无关的定义会应用至任意向量空间中的任意向量序列。当向量是 A 的列，这两个定义完全相同。

定义如果唯一得到零向量的组合是 Ov1+Ov2+.+0vn，则向量序列 v1，.，vn 是线性无关。

线性无关

x1v1+x2v2+.+xnvn=0 只在 x＇s 全是 0 的时候发生。

（1）

当 x＇s 不全是 0，如果存在一个组合得到 0，这些向量就是线性相关。

正确的语言：「向量序列是线性无关。」可接受的短语：「向量是无关」。不可接受的：「矩阵是无关」。

一个向量序列不是相关就是无关，他们的组合可以得到零（x＇s 不全是 0），也可能无法得到。所以关键问题是：什么样的向量组合可以得到零向量？我们从 R2 一些小范例开始:

（a）向量（1，0）与（0，1）是无关。

（b）向量（1，0）与（1，0.00001）是无关。

（c）向量（1，1）与（-1，－1）是相关。

（d）向量（1，1）与（0，0）是相关，因为有零向量。

（e）在 R2 中，任意 3 个向量（a，b）与（c，の与（e，）是相关。

请尊重版权与译者的劳动成果，侵权必究！ 166

从几何来看，（1，1）与（-1，－1）在一条通过原点的直线上，他们是相关。使用定义，

求 x1 与 x2 使得 x1（1，1）+x2（-1，-1）=（0，0），这个如同求解 Ax=0:

=］-［ 得到 x1=1，x2=1

当零空间中有非零向量，这些列确实是相关。

如果其中一个 ν 是零向量，就不可能是无关，为什么？

在 R2 中的 3 个向量不可能是无关，有一个方法可以看出：矩阵 A 有三个列必

然会有一个自由变量，对于 Ax=0 就会有一个特殊解。另一种方法：如果前两个

向量是无关，他们的某种组合会得到第三个向量，详情见下面第二个高亮处。

现在回到 R3 中的 3 个向量，若其中一个是另外一个的倍数，这些向量是相关。

但是完整的测试是三个向量同时进行，我们把他们放到一个矩阵，然后试着求解

Ax= 0.

范例 1A 的列是相关，Ax=0 有一个非零解：

矩阵的秩只有 r=2。无关列会产生满列秩 r=n=3。

在这个矩阵中，行也是相关。行 1 减去行 3 是零行。对于方形矩阵而言，可

以证明「相关的列」则有「相关的行」。

问题：如何求解 Ax=0? 系统化的方法是消元法：

1 0 3

103

A=|2 1 5

简化得到 R=01-1

10 3

00

解 x=（-3，1，1）恰好就是特殊解，可以说明自由列（列 3）如何成为主元列的组合，

这就杀死了无关。

满列秩当 A 的秩恰好 r=n 时，则 A 的列是无关：有 n 个主元，没有自由变

数，只有 x=0 在零空间中。

有一种情形特别重要，这是因为从开头它就很清楚。假设有 7 个列，每个列

有 5 个分量（m=5 小于 n=7），这些列必然是相关。R5 中的 7 个向量是相关，A

的秩不可能大于 5，5 个行不可能有超过 5 个主元。Ax=0 最少有 7-5=2 个自

由变量，所以有非零解 — 这就表示列是相关。

若 n>m，则 Rm 的任意 n 个向量必然是相关。

网址：linear.neocities.org 箱：876152660@qq.com 167

这种类型矩阵的列比行多 — 属于矮宽形。若 n>m，这些列必然是相关，这是因为 Ax=0 有非零解。

若 n≤m，这些列可能相关也可能无关。从消元法会得到 r 个主元列，这 r 个主元列是无关。

注意：另一种描述线性相关的方法是:「一个向量是其他向量的组合。」听起来很简洁，为什么我们不从这个方法开始？我们的定义比较长:「除了每个系数 x 都是零的平凡组合外，存在某个组合可以得到零向量。」我们必须排除简单方法可以得到零向量的可能，零的平凡组合让每位作者都很头痛。如果一个向量是其他向量的组合，这个向量的系数是 x=1。

有一点要说明，我们的定义并没有把选出一个特定向量视为罪恶，A 的所有列都是等同对待。我们检视 Ax=0，方程式有非零解也可能没有。在最后，这个会比询问最后一列（或第一列，或中间的某一列）是否为其他列的组合来的较好。

向量生成子空间

本书第一个子空间是列空间，从列 ν1，.，ν 开始，子空间被所有的组合 x1ν1+.+xnv 填满，列空间包含列的所有组合 Ax。我们现在介绍单一的单词 span（生成），它的描述是：列空间是被列生成。

定义若一个向量集合的线性组合填满一个空间，则向量集合生成这个空间。

矩阵的列生成它的列空间，他们可能是相关。

范例 2

生成整个二维空间 R2。

3［¦］］［也生成整个空间 R2。

只生成 R2 的一条直线，w1 自己就能做到。

考虑两个 3 维空间中由（0，0，0）出发的两个向量，一般来说会生成一个平面。你的心里会想可以由他们的线性组合得到这个平面。数学上来说，你还知道有其他可能性：两个向量可以生成一条直线，三个向量可以生成整个 R3，或者只生成一个平面，甚至有可能三个向量只生成一条直线，或是 10 个向量只生成一个平面。他们当然不是无关。

列生成列空间，有个新的子空间－由行生成。行的组合得到「行空间」。

请尊重版权与译者的劳动成果，侵权必究！ 168

定义矩阵的行空间是 R」的子空间，行生成行空间。

A 的行空间是 C（AT），就是 AT 的列空间。

m×n 矩阵的行有 n 个分量，他们是 R」的向量－- 或者把他们直接写成列向量。有一个快速的方法可以做到：转置矩阵。不再关注 A 的行，而是检视 AT 的列。同样的数字，但是在列空间 C（A①）中。A 的行空间是 R」的子空间。

范例 5 描述 A 的列空间与行空间。

= 与此处 m-3.n-2.

A 的列空间是 R3 的平面，由 A 的两个列生成。A 的行空间由 A 的三个行（A 的列）生成，行空间是全部的 R2。记得：这些行在 R」中生成了行空间，列在 Rm 中，生成了列空间。同样的数字，不同的向量，不同的空间。

向量空间的基底

两个向量不能生成整个 R3，纵使他们是无关。四个向量不可能是无关，纵使他们生成 R3。我们想要有足够无关向量去生成空间（不能超过），基底就是我们想要的。定义向量空间的一组基底是由一序列的向量组成，具有两个性质：

基底向量是线性无关，他们生成了空间。

这两个性质的组合是线性代数的基础，空间中的每一个向量 ν 都是基底向量的组合，因为他们生成这个空间。除此之外，得到 ν 的组合是唯一的，因为基底向量 V1，..，Vn 是无关。

存在一个而且只有一个方式将 ν 写成基底向量的组合。—

理由：假设 v=a1v1..+ann，且 v=b1v1..bnn，两式相减得到（a1-b1）1.+（an-bn）yn=0。基于 v 的无关性，每个 a1-b1=0，所以 a1=b1，不存在两种方式得到 v。

范例 6-9 的列产生的标准基 m

网址：linear.neocities.org 箱：876152660@qq.com 169

，他

每个人都会先想到这组基底，向量 i 是横跨移动，j 是铅直移动。3×3 单位矩阵的列就是标准基底 i，j，k，n×n 单位矩阵的列就是 R」的标准基底。

现在我们发现了其他很多基底（无限多），基底不是唯一。

范例 7（重要）每一个可逆的 n×n 矩阵所有的列，是 R」的一组基底：

可逆矩阵

奇异矩阵

列空间是 R3

列空间≠R3

Ax=0 的唯一解是 x=A-0=0，列是无关，他们生成整个空间 R」－因为每个向量 b 都是列的组合，Ax=b 永远可以求解 x=A~`b。你看出来每件事情都跟可逆矩阵有关吗？用一句话来说明:

当向量 v1，..，vn 恰好是一个 n×n 可逆矩阵的列时，这些向量是 R」的一组基底，于是 R」有无限多基底。

当列是相关，我们只保存主元列－上述 B 的前两个列具有两个主元。他们是无关且生成列空间。

A 的主元列是列空间的一组基底，A 的主元行是行空间的一组基底。阶梯形式 R 的主元行也是如此。

范例 8 一个不可逆矩阵，它的列不是任何空间的基底。

一个主元列

一个主元行（r=1）4 = 简化成 R=［

A 的列 1 是主元列，单独这个列是列空间的基底。A 的第二列可以是一个不同的基底，列 1 所有的非零倍数都是基底。我们不缺基底，一个肯定的选择是主元列。注意 R 的主元列（1，0）的尾端是 0，这是 R 的列空间的一组基底，但是它不属于 A 的列空间，A 与 R 的列空间不相同，他们的基底也不相同（他们的维度相同）。A 的行空间与 R 的行空间相同，它包含（2，4），（1，2）以及这些向量全部的其他倍数，我们永远有无限多的基底可以选择，这些基底来自前述的向量。一个自然的选择是选取 R 的非零行（有主元的行），所以这个秩一的矩阵 A 只有一个向量在基底中：

请尊重版权与译者的劳动成果，侵权必究！ 170

列空间的基底 23

行空间的基底 12

下一章会再探讨列空间与行空间的基底，我们很高兴遇到刚开始的范例，其中的情景很清晰（基底的概念还是新的）。下个例子比较大，但是一样很清晰。

范例 9 求出列空间与行空间的基底，其中的矩阵是秩二。

1203

R=|0 0 1

0000

列 1 与 3 是主元列，他们是 R 的列空间的一组基底。列空间中的向量全部具有 b=（x，y，0）的形式，R 的列空间是整个三维 xyz 空间中的「xy」平面，这个平面不是 R2，而是 R3 的子空间。列 2 与 3 也是相同列空间的一组基底，R 的哪两个列不是列空间的一组基底？

R 的行空间是 R4 的子空间，这个行空间的最简单基底就是 R 的两个非零行。第三行（零向量）也在行空间中，但它不是行空间的基底，基底向量必须无关。

问题：给定 R7 的 5 个向量，如何求得这 5 个向量生成的空间的一组基底？

第一答案：把这些行变成矩阵 A 的行，利用消元法找到 R 的非零行。

第二答案：把这 5 个向量变成矩阵 A 的列，利用消元法找到 A 的主元列（不是 R 的），这些主元列就是列空间的一组基底。

其他的基底有可能具有更多或是更少的向量吗？这是一个很重要的问题，它的答案是 no，向量空间所有的基底都具有相同的向量数目。

任何一组基底的向量的个数，就是空间的维度。

向量空间的基底

我们必须证明前面的说法。存在很多种方法来选取基底向量，但是每组基底向量的个数永远不会改变。

若 v1，..，m 与 w1，.，wn 都是同一个向量空间的基底，则有 m=n。

证明：假设 w 的数目比 ν 多，n>m，我们希望得到矛盾。全部 ν 向量构成一组基底，所以 w1 必须是 ν 向量的组合。

网址：linear.neocities.org 箱：876152660@qq.com 171

若 w1=a11v1+..+am1vm，这是矩阵乘法 VA 的第一列：

=VA

我们不知道每个 a，但是我们知道 A 的形状（它是 m×n）。第二个向量 w2 也是向量 v＇s 的组合，组合的系数得到 A 的第二列。关键是 A 对于每个 ν 有一行，对于每个 w 有一列。由于假设 n>m，所以 A 是一个矮宽矩阵，Ax=0 有一个非零解。Ax=0 得到 VAx=0，也就是 Wx=0，w 的组合得到零！所以这些 w 不能成为基底 — 我们的假设 n>m，对于两组基底来说是不可能的。

如果 m>n，我们交换 ν 与 w，再重复刚才的步骤。唯一避免矛盾的方法就是 m=n，我们完成了 m=n 的证明。

基底向量的个数与空间有关 — 不是与特定的基底有关。每组基底的数字都会相同，这个数字就是空间的自由度，空间 R」的维度是 n。我们现在介绍一个重要的单词「维度」，也适用于其他的向量空间。

定义

一个空间的维度就是每组基底的向量个数。

这个配我们的直觉，通过 y=（1，5，2）的直线的维度是 1，它是一个子空间，这个子空间的基底是一个向量 ν。垂直这条直线的平面是 x+5y+2z=0，这个平面的维度是 2。要证明前面的推论，我们知道一组基底是（-5，1，0）与（-2，0，1），因为基底有两个向量，所以维度是 2。

这个平面是矩阵 A=［152］的零空间，其中有两个自由变量。我们的基底（-5，1，0）与（-2，0，1）是 Ax=0 的特殊解。下个段落会展示 n-r 个特殊解永远可以得到零空间的一组基底。C（A）有维度 r，零空间 N（A）有维度 n-r。

线性代数语言的注解我们没有说过「空间的秩」或是「基底的维度」或是「矩阵的基底」，这些术语是没有意义的。我们说「列空间的维度等于矩阵的秩」。

矩阵空间的基底与函数空间

这些单词「无关」「基底」「维度」并不局限在列向量。我们可以询问三个矩阵是否无关，这些矩阵是在所有 3×4 矩阵形成的空间中，某些组合可能会得到零矩阵。我们也可以询问所有 3×4 矩阵形成的矩阵空间的维度是多少？（答案是 12）。微分方程式 d2y/dx2=y 有一个解空间，其中一组基底是 y=ex 与 y=ex，计算基底函数的个数，得到所有解组成的空间的维度是 2。（因为是二次导数，所以维度是 2）。

请尊重版权与译者的劳动成果，侵权必究！ 172

矩阵空间与函数空间在 R」之后看起来会有点小奇怪，但是在某个方面来说，直到你可以应用基底与维度到列向量之外的「向量」之前，你还没有完全了解基底与维度的概念。

矩阵空间向量空间 M 包含所有的 2×2 矩阵，它的维度是 4。

一组基底是

［］［］［8］［°］

这些矩阵是线性无关，我们检视的不是列向量，而是整个矩阵。这 4 个矩阵的组合可以产生 M 的任意矩阵，所以他们生成了空间：

每个 A 都是基

底矩阵的组合 c +osdstods ted--a

只有在所有的 c 都是零，A 才会是零－这个证明了 A1，A2，A3，A4 的无关性。

三个矩阵 A1，A2，A4 是子空间的一组基底－上三角矩阵，它的维度是 3。A1 与 A4 是对角矩阵的一组基底。请问对称矩阵的基底是什么？保持 A1 与 A4，剩下两个单元填入 A2+A3。

更深入的说，考虑所有 n×n 矩阵形成的空间，一个可能的基底就是每个矩阵都只在一个单元有非零数（单元是 1），有 n2 个位置是 1，所以有 n2 组基底矩阵。整个 n×n 矩阵形成的空间，维度是 n2。

上三角矩阵形成的子空间，维度是 n2/2+n/2。

对角矩阵形成的子空间，维度是 n。

对称矩阵形成的子空间，维度是 n2/2+n/2（为什么？）

函数空间方程式 d2y/dx2=0 与 d2y/dx2=-y 与 d2y/dx2=y 与二次导数有关，利用微积分的技巧我们求解函数 y（x）:

y＂=0，

解是任意函数 y=cx+d

y＂=-y，1

解是任意组合 y=csinx+dcosx

y＂=y，解是任意组合 y=cex+de-x

y＂=-y 的解空间有两个基底函数 sinx 与 cosx；y＂=0 的解空间有 x 与 1，这个是二次导数的零空间！每个案例的维度都是 2（这些是二阶方程式）。

y＂=2 的解无法形成子空间－右侧的 b=2 不是 0，存在一个特定 y（x）=x2，完整解是 x2+cx+d，这样的函数都满足 y＂=2。注意：特解加上零空间中任意的函数 cx+d。线性微分方程式就好像矩阵方程式 Ax=b，只是我们利用微积分求解，而不是线性代数。网址：linear.neocities.org 箱：876152660@qq.com 173

我们以只包含零向量的空间 Z 作为结束，这个空间的维度是 0，空集合（没有任何向量）是 Z 的基底。因为会失去线性无关性，我们不再允许基底包含零向量。

主要观念的复习

1. 若 x=0 是 Ax=0 的唯一解，则 A 的列是线性无关。

2. 若向量 v1，.，v，的组合填满一个空间，则这些向量生成了空间。

3. 基底包含线性无关的向量，这些向量生成 S，空间中的每个向量都是基底

向量的唯一组合。

4. 空间的所有基底有相同的向量个数，基底的向量个数就是空间的维度。

5. 主元列是列空间的一组基底，维度是 r。

已解范例

3.4A 从向量 v1=（1，2，0）与 v2=（2，3，0）开始，（a）是否是线性无关？（b）是否是任意空间的基底？（c）会生成什么空间 V?（d）空间 V 的维度 =?（e）哪个矩阵 A 的列空间是 V?（f）哪个矩阵 A 的零空间是 V?（g）描述所有的向量 v3， 使得 V1，V2，V3 可以是 R3 的基底。

解

（a）v1 与 v2 是线性无关－— 得到 0 的唯一组合是 Ov1+Ov2=0。

（b）Yes，他们是生成空间的一组基底。

（c）空间 V 包含所有向量（x，y，0），这是 R3 中的 xy 平面。

（d）空间 V 的维度是 2，因为基底有两个向量。

（e）若 A 的每个列都是 v1 与 v2 的组合，则空间 V 是任意 3×n 矩阵 A 的列空间，A

的秩为 2。特定的 A 可以只有 ν1 与 ν2 作为列。

（f）若 B 的每个行都是（0，0，1）的倍数，则空间 V 是任意 m×3 矩阵 B 的零空间，B

的秩是 1。特定的 B 选成 B=［001］，则有 Bv1=0 与 Bv2=0。

（g）加入任意第三个向量 y3=（a，b，c），其中 c0，可以组成 R3 的基底。

请尊重版权与译者的劳动成果，侵权必究！ 174

3.4B 从三个无关向量 w1，w2，w3 开始，这些向量的组合得到 v1，v2，v3，组合的矩阵形式可以写成 V=WB:

V=w+ w2

v2=w1+2w2+w3 就是 V1 V2 V3

WY W2 w

V3 = W2+ CW3

针对 B 进行什么样的测试，可以验证 V=WB 具有无关的列？若 c≠1，证明 v1，v2，v3 是线性无关。若 c=1，证明 v1，v2，v3 是线性相关。

解可以利用第一个定义测试 V 的列的无关性：V 的零空间必须只包含零向量，则 x=0 是列的唯一组合使得 Vx = 零向量。

若问题中的 c=1，我们可以从两个方面看出相关性：首先 v1+y3 会等于 v2（如果你把 w1+w2 与 w2+w3 相加会得到 w1+2w2+w3=V2，换言之，V1-v2+V3=0 - 说明所有的 ν 向量不是线性无关。

另一个方法是检视 B 的零空间。若 c=1，则 x=（1，-1，1）在零空间中，且 Bx=0，当然 WBx=0，也就是 Vx=0，因此所有的 ν 向量是相关。来自零空间的特定 x=（1，-1，1）再次告诉我们 v1-v2+v3=0。

现在假设 c≠1，矩阵 B 是可逆的，如果 x 是任意非零向量，我们知道 Bx 不是零。由于 V=WB，就是说 x 不在 V 的零空间中，换言之，v1，v2，v3 是无关。

通用的规则就是「当 B 可逆时，来自无关 w 的 ν 也是无关。」如果这些向量是在 R3 中，他们不只是无关，还是 R3 的一组基底。

「当基底转换矩阵 B 是可逆，来自基底 w 的 ν 也是基底。」

3.4C（重要范例）假设 v1，..，vn 是 R」的一组基底，且 n×n 矩阵 A 可逆。证明 Av1，..，Av2 也是 R」的一组基底。

解以矩阵语言来说：把基底向量 v1，..，vn 放在一个可逆矩阵 V 的列，则 Av1，.，Avn 就是 AV 的列。由于 A 是可逆，因此 AV 也是可逆，AV 的列就是一组基底。

以向量语言来说：假设 C1Av1+.+CnAvn=0，可以写成 Av=0，其中 v=C1v1+.+CnVn。左乘 A~1 使得 ν=0，由于所有 v＇s 向量的无关性，所有的 c；必然是 0，我们证明了所有 Av＇s 向量是无关。

现在证明所有的 Av＇s 向量生成 R」，求解 C1Av1+..+CnAvn=b，等效于求解 C1v1+.+Cnvn=A-1b，由于 v＇s 向量是一组基底，前式必然有解。

网址：linear.neocities.org 箱：876152660@qq.com 175

问题集 3.4

问题 1-10 有关线性无关与线性相关。

1 证明 V1，V2，V3 是线性无关，但是 V1，V2，V3，V4 是线性相关：

V1= 100 V2 = 110 V3= 111 V4= 234

求解 C1v1+C2v2+C3V3+C4V4=0 或 Ax=0，把 v＇s 引入 A 的列。

2.（推荐）求出下列向量极大可能的无关向量个数。

= 1100 V2 = 1010］ V3 = 1001］ V4= 0110 V5 = 0101］ V6 = 0011

3 证明：若 a=0 或 d=0 或 f=0（3 种情形），U 的列是相关：

00f

4 若问题 3 的 a，d，f 全部不是 0，证明 Ux=0 的唯一解是 x=0，且上三角 U 有

无关的列。

5 决定无关或相关：

（a）向量（1，3，2），（2，1，3），（3，2，1）

（b）向量（1，－3，2），（2，1，－3），（-3，2，1）

6 选择 U 的 3 个无关的列，然后做出另外两种选择，对 A 做同样的事情：

2341

2341

0 67 0

0670

U=

与 A=

0009

0009

4 6 82

7 若 W1，W2，W3 是无关向量，证明差 V1=W2-W3，v2=W1-W3，V3=W1-W2 是相关。

找出 v＇s 得到 0 的组合。前式写成［v1v2v3］=［w1w2w3］A，请问 A 是奇

异吗？

8 若 W1，W2，w3 是无关向量，证明和 v1=W2+W3，v2=W1+W3，v3=W1+W2 是无关。

（将 C1V1+C2V2+C3v3=0 写成 w＇S 的项，求解方程式得到 c＇s，证明都是 0）

请尊重版权与译者的劳动成果，侵权必究！ 176

9 假设 V1，V2，V3，V4 是 R3 的向量。

（a）这 4 个向量是无关，因为

（b）向量 v1 与 v2 是无关，如果

（c）向量 v1 与（0，0，0）是相关，因为

10 在 R4 的平面 x+2y-3z-t=0 中，找出两个无关向量，再找出 3 个无关向量。

为什么找不到 4 个？这个平面是哪个矩阵的零空间？

问题 1-14 有关一组向量集合生成空间，选取向量的所有线性组合。

11 描述下列向量生成的 R3 的子空间（线或平面或 R3?）

（a）两个向量（1，1，－1）与（-1，－1，1）

（b）三个向量（0，1，1）与（1，1，0）与（0，0，0）

（c）所有 R3 中分量是整个数值的向量。

（d）所有 R3 中分量是正数的向量。

12 当

有解时，向量 b 在 A 的列生成的子空间中。当

有解时，

向量 c 在 A 的行空间中。

是非题：若零向量在这个行空间中，行是相关。

13 求出 4 个空间的维度，哪两个空间是相同的？（a）A 的列空间（b）U 的列空间

（c）A 的行空间（d）U 的行空间：

0

1

3

0

0

14 v+w 与 v-w 是 ν 与 w 的组合，将 ν 与 w 写成 v+w 与 v-w 的组合。这两对

向量

相同的空间，在什么条件下，他们是这个相同空间的基底？

问题 15-25 有关基底的要求。

15 如果 v1，.，vn 是线性无关，他们生成的空间的维度是＿__。这些向量是空间

的一组

。如果这些向量是一个 m×n 矩阵的列，则 m__n。如果 m=

n，矩阵是

16 求出每个 R4 的子空间的一组基底：

（a）所有分量相等的向量。

（b）所有分量相加等于 0 的向量。

（c）所有垂直于（1，1，0，0）与（1，0，1，1）的向量。

（d）I（4×4）的列空间与零空间。

网址：linear.neocities.org 箱：876152660@qq.com 177

间的两组不同基底。

18 假设 ν1，ν2，.，6 是 R4 的 6 个向量。

（a）这些向量（会）（不会）（可能不会）生成 R4。

（b）这些向量（是）（不是）（可能是）线性无关。

（c）其中任意 4 个向量（是）（不是）（可能是）R4 的一组基底。

19A 的列是来自 Rm 的 n 个向量，如果他们是线性无关，A 的秩为何？如果他们生成 Rm，秩是多少？如果他们是 Rm 的一组基底，秩是多少？往前看：秩 r 是

列的个数。

20 求出 R3 的平面 x-2y+3z=0 的一组基底，然后求出这个平面与 xy 平面的交集，然后求出所有垂直于这个平面的向量。

21 假设 5×5 矩阵 A 的列是 R5 的一组基底。

（a）因为

，方程式 Ax=0 只有唯一解 x=0。

（b）若 b 在 R5 中，因为基底向量

R5，方程式 Ax=b 有解。

注意：A 是可逆，它的秩是 5，它的行也是 R5 的一组基底。

22 假设 S 是 R6 中的 5 维子空间，是非题（如果错误，举出例子）。

（a）额外加入一个向量，S 的每一组基底都可以延伸成为 R6 的一组基底。（b）移除一个向量，R6 的每一组基底都可以简化成为 S 的一组基底。

23 把 A 的行 3 减去行 1 得到 U:

「1 3 2

1 3 2

A= 0

1 与 U=011

3 2

0 0 0

求出两个列空间的基底，求出两个行空间的基底，求出两个零空间的基底，哪个空间在消元法过程中保持固定。

24 是非题（给出理由）。

（a）如果矩阵的列是无关，行也会是无关。

（b）2×2 矩阵的列空间与它的行空间相同。

（c）2×2 矩阵的列空间与行空间有相同的维度。

（d）矩阵的列是它的列空间的一组基底。

请尊重版权与译者的劳动成果，侵权必究！ 178

25 哪些数值 c 与 d 使得矩阵的秩为 2?

12505

000d2

问题 26-30 有关「向量」是矩阵的空间。

26 求出下列 3×3 矩阵的子空间的基底与维度。

（a）所有的对角矩阵。

（b）所有的对称矩阵（AT=A）。

（c）所有的反对称矩阵（AT=-A）。

27 写出 6 个线性无关的 3×3 阶梯矩阵 U1，..，U6。

28 所有每个列的总和都是 0 的 2×3 矩阵写成一个空间，求出它的一组基底。如

果改成每个行的总和是 0，求出它的一组基底。

29 下列集合生成的 3×3 矩阵的子空间是什么？

（a）可逆矩阵。

（b）秩一矩阵。

（c）单位矩阵。

302×3 矩阵的零空间包含（2，1，1），求出此类矩阵形成的空间的一组基底。

问题 31-35 有关「向量」是函数的空间。

31（a）求出满足 dy/dx=0 的所有函数。

（b）选择满足 dy/dx=3 的一个特解。

（c）求出满足 dy/dx=3 的所有函数。

32 余弦空间 F3 包含所有的组合 y（x）=Acosx+Bcos2x+Ccos3x，求出子空间的一组基底，其中 y（0）=0。

33 求出满足下列方程式的函数空间的一组基底。

（a）dy/dx-2y=0

（b）dy/dx-y/x=0

34 假设 y1（x），y2（x），y3（x）是 x 的 3 个不同函数，他们生成的空间的维度可能是 1，2 或 3，给出 y1，y2，y3 的例子来说明这些可能性。

35 求出次数≤3 的多项式 p（x）形成的空间的一组基底。如果子空间的 p（1）=0，

求出一组基底。

36 对于 a+c+d=0 的向量（a，b，c，d）形成的空间 S，找出它的一组基底。同时对

a+b=0 与 c=2d 的向量（a，b，c，d）形成的空间 T，找出它的一组基底。两者

交集 S∩T 的维度是多少？

网址:linear.neocities.org 箱：876152660@qq.com 179

37 若平移矩阵 S 有 AS=SA，证明 A 必须有下列的特殊形式：

а b c］［о 1 0］［о 1 0］［а b c］

若排排

ghi］00이o0이L8hi

00a

「与平移矩阵 S 可以交换的矩阵形成的子空间有维度

。」

38 下列何者是 R3 的基底：

（a）（1，2，0）与（0，1，－1）

（b）（1，1，-1），（2，3，4），（4，1，-1），（0，1，-1）

（c）（1，2，2），（-1，2，1），（0，8，0）

（d）（1，2，2），（-1，2，1），（0，8，6）

39 假设 A 是 5×4 且秩 4，证明当 5×5 矩阵［Ab］可逆时，Ax=b 无解。证明当［A

b］奇异时，Ax=b 有解。

40 所有的解约底

求－+ 求

挑战问题

41 将 3×3 单位矩阵写成其他 5 个排列矩阵的组合，然后证明这 5 个矩阵是线性

无关。（假设某个组合得到 c1P1+.+c5P5 = 零矩阵，检验矩阵的单元证明 c1

至 c5 都必须是 0。）考虑行与列的总和都相等的 3×3 矩阵形成的子空间，前

述的 5 个排列矩阵就是上述子空间的一组基底。

42 选择 R4 的 x=（x1，x2，x3，x4），它有 24 种排列顺序，比如（x2，x1，x3，x4）与（x4，x3，x1，

x2）。这 24 个向量，包含 x 本身，生成一个子空间 S，求出特定的向量 x 使得

S 的维度是（a）0（b）1（c）3（d）4

43 交集与总和有 dim（V）+dim（W）=dim（V∩W）+dim（V+W）。从 V∩的一

组基底 u1，..，u，开始，u＇s 加上 ν1，.，v3 形成 Ⅴ 的一组基底，以及 u＇s 加上

w1，..，w2 形成的一组基底。证明 u＇s 与 v＇s 与 w＇s 放在一起是线性无关，

维度就如预期的（r+s）+（r+t）=（r）+（r+s+t）。

44 Mike Artin 提出一个关于问题 43 的简洁高层次证明。从 V 的所有输入 ν 与 W

的 w，「总和转换」得到 v+w，这些输出得到 V+W，零空间包含所有向量

配对 v=u，w=-u，其中向量 u 在 V∩中。（则 v+w=u-u=0）。依据计

数定理，得到 dim（V+W）+dim（V∩W）=dim（V）+dim（W） （来自 Ⅴ 与的

输入维度）。输出的维度 + 零空间的维度 = 输入的维度

问题：对于秩 r 的 m×n 矩阵，这 3 个维度为何？输出 = 列空间。这个问题在段落 3.5 会再说明，你现在会做吗？

请尊重版权与译者的劳动成果，侵权必究！ 180

45 在 R」，假设维度（V）+ 维度（W）>n，证明某些非零向量同时在 V 与 W 中。

46 假设 A 是 10×10 且 A2=0（零矩阵），所以 A 乘（A 的每个列）得到零向量。这就

表示 A 的列空间在＿__中。若 A 的秩 r，这些子空间的维度 r≤10-r，所以

秩 r≤5。

网址：linear.neocities.org 箱：876152660@qq.com 181

3.5 四个子空间的维度

1. 列空间 C（A）与行空间 C（AT）两者都有维度 r（A 的秩）。

2. 零空间 N（A）的维度是 n-r，左零空间 N（AT）的维度是 m-r。

3. 消元法可以得到 A 的行空间与零空间的基底：对 R 而言是相同的。

4. 消元法通常会改变列空间以及左零空间（但是维度不变）。

5. 秩一矩阵：A=uvT = 列乘行：C（A）的基底是 u，C（AT）的基底是 v。

本章主要的定理会联结秩与维度，矩阵的秩是主元的个数，子空间的维度是基底的向量个数，我们计算主元或是基底向量的个数，A 的秩会显示全部 4 个基础子空间的维度。以下就是这些子空间，包含一个新的子空间。

两个子空间直接来自 A，其余两个来自 AT:

4 个基础子空间

1. 行空间是 C（AT），Rn 的一个子空间。

2. 列空间是 C（A），Rm 的一个子空间。

3. 零空间是 N（A），R」的一个子空间。

4. 左零空间（left nullspace）是 N（AT），Rm 的一个子空间，这是我们的新空间。在本书先看到列空间与零空间，我们已经非常了解 C（A）与 N（A），现在另外两个子空间来了。行空间包含所有行的组合，A 的行空间就是 AT 的列空间。

对于左零空间来说，我们求解 ATy=0 - 这个系统是 n×m，这是 AT 的零空间。当我们把方程式改写成 yTA=0T 时，向量 y 会出现在 A 的左侧。矩阵 A 与 AT 通常是不一样的，所以他们的列空间与零空间也会不一样，但是这些空间会以一种绝对美丽的方式结合在一起。

基础定理的第一个部分要找出这 4 个子空间的维度，有一个突出的事实：行空间与列空间具有相同的维度 r，数字 r 是矩阵的秩。另一个重要的事实与两个零空间有关。

N（A）与 N（AT）的维度是 n-r 与 m-r，用来加总全部的 n 与 m。

基础定理的第二个部分会描述如何将这 4 个子空间融合在一起（两个在 R」，两个在 Rm），让我们找到了解每一个 Ax=b 的「正确方法」。跟它在一起－你正在做真正的数学。

请尊重版权与译者的劳动成果，侵权必究！ 182

R 的 4 个子空间

假设 A 简化为行阶梯形式 R，这个特殊的形状可以容易的鉴别这 4 个子空间，我

们会找到每个子空间的基底以及维度。我们回过头看 A，并且检视这些子空间如

何变化（其中有两个不变），重点是 A 与 R 有相同的 4 个维度。

对于特定的 3×5 范例，从阶梯形式 R 检视这 4 个子空间。m=3

1350

1 主元行 1 与 2

n=5

R= 0001

2

r=2

0000 0 主元列 1 与 4

矩阵的秩 r=2（两个主元），依据顺序处理这 4 个子空间。

1.R 的行空间的维度是 2，与秩相同。

理由：前两行作为基底，行空间包含这三个行的所有组合，但是第三行（零行）

没有引进新东西，所以行 1 与 2 生成行空间 C（RT）。

主元行 1 与 2 是无关，对于本例来说很明显，而且永远是正确的。如果我们

只看主元列，可以看到 rxr 的单位矩阵，我们没办法组合这些行得到零行（除了系

数为 0 的组合），所以 r 个主元行是行空间的一组基底。

行空间的维度是秩 r，R 的非零行形成一组基底。

2.R 的列空间维度也是 r=2。

理由：主元列是列 1 与 4 形成 C（R）的一组基底，因为他们以 rxr 单位矩阵做开

头，所以是无关。这些主元列的组合无法得到零列（除了系数为 0 的组合），他们

也生成了列空间。其他的每个自由列都是主元列的组合，实际上这些组合需要的

是下列三个特殊解：

列 2 是 3（列 1）

特殊解是（-3，1，0，0，0）

列 3 是 5（列 1）

特殊解是（-5，0，1，0，0）

列 5 是 7（列 1）+2（列 4）

解是（-7，0，0，－2，1）

主元列是无关，又生成了 C（R），所以是 C（R）的一组基底。

列空间的维度是秩 r，主元列形成一组基底。

网址：linear.neocities.org 箱：876152660@qq.com 183

3.R 的零空间的维度是 n-r=5-2，存在 n-r=3 个自由变量。此处 x2，x3，x5 是自由（这些列没有主元），他们提供三个 Rx=0 的特殊解。令一个自由变量为 1，求解 x1 与 x4。

－7

1

s2= 000 S3= 50100

Rx=0 的完整解：

s5= 0021 x=x282+x383+x5S5

零空间的维度是 3

理由：这是对于每个自由变量的特殊解。如果有 n 个变量及 r 个主元，可以得到 n-r 个自由变量与特殊解。这几个特殊解是无关，因为他们在行 2，3，5 包含单位矩阵，所以 N（R）的维度是 n-r。

零空间的维度是 n-r，特殊解形成一组基底。

4.RT 的零空间（R 的左零空间）的维度是 m-r=3-2。

理由：方程式 Ry=0 在寻找 RT 的列（R 的行）的组合得到零向量，方程式 RTy=0 或者方程式 yTR=0T:

左零空间

y1 ［1， 3， 5， 0， 7

行的组合

+y2

0， 0， 1， 2

0，

0， 0

（1）

为零

+y3 0，

0， 0， 0， 0，0

解 y1，y2，y3 非常清楚，我们需要 y1=0 与 y2=0，变量 y3 是自由（可以是任意数），RT 的零空间包含所有的向量 y=（0，0，y3）。

所有的情形下，R 的尾端会有 m-r 个零行，这些 m-r 个行的每一个组合都是零，这些行是 R 中可能得到零组合的行，因为主元行是线性无关，所以左零空间中的 y 有 y1=0，.，y，=0。

若 A 是 m×n 矩阵且秩为 r，它的左零空间的维度是 m-r。

为什么叫做「左零空间」？理由是 RTy=0 可以转置成为 yTR=0T。现在 yT 是 R 的「左侧」的行向量，你在方程式（1）中看到这些 y＇s 乘上行。这个子空间是第四个介绍的，有些线性代数的书会删除它 — 但是这样会错失整个主题的美感。在 R」，行空间与零空间的维度分别是 r 与 n-r。（加起来得到 n）。

在 Rm，列空间与左零空间的维度分别是 r 与 m-r。（总和是 m）。

请尊重版权与译者的劳动成果，侵权必究！ 184

A 的 4 个子空间

我们还有一个工作要做，A 的子空间的维度与 R 的维度完全相同，接下来的工作

要解释为什么？现在 A 是可以简化得到 R=rref（A）的任意矩阵。1 35 07

A 简化得到 RA=00012

注意 C（A）≠C（R）

（2）

135 19

C（AT）

C（A）

dimr

dim r

行空间

列空间

所有 Ay

所有 Ax

大图

R

Rm

左零空间

零空间

ATy=0

Ax = 0

N（A）

N（AT）

维度 n-r

维度 m-r

图 3.5:4 个基础子空间的维度（R 与 A）。

1A 与 R 有相同的行空间。相同的维度 r 与相同的基底。

理由：A 的每个行是 R 的行的组合，R 的每个行也是 A 的行的组合。消元法会改

变行，但不会改变行空间。

由于 A 与 R 有相同的行空间，我们可以选择 R 的前 r 个行作为一组基底，或

是我们也可以选择原始 A 的 r 个合适的行，他们可能不是 A 的前 r 个行，因为 A

的前 r 个行可能是相关。A 适当的 r 个行最终是 R 的那些主元行。

2A 的列空间的维度是 r，列的秩等于行的秩。

秩定理：无关列的个数 = 无关行的个数

错误理由:「A 与 R 有相同的列空间。」这是错误的。R 的列通常是以 0 结束，

A 的列不常以 0 结束，则 C（A）≠C（R）。

网址：linear.neocities.org 箱：876152660@qq.com 185

正确理由：相同的列组合对 A 与 R 都是零（或非零）。在 A 中相关在 R 中相关。另一种说法：只有当 Rx=0 时，才有 Ax=0。他们的列空间不相同，但是维度相同－等于 r。

结论：A 的 r 个主元列是 A 的列空间 C（A）的一组基底。

3A 与 R 有相同的零空间。相同的维度 n-r 以及相同的基底。

理由：消元法不会改变解，特殊解是零空间（我们已知）的一组基底，存在 n-r 个自由变量，所以零空间的维度就是 n-r。这就是「计数定理（counting theorem）」： r+（n-r）=n。（列空间的维度）+（零空间的维度）=R」的维度。

4A 的左零空间（AT 的零空间）的维度是 m-r。

理由：AT 与 A 两者的本质相同，当我们知道每一个 A 的维度，我们也会知道 AT 的维度，它的列空间已经证明具有维度 r。由于 AT 是 n×m，「整个空间」现在是 Rm。A 的计数规则是 r+（n-r）=n，AT 的计数规则就是 r+（m-r）=m。我们现在有了大定理的全部细节：线性代数的基础定理，第一部分

列空间与行空间都有维度 r

零空间有维度 n-r 与 m-r

专注在向量的空间，而不是个别的数字或是向量，我们得到一些清楚的规则。你很快视为理所当然－- 最终他们开始明显。但是如果你写下一个 11×17 的矩阵，其中有 187 个非零单元，我不觉得大部分人会了解为什么这些事实是真实的：

两个关键事实

C（A）的维度 = C（AT）的维度 = A 的秩

C（A）的维度 + N（AT）的维度 = 17

范例 1A=［123］的 m=1，n=3，秩 r=1。

行空间是 R3 的一条直线，零空间是平面 Ax=x1+2x2+3x3=0，这个平面的维度是 2（=3-1），维度相加是 1+2=3。

1×3 矩阵的列在 R1 中，列空间就是整个 R1。左零空间只包含零向量，A①y=0 的唯一解是 y=0，没有其他［123］的倍数得到零行。于是 N（A①）是 Z，零空间的维度是 0（=m-r）。在 Rm 中，C（A）与 N（A）的维度相加得到 1+0=1。

请尊重版权与译者的劳动成果，侵权必究！ 186

范例 2A=［］的 m=2，n=3，r=1。

行空间是穿过（1，2，3）的同样直线，零空间必须是同样的平面 Ax=x1+2x2+3x3=0，直线与平面的维度相加仍然是 1+2=3。

所有的列都是第一列（1，2）的倍数。2 乘第一行减去第二行等于零，因此 Ay=0 有一个解是 y=（2，-1）。列空间与左零空间是 R2 的垂直线，维度是 1+1=2。

－ ma － 410s

若 A 有三个相等的行，它的秩是＿__? 左零空间中的两个 y 是什么？

左零空间中的 y＇s 与行的组合得到零行

范例 3 构成方程式后，你已经接近完成三章的学习，但是无法永远继续。此处是一个较好的 5 个方程式的范例（图 3.6 的每个边对应一个方程式）。这 5 个方程式有 4 个未知数（每个节点对应一个未知数），Ax=b 的矩阵是一个入射（incidence）矩阵，矩阵 A 的每一行有一个 1 与一个－1。

－x1+x2

=b

差矩阵 Ax=b

－x1+x3

=b2

在节点 1，2，3，4 之间

－x2+x3

=b3

（3）

存在横跨边 1，2，3，4，5

－x2

+x4=b4

－x3+x4=b5

如果你了解矩阵的 4 个基础子空间（A 与 AT 的列空间与零空间），你已经捕捉到线性代数的中心概念。

T1

边

b1

b2

1

1

1

2

b3

T2

T3

A=

1

3

1

4

b4

bs

－1 1

5

4

图 3.6：一个具有 5 个边 4 个节点的「图」，A 是 5×4 的入射矩阵

零空间 N（A）令 b=0 求出零空间，第一个方程式得到 x1=x2，第二个方程式是 x3=x1，方程式 4 是 x2=x4。这 4 个未知数 x1，x2，x3，x4 有相同的值 C，则向量 x=（c，c，c，c）填满 A 的零空间。

零空间是 R4 的一条直线，特殊解 x=（1，1，1，1）是 N（A）的一组基底，N（A）的维度是 1（基底只有一个向量）。由于 n-r=4-3=1，A 的秩必须是 3。我们知道所有 4 个子空间的维度。

网址：linear.neocities.org 箱：876152660@qq.com 187

列空间 C（A）必定有 r=3 个无关列。快速的方法是检视前三个列，系统化的方法是求出 R=rref（A）。

－1 10

100-1］

－101

0 1 0 －1

A 的列 1，2，30-11

R = 简化行阶梯形式 = 001-1

0-10

0000

00-1

从 R 我们再度看到特殊解 x=（1，1，1，1），前三列是基本，第四列是自由。要得到 C（A）的一组基底（不是 C（R）的），我们回到 A 的列 1，2，3，列空间的维度 r=3。

行空间 C（A）维度再次必须是 3，但是 A 的前三行不是无关：行 3 = 行 2 - 行 1，所以行 3 被消元法变成零，行 3 与行 4 交换。前三个无关行是行 1，2，4，这三个行是行空间的一组基底（一组可能的基底）。

我注意到图中的边 1，2，3 形成一个回圈：相关行 1，2，3。边 1，2，4 形成一个树（tree），树没有回路，无关行 1，2，4。

左零空间 N（A）现在我们求解 ATy=0，找到行的组合得到零。我们已经注意到行 3 = 行 2 - 行 1，所以一个解是 y=（1，-1，1，0，0）。我会说：这个 y 是来自图中上方的回圈；另一个 y 来自下方的回圈且 y=（0，0，-1，1，1）：行 3 = 行 4 + 行 5。这两个 y＇s 是无关，他们是 ATy=0 的解，且 N（AT）的维度是 m-r=5-3=2，所以我们找到了左零空间的一组基底。

你可能会问「回圈」与「树」如何进入问题当中，这件事情没有必要发生。我们可以利用消元法求解 Ay=0，则 4×5 矩阵 AT 会有三个主元列 1，2，4 以及两个自由列 3，5。存在两个特殊解且 AT 的零空间的维度是 2:m-r=5-3=2。但是回圈与树可以用一种美丽的方法鉴别相关行与无关行，我们在段落 10.1 会针对每一个好像 A 的入射矩阵使用这个方法。

方程式 Ax=b 在 4 个节点上得到「电压（voltage）」x1，x2，x3，x4；方程式 ATy=0 在 5 个边得到「电流（current）」y1，y2，y3，y4，y5。这两个方程式就是「基尔霍夫电压定律与基尔霍夫电流定律」，这些是用在电网络的术语。但是隐藏在术语背后的是可以应用在所有的工程、科学、经济以及商务。

图形是离散（discrete）应用数学中最重要的模型，你可以在任何地方看到图形：比如说道路、管线、血液流、大脑、网络、国家或是世界经济，我们可以了解他们的矩阵 A 与 AT。

请尊重版权与译者的劳动成果，侵权必究！ 188

秩一矩阵（复习）

假设每个行都是第一行的倍数，典型的例子：

2378］［1］

2b 3b 7b 8b］b

左侧的矩阵有三行，但是它的行空间的维度只有 1。行向量 νT=［2378］是行空间的一组基底，行的秩是 1。

现在检视列，「列的秩等于行的秩等于 1。」矩阵所有的列必须都是某一列的倍数，你有没有看出这个线性代数的关键规则是否正确？列向量 u=（1，a，b）分别乘了 2，3，7，8，这个非零列向量是列空间的一组基底，列秩也是 1。

每一个秩一的矩阵是一列乘一行 A=uvT

秩二矩阵 = 秩一加秩一

有一个矩阵 A 的秩 r=2，我们无法从 A 立即看出 r，所以我们使用行运算把矩阵简化成 R=rref（A），有一些消元矩阵 E 把 A 简化成 EA=R，则逆矩阵 C=E1 把 R 回复至 A=CR。

你已经知道重点：R 与 A 有相同的行空间。

（4）

4220］421000］

R 的行空间明显有两个基底向量 v=［103］与 v=［014］，所以 A 的行空间也有同样的基底：行秩 = 2。C 乘 R 可以得到 A 的行 3 是 4v+2v。

现在检视列。R 的主元列明显是（1，0，0）与（0，1，0），则 A 的主元列也是在列 1 与 2:u1=（1，1，4）与 u2=（0，1，2）。

当你将字母放在列与行时，你会看到秩二 = 秩一 + 秩一。

矩阵 A 的秩是二 A= u1 u2 и3

=uv+u2v2 = 秩一 + 秩一

零行

你有看到最后一个步骤吗？我是对矩阵使用列乘行，对于这个问题非常完美。每个秩 r 的矩阵，是 r 个秩一矩阵的总和：A 的主元列乘 R 的非零行，行［000］简单的消失了。

主元列 u1 与 u2 是列空间的一组基底，你懂的！

网址：linear.neocities.org:876152660@qq.com 189

主要观念的复习

1.R 的 r 个主元行是 R 与 A 的行空间（相同空间）的一组基底。

2.A 的 r 个主元列是 A 的列空间 C（A）的一组基底。

3.n-r 个特殊解是 A 与 R 的零空间（相同空间）的一组基底。

4. 若 EA=R，E 最后的 m-r 个行是 A 的左零空间的一组基底。

关于 4 个子空间的注释：这个基础定理看起来很像纯数学，但是它有非常重要的应用。我最喜欢的是在第十章介绍的网络（我通常在下一次上课时直接讲 10.1），在左零空间中的 y 的方程式就是 ATy=0:

流进一个节点等于流出，基尔霍夫电流定律就是「平衡方程式」

这个必须是应用数学中最重要的方程式，所有科学、工程与经济的模型都与平衡有关－- 包含力、热流、电荷、动量或是金钱的平衡。平衡方程式，加上胡克定律、欧姆定律或是与位能到流量相关的定律，给出了应用数学的明显框架。

我的「计算科学与工程」这本教科书开发了这样的框架，连同演绎法去求解方程式：有限差，有限元素，频谱方法，回归方法以及多网格法。

已解范例

3.5A 把 4 个 1 放进一个 5×6 的零矩阵中，让行空间的维度尽可能最小。描述所有使得列空间的维度尽可能最小的方法。描述所有使得零空间的维度尽可能最小的方法。如何使得 4 个子空间的维度总和最小？

解如果 4 个 1 放在同一行，或者同一列，矩阵的秩是 1。他们也可以放在两行以及两列（所以 ai=aj=aji=a=1）。由于列空间与行空间的维度相等，已经回答了前两个问题：维度 1。

当矩阵的秩是 r=4，零空间最小可能的维度是 6-4=2。要达成秩 4，4 个 1 必须放在 4 个不同行及 4 个不同列。

关于这个总和 r+（n-r）+r+（m-r）=n+m，你是无计可施的。无论 4 个 1 怎么放置，总和永远是 6+5=11。纵使矩阵里面没有任何的 1，总和还是 11。如果 A 的其他单元都是 2 而不是 0，这些答案会怎么改变？

请尊重版权与译者的劳动成果，侵权必究！ 190

3.5B 事实：AB 所有的行都是 B 的行的组合，所以 B 的行空间会包含 AB 的行

空间（有可能相等），秩（AB）≤秩（B）。

AB 所有的列是 A 的列的组合，所以 A 的列空间会包含 AB 的列空间（有可能

相等），秩（AB）≤秩（A）。

如果我们左乘一个可逆矩阵，秩不会改变。秩不会掉落是因为当我们左乘逆

矩阵时，秩不会跳回来。

问题集 3.5

1（a）若一个 7×9 矩阵的秩是 5，它的 4 个子空间的维度是多少？这 4 个维度总

和是多少？

（b）若一个 3×4 矩阵的秩是 3，则它的列空间与左零空间为何？

2 求出 A 与 B 的 4 个子空间的基底与维度:

4∷52

3 求出 A 的 4 个子空间的基底:

01234］［100］01234

A=01246=11000012

0001201100000

4 写出满足下列要求性质的矩阵或是说明为什么不可能：

（a）列空间包含（1，1，0）与（0，0，1），行空间包含（1，2）与（2，5）。

（b）列空间的基底（1，1，3），零空间的基底（3，1，1）。

（c）零空间的维度 = 1 + 左零空间的维度。

（d）零空间包含（1，3），列空间包含（3，1）。

（e）行空间 = 列空间，零空间≠左零空间。

5 若 V 是由（1，1，1）与（2，1，0）生成的子空间，求矩阵 A 使得 V 是它的行空间。

求矩阵 B 使得 Ⅴ 是它的零空间。求出乘积 AB。

6 不使用消元法，求出下列矩阵的 4 个子空间的维度与基底：

1

7 假设 3×3 矩阵 A 可逆，写出 A 的 4 个子空间的基底。令 3×6 矩阵 B=［AA］，

求出 B 的 4 个子空间的基底。（Z 的基底是空集合。）

网址：linear.neocities.org 箱：876152660@qq.com 191

8 若 I 是 3×3 的单位矩阵，0 是 3×2 的零矩阵，求 A，B，C 的 4 个子空间的维度：9 下列矩阵的大小都不相同，哪些子空间却是相同？

（）［4］［］）［4］［4

证明这些矩阵有相同的秩 r。

10 如果 3×3 矩阵的单元在 0 至 1 之间随意选取，4 个子空间最有可能的维度是多少？如果随机矩阵是 3×5?

11（重要）A 是秩 r 的 m×n 矩阵，假设存在右侧的 b 使得 Ax=b 无解。

（a）在 r，m，n 之间的不等号（< 或≤）必须如何安排才正确？

（b）你如何知道 Ay=0 有除了 y=0 的解？

12 以（1，0，1）与（1，2，0）作为基底的行空间的矩阵为何？它的列空间为何？为什么这组基底不能成为行空间与零空间的基底？

13 是非题（给出理由或是反例）：

（a）若 m=n 则 A 的行空间等于 A 的列空间。

（b）矩阵 A 与－A 共享相同的 4 个子空间。

（c）若 A 与 B 共享相同的 4 个子空间，则 A 是 B 的倍数。

14 不计算 A，求出它的 4 个基础子空间：

15 如果你交换 A 的前两行，4 个子空间中哪些保持不变？若 ν=（1，2，3，4）在 A 的左零空间中，写出一个在行交换后新矩阵的左零空间中的向量。

16 说明为什么 ν=（1，0，－1）不可能既是 A 的一个行又在零空间中？

17 描述下列 R3 中的矩阵的 4 个子空间:

请尊重版权与译者的劳动成果，侵权必究！ 192

18（左零空间）引入额外的列 b，简化 A 至阶梯形式：

b1

A 的行的组合得到零行，这是什么样的组合？（检视右侧的 b3-2b2+b1），哪

些向量在 AT 的零空间中？哪些向量在 A 的零空间中？

19 依据问题 18 的方法，简化 A 至阶梯形式然后检视零行，b 列会告诉我们你用

了什么样的行组合： 12b

23b2

从消元后的 b 列，会得到在左零空间的 m-r 个基底向量，这些 y＇s 是行的组

合，这些行得到阶梯形式的零行。

20（a）检验 Ax=0 的解垂直于 A 的行：

（b）ATy=0 有几个无关的解？为什么 yT=E-1 的行 3?

21 假设 A 是两个秩一矩阵的总和：A=uvT+wzT。

（a）哪些向量生成 A 的列空间？

（b）哪些向量生成 A 的行空间？

（c）如果

或如果

，则秩小于 2。

（d）若 u=z=（1，0，0）且 v=w=（0，0，1），计算 A 及它的秩。

22 创建 A=uvT+wzT，A 的列空间有基底（1，2，4）与（2，2，1），行空间有基底（1，0）

与（1，1）。把 A 写成（3×2）乘（2×2）。

23 不计算矩阵乘积，求 A 的行空间与列空间的基底：

从这些形状，你如何知道 A 不可能是可逆？

24（重要）当 d 在 4 个子空间的哪个空间时，Ay=d 有解？当＿_只包含零向

量时，有唯一解 y。

网址：linear.neocities.org 箱：876152660@qq.com 193

25 是非题（理由或反例）：

（a）A 与 A 有相同的主元个数。

（b）A 与 AT 有相同的左零空间。

（c）如果行空间等于列空间则，AT=A。

（d）如果 AT=-A，则 A 的行空间等于列空间。

27 求出 8×8 棋盘格矩阵 B 以及西洋棋矩阵 C 的秩：

1 01 01 01 0

r n b g k bn r

01010101

р р р р р р р р

B= 1 010101 0 C=

4 个零行

oi o ioio i

ррррр ррр

r n bg k b n r

r，n，b，g，k，p 是完全不同的数字，求出 B 与 C 的行空间与左零空间的基底。挑战问题：求出 C 的零空间的一组基底。

28 完成井字游戏矩阵（A 有 5 个 1 与 4 个 0）之后的 rank（A）=2，但是两边都没有走出致胜棋步，可能吗？【译者自己下了一盘才明白题目的意思】

29 若 A=uvT 是秩 1 的 2×2 矩阵，重画图 3.5 更清楚显示这 4 个子空间。若 B 有相同的 4 个子空间，B 与 A 的确切关系为何？

30M 是 3×3 矩阵的空间，X 是 M 的任意矩阵，乘积 AX:

（a）哪些矩阵 X 使得 AX = 零矩阵。【求 A 的零空间，就是下面的（a）】

（b）对矩阵 X，哪些矩阵具有 AX 的形式？【求 A 的列空间，就是下面的（b）】（a）求 AX 的零空间。（b）求列空间。M 的这两个子空间的维度为何？为什么

维度加起来是（n-）+r=9

31 假设 m×n 的矩阵 A 与 B 有相同的 4 个子空间，如果他们都已经是行简化阶梯形式，证明 F=G：4--〖

请尊重版权与译者的劳动成果，侵权必究！ 194

第四章

正交性质

4.1 四个子空间的正交性质

1 正交向量有 w=0，则‖2+IP‖+wI=‖－wI2

2 若子空间 V 中的每个 ν 与子空间 W 中的每个 w 都存在 vw=0，则子空间 V

与子空间 W 正交。

3A 的行空间与零空间正交，列空间与 N（AT）正交。

4 一组维度配对相加得到 r+（n-r）=n，另一组相加是 r+（m-r）=m。

5 行空间与零空间是「正交补充」：R」的每个 x 分成 xrow+xnull。

6 假设空间 S 的维度是 d，则 S 的每组基底包含 d 个向量。

7 若空间 S 的 d 个向量无关，这些向量生成 S。若 d 个向量生成 S，则这些向量

无关。

两个向量的点积为零，则两个向量正交：v·w=vTw=0。本章转移到正交子

空间与正交基底以及正交矩阵。在两个子空间中的向量，在一组基底的向量以及

Q 中的列向量，前述所有的向量配对都是正交。想起直角三角形有 a2+b2=c2，

其中三角形的边是 ν 与 w。

正交向量 vw=0 且‖v12+‖w12=1‖v+w2

当 vTw=wTv=0，直角边（v+w）T（v+w）等于 vTv+wTw。

第三章的子空间在阐述 Ax=b，现在我们需要列空间与零空间，聚光转到 AT，

揭开另外两个子空间，这 4 个子空间显示了矩阵实际在做什么。

矩阵乘向量：A 乘 x。第一层次只有数字，第二层次 Ax 是列向量的组合，第

三层次展示了子空间。但是我不认为你已经看到全貌，直到你研读了图 4.2。

网址：linear.neocities.org 邮箱：876152660@qq.com 195

子空间适配在一起显示 A 乘 x 的潜在真实性，两个子空间之间的 90° 角是新的主题－我们现在可以说直角代表什么意义。

行空间与零空间垂直，A 的每个行与 Ax=0 的每个解垂直，得到图形左侧的 90° 角。这个子空间的垂直性是线性代数基础定理的第二部分。

列空间与 AT 的零空间垂直，当 b 在列空间之外－- 当我们想要求解 Ax=b 却做不到时 — 此时 AT 的零空间就会显示出独特的优势，它包含「最小二乘」解的误差 e=b-Ax，最小二乘是线性代数在本章中的关键应用。

基础定理的第一部分给定子空间的维度，行与列空间有相同的维度 r（他们吸取相同大小），两个零空间有剩下的维度 n-r 与 m-r。现在我们证明行空间与零空间是 R＂中的正交子空间。

定义向量空间的两个子空间 V 与 W，如果 V 中的每个向量 ν 都与 W 中的每个向量 w 垂直，则 V 与 W 正交：

正交子空间 V 中的所有 ν 与 W 中的所有 w 都有 vTw=0。

范例 1 你房间的地板（延申至无限）是一个子空间 V，两面墙的交线是子空间 W（1 维），这两个子空间正交。墙与墙的交线上的向量与地板的每个向量垂直。

范例 2 两面墙看起来是垂直，但是这两个子空间没有正交！交线同时在 V 与 W— 这条直线与本身并没有垂直。两个平面（在 R3 中，维度是 2 与 2）不可能是正交子空间。

当一个向量同时在两个正交子空间中，它必须是零，它垂直于本身。它是 ν 也是 w，所以 νTν=0，这个只能是零向量。

已

V

V vTw+0

正交平面 Ⅴ 与直线 W

非正交平面

图 4.1：当 dim V+dim W>dim（整个空间），不可能正交。

线性代数重要的范例来自 4 个基础子空间，零是零空间与行空间唯一的交点，此外，A 的零空间与行空间是 90° 交会。关键的事实直接来自 Ax=0:

请尊重版权与译者的劳动成果，侵权必究！ 196Ax=0，A 的零空间中的每个向量 x 与 A 的每一行垂直。零空间 N（A）与

行空间 C（AT）是 R」中的正交子空间。

要了解为什么 x 与这些行正交，检视 Ax=0，每个行乘 x:

行 1

←（行 1）x 是零

Ax=

x =

（1）

行 m

0

←（行 m）·x 是零

方程式 1 说明行 1 与 x 垂直，最后方程式说明行 m 与 x 垂直。每一行与 x 的点积

都是零，x 也与行的每个组合垂直。整个行空间 C（AT）与零空间 N（A）是正交。

此处提供喜欢矩阵缩写的读者第二种证明，行空间的向量是行的组合 ATy，

计算 Ay 与零空间的 x 的点积，这些向量互相垂直：

零空间与行空间正交 xT（ATy）=（Ax）Ty=0Ty=0

（2）

我们喜欢第一个证明，你可以从方程式（1）看到 A 的这些行乘 x 得到零，第二个证

明展示了为什么 A 与 AT 都在基础定理中。

范例 3 矩阵 A 的行与零空间中的 x=（1，1，-1）垂直：

得到点积 1+3-4=0

5+2-7=0

现在回到另外两个子空间。在本例中，列空间是全部的 R2，AT 的零空间只有零向

量（与所有向量正交），A 的列空间与 AT 的零空间永远是正交子空间。

AT 的零空间中的每个向量 y 与 A 的每一列垂直，左零空间 N（AT）与

列空间 C（A）在 Rm 中正交。

对 AT 应用原始的证明，AT 的零空间与 AT 的行空间正交－AT 的行空间就是 A 的列

空间。证明完毕。

视觉化的证明：检视 Ay=0，A 的每一列乘 y 得到 0:

C（A）LN（AT）

ATy=

（3）

y 与 A 的每一列的点积是零，则左零空间中的 y 与 A 的每一列垂直－— 也就是与整

个列空间垂直。网址：linear.neocities.org 邮箱：876152660@qq.com 197

维度

维度

=r

=r

1 的行

A 的列

空间

行空间到列空间

空间

Axrow=b

R＂

90

90°

Rm

Axnull =0

零空间到

A①的零

A 的零

空间

空间

维度

维度

=m-r

=n-r

图 4.2：两对（pairs）正交子空间，维度总和是 n 与 m。这是大图－两个子空间在 R」中，两个子空间在 Rm 中。

正交补充

重要基础子空间不止是正交（成对）而已，他们的维度也是恰当的。R3 中的两条直线可能垂直，但是这些直线不可能是 3×3 矩阵的行空间与零空间。两条直线的维度是 1 与 1，加起来是 2，但是正确的维度 r 与 n-r 加起来必颁等于 3。

3×3 矩阵的基础子空间的维度有 2 与 1，或是 3 与 0。这些子空间配对不只是正交，他们还是正交补充。

定义子空间 V 的正交补充包含每个与 V 垂直的向量，这个正交子空间写成 V4（读成 Vperp）。

基于这个定义，零空间是行空间的正交补充，每个垂直行的 x 满足 Ax=0，并且落在零空间中。

反向也是成立的，如果 ν 与零空间正交，它必须在行空间中，否则我们可以把 ν 加入矩阵作为一个额外的行，而没有改变它的零空间。行空间会变大，破坏 r+（n-r）=n 的法则。我们的结论是零空间补充 N（A）确切是行空间 C（AT）。

同样的方式，左零空间与列空间在 Rm 中正交，他们是正交补充，他们的维度 r 与 m-r 相加得到满维度 m。

请尊重版权与译者的劳动成果，侵权必究！ 198

线性代数基础定理，第二部分

N（A）是行空间 C（AT）的正交补充（在 R」）

N（AT）是列空间 C（A）的正交补充（在 Rm）

第一部分给定子空间的维度，第二部分给定他们之间的 90° 角。「补充」的重

点在于每一个 x 可以分成一个行空间分量 x，与一个零空间分量 xn。图 4.3 显示 Ax

=Ax，+Axn 发生了什么：

零空间分量走到零：Axn=0。

行空间分量走到列空间：Ax，=Ax。

每个向量都走到列空间！左乘 A 不能做其他事情，除此之外：列空间中的每个向

量 b 来自行空间中的一个而且是唯一的向量 x，。证明：若 Ax，=Ax，＇，两者的差

x-x，＇会在零空间中，它也会在行空间中，因为 x，与 x，＇都来自行空间。两者的

差必须为零向量，这是因为零空间与行空间互相垂直，因此 x，=x，＇。

如果我们抛开两个零空间，在 A 中隐藏一个 rxr 的可逆矩阵。从行空间到列

空间，A 是可逆。「伪逆反（pseudoinverse）」会逆反段落 7.4 中 A 的那部分。

范例 4 每个秩 r 的矩阵有一个 rxr 的可逆子矩阵：

＊＊

其他 11 个 0 负责零空间。B 的秩也是 r=2:

机含在主元与列

当我们选择了正确的 R」与 R」的基底，每个矩阵都可以对角化，这个「奇异值分解

（singular value decomposition）」在应用上已经变得非常重要。

让我重复一个清晰的事实，A 的行不可能在 A 的零空间中（除了零行之外），

两个正交子空间中都存在的向量只有零向量。

如果一个向量 ν 与本身正交，则 ν 一定是零向量。

网址：linear.neocities.org 箱：876152660@qq.com 199

dim r

dim r

行的

Ax，=b

列的

所有组合

所有组合

Ax=b

x=xr+xn

R＂

Rm

Axn=0

所有与列

所有与行

正交的向量

正交的向量

dimm-r

dim n-r

图 4.3：这是图 4.2 的更新图，显示 A 对于 x=x，+xn 的真实作用。行空间向量 x，到列空间，零空间向量 x 到零。

画出大图

我不知道画出在图 4.2 与 4.3 的 4 个子空间的最佳方法，这张大图必须显示这些子空间的正交性质。我能够看到一个可能的方法去做这件事情，就是一条线与一个平面的交会－可能图 4.4 也显示了这些空间是无限的，比图 4.3 的矩形要更清晰。但是我该如何在 R 画出一对 2 维的子空间，去展示他们彼此之间是正交？欢迎提供好点子。

3 行

A 的零空间

1 1 1

A= 1 0 1

1 －1 1

方向（1，0，－1）

行空间

与行正交

图 4.4:A 的行空间 = 平面，零空间 = 正交直线，维度 2+1=3。

请尊重版权与译者的劳动成果，侵权必究！ 200

从子空间组合基底

接下来是一些关于基底的有价值事实，他们一直储存到现在－当我准备好使用他们。一个星期以后你对于基底是什么（线性无关的向量生成空间），就会有一个清晰的观念。正常情形下要检验两个性质，当计数是正确的，一个性质就可以推论至另一个性质：

R＂中任何 n 个无关向量必然生成 R」，所以他们是一组基底。

生成 R＂的任何 n 个向量必然无关，所以他们是一组基底。

从向量的正确个数开始，基底的一个性质产生另一个性质。对于任意的向量空间来说这是真实的，但是我们会关注 R」更多。当这些向量进入 n×n 方形矩阵 A 的列时，有两个相同的事实：

若 A 的 n 个列是无关，他们生成 R＂，所以 Ax=b 有解。

若这 n 个列生成 R＂，他们是无关，所以 Ax=b 有唯一解。

唯一性推论到存在性而且存在性也推论到唯一性，则 A 是可逆的。如果不存在自由变量，解 x 是唯一，此时必须有 n 个主元，然后利用反向代入法求解 Ax=b（存在解）。

从反向开始，假设对于每个 b，Ax=b 都有解（存在解），消元法不会得到零行，有 n 个主元，没有自由变量，零空间只包含 x=0（唯一性）。

对于行空间与零空间的基底来说，我们有 r+（n-r）=n 个向量，这是正确的数字，这 n 个向量是无关 2，因此他们生成 R＂。

每个 x 是 x，+xn 的总和，其中 x，來自行空间，xn 來自零空间。

范列 54 = 把 x=| 分成 x，+x=+｝

向量（2，4）在行空间中，正交向量（2，－1）在零空间中。下个段落会计算对于任意 A 与 x 的分割，使用投影法（projection）。

【原文没有 footnote 1】

2 若全部 n 个向量的组合得到 x，+xn=0，则 x，=-xn 同时在两个空间，所以 x，=-xn=0。行空间与零空间的基底的所有系数必须为零，证明了这 n 个向量在一起是无关。

网址：linear.neocities.org 箱：876152660@qq.com 201

主要观念的复习

1. 如果 V 中的每个 ν 都与 W 中的每个 w 正交，则子空间 V 与 W 正交。2. 如果 W 包含所有与 V 垂直的向量（反之亦然），则 V 与 W 是「正交补充」。3. 零空间 N（A）与行空间 C（A）是正交礼充，维度是（n ー）+r=n。相似的，N（AT）与 C（A）是正交补充，维度是（m-r）+r=m。

4.R＂中任何 n 个无关向量生成 R」，任何 n 个生成向量必然无关。

已解范例

4.1A 假设 S 是 9 维空间 R9 中的 6 维子空间。

（a）与 S 正交的子空间的可能维度是多少？

（b）S 的正交补充 S 的可能维度是多少？

（c）矩阵 A 的行空间是 S，则 A 可能的最小大小（smallest size）为何？

（d）矩阵 B 的零空间是 S，则 B 可能的最小大小为何？

解（a）若 S 是 R° 的 6 维子空间，与 S 正交的子空间的可能维度是 0，1，2，3。（b）正交补充 S 是最大的正交子空间，维度是 3。

（c）最小的矩阵 A 是 6×9（它的 6 个行是 S 的一组基底）。

（d）答案与（c）相同。

如果 B 的新行 7 是 A 的 6 个行的组合，则 B 与 A 有相同的行空间，也有相同的零空间。Ax=0 的特殊解 S1，S2，S3 与 Bx=0 的特殊解相同。消元法会把 B 的第 7 行变成全部是零。

4.1B 方程式 x-3y-4z=0 描述了 R3 的一个平面 P（实际是个子空间）。

（a）平面 P 是哪个 1×3 矩阵 A 的零空间 N（A）? 答案：A=［1-3-4］。（b）找出 x-3y-4z=0 的特殊解的基底 s1 与 s2。（这些是零空间矩阵 N 的列）。答案：s1=（3，1，0）与 S2=（4，0，1）。

（c）找出垂直 P 的直线 P 的一组基底。答案：（1，－3，－4）。

请尊重版权与译者的劳动成果，侵权必究！ 202

问题集 4.1

问题 1-12 图 4.2 与 4.3 的四个子空间的发展。

1 写出任意 2×3 的秩 1 矩阵，复制图 4.2，在每个子空间中放置一个向量（零空间中放两个。）哪些向量是正交？

2 对 3×2 秩 r=2 的矩阵重画图 4.3，哪个子空间是 Z（只有零向量）?R2 中任意向量 x 的零空间部分 xn=

3 写出一个满足要求的矩阵，或是说明为何不可能？

2

（a）列空间包含 2 与 －3，零空间包含

－3

5

（b）行空间包含

与 235，零空间包含 111111

（c）Ax = 有一个解且 AT 100 =

（d）每一行与每一列正交（A 不是零矩阵）

（e）全部列相加得到一列的零，全部行相加得到一行的 1＇s。

4 若 AB=0，则 B 的列在 A 的

中，A 的行在 B 的

中。AB=0，为

什么 A 与 B 不可能是秩 2 的 3×3 矩阵。

5（a）若 Ax=b 有一个解且 ATy=0，则（yTx=0）或是（yTb=0）?

（b）若 A1y=（1，1，1）有一个解且 Ax=0，则

6 方程式系统 Ax=b 无解（他们得到 0=1）：

x+2y+2z=5

2x + 2y+ 3z = 5

3x+ 4y+ 5z = 9

求出数字 y1，y2，y3 分别乘方程式相加后得到 0=1，你会发现向量 y 在哪个子空间？它的点积 yTb 是 1，所以 x 无解。

7 每个无解的系统就像问题 6 一样，存在数字 y1，.，ym 分别乘 m 个方程式，相加后得到 0=1。这个称为「Fredholm＇s 替代（alternative）」：

下列问题中恰好只有一个问题有一个解

Ax=b 或 ATy=0 且 yTb 是 1

若 b 不在 A 的列空间中，它与 AT 的零空间就不正交。分别用数字 y1，y2，y3 乘方程式 x1-x2=1 与 x2-x3=1 与 x1-x3=1，选取适当的 y＇s 使得方程式相加得到 0=1。网址：linear.neocities.org:876152660@qq.com 203

8 在图 4.3 中，我们如何知道 Ax，等于 Ax? 我们如何知道这个向量在列空间中？ 若 A-｛与 x-［｝，求 x。

9 若 ATAx=0 则 Ax=0。理由：Ax 在 AT 的零空间中，也在 A 的

中且

这些空间是

。结论：AA 与 A 有相同的零空间。下个段落会重复这个关键事实。

10 假设 A 是对称矩阵（AT=A）。

（a）为什么它的列空间与它的零空间垂直？

（b）若 Ax=0 与 Az=5z，哪个子空间包含「固有向量」x 与 z?

对称矩阵有垂直的固有向量 xTz=0。

11（推荐）画出图 4.2，正确的展示每个子空间：

4=|| 与 8=||

12 找出片段 x 与 xn 并且正确画出图 4.3，如果

与 x-

问题 13-23 有关正交子空间。

13 把子空间 V 与 W 的基底放进矩阵 V 与 W 的列，说明为什么正交子空间的测试可以写成 VTW=0 矩阵？这也符合正交向量的 vTw=0。

14 地板 V 与墙 W 不是正交子空间，因为他们共享一个相同的非零向量（沿着交线的向量），没有 R3 中的平面 V 与平面 W 可以正交！找出下列两个矩阵的列空间的一个向量：

这会是一个向量 Ax 以及 Bx。想象 3×4 的矩阵［AB］。

15 延申问题 14 至 R」的一个 p 维的子空间 V 与一个 q 维的子空间 W，什么样的 p+q 的不等式确保 V 与 W 的交集是非零向量？这些子空间不可能正交。

16 利用方程式（2）的矩阵缩写，证明 N（AT）中每一个 y 与列空间中每一个 Ax 垂直。从 A①y=0 开始。请尊重版权与译者的劳动成果，侵权必究！ 204

17 若 R3 的子空间 S 只包含零向量，S 为何？若 S 由（1，1，1）生成，S 为何？若 S 由（1，1，1）与（1，1，－1）生成，S 的一组基底为何？

18 假设 S 只包含两个向量（1，5，1）与（2，2，2）（不是子空间），则 S 是矩阵 A=

的零空间。尽管 S 不是子空间，但是 S①是子空间。

19 假设 L 是 R3 的一维子空间（一条直线），它的正交补充 L + 是垂直 L 的

则（L+）是垂直 L + 的

。事实上（L+）与

相同。

20 假设 V 是整个空间 R4，V4 只包含

向量，则（V4）+ 是

，所以（V4）1

与

相同。

21 假设 S 由向量（1，2，2，3）与（1，3，3，2）生成，找出两个向量生成 S4，这相当于求解 Ax=0，求 A?

22 假设 R4 的平面 P 满足 x1+x2+x3+x4=0，写出 P 的一组基底，写出把 P 作为零空间的矩阵。

23 假设子空间 V 包含子空间 S，证明 S 包含 V。

问题 24-30 有关垂直列与行。

24 假设一个 n×n 矩阵可逆：AA1=I，则 A1 的第一列与 A 的哪些行生成的空间正交？

25 假设 A 的列是单位向量且全部互相垂直，求 ATA。

26 建立 3×3 矩阵 A，其中 A 没有 0 单元且它的列互相垂直，计算 ATA。为什么它是对角矩阵？

27 直线 3x+y=b1 与 6x+2y=b2 是

。如果

，他们是同一条线，这

个情况下（1，b2）与向量

垂直。矩阵的零空间是直线 3x+y=

，这个

零空间中的一个特定向量是

28 为什么下列的叙述是错误的？

（a）（1，1，1）与（1，1，－2）垂直，所以 x+y+z=0 与 x+y-2z=0 是正交子空间。（b）（1，1，0，0，0）与（0，0，0，1，1）生成的子空间，是（1，－1，0，0，0）与（2，－2，3，4，

－4）生成的子空间的正交补充。

（c）交集只有零向量的两个子空间正交。

29 求出一个矩阵使得 ν（1，2，3）同时在矩阵的行空间与列空间中。找出另一个矩阵使得 ν 同时在零空间与列空间中。ν 不能同时在哪些子空间的配对？

网址:linear.neocities.org 邮箱：876152660@qq.com 205

挑战问题

30 假设 A 是 3×4 与 B 是 4×5 且 AB=0，所以 N（A）包含 C（B）。由 N（A）与 C（B）的维度证明 rank（A）+rank（B）≤4。

31 指令 N=null（A）会得到 A 的零空间的一组基底。则指令 B=null（N＂）会得到 A 的＿_的一组基底。

32 假设我给你 4 个 R2 的非零向量 r，n，c，1:

（a）要想成为 2×2 矩阵的 4 个基础子空间 C（A1），N（A），C（A），N（AT）的基底，这些向量要有什么条件？

（b）可能的矩阵 A 为何？

33R ri， r2， mi， n2， ci， c2， 11，12

（a）要想成为 4×4 矩阵的 4 个基础子空间的基底，这些向量要有什么条件？（b）可能的矩阵 A 为何？

请尊重版权与译者的劳动成果，侵权必究！ 206

4.2 投影

1 向量 b 在通过 a 的直线的投影是直线与 b 的最近点 p=a（aTb/aTa）。

2 误差 e=b-p 与 a 垂直：直角 bpe 有 | p‖2+‖e‖2=‖b|2。

3b 在子空间 S 的投影是 S 中与 b 的最近点 p；b-p 与 S 正交。

4 只有在 A 有无关列时，ATA 可逆（且对称）：N（ATA）=N（A）。

5b 在 A 的列空间的投影是向量 p=A（ATA）-1ATb。

6 投影到 C（A）的投影矩阵是 | P=A（ATA）1AT，其中 p=Pb 且 P2=P=PT。

本段落开始前我可以提出两个问题吗？（那个问题再加一。）第一个问题的目的在于展示投影是很容易视觉化的，第二个问题是有关「投影矩阵（projectionmatrix）」－- 对称矩阵且 P2=P。b 的投影是 Pb。

1b=（2，3，4）在 z 轴与在 xy 平面的投影为何？

2 什么样的矩阵 P1 与 P2 可以产生在直线与平面的投影？

当 b 投影到一条直线，它的投影 p 是 b 沿着这条直线的部分。如果 b 投影

到一个平面，p 是 b 在平面的部分。投影 p 就是 Pb。

投影矩阵 P 乘 b 得到 p，本段落求 p 也求 P。

我们把在 z 轴的投影称为 p1，第二个投影直接下降至 xy 平面，你心中的图形应该是图 4.5。从 b=（2，3，4）开始，横向投影得到 p1=（0，0，4），下降投影得到 p2=（2，3，0），这些是 b 沿着 z 轴与在 xy 平面的部分。

投影矩阵 P1 与 P2 是 3×3，他们乘有 3 个分量的 b 得到有 3 个分量的 p。在直线的投影来自一个秩 1 矩阵，在平面的投影来自一个秩 2 矩阵。

000

1 0 0

投影矩阵到 z 轴：P=000

到 xy 平面：P2=010

001

0 0 0

P1 筛选出每个向量的 z 分量，P2 筛选出 x 与 y 的分量。要求 b 的投影 p1 与 p2，使用 P1 与 P2 乘 b（小 p 是向量，大写 P 是产生 p 的矩阵）:

0

0

P1=Pb= 0

P2=P2b 0

0 0

网址:linear.neocities.org 箱：876152660@qq.com 207

这个情形下投影 p1 与 p2 垂直，xy 平面与 z 轴是正交子空间，就好像房间的地板与两面墙的交线一样。

投影 P1=b-［］

b 8N

图 4.5：在 z 轴与 xy 平面的投影 p1=P1b 与 p2=P2b。

不只是正交，直线与平面是正交补充，他们的维度加起来是 1+2=3。整个空间的每个向量 b 都是它在这两个子空间的部分的总和，投影 p1 与 p2 恰好就是 b 的这两个部分： 向量得到 p1+p2=b 矩阵得到 P1+P2=I

（1）

这是完美的，我们达成了目标 — 在这个例子，对于任何直线与任何平面以及任何 n 维子空间，我们都有相同的目标。我们的目的是在每个子空间找到 p 的部分，以及可以得到那个部分的矩阵 P 使得 p=Pb。Rm 的每一个子空间有自己的 m×m 投影矩阵，要计算 P，我们绝对需要投影的目标子空间的良好描述。

子空间的最佳描述就是基底，我们把基底放进 A 的列，现在我们是对于 A 的列空间在投影！当然 z 轴是 3×1 矩阵 A1 的列空间，xy 平面是矩阵 A2 的列空间，这个平面也是 A3 的列空间（一个子空间有很多基底），所以 p2=p3 且 P2=P3。

4 - 与－| 与－

我们的问题是把任意的 b 投影至任何 m×n 矩阵的列空间。从一条直线开始（维度 n=1），矩阵 A 只有一列，称为 a。

在直线的投影

一条通过原点且方向是 a=（a1，.，am）的直线，沿着这条直线，我们希望点 p 最靠近 b=（b1…bm）投影的关键在于正交：由 b 到 p 的直线与向量 a 垂直，这是图 4.6 左侧标示 e=b-p 的点线，其中 e 代表误差。我们现在用代数计算 p。

请尊重版权与译者的劳动成果，侵权必究！ 208

投影 p 会是 a 的某个倍数，写成 p=xa=「xhat」乘 a。计算数字 x 可以得到向

量 p，从 p 的公式我们得到投影矩阵 P。这三个步骤可以求得所有的投影矩阵：

找出，找出向量 p，然后找出矩阵 P。

点线 b-p 是「误差」e=b-a，它与 a 垂直－这个可以决定 x。当他们的点

积为 0，使用 b-a 与 a 垂直的事实：

（2）

乘法 ab 与 a·b 相同，使用转置会好一点，这是因为它也可以应用在矩阵。我们

的公式 x=aTb/aTa 得到投影 p=xa。

b

b

误差

e=b-p

p=Ax

a

e

=A（ATA）-1ATb

=Pb

0

p=a=aTa

S

图 4.6:b 在一条直线的投影 p 以及 b 在 S=A 的列空间的投影

向量 b 在通过 a 的直线的投影是向量

特殊案例 1：若 b=a 则 = 1，a 在 a 的投影就是自己，Pa=a。

特殊案例 2：若 b 与 a 垂直则 ab=0，投影是 p=0。

解数字 x 是 ab=5 与 aa=9 的比值，所以投影 p 是 a。网址：linear.neocities.org 箱：876152660@qq.com 209

b 与 p 之间的误差向量是 e=b-p，向量 p 与 e 相加得到 b=（1，1，1）:

p-a=（）与 e-b-p=（--）

误差 e 会垂直 a=（1，22），就是 ea=--=0。

检视直角三角形 b，p 与 e，向量 b 分成两个部分－沿着直线的分量是 p，垂直的部分是 es수迦 pe 的度 ll pll=ll b ll cos lle ll=ll b ll sin 6 角学与点积是适配的：

（3）

点积会比掺杂 cosθ 与 b 的长度来得更简洁，这个例子在 cos0=5/3√3 与‖b‖=√3 出现平方根，投影 p=5a/9 却没有平方根出现，获得 5/9 的好方法是 aTb/aTa。

现在来到投影矩阵，在 p 的公式中，要用什么矩阵乘 b? 如果数字 x 在 a 的右侧，你就看得出来矩阵的优点：

投影矩 P 当是 P-。D=-Pb

P 是一列乘一行！列是 a，行是 aT，再除以数字 aa。投影矩阵 P 是 m×m，但是它的秩是 1。我们在对 1 维子空间做投影，直线通过 a，这条线就是 P 的列空间。N2

解执行乘法：（列 a）乘（行 aT），再除以 aTa=9:

投影矩阵

这个矩阵可以把任何 b 投影至 a，检验范例 1 的 p=Pb，其中 b=（1，1，1）:

如果向量 a 加倍，矩阵 P 保持相同！它仍然投影在相同的直线。如果矩阵变成平方，P2 等于 P，第二次的投影不会改变任何东西，所以 P2=P。P 的对角单元全部相加得到（1+4+4）/9=1。

请尊重版权与译者的劳动成果，侵权必究！ 210

矩阵 I-P 必然也是投影矩阵，它可以得到三角形的另一边 e— 也就是 b 的垂

直部分。注意（I-P）b 等于 b-p，这就是左零空间中的 e

当 P 投影在一个子空间，I-P 会投影在垂直的子空间，此处的 I-P 投影在

垂直 a 的平面。

现在我们超越在一条直线的投影，投影至 Rm 的 n 维子空间需要更多付出，重

要的公式会收集在方程式（5）-（6）-（7），基本上你需要记住这三个方程式。

投影在子空间

从 Rm 的 n 个向量 a1，..，an 开始，假设这些 a＇s 是线性无关。

问题：找出组合 p=x1a1+..+xnan，使得 p 最靠近给定的向量 b。

我们是把 Rm 的每个 b 投影至 a＇s 生成的子空间。

当 n=1（一个向量 a1），就是投影至一条直线，这条直线是 A 的列空间，A 只

有一个列，一般来说 A 有 n 个列 a1，..，an。

Rm 中的组合是列空间中的向量 Ax，我们在寻找最靠近 b 的特解 p=A（投影），

x 上方的帽子指出这是最佳选择，产生列空间中最靠近的向量。当 n=1，这个

选是当 n1 我现在要找出最

我们像以前一样用三个步骤来计算在 n 维子空间的投影：

找出向量，找出投影 p=A，求出投影矩阵 P。

关键在几何！图 4.6 的点线从 b 到子空间中的最近点 A，误差向量 b-A 与

子空间垂直。误差 b-A 与基底的所有向量 a1，an 的角度都是直角，这 n 个直

角得到 n 个的方程式：

a1（b-4x）=0 或

（4）

a（b-Ax）=0

具有行 aT 的矩阵是 AT，这 n 个方程式就是 AT（b-Ax）=0。

改写 AT（b-Ax）=0 成为著名的形式 ATAx=ATb，这是的方程式，系数矩阵

是 ATA。我们现在可以依照顺序求出与 p 与 P。

网址：linear.neocities.org 箱：876152660@qq.com 211

组合 p=x1a1+..+xnan=A＆，其中 p 是从到 b 的最近点：

求（n×1）

AT（b-Ax）=0 或 ATAx=ATb

（5）

对称矩阵 ATA 是 n×n，如果 a＇s 无关，ATA 是可逆，解是 x=（ATA）-1ATb。b 在子空间的投影是 p:

求 p（m×1）

P=A=A（ATA） ＇ATь

（6）

下个公式饰选出投影矩阵，它就是（6）中乘 b 的部分

求 P（m×m）

P=A（ATA）AT

（7）

比较在直线的投影，当 A 只有一列时：ATA=aTa。

当 n=1，

－b 与 p=a 与 P-00

这些公式与（5）与（6）与（7）完全相同，数字 aTa 变成矩阵 ATA。当它是个数字，我们除以它，当它是个矩阵，我们逆反它，新的公式包含（ATA）1 而不是 1/（aTa）。这些列 a1，.，an2 的线性无关确保逆矩阵的存在。

关键的步骤在于 AT（b-Ax）=0，我们使用几何学（e 与每个 a 正交），线性代数也给出「正态方程式（normal equation）」，这是非常快速又美丽的方法：

1. 我们的子空间是 A 的列空间。

2. 向量 b-A 与列空间垂直。

3. 因此 b-A 在 AT 的零空间中！意思就是 AT（b-Ax）=0。

左零空间在投影非常重要，AT 的零空间包含误差向量 e=b-Ax，向量 b 分成投影 p 与误差 e=b-p 投影产生直角三角形的三个边个 p，e 与 b。

解计算方形矩阵 ATA，也计算向量 ATb:

请尊重版权与译者的劳动成果，侵权必究！ 212

现在求解正态方程式 ATAx=ATb 得到：

B］-［得到

（8）

组合 p=Ax 是 b 在 A 的列空间的投影：

，误差 e=

b

－p

一

（9）

两个计算上的检查。第一个，误差 e=（1，-2，1）与两个列（1，1，1）与（0，1，2）都垂直。第二个，矩阵 P 乘 b=（6，0，0）正确的得到 p=（5，2，-1）。在我们得到 P 时，立即可以对特定的 b 求解问题。

投影矩阵是 P=A（ATA）1AT，ATA 的行列式是 15-9=6；所以（ATA）-1 容易解决。A 乘（ATA）-1 乘 AT 得到 P:

w--

（10）

我们必须有 P2=P，因为第二次的投影不会改变第一次的投影。

警告：矩阵 P=A（ATA）-1AT 具有误导性，你可能会尝试分开（ATA）-1 变成 A-1 乘（AT）1。如果你犯了这个错误继续代入 P，你会发现 P=AA-1（AT）-1AT。很显然全部都消除了，看起来就是 P=I，单位矩阵，我们要来说明为什么是错误。

矩阵 A 是矩形，没有逆矩阵。因为没有最前方的 A1，我们不能分开（ATA）变成 A-1 乘（AT）-1。

在我们的经验看来，牵涉到矩形矩阵的问题大部分都会得到 ATA。当 A 有无关的列，AA 是可逆。这个事实非常重要，所以我们要清楚的阐述并且证明。ATA 是可逆当且仅当 A 有线性无关的列。

证明 ATA 是方形矩阵（n×n），对于每一个矩阵 A，我们现在展示 ATA 与 A 有相同的零空间。当 A 的列是线性无关时，它的零空间只包含零向量，则有相同零空间

的 ATA 是可逆。

令 A 是任意矩阵，若 x 在它的零空间中则 Ax=0，左乘 AT 得到 ATAx=0，所以 x 也在 ATA 的零空间。

现在从 ATA 的零空间开始，由 ATAx=0，我们必须证明 Ax=0。我们不能左乘（AT）1，这个通常都不存在，只能乘 xT:

（x）A+Ax=0 或（Ax）+Ax=0 或‖Ax‖2=0

（11）

我们已经展示：若 AAx=0 则 Ax 有零长度，因此 Ax=0。在一个零空间中的每个向量 x，也会在另一个零空间中。若 A①A 有相关的列，A 也是。若 A①A 有无关的列，A 也是。这就是最好的情况：ATA 是可逆。

网址：linear.neocities.org 箱：876152660@qq.com 213

当 A 有无关的列，AA 是方形，对称，可逆。

再次强调：AA 是（n×m）乘（m×n），ATA 是方形（n×n）。它是对称，因为它的转置是（ATA）T=AT（AT）T 等于 ATA。我们刚才证明了 ATA 可逆－假设 A 有无关的列。注意无关列与相关列的差别：

AT

A

ATA

A

ATA

相关

奇异

无关

可逆

非常简单的摘要要找出投影 p=x1a1+..+nan，求解 ATAx=ATb，得到 x，投影是 p=Ax 以及误差 e=b-p=b-Ax，投影矩阵 P=A（ATA）1AT 得到 p=Pb。

矩阵满足 P2=P，从 b 到子空间 C（A）的距离是‖e‖。

主要观念的复习

1.b 在通过 a 的直线的投影是 p=ax=a（aTb/aTa）。

2. 秩一投影矩阵 P=aaT/aTa，P 乘 b 得到 p。

3. 把 b 投影在子空间出现 e=b-p 与子空间垂直。

4. 当 A 有满秩 n，方程式 ATA=ATb，得到与 p=A。

5. 投影矩阵 P=A（ATA）-1AT，且 PT=P，P2=P，Pb=p。

已解范例

4.2A 把 b=（3，4，4）投影在通过 a=（2，2，1）的直线，然后投影在同时包含 a＊=（1，0，0 の的平面。检验第一个误差向量 b-p 与 a 垂直，第二个误差向量 e＊=b-p＊也与 a 垂直。

求出 3×3 投影矩阵 P 会把向量投影在包含 a 与 a＊的平面。找出一个向量在上述平面的投影是零向量，为什么它就是误差 e＊?

请尊重版权与译者的劳动成果，侵权必究！ 214

解 b=（3，4，4）在通过 a=（2，2，1）的直线的投影是 p=2a:

投影在直线 p=（a1b/aa）a=1（22，1）=（44，2）=2a

误差向量 e=b-p=（-1，0，2）与 a=（2，2，1）垂直，所以 p 是正确。

包含 a=（2，2，1）与 a＊=（1，0，0）的平面是 A=［aa＊］的列空间：

现在 p＊=Pb=（3，4.8，2.4），误差 e＊=b-p＊=（0，-.8，1.6）与 a 及 a＊垂直。这个 e＊在 P 的零空间中且它的投影是零！注意 P2=P=PT。

4.2B 假设你的心跳量测每分钟是 x=70，然后是 x=80，再然后是 x=120。这三个方程式 Ax=b 只有一个未知数，且 A=［111］，b=（70，80，120）。最佳是 70，80，120 的

。使用微积分与投影：

1. 求解 dE/dx=0，极小化 E=（x-70）2+（x-80）2+（x-120）2。

2. 把 b 投影在 a=（1，1，1），找出 x=ab/aa

解最接近高度 70，80，120 的水平线是平均值 = 90:

dE/2-0+80+212）得到 =++10

利用投影：x=ab/aa=（1.1）（70.80.120）_70+80+120=90

在递归最小二乘，第 4 个量测值 130 把平均值 xOLD=90 变成 NEW=100。验证更新公式 NEw=xOLD+（130-xOLD）/4。当我们得到一个新的量测值，我们不需要把旧的量测值再度平均！

问题集 4.2

问题 1-9 问投影 p 至直线，误差 e=b-p，矩阵 P。

1 把 b 投影在通过 a 的直线，验证误差 e 与 a 垂直：

网址:linear.neocities.org 箱：876152660@qq.com 215

2 画出 b 在 a 的投影，也计算 p=a:

3 问题 1 中，求投影矩阵 P=aaT/aTa 在通过每个 a 的直线的投影。验证两个情形下都有 P2=P。依据两种情形下的 Pb 计算投影 p。

4 建立问题 2 中在通过 a 直线的投影矩阵 P1 与 P2。（P1+P2）2=P1+P2 正确吗？如果 P1P2=0 前式才会成立。

5 分别计算在通过 a1=（-1，2，2）的直线以及 a2=（2，2，-1）的直线的投影矩阵 aaT/aTa。把投影矩阵相乘，并解释为什么他们的乘积 P1P2 会是这样的结果？6 把 b=（1，0，0）投影在通过问题 5 中的 a1 与 a2 的直线，也投影在 a3=（2，-1，2）。把三个投影相加 p1+P2+P3。

7 继续问题 5-6，求出在 a3=（2，-1，2）的投影矩阵 P3，验证 P1+P2+P3=I。这是因为基底 a1，a2，是正交。

］

a2 H

al

b =

P2a1

a2 =

al

PiP2a1

问题 5-6-7：正交

问题 8-9-10：不正交

8 把 b=（1，1）分别投影在通过 a1=（1，0）与 a2=（1，2）的直线，画出投影 p1 与 p2，

再计算 p1+p2。因为 a＇s 不正交，投影相加不会等于 b。

9 问题 8 中，b 在 a1 与 a2 形成的平面的投影会等于 b。求 P=A（ATA）-1AT，其中 A=［a1a2］=［］= 可逆矩阵。

10 把 a1=（1，0）投影在 a2=（1，2），然后把得到的结果再投影回到 a1。画出这些投影然后计算投影矩阵的乘积 P1P2：这是投影吗？

请尊重版权与译者的劳动成果，侵权必究！ 216

问题 11-20 询问投影，投影矩阵，在子空间。

11 求解 AAx=ATb 得到 b 在 A 的列空间的投影 p=Ax。

－-

求 e=b-p，它应该与 A 的列垂直。

12 计算问题 11 的两个在列空间的投影矩阵 P1 与 P2。验证 P1b 得到第一个投影 P1，也验证 P22=P2。

13（快速与推荐）假设 A 是把 4×4 单位矩阵移除最后一列的矩阵，所以 A 是 4×3。把 b=（1，2，3，4）投影在 A 的列空间，投影矩阵 P 的形状为何？P=?

14 假设 b 是 2 乘 A 的第一列，b 在 A 的列空间的投影为何？本案例是否 P=I? 当 b=（0，2，4）以及 A 的列是（0，1，2）与（1，2，0），计算 p 与 P。

15 如果 A 变成 2 倍，则 P=2A（4ATA）-12AT，与 A（ATA）1AT 相同。2A 的列空间与

相同，A 与 2A 的是否相同？

16（1，2，-1）与（1，0，1 的哪个组合最接近 b=（2，1，1）

17（重要）若 P2=P 证明（I-P）2=I-P。当 P 投影至 A 的列空间时，I-P 会投影至

18（a）若 P 是在通过（1，1）的直线的 2×2 投影矩阵，则 I-P 是在

的投影

矩阵。

（b）若 P 是在通过（1，1，1）的直线的 3×3 投影矩阵，则 I-P 是在

的投

影矩阵。

19 要求出在平面 x-y-2z=0 的投影矩阵，选择平面的两个向量使得他们是 A 的列，这个平面就是 A 的列空间！计算 P=A（ATA）1AT。

20 要求出在平面 x-y-2z=0 的投影矩阵，写出一个与平面垂直的向量 e，计算投影 Q=eeT/eTe，则 P=I-Q。

问题 21-26 展示投影矩阵满足 P2=P 与 PT=P。

21 矩阵 P=A（ATA）1AT 乘以自己，消除之后证明 P2=P。解释为什么 P（Pb）永远等于 Pb：向量 Pb 在 A 的列空间中，所以对列空间的投影是

22 计算 PT 证明 P=A（ATA）AT 是对称，记得对称矩阵的逆矩阵还是对称。

网址：linear.neocities.org 邮箱：876152660@qq.com 217

23 若 A 是方形可逆，对于分割（ATA）-1 的警告就不适用了，AA1（AT）1AT=I 是真实的。当 A 可逆，为什么 P=I? 误差 e 为何？

24AT 的零空间与列空间 C（A）是

，所以若 ATb=0，b 在 C（A）的投影应该

是

。检查 P=A（ATA）-1AT 可以得到答案。

25 在 Rm 的 n 维子空间的投影矩阵的秩 r=n。理由：投影 Pb 填满子空间 S，所以 S 是 P 的

26 若 m×m 矩阵有 A2=A 且秩是 m，证明 A=I。

27 结束本段落的重要事实：若 AAx=0，则 Ax=0。新的证明：向量 Ax 在

的零空间，Ax 永远在

的列空间。要同时在两个垂直的子空间中，Ax 必须是零。

28 利用 PT=P 且 P2=P，证明列 2 长度的平方永远等于对角单元 P22。这个数字 29 若 B 的秩是 m（满行秩，无关的行），证明 BBT 是可逆。

挑战问题

30（a）求出在 A 的列空间的投影矩阵 Pc（仔细观察矩阵之后！）:

（b）求出在 A 的行空间的 3×3 投影矩阵 PR。执行 B=PCAPR，你的答案 B 会

有一点小惊奇－你能解释吗？

31 在 Rm，假设我给你 b 以及 a1a 的组合 p，你如何测试 p 是不是 b 在 as 生成子空间的投影？

32 假设 P1 是在 A 的第一列生成的 1 维子空间的投影矩阵，假设 P2 是在 A 的 2 维列空间的投影矩阵。稍微想想，计算 P2P1。

请尊重版权与译者的劳动成果，侵权必究！ 218

33 假设你知道 b1，b2…，平均值，当第 100 个到来，检验新的平均值是 xod 与错位（mismatch）b1000-xold 的组合：

S=A++A000++500+100（G000+000

这是「卡尔曼滤波器」xnew=xold+（b1000-xold）/1000，其中增益矩阵 1/1000。本书的最后一页把卡尔曼滤波器延伸至矩阵的更新。

34（2017）假设 P1 与 P2 是投影矩阵（P2=P1=P1）。证明这个事实：

P1P2 是投影矩阵当且仅当 P1P2=P2P1

网址:linear.neocities.org 箱：876152660@qq.com 219

4.3 最小二乘近似

1 求解 ATAx=ATb 得到 b 在 A 的列空间的投影 p=Ax。

2 当 Ax=b 无解，是「最小二乘解」：‖b-A‖2 = 极小值。

3 令 =『的部分导数为 0（-）会产生 = Ab

4 利用一条直线去适配点（t1，b1），.，（tm，bm），A 有（1，.，1）与（t1，..，tm）的列。5 在上述的情形下，44 是 22 阵 4 是向

Ax=b 经常是无解，一般的理由是方程式太多。矩阵 A 的行比列多，方程式

的个数大于未知数的个数（m 大于 n）。这 n 个列只生成了 m 维空间的一小部分，

除非所有的量测值都很完美，否则 b 会落在 A 的列空间之外。消元法得到不可能

存在的方程式然后停止，但是我们不能停止，因为量测值必然包含杂讯。

重复：我们不可能一直把误差 e=b-Ax 降为零，当 e 是零，x 是 Ax=b 的确

切解。当 e 的长度尽可能的小，父就是「最小二乘解（least squares solution）」。我

们在本段落的目标是计算并且使用，还有很多实际的问题需要解答。

前一个段落强调 p（投影），本段落强调（最小二乘解），他们之间借由 p=A 得

到关联，基础方程式还是 ATA=ATb。此处有一个非正式的方法得到「正态方程

式」：

当 Ax=b 无解，左乘 AT 然后求解 ATAx=ATb。

范例 1 最小二乘的一个重要应用是对于 m 个点适配一条直线，从 3 个点开始：

求最接近点（0，6），（1，0），（2，0）的直线。

没有直线 b=C+Dt 通过这三个点，我们现在要求两个数字 C 与 D 满足三个方程

式：n=2 且 m=3。此处的三个方程式在 t=0，1，2 要适配给定的值 b=6，0，0:

t=0

若 C+D-0=6 则第一个点在直线 b=C+Dt

t=1

若 C+D·1=0 则第二个点在直线 b=C+Dt

t=2

若 C+D·2=0 则第三个点在直线 b=C+Dt

请尊重版权与译者的劳动成果，侵权必究！ 220

这个 3×2 的系统无解：b=（6，0，0）不是列（1，1，1）与（0，1，2）的一个组合。从这些方程式得到 A，x 与 b:

Ax=b 无解

同样的数字在前个段落范例 3 出现过，我们计算 =（5，－3）。这些数字是最佳的 C 与 D，所以 5-3t 是这三个点的最佳直线。我们必须让投影与最小二乘产生关联，这就要说明为什么 ATAx=ATb。

实际的问题上，可能轻易有 100 个点而不是 3 个点，他们没有办法适配任何的直线 C+Dt。我们的数字 6，0，0 夸大了误差，你可以在图 4.6 看到 e1，e2 与 e3。

极小化误差

我们如何使得误差 e=b-Ax 尽可能的小？这是一个有着美丽答案的重要问题。最佳 x（称为 x）可以从几何学（误差 e 与 A 的列空间的夹角是 90°）。也可以从代数求得：ATAx=ATb。微积分也有相同的答案：误差 | Ax-b|2 的导数在为 0。

从几何学每个 Ax 都落在列（1，1，1）与（0，1，2）的平面，在这个平面上，我们寻找最接近 b 的点，这个「最近点」就是投影 p。

A 最佳选抒是 p，最小可能的误差是 e=b-p，与这些列垂直。这三个在高度（1，P2，P3）的点确实在同一个平面，因为 p 在 A 的列空间中。当我们适配一条直线时，x 是（C，D）的最佳选择。

从代数每个向量 b 分成两部分，在列空间的部分是 p，垂直部分是 e。我们无法求解这个方程式（Ax=b），但是我们可以也确实求解一个方程式 Ax=p（移除 e 然后求解 ATAx=ATb）:

Ax=b=p+e 不可能求解；Ax=p 有解：是（ATA）-1ATb

（1）

Ax=p 的解得到最小可能的误差（就是 e）:

任意 x 的长度平方‖Ax-b|‖2=‖Ax-p‖2+‖e‖2

（2）

这是直角三角形公式 c2=a2+b2，列空间的向量 Ax-p 与左零空间中的 e 垂直。选择 x=，我们把 Ax-p 降低至 0，这就留下了最小可能误差 e=（e1，e2，e3），这是我们不能降低的。

注意「最小」的意义是什么，Ax-p 的长度平方被极小化。

最小二乘解 x 使得 E=‖Ax-b‖2 尽可能最小。

图 4.6a 显示最近线，它的错失距离是 e1，e2，e3=1，-2，1，这些都是铅垂线距离。这条最小二乘线极小化 E=e12+e22+e32。

网址：linear.neocities.org 箱：876152660@qq.com 221

图 4.6b 显示在三维空间（b，p，e 空间）相同的问题，向量 b 不在 A 的列空间，这是为什么不能求解 Ax=b 的原因，没有直线穿过这三个点。最小可能误差是垂直向量 e，这是 e=b-Ax，误差向量（1，－2，1）在这三个方程式中，就是与最佳直线的距离。潜藏在两个图形背后的是基础方程式 ATAx=ATb。

列空间

b1 =6 X

a2

e1 = 1

P1 = 5

最佳直线 b=5-3t

al

p2=2

b

52

6

e2=-2

b3 = 0

b

×

e3 = 1

00

t b2=0

e

P3 =-1

误差 = 到直线的铅垂线距离

e = （1，-2，1）

图 4.6：最佳直线与投影：两个图形，同样问题。直线有高度 p=（5，2，-1）且误差 e=（1，-2，1）。方程式 ATAx=ATb 得到 x=（5，-3），相同答案！最佳直线是 b=5-3t 且最近点是 p=5a1-3a2。

注意误差 1，－2，1 加起来等于 0。理由：误差 e=（e1，e2，e3）与 A 的第一列（1，1，1）垂直，点积得到 e1+e2+e3=0。

从微积分大部分函数的极小化都是利用微积分！图形降到最低点而且在每一个方向的导数为零。此处要极小化的误差函数 E 是平方的总和 e12+e2+e32（每个方程式中误差的平方）:

E=|Ax-b|2=（C+D.0-6）2+（C+D.1）2+（C+D.2）2

（3）

未知数是 C 与 D，两个未知数配上两个导数－在极小值时都是 0。他们是「部分导数」，因为∂E/0C 把 D 视为常数，∂E/∂D 把 C 视为常数：

0E/0C=2（C+D.0-6）+2（C+D.1）+2（C+D.2）=0

∂E/0D=2（C+D·0-6）（0）+2（C+D·1）（1）+2（C+D·2）（2）=0

∂E/∂D 包含来自链条法则的额外因子 0，1，2。（最后一个（C+D·2）2 的导数是 2 乘 C+2D 乘额外的 2。）在∂E/∂C 时，这些因子只是 1，1，1 而已。

请尊重版权与译者的劳动成果，侵权必究！ 222 毫无意外的 | Ax-b|2 的导数的因子 1，1，1 与 0，1，2 是 A 的列。现在消去每一项的 2 然后收集全部的 C＇s 与全部的 D＇s:

C 导数是零：3C+3D=6

D 导数是零：3C+5D=0

矩阵］是 AA

（4）

这些方程式与 ATAx=ATb 完全相同，最佳的 C 与 D 是分量。来自微积分的方程式与来自线性代数的正态方程式完全相同，这些是最小二乘的关键方程式：

当 ATAx=ATb，‖Ax-b|2 的部分导数是零。

解是 C=5 与 D=-3，因此 b=5-3t 是最佳直线－它与这三个点最接近。在 t=0，1，2 时，这条线通过 p=5，2，-1，它不会通过 b=6，0，0。误差是 1，－2，1，这是向量 e

最小二乘的大图

本书的关键图形显示 4 个子空间与矩阵的真实作用，图 4.3 左侧的向量 x 走到右侧的 b=Ax，在这个图形中 x 分割成 x+xn，存在很多 Ax=b 的解。

本段落的情况刚好相反，Ax=b 无解。我们不分割 x，而是分割 b=p+e。图 4.7 显示最小二乘的大图，我们求解 Ax=p 而不是求解 Ax=b，误差 e=b-p 是无法避免的。

p 在列空间中

在 Rm 的

行空间是

则对 p 有解

列空间

所有的 R＂

Ax=p

p=Pb

最佳￡

Ax=b

最接近 b

b 不在列空间中

b=p+e

则对 b 无解

0

e = 极小误差

无关的列

零空间 =｛0｝

AT 的零空间

图 4.7：投影 p=Ax 接近 b，所以小化 E=‖Ax-b‖2。

注意零空间 N（A）是如何的小－只有一个点，由于无关的列，Ax=0 的唯一解是 x=0，方程式 ATAx ATb 完全决定了最佳向量。误差有 ATe=0。

网址：linear.neocities.org 邮箱：876152660@qq.com 223

第七章会有完整的图形－包含所有的 4 个子空间。每个向量 x 分割成 x，+xn，每个 b 分割成 p+e，最佳解是在行空间的 x=，。我们不能帮助 e，我们不要来自零空间的 xn- 这就留下了 Ax=p。

适配一条直线

适配一条线是最小二乘最清晰的应用，从 m>2 个点开始，希望能够接近一条直线。在时间点 t，，m，那 m 个点的高度在 b1，…b 最佳直线 C+Dt 错失这些点的垂直距离是 e1，.，em。没有直线是完美的，最小二乘线极小化 E=e12+.+em2。第一个例子是本段落图 4.6 所示的三个点问题，现在我们允许 m 个点（m 可以是很大），x 的两个分量仍然是 C 与 D。

当我们确切求解 Ax=b 时，这条直线会通过这 m 个点，一般情况下我们无法做到。两个未知数 C 与 D 决定一条线，所以 A 只有 n=2 个列。要想适配 m 个点，我们尝试求解 m 个方程式（我们只有两个未知数！）：

C+Dty=b

Ax=b 是 C+Dt2=b2 其中 A=

（5）

C+ Dtm=bm

列空间是如此的薄，使得大部分的 b 都落在列空间之外。当 b 碰巧在列空间中，点也磁巧落在直线上，此时 b=p，则 Ax=b 有解，误差是 e=（0，….）

C+ Dt p1，..， Dm e， ..， m s

求解 ATAx=ATb 得到 =（C，D），误差是 ei=bi-C-Dti。

直线上的适配点非常重要，我们一劳永逸的给定两个方程式 ATAx=ATb。A 的两个列是无关的（除非所有的时间点 t 都相同），所以我们转移到最小二乘并且求解 ATAx=ATb。

（6）

正态方程式的右侧是 2×1 向量 ATb:

（7）

在特定问题中，这些数字是给定的。最佳 =（C，D）=（ATA）1ATb。

当 ATA＆=ATb 时，直线 C+Dt 极小化 e12+..+em2=‖Ax-b‖2:

请尊重版权与译者的劳动成果，侵权必究！ 224

AТA =AТb

（8）

直线上 m 个点的垂直误差是 e=b-p 的分量，这个误差向量（残余）b-Ax 与 A 的列垂直（几何学），误差在 AT 的左零空间中（线性代数）。最佳 x=（C，D）极小化总误差 E，E 是平方的和（微积分）：

E（x）=|Ax-b|2=（C+Dt1-b1）2+..+（C+Dtm-bm）2

微积分令 0E/0C 与∂E/0D 等于 0，以及 ATAx=ATb。

另一个最小方程式问题的未知数比 2 来得多，适配最佳抛物线要有 n=3 个系数 C，D，E（见下方）。一般来说，我们用 n 个参数 x1，..，xn 适配 m 个资料点，矩阵 A 有 n 个列且 n<m。‖Ax-b|2 的导数得到 ATAx=ATb，平方的导数是线性的，这是为什么最小二乘会流行的原因。

范例 2 当量测时间点 t2 的总和为零时，假设在时间点 t=-2，0，2，b=1，2，4，这些时间点的总和是零。A 的列有零的点积：（1，1，1）与（-2，0，2）正交：

C+D（-2）=1

C+D（0）=2 或 Ax=

C

C+ D（2）=4

1

24

当 A 有正交的列，ATA 会是一个对角矩阵：

－л ］［］-［3

（9）

重点：由于 ATA 是对角，可以分开求解 C=7/3 与 D=6/8，在 ATA 中的零是 A 的垂直列的点积。当单元数 m=3 且 t12+t2+t32=8，对角矩阵 ATA 基本上与单位矩阵有差不多的性质。

正交矩阵非常有帮助，所以值得我们借由减去时间平均值？=（t1+..+m）/m 完成时间点的平移。如果原始时间点是 1，3，5，则平均值是 = 3，平移时间是 T=t-2=t-3，总和变成零！

T=1-3=-2

T=3-3= 0

4-g

T3=5-3= 2

现在 C 与 D 直接来自简单的方程式（9），则最佳直线 C+DT 就是 C+D（t-）=C+D（t-3）。问题 30 甚至给定一个 C 与 D 的公式。

网址：linear.neocities.org 箱：876152660@qq.com 225

那是一个「格莱姆－施密特概念」的完美例子，下个段落会介绍：事先使得列变成正交，则 ATnew Anew 是对角且 new 变得简单。A 的相关列：是什么？

本章从头开始一直假设 A 的列是无关，ATA 是可逆，ATAx=ATb 得到 Ax=b 的最小二乘解。

如果 A 的列是相关，什么样的是最佳？下面是个特殊的例子。

］-］-

b1 = 3、

b2 = 1 +

Ax=b

Ax =p

+

t

T=1

量测值 b1=3 与 b2=1 在相同的时间点 T！直线 C+Dt 不可能同时通过两个点，我想我们把 b=（3，1）投影到 A 的列空间的 p=（2，2）是正确的，这样把方程式 Ax=b 变成 Ax=p，一个无解的方程式变成一个有无限多解的方程式，问题在于 A 有相关的列以及（1，－1）在它的零空间中。

我们应该选择哪个解？图中所有的虚线在时间点 T 有相同的两个误差 1 与－1，误差（1，－1）=e=b-p 要尽可能的小，但是没有告诉我们哪条虚线是最佳。我的直觉是选择在高度 2 的水平线，如果最佳直线的方程式是 b=C+Dt，我选择 x1=C=2 与 x2=D=0。但是如果直线写成 b=ct+d 呢？这也是同样正确的（只是反转 C 与 D）。现在水平线有 x1=c=0 与 x2=d=2。我看不到其他出路。在段落 7.4，A 的「伪逆矩阵（pseudoinverse）」会选出 Ax=p 的最短长度解。此处最短解是 x+=（1，1），这是在 A 的行空间中的特解，且 x + 的长度是√2。（两个解 x=（2，0）与（0，2）的长度都是 2。）我们是任意选取解 x 的零空间分量为零。当 A 有无关的列，零空间只包含零向量且伪逆矩阵是我们正常的左逆矩阵 L=（ATA）1AT。当我写成这个形式，伪逆矩阵听起来好像是选取 x 的最佳方式。

注解 MATLAB 的奇异矩阵试验不是得到 Inf 就是 NaN（不是一个数）或是 1016（不好的数），每个情况都会有警告出现！我相信 Inf 与 NaN 与 1016 都来自可能的 0x=b 与 0x=0 与 10-16x=1。

那些是 3 个小范例来自 3 个大困难：奇异而无解，奇异而无限多解以及非常非常接近奇异。

请尊重版权与译者的劳动成果，侵权必究！ 226

适配一条抛物线

如果我们丢一颗球，想要用一条直线适配球的路径那是疯狂的行为，一条抛物线 b=C+Dt+Et2 允许球向上再向下（b 是在时间点的高度）。实际的路径不是完美的抛物线，但是投影的全部定理从近似开始。

当伽利略从比萨斜塔丢下一块石头，它会加速，距离包含一个二次项 gr2/2。（伽利略的观点是与石头的重量无关。）缺少 r2 项我们无法将卫星送进它的轨道。但是纵使出现 r2 的非线性函数，未知数 C，D 与 E 仍然是线性的出现！最佳抛物线的适配点仍然是线性代数的一个问题。

问题在时间点 1，… 的高度是点 b1，.b，利用抛物线话配这些点

解有 m>3 个点，确切适配的 m 个方程式一般是无解：

C+D1+Et2=b 是 Ax=b，矩阵是 m×3A=

（10）

C+Dtm+Etm2=bm

m m

最小二乘最接近的抛物线 C+Dt+Et2 选取 x=（C，D，E）来满足三个正态方程式。ATAx=ATb。

我可以问你如何把这个变成投影的问题吗？A 的列空间的维度是，b 的投影是 p=Ax，其中 p 是用系数 C，D，E 来组合三个列。第一个资料点的误差是 e1=b1-C-Dt-Et2，误差平方的总和 e12+__。如果你喜欢用微积分的极小化，就计算 E 相对于＿_，＿__，＿__的部分导数，当 x=（C，D，E）是 3×3 方程式系统 ATAx=ATb 的解时，这三个导数等于零。

段落 10.5 有更多最小二乘的应用，最大的应用是傅里叶级数 — 近似函数而不是近似向量。要极小化的函数从平方总和 e12+..+em2 变成误差平方的积分。范例 3 一个抛物线 b=C+Dt+Er2，在时间点 t=0，1，2 时，通过三个高度 b=6， 0，0。C，D，E 的方程式：

C+D·0+E·0²=6

C+D·1+E.12=0

（11）

C+D.2+E.22=0

这是 Ax=b，我们可以确切的求解。这 3 个资料点得到 3 个方程式与 1 个方形矩阵，解是 x=（C，D，E）=（6，-9，3）。通过这三点的抛物线如图 4.8a 所示是 b= 6-9t+3t2。

网址：linear.neocities.org 箱：876152660@qq.com 227

上述的结果对投影来说表示什么？矩阵有 3 个列，生成整个 R3 空间，投影矩

阵是单位矩阵，b 的投影是 b，误差是零。我们不需要 ATA=ATb，因为我们可

以求解 Ax=b。当然我可以左乘 AT，但是没有道理。

图 4.8 页是示了在时间点 t4 的第四点 b4，如果那个点落在抛物线上，新的 Ax

=b（4 个方程式）还是有解。当第四个点不在抛物线上，我们转移到 ATA=ATb。

那么最小二乘抛物线会保持一样，使得所有的误差都落在第四点吗？不一定哦！

最小二乘会平衡四个误差得到三个 C，D，E 的方程式。

6

0

b=6-9t +3t2

600

1424

is in R4

b4

012

b4

14

0

t

111

t4

1

2

图 4.8：抛物线在 t=0，1，2 确切的适配表示 p=b 且 e=0。第四个点离开抛物

线使得 m>n 以及我们需要最小二乗：把 b 投影到 C（4）。右侧的图形示 b-- 不

是 A 的 3 个列的组合。

主要观念的复习

1. 最小二乘解 x 会极小化 |‖Ax-b|2=xTATAx-2xTATb+bTb。这是 E，m 个方程式的误差的平方总和（m>n）。

2. 最佳来自正态方程式 ATAx=ATb，E 是极小值。

3. 利用直线 b=C+Dt 适配 m 个点，正态方程式可以得到 C 与 D。

4. 最佳直线的高度是 p=（p1，.，pm），与资料点的垂直距离是误差

e=（e1，.，em），关键方程式是 ATe=0。

5. 如果我们学试借由 n 个函数的组合去配 m 个点（n<m），这 m 个方程式

Ax=b 通常都是无解。这 n 个方程式 ATAx=ATb 得到最小二乘解－最小

MSE（均方值，mean square value）的组合。

请尊重版权与译者的劳动成果，侵权必究！ 228

已解范例

4.3A 从 9 个时间点 t=1，..，9 开始，这 9 个量测值 b1 到 b9 全部是零，第 10 个

量测值 b10=40 是一个局外者。请找出最佳水平线 y=C 可以透配这 10 个点（1，0），

（2，0），.，（9，0），（10，40），其中对于误差 E 使用三种选项：

（1）最小二乘 E2=e12+.+e102（C 的正态方程式是线性）

（2）最小极大误差 Eo=|emax|（3）最小误差和 E1=|e1|+.+|e10|

解（1）借由水平线 C=4 得到最小二乘适配 0，0，..，0，40:

A=1＇s 的列 ATA=b1 的总和 = 40 所以 10C=40

（2）最小极大误差（least maximum error）需要 C=20，在 0 与 40 的半程。

（3）最小误差和需要 C=0。若 C 从零往上增，误差和是 9|C|+|40-C | 会增加。最小和来自中位（median）量测（0，.，0，40 的中位数），许多统计学家觉得最小

二乘解会被局外者严重影响，比如 b10=40，他们比较偏好最小和，但是方程式

变成非线性。

现在找出最小二乘直线 C+Dt 通过这 10 个点（1，0）到（10，40）:

这些来自方程式（8），则 ATA=ATb 得到 C=-8 且 D=24/11。

如果你对 b=（0，0，..，40）乘 3 后再加 30 得到 bnew=（30，30，..，150），此时对于

C 与 D 会发生什么？线性允许我们重设 b 的比例，3 乘 b 会得到 3 乘 C 与 3 乘 D。

加 30 到所有的 b1 相当于 C 加 30。

4.3B 在时间点 t=-2，-1，0，1，2 得到值 b=（0，0，1，0，0），求出抛物线 b=C+Dt

+Er2 来自前述量测的最近值（最小二乘误差）。首先写下 5 个方程式 Ax=b，其中

有 3 个未知数 x=（C，D，E），目的是希望抛物线通过这 5 个点。这个必然无解，

因为没有这样的抛物线存在，只能求解 ATAx=ATb。

我会预测 D=0。为什么最佳抛物线是会环绕 t=0 对称？在 ATA=ATb 中针

对 D 的方程式 2 必须与方程式 1 与 3 解耦。

解 Ax=b 的 5 个方程式具有矩形的范德蒙德矩阵 A:

C+D（-2）+E（-2）2=0

2 4

C+D·（-1）+E·（-1）2=0

ATA 5010

C+D·（0）+E·（0）2=1 A

0 10 0

C+ D·（1）+E·（1）² =0

10034

2

C+D·（2）+E·（2）2=0

网址：linear.neocities.org 箱：876152660@qq.com 229

那些 AA 的零表示 A 的列 2 与列 1 及列 3 垂直，我们直接在 A 可以看到（时间点－2，－1，0，1，2 是对称）。抛物线 C+Dt+Et2 的最佳 C，D，E 来自 ATAx=ATb，且 D 与 C 及 E 是解耦的：

5010

C = 34/70

0100

得到 D=0，如同预测

10034 OA

100

E = －10/70

问题集 4.3

问题 1-11 利用 4 个资料点 b=（0，8，8，20）带出关键概念。

b4= 20 T

e4

b= （0，8，8， 20）

P4

e

b=C+Dt P3

p= Ca1+ Daz

e3

b?=b3=8

e2 P2

a2=（0， 1，3，4）

Pi

a1 = （1， 1，1， 1）

b1 =0 ei

1=0 2=1

3=3 4=4

图 4.9：问题 1-11：最近线 C+Dt 适配 R4 中的 Ca1+Da2

1 在 t=0，1，3，4 有 b=0，8，8，0，设定并求解正态方程式 ATAx=ATb。对于图 4.9a 的直线求出 4 个高度 p；与 4 个误差 e；。极小值 E=e12+e2+e32+e42=?2（直线 C+Dt 确实通过 p＇s）在 t=0，1，3，4 有 b=0，8，8，0，写下 4 个方程式 Ax=b（无解）。变更量测值成为 p=1，5，13，17，求 Ax=p 的确切解。

3 检验 e=b-p=（-1，3，-5，3）与同样 A 的两个列垂直。从 b 到 A 的列空间的最短距离 |‖e‖为何？

4（使用微积分）写下 E=|Ax-b|2 作为 4 个平方的总和－前一个是（C+4D-20）2。求出导数方程式∂E/0C=0 及∂E/∂D=0。除 2 得到正态方程式 ATAx=ATb。5 求出最佳水平线的高度 C 适配 b=（0，8，8，20）。确切的适配要求解无解方程式 C=0，C=8，C=8，C=20。找出这些方程式的 4×1 矩阵 A，求解 ATAx=ATb。画出在高度 = C 的水平线以及 4 个误差 e。

请尊重版权与译者的劳动成果，侵权必究！ 230

6 把 b=（0，8，8，20）投影在通过 a=（1，1，1，1）的直线，求出 x=aTb/aTa 与投影 p=a。检验 e=b-p 与 a 垂直，找出从 b 到通过 a 的直线的最短距离 |‖e|‖。7 找出通过原点且与同样 4 个点（问题 6）最接近的直线 b=Dt，确切的适配要求

解 D·0=0，D·1=8，D·3=8，D·4=20。找出 4×1 矩阵 A 并求解 AAx=Ab。重画图 4.9a 所示的最佳直线 b=Dt 以及 e＇s

8 把 b=（0，8，8，20）投影在通过 a=（0，1，3，4）的直线，求出 x=D 与投影 p=xa。

问题 5-6 的最佳 C 与问题 7-8 的最佳 D 与问题 1-4 的最佳（C，D）并不一致。这

是因为（1，1，1，1）与（0，1，3，4）是垂直。

9 针对同样 4 个点的最接近抛物线 C+Dt+Et2，写出不可解的方程式 Ax=b，

其中 3 个未知数是 x=（C，D，E），设定这 3 个正态方程式 ATAx=ATb（不需要

求解）。图 4.9a 中，你对 4 个点适配一条抛物线－在图 4.9b 中发生了什么？10 针对同样 4 个点的最接近立方线（cubic）C+Dt+Et2+Ft3，写出 4 个方程式的

Ax=b，利用消元法求解。在图 4.9a 中，这条立方线确实通过这 4 个点。求 p

与 e。

114 个时间点的平均是？=（0+1+3+4）/4=2，4 个 b＇s 的平均是 b=（0+8+8+ 20）/4=9。

（a）验证最佳直线通过中心点（t，b）=（2，9）。

（b）说明为什么 C+Dt=b 是来自 ATAx=ATb 的第一个方程式。

问题 2-16 介绍统计的基本概念－最小二乘的基础

12（推荐）这个问题把 b=（b，bm 投影在通过 a=（1，.1 线，我们求解 n

个方程式 ax=b，只有一个未知数（利用最小二乘）。

（a）求解 aax=ab 证明是 bs 的平均值。

（b）求出 e=b-a 与方差 =‖e‖2 以及标准差 |‖e‖。

（c）水平线 b=3 与 b=（1，2，6）最接近，检验 p=（3，3，3）与 e 垂直并求出 3×3

矩阵 P。

13 最小二乘背后的第一个假设：Ax=b-（平均值为 0 的杂讯）。把误差向量 e=b

－Ax 左乘（ATA）-1AT，得到在右侧的 x-x。这项估测误差－x 的平均值也是

零，估测值＆是无偏的（unbiased）。

14 最小二乘背后的第二个假设：这 m 个误差 e 是无关且方差为 o2，所以（b-Ax）

（b ー Ax）的平均值是 2I. 把（b-Ax）（b-Ax）左乘（AA）-1A 再右乘 A（AA），

证明平均值矩阵（x-x）（x-x）是（4A），这就是段落 10.2 的协方差矩阵 W

（covariance matrix）.

网址：linear.neocities.org 箱：876152660@qq.com 231

15 医生该取 4 次你的心率值，x=b1，….xb4 的最佳解是 b1b 平均值，矩阵 A 是一列的 1＇s。问题 14 得到期望误差（x-x）2 是 o2（ATA）1= 。取

平均值，方差从 2 掉到 σ2/4。

16 如果你知道了 9 个数值 b1，.b 的平均值 x，现在增多了一个数字 b10，你如何快速的求得平均值 10? 递归最小二乘的概念在于避免 10 个数字相加，计算 10 时，9 会乘什么数？

x10=b10/10+__x9=（b1+..+b10）/10 如同已解范例 4.2C。

问题 17-24 更多在的练习 x 与 p 与 e。

17 写下直线 b=C+Dt 的三个方程式，其中 t=-1 时 b=7，t=1 时 b=7，t=2 时 b=21。找出最小二乘解 x=（C，D）并画出最接近的直线。

18 找出问题 17 的投影 p=Ax，会在最接近线得到 3 个高度。证明误差向量是 e=（2，-6，4）。为什么 Pe=0?

19 假设问题 18 的量测值，在 t=-1，1，2 时，误差是 2，－6，4。计算 x 并画出最接近量测值的直线。说明答案：b=（2，-6，4）与垂直，所以投影是 p=0。

20 假设量测值在 t=-1，1，2 时，b=（5，13，17）。计算 x，接近的直线与 e。因为 b 是，所以误差 e=0。

214 个子空间的哪一个包含误差向量 e? 哪个包含 p? 哪个包含？A 的零空间为何？

22 量测值在 t=-2，-1，0，1，2 时，b=（4，2，-1，0，0），求出最佳直线 C+Dt。因

23 误差向量 e 与 b 正交？与 p 正交？与 e 正交？与 x 正交？证明‖e‖2 等于 eTb，也就是 bTb-pTb，这是最小的整体误差 E。

24|Ax|2 相对于 x1，.，xn 的部分导数是向量 2ATAx。2bTAx 的导数是向量 2ATb，所以当

时，|Ax-b|2 的导数是零。

挑战问题

25 在什么条件下，3 个点（t1，b1），（t2，b2），（t3，b3）会在一条直线上？列空间的答案:（b1，b2，b3）必颁是（1，1，1）与（t，2，t3）的组合。芸试求出关联 ts 与 b＇s 的方程式，我已经很快考虑到这个方程式。

请尊重版权与译者的劳动成果，侵权必究！ 232

26 方形 4 个角的坐标（1，0），（0，1），（-1，0），（0，－1）对应 b=（0，1，3，4），找出一个最

佳适配的平面。C+Dx+Ey=b 在 4 个点的方程式是 Ax=b，其中有 3 个未

知数 x=（C，D，E）。A 为何？在方形的中心点（0，0），证明 C+Dx+Ey=b＇s 的

平均值。

27（两条线的距离）点 P=（x，x，x）与 Q=（y，3y，-1）在空间中的两条不相交的直线

上，选择 x 与 y 极小化距离平方 | P-Q|2，连接最接近 P 与 Q 的直线与

垂直。

28 假设 A 的列是相关，你如何找出矩阵 B 使得 P=B（BTB）BT 确实得到在 A 的

列空间的投影。（一般的公式在 ATA 不可逆时会失败。）

29 在 R」中，通常会存在唯一的超平面包含 n 个给定点 x=0，a1，.，an-1。（例如 n

=3：除非

，存在一个平面包含 0，a1，a2。如何测试在 R」中恰好只有一

个平面？

30 范例 2 平移时间点 t1 使得总和是零，我们减去平均时间 =（t1+..+m）/m 得

到 T1=t1-↑，这些 T1 的总和是零。

现在列（1，.，1）与（T1，.，Tm）正交，ATA 是对角，它的单元是 m 与 T12+.+Tm2。

证明最佳的 C 与 D 有直接的公式：

T=t-î

C-h tt on

D-7

最佳直线是 C+Dt 或 C+D（t-i）。时间平移使得 AA 变成对角是格莱姆－

施密特程序的一个范例：事先正交化 A 的列。

网址：linear.neocities.org 箱：876152660@qq.com 233

4.4 正交单位基底与格莱姆－施密特

1 若列｝则是交单位

2 若 Q 也是方形，则 QQT=I 且 QT=Q-1，Q 是「正交矩阵」。

3Qx=b 的最小二乘解是 x=QTb，b 的投影：p=QQTb=Pb。

4 格莱姆－施密特程序使得无关的 a；成为正交单位的 qi，从 q1=a1/‖a1 | 开始。5g 是（a - 投影 pIla-l 投影 p=（ag）91+….（a）4-1

6 每个 a1 是 q1 至 q1 的组合，则 A=QR：正交 Q 与三角 R。

本段落有两个目的，为什么与如何，第一个目标是了解为什么正交性很棒。点积是零所以 AA 是对角，在求取与 p=A 时会变得如此简单。第二个目标是创建正交向量，你会看到格莱姆－施密特选取原始基底向量的组合获得直角。这些原始向量是 A 的列，可能不是正交，正交单位基底向量是新矩阵 Q 的列。从第三章，一组基底包含生成空间的无关向量，基底向量可以交会在任何角度（除了 0° 与 180°），但是每次我们看到坐标轴，他们都是垂直的。在我们的想象中，坐标轴实际上永远正交，简化图形以及大大简化计算。

当他们的点积 qiqj 是零，向量 q1，..，qn 是正交，更准确的说只要 i≠j 则 q1q1=0。再多一步，只要除以自己的长度 — 向量变成正交单位向量。他们的长度都是 1（正常），此时基底称为正交单位（orthonormal）。

定义向量 q1… 是正交单位，若

99，= 单位：=1

一个有正交列的矩阵都指定特殊字母 Q。

矩阵 Q 很容易处理，因为 QTQ=I。在矩阵语言中再次说明列 q1，..，qn 是正交单位，Q 不需要是方形。

请尊重版权与译者的劳动成果，侵权必究！ 234

具有正交单位列的矩阵 Q 满足 QQ=1

—q1T—

= －q2-

= I

（1）

－qnT

QT 的行 i 乘 Q 的列 j，点积是 qiTqj。非对角线（i≠j）因为正交使得点积为零，在对角线（i=j）单位向量得到 qq1=|q1|2=1。通常 Q 是矩形（m>n），有时候 m=n。

当 Q 是方形，Q=1，表示 = 2：转置 = 逆矩阵

如果列只是正交（不是单位向量），点积还是得到对角矩阵（不是单位矩阵），这个对角矩阵与 I 近乎完全相同。重要的是正交性－它很容易创建单位向量。

重复说明：尽管 Q 是矩形，还是有 QTQ=I，这种情形下 QT 只是左逆矩阵。对于方形矩阵我们也有 QQT=I，所有 QT 是 Q 的双边逆矩阵。方形 Q 的行好像列一样也是正交，逆矩阵就是转置，我们称方形的案例 Q 是正交矩阵 1。

下列有 3 个正交矩阵例子 — 旋转与排列与反射，最快的测试是检查 QTQ=I。范例 1（旋转）Q 把平面的每个向量旋转 θ 角：

Q 的列是正交（取他们的点积），因为 cos20+sin20=1，他们是单位向量，这些列是平面 R2 的一组正交单位基底。

标准基底向量 i 与 j 旋转 θ 角（见图 4.10a），Q1 把向量旋转－0 角回复原状。它与 QT 一致，因为－0 的余弦等于 θ 的余弦，sin（-0）= －sin0，我们有 QTQ=I 与 QQT=I。

范例 2（排列）这些矩阵改变向量分量的顺序成为（y，z，x）与（y，x）:

irae-a

这些 Q 的列都是单位向量（他们的长度明显是 1），他们也是正交（1＇s 出现在不同位置）。排列矩阵的逆矩阵是它的转置：Q-1=QT，逆矩阵使得分量回复原始顺序：1「正交单位矩阵」会是 Q 比较好的名字，但是没有使用它。任何具有正交单位列的矩阵就有字母 Q，但是当它是方形时，我们只称为正交矩阵。

网址：linear.neocities.org 箱：876152660@qq.com 235

每个排列矩阵是一个正交矩阵。

范例 3（反射）若 u 是任意的单位向量，令 Q=I-2uuT。注意 uuT 是一个矩阵，而 uTu 是一个数字 | u|2=1。则 QT 与 Ω－1 都等于 Q:

o＇=1-2uu＇ =0 H 0＇0=1-4uu＇ + 4uu＇ uu＇ =I

（2）

反射矩阵 I-2uuT 对称而且正交。如果把它平方你会得到单位矩阵：Q2=QTQ=I。通过镜子反射两次会回到原始状态，好像（-1）2=1。注意方程式（2）的 4uuTuuT 中间的 uTu=1。

j

Qi=j

น

镜子

旋转 θ

0

反射

i

u to －u

Qj=i

41 以及－

如果选择方向 u=（-1/√2，1/√2），计算 2uu（列乘行）然后从 I 减去，可以得到在方向 u 的反射矩阵 Q:

=1-2［53］-［¦］［］］-］

当（x，y）变成（y，x），例如（3，3）的向量并没有移动，它在反射线上。

旋转会保有每个向量的长度，反射也是，排列也是，用任何正交矩阵去乘也是－长度与角度没有改变。

证明‖Qx|2 等于‖x|2，因为（Qx）T（Qx）=xTQTQx=xTIx=xTx

若 Q 有正交单位列（Q=D），它会保持长度不变：

Qx 有相同长度对于每个向量 x 都有‖Qx‖=‖x‖

（3）

Q 也会保有点积：（Qx）T（Qy）=xTQTQy=xTy，只应用了 QTQ=I！

请尊重版权与译者的劳动成果，侵权必究！ 236

投影使用正交单位基底：Ω 代替 A

正交矩阵非常适合计算 — 当向量长度固定时，数字不会变的太大，稳定的电脑代

码尽可能使用 Q＇s。

对于投影在子空间来说，所有的公式都跟 ATA 有关，ATA 的单元是基底向量

a1，.，an 的点积 aa；。

假设基底向量是真实的正交单位，a＇s 变成 q＇s，则 ATA 简化成 QTQ=I。检视

与 p 与 P 的改善，不用 QTQ，我们打印一个空格代表单位矩阵： x=QTb 与 p=Qx 与 P=

（4）

Qx=b 的最小二乘解是 x=QTb，投影矩阵是 QQT。

没有矩阵需要逆转，这是正交单位基底的关键点。最佳 x=QTb 只有 q1，.，qn 与 b

的点积，我们有 1 维的投影！「耦合矩阵」或是「关联矩阵」ATA 现在变成 QTQ

=I，不存在耦合。当 A 是 Q，具有正交单位的列，得到 p=Qx=QQTb:

在 q＇s 的投影

（5）

重要案例：当 Q 是方形且 m=n，子空间是整个空间，则有 QT=Q1 而且 x=QTb

与 x=Q＇b 相同，这个解是确切的！b 在整个空间的投影就是 b 自己，此时 p=b

且 P=QTQ=I。

你可以认为在整个空间的投影不值一提，但是当 p=b，我们的公式把 b 从它

的一维投影中聚集起来。若 q1，..，qn 是整个空间的一组正交单位基底，则 Ω 是方

形，每个 b=QQTb 是它沿着 q＇s 的分量的总和：

b=q1（q1b）+...+9n（gnb）

（6）

转换 QQT=I 是傅里叶级数的基础，也是所有应用数学中伟大「转换」的基础。

他们把 b 或函数 f（x）打碎成为垂直的片段，借由（6）中的片段，逆转换把 b 与 f（x）

再次一起恢复。

范例 4 正交 Ω 的列是正交单位向量 q1，92，93:

m=n=3

网址：linear.neocities.org 箱：876152660@qq.com 237

b=（0，0，1）分别在 q1，293 的投影是 p1，23

（G）-32（42 ）-329（ ）=-3

前两项的总和是 b 在 q1 与 q2 的平面的投影，全部三项的总和是 b 在整个空间的投影一就是 p1+p2+p3=b 自己：

重建 b=p1+p2+P3 n+

格莱姆－施密特程序

本段落的重点在于「正交就是好」，投影与最小二乘都与 A①A 有关，当矩阵变成 QTQ=I，逆矩阵就不是问题。一维的投影是非耦合的，最佳是 QTb（只是 n 个分别的点积。）为了让此成真，我们必须说「若向量是正交单位」。现在我们说明格莱姆－施密特方法来创建正交单位向量。

从三个无关向量 a，b，c 开始，我们希望创建 3 个正交向量 A，B，C，然后（在最后会最容易）我们除以 A，B，C 的长度，就会得到 3 个正交单位向量 q1=A|A|， 92=B/|B|，93=C/|C|。

格莱姆－施密特从选择 A=a 开始，自然的接受第一个方向，下个方向 B 必须与 A 垂直。从 b 减去在 A 的投影开始，留下垂直的部分，这个就是正交向量 B:

Ab

格莱姆－施密特的第一步

B=.

（7）

图 4.11 的 A 与 B 正交，使用 AT 左乘方程式（7）验证 ATB=ATb-ATb=0。向量 B 是我们以前所的误差向量 e，与 A 垂直。注意方程式（7）中的 B 不是零（否则 a 与 b 相关），方向 A 与 B 设定完成。

第三个方向从 c 开始，它不是 A 与 B 的组合（因为 c 不是 a 与 b 的组合），但是 c 不太可能与 A 及 B 垂直，所以减去 c 在两个方向的分量得到垂直方向 C：格莱姆－施密特的下一步

（8）

这是格莱姆－施密特程序唯一的概念，从每个新向量减去在已经存在的方向的投影，这个概念在每个步骤重复 2。如果我们有第四个向量，我们会减去三个在 A，B，C 的投影得到 D。

2 我认为格莱姆有这个概念，我真的不知道施密特是哪来的。

请尊重版权与译者的劳动成果，侵权必究！ 238

C=c-p

减去投影 p

c

得到 B=b-p

В

单位向量

В

A

投影

=-

A=a b

图 4.11：首先把 b 投影在通过 a 的直线，求出正交 B 是 b-p。把 c 投影在 AB 平

面，求出 C=c-p。除以 | A‖，‖B|‖，‖C‖。

在最后或是每项都找到以后，A，B，C，D 正交向量分别除以各自的长度，得到的

向量 q1，2，93，94 就是正交单位。

格莱姆－施密特的范例假设无关但非正交向量 a，b，c:

则 A=a 有 ATA=2 且 ATb=2，从 b 减去沿着 A 的投影 p:

第一步

检验：AB=0 满足要求。现在减去 c 在 A 与 B 的投影得到 C:

下一步

－++---

检验：C=（1，1，1）与 A 及 B 都垂直。最终把 A 与 B 与 C 转成单位向量（长度 1，

正交）。A 与 B 与 C 的长度是√2 与√6 与√3，除以这些长度得到正交单位基底：

通常 A 与 B 与 C 都包含分数，大部分的 g1，92，93 都会有平方根。网址：linear.neocities.org 箱：876152660@qq.com 239

分解 A=QR

我们从一个矩阵 A 开始，它的列是 a，b，c。我们用矩阵 Q 结束，它的列是 q1，q2，q3。这些矩阵的关系为何？由于向量 a，b，c 是 q＇s 的组合（以此类推），必然存在第三个矩阵关联 A 与 Q，第三个矩阵是 A=QR 中的三角 R。

第一步是 q=a/|a|（其他向量不参与），第二步是方程式（7），其中 b 是 A 与 B 的组合，在这个步骤 C 与 q3 没有参与。下一个向量不参与正是格莱姆－施密特的关键点：

·向量 a 与 A 与 q1 沿着单一直线。

·向量 a，b 与 A，B 与 q1，2 在同一个平面。

·向量 a，b，c 与 A，B，C 与 q1，q2，q3 在同一个子空间（维度 3）。

在每一步 a1，.，ak 是 q1，.，qk 的组合，后面的 q＇s 没有参与。关联矩阵 R 是三角形，我们有 A=QR:

qiTa qiTb qiTc

［abcl=192］

q2Tbq2Tc 或 A=OR

（9）

93c

A=QR 是格莱姆－施密特的概括，左乘 QT 确认上式的 R=QTA:

（格莱姆施密特）从无关向量 a1…n 格莱姆施密特创建正交单位向量 q1…n 这些列构成的矩阵满足 A=QR，则 R=QTA 是上三角，因为后面的 q＇s 与较早的 a＇s 正交

下列是上面例子的原始 a＇s 与最终的 q＇s，R=QTA 的 i，j 单元是 QT 的行 i 乘 A 的列 j，点积 q1Ta 进到 R，则 A=QR:

近看 Q 与 R，A，B，C 的长度是 R 的对角线√2，√6，√3，Q 的列是正交单位。因为有平方根，QR 看起来比 LU 困难，这两种分解是线性代数计算的绝对中心。任何具有无关列的 m×n 矩阵 A 可以分解成为 A=QR，m×n 矩阵 Q 有正交单位的列，方形矩阵 R 是上三角形：ATA=（QR）TQR=RTQTQR=RTR。最小二乘的方程式 ATAx=ATb 简化成 RTRx=RTQTb，最终得到 Rx=QTb：赞。

请尊重版权与译者的劳动成果，侵权必究！ 240

最小二乘 RTRX=RTQTb 或 Rx=QTb 或 = R1QTb（10）不是求解 Ax=b，这是不可能的，我们利用反向代入法求解 Rx=QTb - 这个非常快速。格莱姆－施密特程序实际的成本是 mn2 次乘法，这些是用来创建正交 Q 与三角 R 得到 A=QR。

下列是非正式的代码，它对于 j=1，j=2，最终到 j=n 执行方程式（11），重要的 4-5 行从 ν=a；减去在每个 qj 的投影，i<j。代码的最后一行正态化 ν（除以 rj=‖|‖）得到单位向量 g

－与 w-w - 与－2 与－

（11）

从 a，b，c=a1，a2，a3 开始，这个代码会创建 q1，然后 B，q2 然后 C，q3:

9-a/lal B- a2 －4＇a4 4 － 5/

c＇=a-g）c=c-c）rgs=c에

方程式（11）一次减去一个投影，如同 C 与 C，这项改变称为「修正格莱姆－施密特」。这个代码在数值上比方程式（8）来得稳定，其中（8）一次性减去所有的投影。

forj=1 to n

％修正格莱姆－施密特

v=A（:，j）；

％向量 ν 从原始 A 的列 j 开始

fori= 1 ： j-1

％列 g 到已经在 Q 安顿

R（i， j）=Q（i， j）＇ v；

％计算 R=q1Ta 就是 qTv

v=v －R（i，j） ＊Q（i，j）；

％减去投影（qTv）q

end

％现在 v 与所有的 g1 到 9-1 垂直

R（i， j）= norm（v）；

％矩阵 R 的对角单元是长度

Q（:，j）=v/R（j，j）；

％向量 ν 除以它的长度得到 q

end

％ 回圈 forj=1 ：n 得到所有的 q

要恢复 A 的列 j，撤销最后一个步骤以及中间步骤的代码：

（12）

把总和移动到最左边，列 j 出现在乘积 QR=A 中。

网址：linear.neocities.org 箱：876152660@qq.com 241

告白好的软件，比如 LAPACK，应用在好的系统，比如 MATLAB，Julia 与 Python，都没有使用格莱姆－施密特代码，现在有更好的方法。「豪斯霍尔德反射」作用在 A 得到上三角 R，每次处理一个列，就如同消元法得到 LU 的 U 时相同的方法。

这些反射矩阵 I-2uuT 在第十一章有关数值线性代数中会描述。如果 A 是三角，我们甚至可以简化至 2×2 的旋转，结果永远是 A=QR 且 MATLAB 正交化 A 的指令是［Q，R］=qr（A）。我相信格莱姆－施密特仍然是很好的程序，纵使反射或是旋转会得到更完美的 Q。

主要观念的复习

1. 若正交单位向量 q1，.，qn 是 Q 的列，则 qTq=0，qqi=1 转换成矩阵乘

法 QTQ=I。

2. 若 Q 是方形（正交矩阵）则 QT=Q1：转置 = 逆反。

3.Qx 的长度等于 x 的长度：‖Ωx|‖=‖x‖。

4. 在 Q 的列空间的投影是 P=QQ，其中 Q 由 q＇s 生成

5. 若 Q 是方形则 P=Q0=1 以及每个 b=g1（9b）….9（nb）

6. 格莱姆施密特程序从 a，b，c 得到正交单位向量 1，92，93。矩阵形式是分

解 A=QR=（正交 Q）（三角 R）。

已解范例

4.4A 额外加入两个单元不是 1 就是－1 的列，使得 4×4「哈达玛矩阵」是正交。你如何把 H4 变成正交矩阵 Q?

=［］

方共矩 H=- 个单元都是 1 与的乘

H8TH8=?b=（6，0，0，2）在 H4 的第一列的投影是 p1=（2，2，2，2），求 b 在前两列生成的 2 维子空间的投影 p12 为何？

请尊重版权与译者的劳动成果，侵权必究！ 242

解 H4 可以从 H2 得到，如同 H8 可以从 H4 得到：

则 Q=H/2 有正交单位的列，除以 2 得到 Q 的单位向量。5×5 的哈达玛矩阵是不可能的，这是因为列的点积有 5 个 1＇s 且 / 或－1＇s，总和不可能是零。Hg 有长度√8 的正交列。

4.4B 正交列的关键点是什么？答案：AA 是对角且容易逆反，我们可以投影到直线然后相加，轴是正交的。

加上 p＇s 在平面的投影 P1，2 等于在正交直线的投影 p1+P2。

问题集 4.4

问题 1-12 有关正交向量与正交矩阵。

1 下列的向量配对是正交单位？或只是正交？或只是无关？

·5:5:5

有需要时改变第二个向量得到正交单位向量。

2 向量（2，2，－1）与（-1，2，2）正交，除以自己的长度求出正交单位向量 q1 与 2， 放进 Ω 的列，求 QTQ 与 QQT。

3（a）若 A 有 3 个长度都是 4 的正交列，求 ATA。

（b）若 A 有 3 个长度分别是 1，2，3 的正交列，求 ATA。

4 依据下列情形给定一个范例：

（a）矩阵 Q 有正交单位的列，但是 QQT≠I。

（b）两个向量正交，却不是线性无关。

（c）R3 的一组正交单位基底，包含向量 g1=（1，1，1）3

5 找出平面 x+y+2z=0 的两个正交向量，再使得他们之间。

6 若 Q1 与 Q2 是正交矩阵，证明乘积 Q1Q2 也是正交矩阵。（使用 QTQ=D）。

网址：linear.neocities.org 箱：876152660@qq.com 243

7 若 Q 有正交单位的列，Qx=b 的最小二乘解 x 为何？

8 若 q1 与 q2 是 R5 的正交单位向量，最接近给定向量 b 是＿_q1+__q2 的组合。9（a）当 q1=（.8，.6，0）与 q2=（-.6，.8，0），计算 P=QQT，验证 P2=P。

（b）使用 QTQ=I，证明（QQT）2=QQT，则 P=QQT 是在 Q 的列空间的投影矩

阵。

10 正交单位向量自动是线性无关。

（a）向量证明：当 C1q1+C292+C393=0，什么样的点积得到 C1=0? 相似的 C2

=0 与 c3=0，于是 q＇s 是无关。

（b）矩阵证明：证明 Qx=0 得到 x=0。由于 Q 可以是矩形，你可以使用 QT

但不能使用 Q。

11（a）格莱姆－施密特：找出由 a=（1，3，4，5，7）与 b=（-6，6，8，0，8）生成空间的正

交单位向量 g1 与 q2°

（b）平面中的哪个向量最接近（1，0，0，0，0）?

12 若 a1，a2，a3 是 R3 的一组基底，任意向量 b 可以写成

b=x1++x2-8

（a）假设 a＇s 正交单位，证明 x1=a1Tb。

（b）假设 a＇s 正交，证明 x1=a1Tb/a1Ta1。

（c）假设 a＇s 无关，x1 是＿_乘 b 的第一分量。

问题 13-25 有关格莱姆－施密特程序与 A=QR。

13 少得果与郎出限示 aB

14 计算问题 13 的格莱姆－施密特程序，令 q1=a/a‖且 q2=B/‖B‖，然后分解

成 QR:

=n］

请尊重版权与译者的劳动成果，侵权必究！ 244

15（a）找出正交单位向量 q1，92，93 使得 q1，q2 生成 A 的列空间：

（b）4 个子空间中哪个子空间包含 q3?

（c）利用最小二乘法求解 Ax=（1，2，7）。

16 多少乘 a=（4，5，2，2）最接近 b=（1，2，0，0）? 在 a 与 b 的平面找出正交单位向量 q1 与 q20

17 求出 b 在通过 a 的直线的投影：

1

a=

b= 135

p=?e=b-p=?

i 算正交位向 q1=a/l all g2=e/ll ell

18（推荐）利用格莱姆－施密特程序，从 a，b，c 找出正交向量 A，B，C:

a=（1，-1，0，0）

b=（0，1，-1，0）

c=（0， 0， 1， －1）

A，B，C 与 a，b，c 是垂直于 d=（1，1，1，1）的向量的基底。

19 若 A=QR 则 ATA=RTR=

三角乘

三角。格莱姆－施密特对 A 相当于

消元法对 ATA，其中 AA 的主元必须是 R 的对角线单元的平方。针对 A 利用格莱姆－施密特求出 Q 与 R:

＊8 旧

20 是非题（每个案例给出一个例子）：

（a）当 Q 是正交矩阵则 Q1 是正交矩阵。

（b）若 Q（3×2）有正交单位的列，则 |‖Qx|‖永远等于 | x|‖。

21 求出 A 的列空间的一组正交单位基底：

－

4

A=·1111 2013 与

－3

b

3

0

然后计算 b 在列空间的投影。

网址：linear.neocities.org 箱：876152660@qq.com 245

22 利用格莱姆－施密特求出正交向量 A，B，C:

23 找出 a，b，c（无关的列）的组合 q1，q2，q3，然后 A 写成 QR:

24（a）在 R4 中，下列方程式的解生成子空间 S，求出它的一组基底：

x1+x2+x3+x4=0

（b）找出正交补充 S + 的一组基底。

（c）在 S 找出 b1，在 S 找出 b2 使得 b1+b2=b=（1，1，1，1）。

25 若 ad-bc>0，A=QR 的单元是：

a －c a²+¢² ab+cd

［a a］

C a

0

ad-bc

Va²+c²

Va²+c²

当 a，b，c，d=2，1，1，1 以及 1，1，1，1 时写出 A=QR。当列是相关且格莱姆－施

密特崩溃时，R 的哪个单元变成零？

问题 26-29 使用方程式（11）的 QR 代码，它执行格莱姆－施密特。

26 说明为什么 C（在方程式（11）之后，利用 C 得到）等于方程式（8）的 C?

27 方程式（8）从 c 减去它沿着 A 与 B 的分量，为什么不从 c 减去它沿着 a 与 b 的

分量？

28 方程式（11）中的 mn2 次乘法是哪儿来的？

29 应用 MATLAB 的 qr 代码到 a=（2，2，-1），b=（0，-3，3），c=（1，0，0）。q 为何？问题 30-35 有关特殊的正交矩阵。

30 前 4 个小波位于小波（wavelet）矩阵 W 的列：

这些列有什么特殊？求出逆反小波转换 W1。

请尊重版权与译者的劳动成果，侵权必究！ 246

31（a）选择 c 使得 Q 是正交矩阵：

把 b=（1，1，1，1）投影至第一列，然后把 b 投影到前两列的平面。

32 若 u 是单位向量，Q=I-2uuT 是一个反射矩阵（范例 3）。从 u=（0，1）求出 Q1，

从 u=（0，√2/2，√2/2）求出 Q2。当 Q1 与 Q2 乘向量（1，2）与（1，1，1），画出反

射图形。

33 找出所有既是正交又是下三角的矩阵。

34 当 uTu=1，Q=I-2uuT 是一个反射矩阵，两次反射得到 Q2=I。

（a）证明 Qu=-u，镜子与 u 垂直。

（b）当 uv=0 求 Qv。它会反射到自己。

挑战问题

35（MATLAB）因子［Q，R］=qr（A），其中 A=eye（4）-diag（［11 1，－1］）。你在正交

化 A 的列（1，－1，0，0）与（0，1，－1，0）与（0，0，1，－1）与（0，0，0，1）。你能够重设 Q

的正交列的比例得到漂亮的整数分量吗？

36 若 A 是 mxn 且秩 n，qr（A）得到方形 Q 与 R 下方的零：

来自 MATLAB 的因子是（mxm）（mxn）4=［:［

Q1 的 n 个列是哪个基础子空间的一组正交单位矩阵？

Q2 的 m-n 个列是哪个基础子空间的一组正交单位矩阵？

37 我们知道 P=QQT 是在 Q（m×n）的列空间的投影，现在加入一个额外的列 a 得

到 A=［Qa］。格莱姆－施密特会用什么向量 q 取代 a? 从 a 开始，减去＿__，＿_

，

然后除以＿__得到 q。

网址：linear.neocities.org 箱：876152660@qq.com 247

第五章

行列式

2 反 9

3 ［E 列式 + 列在行 1 本是

线性。

4 消无法 E=［d-］EA=a（d-b）= 末无机 = daA.

5 若 A 是 n×n 则 1，2，3，4 仍然成立：当 A 是奇异，det=0；交换行会反转符号；det 在行 1 本身是线性；det = 主元的乘积。永远有：

det BA=（det B）（detA）以及 detAT=detA。这是一个惊奇的数字。

5.1 行列式的性质

方形矩阵的行列式是单一的数字，这个数字包含一个关于矩阵的惊奇信息量，它能够立即分辨矩阵是否可逆。当矩阵没有逆矩阵时，行列式为零。当 A 可逆，A 的行列式是 1/（detA）。若 detA=2 则 detA-1=1/2。事实上行列式对 A-1 的每个单元都能导出一个公式。

这是行列式的一个用途－求出逆矩阵与主元与解 Ab 的公式。对大型矩阵来说，我们很少使用这些公式，因为消元法很快速。一个 2×2 矩阵，它的单元是 a，b，c，d，它的行列式 ad-bc 显示 A 是如何随着 A 改变而改变。注意除以行列式！

A=［］有逆矩阵 4=a-b［］

（1）

请尊重版权与译者的劳动成果，侵权必究！ 248

矩阵乘逆矩阵得到 I。当行列式是 ad-bc=0，我们被要求除以零，这是不行的 — 此时 A 没有逆矩阵。（当 a/c=b/d，矩阵的两个行是平行，得到 ad=bc 以及 detA=0。）相关的行永远得到 detA=0。

行列式也与主元有关联，2×2 矩阵的主元是 a 与 d-（c/a）b，主元的乘积是行列式：主元乘积

ala-s）-

ad-bc 就是 detA

在一次行交换之后，主元变成 c 与 b-（a/c）d，这些新的主元乘积是 bc-ad。针对

的行交换会反转行列式的符号。

往前看 n×n 矩阵的行列式有 3 种方法求得：

1n 个主元的乘积（乘 1 或－1）

这是主元公式

2n！项的总和（乘 1 或－1）

这是「大公式」

3 组合 n 个较小的行列式（乘 1 或－1）

这是余子式公式

你看到加号或减号－- 在 1 与－1 之间的决策－- 是行列式的重大部分，它来自以下针对 n×n 矩阵的规则：

当矩阵的两个行（两个列）交换，行列式改变符号。

单位矩阵的行列式是 + 1，交换两个行则 detP=-1，再交换两个行则新的排列有 det P= +1。半数的排列是偶数（det P=1），半数的排列是奇数（det P=-1）。从 I 开始，半数的 P 是偶数次数的交换，半数需要奇数。在 2×2 的例子中，ad 有一个加号，bc 有减号 — 来自行交换：

－-1

另一个重要规则是线性－但是首先会有一个警告。线性不代表 det（A+B）=detA+detB，这是绝对的错误。纵使 A=I 且 B=I，这种线性还是错误。错误的规则会得到 det（I+I）=1+1=2，正确的规则是 det2I=2」。当矩阵乘 2，行列式要乘 2」（不是只有 2）。

我们不想用公式定义行列式，从它的性质开始会比较好－符号反转与线性。这些性质很简单（段落 5.1），他们是为公式做准备（段落 5.2），然后是应用，包含这三种：

（1）行列式产生 A1 与 A-1b（这个公式称为克拉默规则）。

（2）当盒子的边是 A 的行，体积是 | detA|。

（3）存在 n 个特殊数字 λ 称为特征值（eigenvalue），A-I 的行列式是 0。这

是非常重要的应用。特征值构成第六章。

网址：linear.neocities.org 箱：876152660@qq.com 249

行列式的性质

行列式有 3 个基本性质（规则 1，2，3），使用这些规则我们可以计算任何方形矩阵的行列式。这个数字写成两种形式，detA 或 | A|。注意：中括号对矩阵，直线对行列式。当 A 是 2×2 矩阵，规则 1，2，3 得到我们想要的答案：

从规则 1-3 可以延伸至规则 4-10，最后两个规则是 detAB=（detA）（detB）与 detAT=detA。我们会以 2×2 矩阵来检查所有的规则，但是不要忘记：规则适用于任何 n×n 矩阵 A。

规则 1（最简单），detI=1 适配单位立方体的体积 = 1。

1n×n 单位矩阵的行列式是 1。

1

与

·. =1

1

2 交换两个行，行列式改变符号（符号反转）。

检验：－（两侧都等于 bc-ad）

因为这个规则，我们可以求出任何排列矩阵 P 的行列式。只要对 I 持续交换行，直到你得到 P，则 detP=+1 对应偶数次的交换行，以及 detP=-1 对应奇数次。

第三个规则必须对所有矩阵的行列式做了大跳跃。

3 行列式对于个别的行是线性函数（其他行保持固定）。

如果用 t 乘第一行，t 也会乘行列式。如果第一行是相加，行列式也是相加。只有当其他行保持不变时，这个规则才能适用。注意 c 与 d 如何保持不变：

任意数 t 乘行 1，t 乘行列式

ta tb

b

=t

c d

A 的行 1 与 A＇的行 1 相加，行列式相加：

a+a′ b+b′

a＇ b′

+

d

d

第一种情形，两侧都是 tad-tbc，取出因子 t。第二种情形，两侧都是 ad+a＇d-bc-b＇c。这个规则同样适用 A 是 n×n，以及一次的行交换。

400 8 8

与

10 11 400 010 011 + 000 810 811

依据规则自身，规则 3 没有说这些行列式是多少（detA=4）。

请尊重版权与译者的劳动成果，侵权必究！ 250

组合乘法与加法，我们在一个行得到任意的线性组合。针对交换行的规则 2

可以先把那一行放在第一行，之后再换回来。

这个规则的意思不是 det2I=2detI，要得到 2I，我们必须用 2 乘两个行，因

子 2 会提出来两次：

？|-2=4||-³

这就好像面积与体积一样，把矩形变成 2 倍，面积变成 4 倍。扩展一个 n 维的盒

子 t 倍，体积会扩展 t」倍。这个关联不是偶然 — 我们会看到行列式如何等于体积。

给予规则 1-3 特殊的关注，他们完全决定了数字 detA。我们可以停在这里然

后寻找 n×n 行列式的公式（有点复杂），我们喜欢缓步前进，因为规则 4-10 会使得

行列式更容易处理。

4 若 A 有两个行相等，则 detA=0。

相等的行检查 2×2:

=0

规则 4 来自规则 2，（记得我们必须使用这个规则，而不是用 2×2 的公式。）交换

两个相等的行，行列式 D 应该要改变符号，但是 D 又保持相同，因为矩阵没有改

变，唯一会有－D=D 的数字只有 D=0 - 这必须是行列式。（注意：这个理由在布

尔代数中不成立，因为－1=1，则 D 是以规则 1，3，4 做定义。）

有两个相等的行的矩阵没有逆矩阵，规则 4 使得 detA=0，但是矩阵可以在

没有相等行的情况下，可以是奇异，行列式也可以是零！规则 5 会是关键，我们

可以做行运算（好像消元法）而不会改变 detA。

5 从另一行减去乘数乘某一行，detA 不变。

从行 2 减去 / 乘行 1

a b

a b

c-la d-lb

规则 3（线性）把左侧分割成右侧加上另一项－

，依据规则 4 这个额外项是

零：相等的行。因此规则 5 正确（不只是 2×2）。

结论正常从 A 到 U 的消元步骤不会改变行列式，所以 detA=detU。如果我们

可以从三角矩阵 U 得到行列式，就可以得到所有矩阵 A 的行列式。每个列交换会

反转符号，所以一定有 detA=±detU。规则 5 把问题缩小到三角矩阵。

6 有一整行都是零的矩阵，则 detA=0。

零的行

00

c d=0 与

=

简单证明，把另一行加到零行，行列式不变（规则 5），但是矩阵现在有两个相等的

行，所以依据规则 4，detA=0。

网址：linear.neocities.org 箱：876152660@qq.com 251

7 若 A 是三角则 detA=a11a22.ann = 对角单元的乘积。

三角

=ad 与 = ad

假设所有的对角单元都不是零，利用消元法移除非对角单元！（若 A 是下三角，从较低的行减去每一行的乘数倍；若 A 是上三角，从较高的行）。依据规则 5 行列式不变－现在矩阵是对角矩阵：

a11

0

对角矩阵

det

a22 .

= （a1） （a22）. （ann）

0

ann

依据规则 3，因子 a11 来自第一行，因子 a22 来自第二行，最终因子 a 来自最后一行，行列式就是 a11 乘 a22 乘。乘 an 乘 detI。最后使用规则 1，detI=1。如果对角单元 a＃是零该如何？则三角 A 是奇异，消元法得到零行；依据规则 5，行列式不变；依据规则 6，零行表示 detA=0，我们得到测试奇异或可逆矩阵的伟大方法。

8 若 A 奇异则 detA=0，若 A 可逆则 detA≠0。

奇异

ad-be-0

证明从 A 到 U 执行消元法，若 A 奇异则 U 有一个零行，规则得到 detA=detU=0。若 A 可逆则 U 有主元在对角线，非零主元的乘积（依据规则 7）得到非零的行列式。

乘主元

detA=±det U=±（主元的乘积）

（2）

2×2 矩阵的主元是 a（若 a≠0）与 d-（c/a）b:

行列式

eo d-edah-ad-be

这是行列式的第一个公式，MATLAB 利用主元乘积求得 det A。±detU 中的符号与行交换的次数是偶数或是奇数有关：+1 或－1 是交换行的排列矩阵 P 的行列式。

没有交换行，P=I 且 detA=detU = 主元的乘积且 detL=1:

若 PA=LU 则 det PdetA=detL detU 且 detA=±detU

（3）

请尊重版权与译者的劳动成果，侵权必究！ 252

9AB 的行列式是 detA 乘 detB:|AB|=|A|B|。

乘积规则

当矩阵 B 是 A~1，这个规则得到 A~1 的行列式是 1/detA:

A 乘 A1AA1=I 所以（detA）（detA1）=detI=1

这个乘积规则是目前为止最错综复杂的，甚至 2×2 的案例也要一些代数：

AB=（ad －be） （ps-gr）= （ap +br）（cg ds）-（ag bs） （cp+ dr）=AB

对于 n×n 的案例来说，此处有一个简洁的方法可以证明 | AB|=|A|B|。当 | B|≠0，考

虑比值 D（A）=|AB|/|B|。检查比值 D（A）具有性质 1，2，3，则 D（A）必须是行列式且

我们有 | AB|/|B|=|A|。赞。

性质 1（I 的行列式）若 A=I 则比值 D（A）变成 | B|/|B|=1。

性质 2（符号反转）当 A 的两个行交换，AB 同样的两个行也会交换，因此 | AB|

会改变符号，比值 | AB|/|B | 也会。

性质 3（线性）当 A 的行 1 左乘 t，AB 的行 1 也是，行列式变成 | AB | 左乘 t，所

以比值 | AB|/|B | 也会左乘 t。

把 A 的行 1 加到 A 的行 1，则 AB 的行 1 加到 AB 的行 1，依据规则 3，行列

式也会相加，除以 | B | 之后，比值也相加－- 如同预期。

结论比值 | AB|/B | 有 3 个与定义 A 的相同性质，因此它等于 | A|，这就证明了乘积

规则 | AB|=|A|B|。|B|=0 的案例分开处理但是很容易，因为当 B 奇异则 AB 奇异，

则 | AB|=|A|B | 是 0=0。

10 转置 AT 与 A 与相同的行列式。

转置

两侧都等于 ad-bc。

当 A 奇异时，方程式 | AT=|A | 变成 0=0（我们知道 AT 也是奇异），否则 A 会有正常

的分解 PA=LU，两侧同时转置得到 APT=ULT。依据有关乘积的规则 9 来证明

IAl=LATI:

比较 det PdetA=det L det U 且 detAT det PT=det UT det LT

第一，detL=detLT=1（两者都有 1 在对角线）。第二，det U=det UT（这些三

角矩阵有相同的对角线）。第三，detP=det PT（排列矩阵有 PTP=I，依据规则 9

得到 | PT|P|=1；于是 | PT | 与 | P | 同时等于 1 或同时等于－1）。所以 L，U，P 与 LT，UT，

PT 有相同的行列式，我们得到 detA=detAT。

网址：linear.neocities.org 箱：876152660@qq.com 253

列的重要注解对于行的每条规则都适用于列（利用转置，因为 | A|=|AT），当两个

列交换，行列式改变符号；一个零列或是两个相等的列使得行列式为零；如果一

个列乘 t，行列式也会；行列式是个别列的线性函数。

是时候停止了，性质表已经够长了，接下来我们会求出并使用行列式的公式。

主要观念的复习

1. 行列式的定义：detI=1，符号反转，以及个别行的线性。2. 消元法之后 detA=±（主元的乘积）

3.A 不可逆时，行列式为零。

4. 两个重要性质：detAB=（detA）（detB）与 detAT=detA。

已解范例

5.1A 对 A 应用下列的运算，求出 M1，M2，M3，M4 的行列式：

在 M1，每个 a 乘（-1）得到检核版符号模式。

在 M2，从 A 的行 2，3，1 减去 A 的行 1，2，3。

在 M3，把 A 的行 1，2，3 加到 A 的行 2，3，1。

M1，M2，M3 的行列式与 A 的行列式有什么关联？【本题没有 M4，原文错误】

a11 －a12 a13

行 1 - 行 3

行 1 + 行 3

－a21 a22 －a23

行 2 - 行 1

行 2 + 行 1

a31- a32 a33

行 3 - 行 2

行 3 + 行 2

解三个行列式是 detA，0，2detA，理由是：

a11a12a13］［1

M1= －1

－1

所以 detM1=（-1）（detA）（-1）

1 a31 a32 A33

1

M2 是奇异，因为行的总和是零，所以行列式是零。

依据规则 3（个别行的线性），M3 可以分割成 8 个矩阵：【圆圈处原文 3，错误】

行 1 + 行 3

行 1

行 3 行 1

行 3

行 2 + 行 1

行 2 + 行 2 + 行 1 +.+ 行 1

行 3 + 行② 行 3 行 3 行 3

行 2

除了第一与最后之外，其余的都有重复的行与零行列式。第一个是 A 以及最后一

个有两个行交换，所以 detM3=detA+detA=2detA。（尝试 A=I。）

请尊重版权与译者的劳动成果，侵权必究！ 254

5.1B 说明如何利用行运算得到下列的行列式：

（4）

解从行 1 减去行 3，然后从行 2 减去行 1，得到

现在把列 1 加到列 3，列 2 也加到列 3，得到一个下三角矩阵，其中对角线是

－a，-a，3- a：det=（-a）（-a）（3-a）。

若 a=0 或 a=3 则行列式是零。如果 a=0 我们得到全 1 矩阵，必然奇异；如

果 a=3，每个行的总和都是零－再度奇异。这些数字 0 与 3 是全 1 矩阵的「特征

值（eigenvalue）」，这个例子有揭示性并且重要，直指第六章。

问题集 5.1

问题 1-12 有关行列式的规则。

1 若 4×4 矩阵有 detA=1/2，求 det（2A）与 det（-A）与 det（A2）与 det（A1）。2 若 3 矩阵有 eA - 与 d（A（（）

3 是非题，如果对，给出理由；如果错，举出反例：

（a）I+A 的行列式是 1+detA。

（b）ABC 的行列式是 | A|B|C|。

（c）4A 的行列式是 4|A|。

（- 是试 8g

4 哪些行交换会使得这些「反单位矩阵」J3 与 J4 有 | J3|=-1 与 | J4|=+1?

‖~

5 当 n=5，6，7，计算行交换的次数使得反单位矩阵 Jn 变成单位矩阵 In。提出对

于任意大小 n 的规则，并且预测 J101 的行列式是 + 1 或是－1。

网址：linear.neocities.org 箱：876152660@qq.com 255

6 说明规则 6（若一行都是零，行列式是零）如何来自规则 3。

7 求出旋转与镜射的行列式：

8 证明每个正交矩阵（QTQ=I）有行列式 + 1 或－1。

（a）使用乘 4B=A|B 置 = T

（b）只使用乘积规则。若 | det Q|>1 则 det Q＂=（det Q）＂会爆炸。你如何知道这个不可能发生在 Q＂?

9 下列矩阵的行列式是 0，1，2 或 3?

10 若 A 的每一行的总和是零，求解 Ax=0 证明 detA=0。若这些单元的总和是 1，证明 det（A-I）=0。这个代表 detA=1 吗？

11 假设 CD=-DC，找出下列推论的错误：取行列式得到 | C|D|=-|D|C|，因此 | C|=0 或是 | D|=0，其中一个或是两者必须是奇异。（这是错误的。）

122×2 矩阵的逆矩阵似乎有行列式 = 1:

这个计算哪儿错了？正确的 detA1 为何？

问题 13-27 使用规则计算特定行列式。

13 简化 A 到 U 然后求出 detA = 主元乘积：

14 应用行运算得到上三角 U，计算

1230

请尊重版权与译者的劳动成果，侵权必究！ 256

15 应用行运算简化并计算下列矩阵的行列式：

16 求秩一矩阵与反对称矩阵的行列式:

17 反对称矩阵有 AT=-A，把问题 16 中的 1，3，4 换成 a，b，c 然后证明 | A|=0。写下一个 4×4 的例子 | A|=1。

18 应用行运算证明 3×3 的「范德蒙德行列式」是：

.

19 求出 U 与 U1 与 U2 的行列式：

20 假设你同时做了两次行运算，

从［］到［］

求第二个的行列式，它会等于 ad-bc 吗？

21 行交换：A 的行 1 加到行 2，然后从行 1 减去行 2，然后行 1 加到行 2，然后－1 乘行 1，最终得到 B。哪些规则说明

det B=| 等于－detA=-||?

这些规则可以取代规则 2 作为行列式的定义。

22 从 ad-bc，求出 A 与 A1 与 A-I 的行列式：

哪两个数字使得 det（A-）=0? 对于这些数字，写下矩阵 A-- 它应该是不可逆。网址：linear.neocities.org 箱：876152660@qq.com 257

23 从 4［求出与与以及他们的行列式哪两个特

det （A －.I） = 0?

24 使用消元法简化 A 到 U 然后 A=LU:

求出下列的行列式：L，U，A，U，L1 以及 UA。

25 若 A 的 i，j 单元是 i 乘 j，证明 detA=0（除了 A=［1］）。

26 若 A 的 i，j 单元是 i+j，证明 detA=0（除了 n=1 或 2）。

27 应用行运算计算矩阵的行列式：

28 是非题（正确则给定理由，错误则举出 2×2 的例子）：

（a）若 A 不可逆则 AB 不可逆。

（b）A 的行列式永远是主元的乘积。

（c）A-B 的行列式等于 detA-detB。

（d）AB 与 BA 有相同的行列式。

29 下列是投影矩阵的行列式 detP=1 的证明，哪儿出错了？

30（微积分问题）证明 In（detA）的部分导数得到 A1！

of of

f（a， b， c，d）=1n（ad-bc）得到

да дс =A¹

дb дd

31（MATLAB）希尔伯特矩阵 hilb（n）的 i，j 单元等于 1/（i+j － 1），求出 hilb（1），

hilb（2），.，hilb（10）的行列式。希尔伯特矩阵不好处理！hilb（5）的主元为何？32（MATLAB）对于 n=50，100，200，400 的 rand（n）与 randn（n）来说，典型（实验性）

的行列式为何？（MATLAB 的「Inf」是什么意思？）

33（MATLAB）6×6 矩阵的全部单元不是 1＇s 就是－1＇s，找出最大的行列式。

34 如果你知道 detA=6，B 的行列式为何？

从 A--6B-

行 3 + 行 2 + 行 1

行 1

请尊重版权与译者的劳动成果，侵权必究！ 258

5.2 排列与余子式

12×2:ad-bc 有 2！个带 ± 号的项。n×n:detA 加起来有 n！个带 ± 号的项。

2n=3，detA 有 3！=6 个项。两个项是 + a12a23a31 与－a13a22a31。行 1，2，3 与

列 1，2，3 在每个项出现一次。

3 因为顺序 3，2，1 需要一次交换才能恢复顺序 1，2，3，所以产生负号。

4 这六个项包含 + a11a22a33-a11a23a32=a11（a22a33-a23a32）=a11（余子式 C11）。5 永远有 detA=a11C11+a12C12+.+a1nC1n，余子式是大小 n-1 的行列式。

计算机利用主元计算行列式，本段落介绍另外两种方法。存在一个「大公式」用到全部 n！的排列，存在一个「余子式（cofactor）公式」用到大小 n-1 的行列式。最佳范例是我最喜欢的 4×4 矩阵： 2-100

我们可以用 3 种方法求出行列式：主元，大公式，余子式。

1. 主元的乘积是 2·3/2·4/3·5/4，消除之后得到 5。

2. 方程式（8）的大公式有 4！=24 项，只有 5 项不是零：【方程式（8）在 261 页】

det A= 16-4- 4-4+ 1 =5

16 来自 A 的对角线 2·2·2·2。－4 与 + 1 来自哪儿？当你能够找出这 5 项，

你就已经了解公式（8）。

3. 第一行的数字 2，－1，0，0 乘上自己来自其他行的余子式 4，3，2，1，得到 2·4-

1·3=5。这些余子式是 3×3 的行列式，余子式使用的行与列，是第一行的单

元未使用的部分。

行列式的每一项使用每个行与列一次。

主元公式

当消元法得到 A=LU，主元 d1，..，dn 在上三角 U 的对角线。如果没有牵涉到行交换，这些主元乘积就是行列式：

det A=（det L）（det U）=（1）（di d2...dn）

（1）

这个 detA 的公式出现在段落 5.1，后面有可能出现行交换，排列进入时 PA=LU， P 的行列式是－1 或 + 1。

网址：linear.neocities.org 邮箱：876152660@qq.com 259

（det P）（detA）=（det L）（det U）得到 detA=±（d1d2.. dn）

（2）

范例 1 一次行交换得到主元 4，2，1 以及重要的负号：

det A= －（4） （2） （1）=-8

奇数次的行交换（一次）代表 detP=-1。

下一个例子没有行交换。它可能是我们分解得到 LU（当时是 3×3）的第一个矩

阵，重要的是我们可以直接跳到 n×n。主元得到行列式，我们也会看到行列式如

何给出主元。

范例 2 三角矩阵 A 的前几个主元是 2，3/2，4/3，后面是 5/4 与 6/5 最终是（n+1）/n。

分解这个 n×n 可以看出行列式：

2 －1

1

2 －1

－1 2 －1

1

32 －1

－1 2

－ 23

4/3 －1

－1

－1 2

＿n-1 1

n+1

n

n

主元在 U（最后一个矩阵）的对角线。当 2 与 3/2 与 4/3 与 5/4 相乘，分数对消，这

个 4×4 矩阵的行列式是 5.3×3 的行列式是 4，n×n 的行列式是 n+1:

－1，2，-1 矩阵

detA=（2）（3/2）（4/3）..（n+1）/n）=n+1 重点：前面的主元与原始矩阵的左上角有关，这是没有行交换的矩阵都适用

的规则。前 k 个主元来自 A 的左上角的 k×k 矩阵 Ak。

角落子矩阵 Ak 的行列式是 d1d2.dk（前 k 个主元）。

1×1 矩阵 A1 只包含第一个主元 d1，这是 detA1。角落的 2×2 矩阵有 detA2=d1d2，

最终 n×n 矩阵是所有的主元乘积。

当我们开始处理整个矩阵，消元法针对左上角矩阵 AA，我们假设没有行交换

－则 A=LU 且 Ak=LkUk。一个行列式除以前一个行列式（detAk 除以 detAk-1）会全

部抵消只留下最近的主元 dk。每个主元都是行列式的比值。

来自行大的主元个主元是

（3）

当所有的左上子矩阵有 detAk≠0，我们就不需要行交换。

请尊重版权与译者的劳动成果，侵权必究！ 260

行列式的大公式

主元很容易计算，他们聚集了很多信息－- 足够求取行列式，但是它很难与原始的 a 产生联结。如果我们回到规则 1-2-3，这个部分就比较清晰，规则 1-2-3 就是线性与符号反转与 detI=1。我们希望推导出单一又明确的行列式公式，直接来自单元 aj。

这个公式有 n！个项，它的大小会快速增加，这是因为 n！=1，2，6，24，120，..。当 n=11 大概会有百万个项。n=2，这两项是 ad 与 bc。半数的项是负号（如同－bc）， 另外半数是正号（如同 ad）。n=3 有 3！=（3）（2）（1）个项。下列是六个项：

3×3 行列式

+ a11a22a33 + a12a23a31 + a13a21a32

（4）

a11a23a32 － a12a21a33 － a13a22a31

31

注意模式。每个乘积，比如 a11a23a32 各有来自每一行的一个单元，也有来自每一列的一个单元。列顺序 1，3，2 代表这个特定项有一个负号，a13a21a32 的列顺序 3，1，2 有一个正号（粗体字），正是排列告诉我们符号。

下个步骤（n=4）带来 4！=24 项，有 24 种方式从每个行每个列选取一个单元。沿着主对角线，a11a22a33a44 的列顺序是 1，2，3，4，有一个正号，这是单位排列。我从 n=2 开始推导大公式，目标是以系统化的方式得到 ad-bc。把每一行分成筒革的行：［ab=［a이］+［0b］日［cd］=［c이+［0d

现在应用线性，首先在行 1（行 2 固定）然后在行 2（行 1 固定）：

a b a 0 0 b

dc

（分割行 1）

0 b 0 b

（5）

0

/

c 0

d

（分割行 2）

C

0 d

最后一行有 22=4 个行列式。第一个与第四个是零，因为一个行是另一个行的倍数。我们剩下 2！=2 个行列式要计算：

o ale －ad bel d-ad-be

这项分割得到排列矩阵，他们的行列式提供一个正号或是负号。排列可以看出列的序列，本案例是（1，2）或（2，1）。

现在尝试 n=3，每个行分割成 3 个简单行，比如［a1100］。利用每个行的线性，detA 分割成 33=27 个简单的行列式。如果一个列的选项重复了－- 如果我们也选取了行［a2100］- 则这个简单的行列式是零。

网址：linear.neocities.org 箱：876152660@qq.com 261

我们只关注单元 a 是来自不同的列，例如（3，1，2）:

a11 a12 a13

a11

a12

a13

a21 a22 A 23

a 22

+

a23 + a21

a31 a32 a33

A33 a31

a 32

a11

a12

a13

六个项

+

a23 + a21

+

a22

a32

a33 a31

列的排序有 3！=6 个方式，所以有 6 个行列式。（1，2，3）的 6 种排列包含来自

P=I 的单位排列（1，2，3）。

列的数字 =（1，2，3），（2，3，1），（3，1，2），（1，3，2），（2，1，3），（3，2，1）

（6）

后 3 个是奇排列（一次交换），前 3 个是偶排列（0 或 2 次交换）。当列的顺序是（3，1，

2），我们选取单元 a13a21a32-— 这项特定的列顺序带来一个正号（2 次交换），A 的

行列式现在分割成 6 个简单项，取出因子 a：1

1

det A=a11@22433

+a12a23a31

1 + a13a21a32 1

1

1

1

（7）

1

1

+a11a23a32

1 + a12a21a33

+ a13a22a31

1

1

前 3 个（偶排列）有 detP=+1，后 3 个（奇排列）有 detP=-1，我们已经用系统化的

方式证明 3×3 的公式。

现在你可以看到 n×n 公式，有 n！个列的顺序。列（1，2，.，n）进到每一个可能的

顺序（a，B，..，），从行 1 选取 a1a，从行 2 选取 a2β，最终从行 n 选取 an，行列式

包含 a1a2…. 乘再乘上 + 1 或－1。半数顺序的符号是－1

A 的行列式是这 n！简单行列式的总和，再乘上 + 1 或－1，简单行列式 a1aa2β.

an 选取来自每个行每个列的一个单元。对 5×5 而言，a15a22a33a44a51 会有 detP

=-1，因为交换了 5 与 1。

detA=n！个列的排列 P=（a，β，..，ω）的总和

Σ（det P） aιa a2. aπw = 大公式

（8）

2×2 的情形是 + a11a22-a12a21（就是 ad-bc），此处 P 是（1，2）或（2，1）。

请尊重版权与译者的劳动成果，侵权必究！ 262

3×3 的情形有 3 个「右斜下」乘积（见问题 28）与 3 个「左斜下」乘积。警告：很多人相信这个模式应该也可以在 4×4 的案例使用，他们只选取了 8 项－- 但是我们需要 24 项。

范例 3（U 的行列式）当 U 是上三角，n！个乘积中只有一个不是零，这一项来自对角线：detU=+u11u22.unn。其他的列顺序至少选取一个在对角线下方的单元，U 的这些地方都是零。很快的我们选取一个数比如 u21=0，在方程式（8）的那一项确定是零。

当然 detI=1，唯一的非零项是来自对角线的 +（1）（1）.（1）。

范例 4 假设 Z 是除了列 3 不一样的单位矩阵，则

10a 0

Z 的行列式 = 01b0

0 0 c 是 c

（9）

00d1

符号为正的（1）（1）（c）（1）这一项来自主对角线，有 4！=24 个乘积（选取一个来自每个行每个列的因子），但是其他 23 个乘积都是零。理由：如果我们从列 3 选取 a，b 或 d，这一列就用尽了，来自列 3 唯一可用的选择是零。

此处有一个相同答案却是不同的理由，若 c=0，则 Z 有一整行的零，detZ=c=0 是正确的。若 c 不是零，使用消元法，从其他行减去乘数乘行 3，把 a，b，d 去除，剩下一个对角矩阵，detZ=c。

这个例子很快会用在「克拉默规则」，如果我们把 a，b，c，d 移进 Z 的第一列，行列式是 detZ=a（为什么？）改变 I 的一个列使得 Z 有容易的行列式，来自主对角线。

范例 5 假设 A 有 1＇s 在主对角线的上方与下方，此处 n=4:

0100

010 0

A= 01 U

0101 与 P= 100

0 的行列式 = 1

000

0010

001

第一行唯一的非零选择在列 2，行 4 唯一的非零选择在列 3，则行 2 与 3 必须选择列 1 与 4。换言之，detP=detA。P 行列式是 + 1（两次交换得到 2，4，1，3），因此 det A= +1.

余子式求行列式

方程式（8）是行列式的直接定义，一次性把全部都给你 — 但是你必须消化领悟它。毕竟 n！个项都必须满足规则 1-2-3（然后其他性质 4-10 跟上）。最简单的是 detI=1，已经验证完毕。

网址：linear.neocities.org 箱：876152660@qq.com 263

当你分离来自第一行的因子 a11 或 a12 或 a1a，你会看到线性。对 3×3 而言，行

列式的 6 个项可以分成 3 组配对：

detA=a11（a22 a33-a23 a32）+a12（a23a31-a21a33）+a13（a21a32-a22a31）

（8）

括号中的 3 个项称为「余子式」，他们是来自行 2 与 3 的 2×2 的行列式。第一行

贡献了因子 a1，a12，a13，下方的行贡献了余子式 C11，C12，C13。当然行列式 a11C11+

a12C12+a13C13 与 a11，a12，a13 有线性的相关－这是规则 3。

a11 的余子式是 C11=a22a33-a23a32，你可以在下方的分割图看出来：

a11 a12 a13

a11

a12

a13

a21 a22 a23

a22 a23 + a21

a23 + a21 a22

a31 a32 a33

a32 a33

a31

a33

a31 a32

我们仍然选择一个来自每一行每一列的单元，由于 a11 用尽了行 1 与列 1，剩下一

个 2×2 行列式作为它的余子式。

你一直都需要注意符号，这个跟随 a21 的 2×2 行列式好像是 a21a33-a23a31，

但是在余子式 C12 中，它的符号是相反的，a12C12 是正确的 3×3 行列式，沿着第

一行的余子式的符号模式是正－负－正－负。你画掉行 1 与列 1 得到一个大小是 n-

1 的子矩阵 M1，它的行列式乘上符号（-1）1 + 得到余子式：

行 1 的余子式是 C1=（-1）1+detM1

余子式扩展是 detA=a11C11+a12C12+.+a1nC1n

（11）

在大公式（8）中，a11 乘上的一些项组合在一起得到 C11=detM1u，符号是（-1）1+1，

意思是正号。方程式（11）是方程式（8）与方程式（10）的另一种形式，来自行 1 的因

子乘上只用到其他行的余子式。

注解行 1 可以做的，行 i 一样可以。在某一行的单元 a 同样有余子式 C，他们

是阶数 n-1 的行列式乘上（-1。由于 a 代表行 i 列 j，子矩阵 M 移除行 i 列 j

下表展示 a43 与 M43（移除行 4 与列 3），符号（-1）4+3 乘 M43 的行列式得到 C43。符號

矩阵显示 ± 的模式：

+

A=

A43

+

请尊重版权与译者的劳动成果，侵权必究！ 264

行列式是 A 的任意行 i 与使用其他行得到的余子式的点积：

余子式公式 detA=ailCil+ai2C12+.+ainCin

（12）

每个余子式 C（阶数 n-1，移除行 i 与列 j）包含它的正确符号

余子式 C=（-1）+detM

阶数 n 的行列式是阶数 n-1 的行列式的组合，递归的工作还要持续下去，每个子行列式再分成阶数 n-2 的行列式。我们可以依靠方程式（12）定义所有的行列式，规则是从 n 到 n-1 到 n-2，最终到阶数 1。定义 1×1 行列式为 | a | 等于数字 a，则余子式方法完成。

我们偏好从性质创建 detA（线性，符号反转，detI=1），大公式（8）与余子式公式（10）-（12）都是遵循这些规则。最后一个来自规则的公式是 detA=detAT，我们可以采用余子式扩展，沿着一个列而不是沿着一个行。沿着列 j 的单元是 a 到 aj，余子式是 C1 到 Cnj，行列式是下列的点积：

沿着列 j 的余子式 detA=a1jC1j+a2jC2j+..+anjCnj

（13）

当矩阵有很多零时，余子式非常有用 — 如同下个例子。

范例 6-1，2，-1 矩阵在第一行只有两个非零数，所以只有两个余子式 C11 与 C12 与行列式有关。我会高亮 C12:

（14）

在右侧你首先看到 2 乘 C1u，C1u 要移除行 1 与列 1，余子式 C11 与原始 A 有同样的－1，2，－1 模式－— 但是大小变小了。

要计算粗体字的 C12，沿着第一列使用余子式，唯一的非零数在顶端，贡献了另一个－1（所以我们回过头要加负号）。它的余子式是－1，2，－1 的行列式，大小是 2×2，比原始的 A 小了 2 阶。

概要：每个阶数 n 的行列式 Dn 来自 Dn-1 与 Dn-2:

D4=2D3-D2 一般式是 Dn=2Dn-1-Dn-2

（15）

直接计算得到 D2=3 及 D3=4，方程式（14）得到 D4=2（4）-3=5，行列式 3，4，5 满足公式 Dn=n+1，则 Dn 等于 2n-（n-1）。「特殊三对角答案」同样来自范例 2 的主元乘积。网址：linear.neocities.org 箱：876152660@qq.com 265

范例 7 这是相同的矩阵，除了第一单元（左上角）现在是 1:

－1

B4=

2-1 1-21 1-2

矩阵所有的主元都变成 1，所以行列式是 1。行列式是如何来自余子式？在行 1

扩展，余子式与范例 6 相同，只是 a11=2 变成 b11=1:

detB4=D3-D2 而不是 detA4=2D3-D2

B4 的行列式是 4-3=1，每个 Bn 的行列式是 n-（n-1）=1。

如果你也把最后一个 2 变成 1，为什么行列式是 0?

主要观念的复习

1. 没有行交换，detA=（主元乘积）。在 A 的左上角，detAk=（前 k 个主元的乘

积）。

2. 大公式（8）的每一项用到每一行与每一列。n！的半数有正号（当 detP=+1），

半数有负号。

3. 余子式 C 是（-1）乘较小的行列式，这些行列式会把行 i 列与 j 移除（因为

aj 用了那一行与列）。

4. 行列式是任意行与它的余子式的行的点积，当 A 的某一行有很多的零，我

们只需要一些余子式。

已解范例

5.2A 一个海森堡（Hessenberg）矩阵是一个三角矩阵，这个矩阵多了一个对角线。

使用行 1 的余子式证明 4×4 的行列式满足斐波那契规则：|H4|=|H3|+|H2|。相同

的规则适用于所有的大小，|Hn|=|Hn-1|+|Hn-2|。哪个斐波那契数字等于 | Hm|?

请尊重版权与译者的劳动成果，侵权必究！ 266

解 H4 的余子式 C11 是行列式 | H3|，我们也需要 C12（粗体字）:

行 2 与 3 维持相同然后使用行 1 的线性。右侧的两个行列式是－|H3 | 与 +|H2|，则 4×4 的行列式是

|H4|=2C11+1C12=2|H3|-|H3|+|H2|=|H3|+|H2|

实际数字是 | H2|=3 与 | H3|=5（当然 | H1|=2）。由于 | Hn|=2，3，5，8 遵循斐波那契规则 | Hn|=|Hn-1|+|Hn-2|，它必须是 | Hn|=Fn+2。

5.2B 这些问题使用 ± 符号（偶与奇 P＇s）在 detA 的大公式中：

1. 若 A 是 10×10 的全 1 矩阵，大公式如何得到 detA=0?

2. 如果你把所有的 n！排列乘在一起得到单一的 P，P 是奇或是偶？

3. 如果你把每个 a 乘上分数 i/j，为什么 detA 不变？

解在问题 1 中，所有的 a=1，大公式（8）的所有乘积都是 1，半数带正号，半数带负号，互相消除得到 detA=0。（当然全 1 矩阵是奇异，我假设 n>1）。

［°¦］［］

问题 2 中，乘积 1001 得到奇排列，同样对于 3×3，3 个奇排列乘一起得到奇（无关顺序）。但是对于 n>3，所有排列的乘积是偶数。因为 n！包含 4 的因子，所以 n！/2 的奇排列还是偶数。

问题 3 中，每个 a 乘 i/j，所以大公式的每个乘 a1a2…a 乘上所有的行数字 i=1，2，.，n 以及除以所有的列数字 j=1，2，..，n。（列来自相同的的排列顺序！），每个乘积都不变所以 detA 维持原状。

问题 3 的另一方法：当行 i 乘 i，如同使用对角线矩阵 D=diag（1:n）乘矩阵 A；当列 j 除 j，如同右乘 D~1。根据乘积规则，DAD1 的行列式与 detA 相同。

问题集 5.2

问题 1-10 使用有 n！项的大公式：|A|=∑±a1aa2..an，每一项使用每个行与每个列。

1. 从六个项计算 A，B，C 的行列式，他们的行是无关吗？

B= 145 246 347

网址:linear.neocities.org 箱：876152660@qq.com 267

2 计算 A，B，C，D 的行列式，他们的列是无关吗？

3 证明 detA=0，而且与 5 个标示 x 的非零数无关：

行 1 的余因子为何？

A 的秩为何？

detA 的六项为何？

4 从 4 个不同的行与列，找出两种方法选择非零数：

1 0 01

1002

A = 0 1 11

034

1 1 01

B=

（B 与 A 有相同的的零）

1 0 0 1

2 0 0 1

detA=1+1 或 1-1 或－1-1? detB=?

54×4 矩阵中，如何放置最少个数的零确保 detA=0。如何放置最多个数的零确保 detA≠0。

6（a）若 a11=a22=a33=0，detA 的六项有多少项为零？

（b）若 a11=a22=a33=a44=0，detA 的 24 项乘积 a1ja2ka31a4m 有多少项为零？

75×5 排列矩阵有多少个 detP=+1? 这些是偶排列，求出需要 4 次交换得到单位矩阵的排列矩阵。

8 若 detA 不是零，大公式（8）的 n！项至少有一个不是零。从大公式推导 A 的行的某种顺序使得对角线不存在零。（不使用来自消元法的 P；PA 可以有零在对角线。）

9 单元不是 1＇s 就是－1＇s 的 3×3 矩阵，证明最大的行列式是 4。

10（1，2，3，4）有多少偶排列？他们是哪些？额外积分：求 4×4 的矩阵 I+Peven 的所有可能的行列式。

问题 11-22 使用余子式 C=（-1）detM，移除行 i 与列 j。

11 求出所有的余子式并放进余子式矩阵 C 与 D，求 AC 与 detB。

1 23

请尊重版权与译者的劳动成果，侵权必究！ 268

12 求余子式矩阵 C 与 ACT，比较 ACT 与 A-1:

13 n×n 行列式 Cn 有 1＇s 在主对角线的上方与下方：

0100

（a）C1，C2，C3，C4 的行列式为何？

（b）利用余子式求出 Cn 与 Cn-1 与 Cn-2 的关系。求 C10。

14 问题 13 的矩阵有 1＇s 在主对角线的上方与下方，矩阵继续往下，哪个列顺序（如果有的话）得到全部的 1＇s? 说明为什么当 n=4，8，12，.. 的排列是偶，当 n=2，6，10，. 的排列是奇。然后

Cn=0（奇数 n）Cn=1（n=4，8，..）Cn=-1（n=2，6，.）

15 阶数 n 的三对角 1，1，1 矩阵的行列式 En:

（a）利用余子式证明 En=En-1-En-2。

（b）从 E1=1 与 E2=0 开始，求 E3，E4，..，E8。

（c）注意前式最终的重复情形，求 E100。

16 阶数 n 的 1，1，－1 三对角矩阵的行列式是 Fn:

使用余子式扩展，证明 Fn=Fn-1+Fn-2。这些行列式是斐波那契数字 1，2，3，5，8，13，.。这个序列通常从 1，1，2，3 开始（里面有两个 1），所以我们的 F 是通常的 Fn+1。网址：linear.neocities.org 箱：876152660@qq.com 269

17 矩阵 Bn 是－1，2，－1 矩阵 An 把 a11=2 变成 b11=1 的矩阵，利用 B4 的最后一行扩展余子式，证明 | B4|=2|B3|-|B2|=1。

当每个 | Bm|=1 时，满足递归关系 | Bn|=2|Bn-1|-|Bn-2|。这个递归与范例 6 的递归相同，差别在于大小为 n=1，2，3 的起始值是 1，1，1。

18 回到问题 17 的 Bn，除了 b11=1 之外，它与 An 相同。所以使用第一行的线性， 其中［1-10］=［2-10］-［100］:

0 2-I

1

0 ＿ 0

0

A，-1

A，-1

An-1

0

0

0

线性使得 | Bn|=2|An|-|An-1|=

19 说明为什么下列的范德蒙德行列式包含 x3 而不是 x4 或 x5:

在 x=

，

与

，行列式是零。x3 的余子式是 V3=（b-a）（c-a）（c-b）， 则 V4=（b-a）（c-a）（c-b）（x-a）（x-b）（x-c）。

20 求出 G2 与 G3，然后使用消元法求 G4，你能够预测 G 吗？

0 1 1 1

21 对于下列 1，3，1 矩阵，计算 S1，S2 与 S3，利用斐波那契猜测并检验 S4。

S1=|3|S2-|S3=|

22 问题 21 中，把矩阵左上角的 3 改成 2，为什么这样会有从行列式 Sn 减去 Sn-1? 证明新矩阵的行列式变成斐波那契数字 2，5，13（永远是 F2n+1）。

请尊重版权与译者的劳动成果，侵权必究！ 270

问题 23-26 有关方块矩阵与方块行列式。

234×4 矩阵中有 2×2 的方块，你不可以一直使用方块行列式：

（a）为什么第一个叙述是正确的？B 好像没有参与。

（b）举例说明当 C 参与时，等式失败（如所示）。

（c）举例说明 det（AD-CB）的答案也是错误的。

24 使用方块乘法，A=LU 有左上角的 Ak=LkUk:

4-｝∷

（a）假设 A 的前 3 个主元是 2，3，－1，求出下列的行列式：L1，L2，L3（对角线都是 1＇s），U1，U2，U3 以及 A1，A2，A3。

（b）若 A1，A2，A3 的行列式是 5，6，7，从方程式（3）求出 3 个主元。

25 方块消元法从第二行［CD］减去 CA~ 乘第一行［AB］，会在右下角得到舒尔补充 D-CA1B：［-¢］［ B］-［ Ð－c＇в］

对上述方块矩阵取行列式，若 A 存在，证明下列的正确规则：

l--c - 设 C

26 若 A 是 m×n 与 B 是 n×m，方块乘法得到 detM=detAB:

若 A 是单一行且 B 是单一列，求 detM? 若 A 是单一列且 B 是单一行，求 detM? 两者各做一个 3×3 的例子。

27（微积分问题）证明 detA 相对于 a11 的导数是余子式 C11。其他的单元固定 — 我们只改变 a11。

网址：linear.neocities.org 箱：876152660@qq.com 271

283×3 行列式有 3 个「右斜下」乘积以及 3 个带负号的「左斜下」乘积，计算比如（1）（5）（9）=45 的六项求 D。

1 2 3

2

不计算行列式，说明为什

D= 4 5 6 4 5

么这个特定矩阵是可逆

7 8 9

8

或不可逆。

+ + +

29 对问题 15 的 E4 来说，大公式（8）的 4！=24 项中的 5 项是非零数，找出这 5 项证明 E4=-1。

30 对 4×4 三对角第二差分矩阵（单元－1，2，－1），找出大公式中的 5 项使得 detA= 16-4-4-4+1.

31 利用行 1 的余子式求出循环 P 的行列式，然后再使用大公式。4，1，2，3 需要多少次交换才能变成 1，2，3，4?|P2|=1 或－1?

一挑战问题

32 问题 21 的 1，3，1 矩阵的余子式得到递归关系 Sn=3Sn-1-Sn-2，惊奇的发现这项递归得到每隔一个的斐波那契数字。以下是挑战：

利用 F2n+2=3F2n-F2n-2 的证明来展示 Sn 是斐波那契数字 F2n+2。持续使用斐波那契规则：从 k=2n+2 开始，Fk=Fk-1+Fk-2°

33 对称帕斯卡矩阵的行列式是 1。如果我把 n，n 单元减 1，为什么行列式变成 0?（使用规则 3 或余子式。）

请尊重版权与译者的劳动成果，侵权必究！ 272

34 这个问题有两个方法证明 detA=0（x＇s 是任意数）:

xx xxx

xx xxx

A=|0 （ （ x x

0 0 0 x x

0 0 0 x x

（a）你如何知道行是线性相关？

（b）说明为什么 A 的行列式的大公式的全部 120 项都是零。

35 若 | detA|>1，证明 A 的次方 A」不可能有界。但是若 | detA|≤1，证明 A」的某些单元仍然可能增长太高。特征值会提供稳定度的良好试验，行列式只是告诉我们一个数字而已。

网址：linear.neocities.org 箱：876152660@qq.com 273

5.3 克拉默规则，逆矩阵与体积

1A1=CT/detA，则（A-1）= 余子式 Ci 除以 A 的行列式。

2 克拉默规则：从 x=det（A 的列 j 換成 b）/detA，计算 x=Ab。

3 若平行四边形的 4 个角是（0，0），（a，b），（c，d）与（a+c，b+d），则面积 =|ad-bc|。4 若 A 的行（或 A 的列）是盒子的边，则盒子的体积 =|detA|。

5w-xy 是 d

i j k

注意 v×W=-（u×）。

w1，w2，w3 是行 1 的余子式。

V1 V2 V3_

注意 wTu=0 且 wTv=0。

本段落求解 Ax=b 也计算 A-- 利用代数而不是消元法。所有你看到的公式都有除以 detA，A 与 A-b 的每个单元都是一个行列式除以 A 的行列式。让我们从克拉默（Cramer＇s Rule）规则开始。

克拉默规则求解 Ax=b，一个简洁的公式得到第一分量 x1。把 x 取代 I 的第一列得到有行列式 x1 的矩阵。当你左乘 A，第一列变成 Ax 就是 b，B1 的其他列从 A 复制：

x0이［ by a123

关键概念

（1）

我们一次乘一个列，三个矩阵取行列式求得 x1:

乘积规则

（det A）（x1）=det B1 或是 x1=（det B1）/（detA）。

（2）

这是克拉默规则的 x 的第一分量！改变 A 的一个列得到 B1。现在要求 x2 与 B2，把向量 x 与 b 放在 I 与 A 的第二列：

同样概念

（3）

取行列式发现（detA）（x2）=detB2，这个得到 x2=（detB2）/（detA）。

范例 1 求解 3x1+4x2=2 与 5x1+6x2=4 需要 3 个行列式：

det.=dot 房 = det=

请尊重版权与译者的劳动成果，侵权必究！ 274

矩阵 A，B1，B2 的行列式是－2，－4 与 2，所有的比值都是除以 detA=2:

克拉默规则若 detA 不是零，Ax=b 利用行列式求解：

（4）

矩阵 B 是把 A 的第 j 列换成向量 b。

要求解 n×n 系统，克拉默规则计算 n+1 个行列式（A 以及 n 个不同的 B＇s）。当每个行列式都是 n！项的总和－使用所有排列的大公式－得到总数（n+1）！项，如果这样求解方程式会发疯的，但是我们最终确实得到求解 x 的明确公式。

范例 2 克拉默规则对数字没有效率，但是很适合字母。当 n=2，求解 AA1=I 得到 A-1=［xy］的列：

［a］［］-［］［ea］］-［

他们共享相同的矩阵 A。我们需要 | A | 以及 4 个针对 x1，x2，y1，y2 的行列式：

laà=loalaoa la

最后 4 个行列式是 d，-c，-b 与 a。（他们都是余子式！）下列是 A1:

我选择 2×2 矩阵所以重点会很清楚，新的概念是：A 与余子式有关。当右侧是单位矩阵的一个列，如同 AA1=I 一样，克拉默规则中的每个 B 的行列式就是 A 的一个余子式。

当 n=3，你可以看到这些余子式。求解 Ax=（1，0，0）得到 A-1 的列 1:

B's 的行列式

1 a2 a13 al 1 a3 a1 a12 1

=A 的余因子

o ar as as， o as as a o

（5）

第一个行列式 | B1 | 是余子式 C11=a22a33-a23a32，|B2 | 是余子式 C12。注意正确的负号出现在－（a21a33-a23a31）。这个余子式 C12 进入 A-1 的列 1，当我们除以 detA，我们得到了逆矩阵。

网址：linear.neocities.org 箱：876152660@qq.com 275

A-1 的 i，j 单元是余子式 Ci（不是 C）除以 detA:

A1 的公式 （4）y = 与 A2=

（6）

余子式 C 进入「余子式矩阵」C，C 的转置得到 A~`。要计算 A~` 的 i，j 单元，移除 A 的行 j 与列 i，行列式乘上（-1）得到余子式 Ci 然后除以 detA。

对 A 的 3，1 单元检验这项规则。对于列 1 我们求解 Ax=（1，0，0），第三个分量 x3 需要方程式（5）的第三个行列式除以 detA。这个行列式确实就是余子式 C13= a21a32-a22a31，所以（A-1）31=C13/detA。

概要求解 AA=I 时，I 的每个列得到 A 的一个列，A1 的每个单元是一个比值：大小 n-1 的行列式 / 大小 n 的行列式。

公式 A1=CT/detA 的直接证明这个表示 ACT=（detA）I:

a11 a12 a13］［C11 C21 C31

det A 0

0

а21 a22 a23 C12 C22 C32=

0 det A 0

（7）

a31 a32 a33］［C13 C23 C33

0

0 det A

（A 的行 1）乘（CT 的列 1）得到右侧的第一个 detA。

a11C11+a12C12+a13C13=detA 这个确切是余子式规则！

同理 A 的行 2 乘 CT 的列 2（注意转置）也得到 detA，单元 a2j 应该乘上余子式 C2 得到行列式。

如何解释方程式（7）的主对角线之外的零？A 的行乘上来自不同行的余子式，为什么答案是零？

A 的行 2，C 的行 1a21C11+a22C12+a23C13=0

（8）

答案：当 A 的第二行复制到自己的第一行，这是新矩阵的余子式规则。新矩阵 A＊有两个相等的行，所以方程式（8）的 det A＊=0。注意 A＊与 A 有相同的余子式 C11，C12，C13— 因为在第一行之后所有的行都一致，于是重要的乘法（7）是正确的：

ACT=（detA）l 或 A-=C

请尊重版权与译者的劳动成果，侵权必究！ 276

范例 3「总和矩阵」A 的行列式是 1，A~1 只包含余子式：

去除 A 的行 1 与列 1 得到 3×3 的余子式 C11=1，现在去除行 1 与列 2 得到 C12，这个 3×3 子矩阵仍然是三角形且行列式是 1，但是余子式 C12 是－1，因为符号（-1）1+2，这个数字－1 进入 A1 的（2，1）单元－不要忘记转置 C。

三角矩阵的逆矩阵是三角形，余子式给出了理由。

范例 4 若所有的余子式都不是零，A 一定可逆吗？不可能。三角形的面积

每个人都知道矩形的面积 — 底乘高，三角形的面积是一半的底乘高。但是这里有一个那些公式无法回答的问题，若我们已知三角形的三个角（x1，y1）与（x2，y2）与（x3，y3），面积是多少？利用这些角求出底与高不是计算面积的好方法。

行列式是求面积的最佳方法，三角形的面积是一个 3×3 行列式的一半，底与高的平方根在优质公式中会抵消。如果一个角在原点，比如（x3，y3）=（0，0），行列式只有 2×2。

（x2， У2）

（x2， У2）

（0， 0）

（0， 0）

（x1， y1）

（x1， y1）

（x3， У3）

图 5.1：一般三角形；来自（0，0）的特殊三角形；来自三个特定点的一般形三角形的三个角在（x1，y1）与（x2，y2）与（x3，y3），面积 = 行列式 / 2:

x1 yi

三角形面积 1-2

111

x2 y21

兰 0 面

X3 y3

网址：linear.neocities.org 箱：876152660@qq.com 277

当你在 3×3 行列式中令 x3=y3=0，你得到 2×2 行列式，这些公式没有平方根 — 他们很容易记忆。3×3 行列式分成 3 个 2×2（余子式）的总和，如同图 5.1 所示的第三个三角形，分成 3 个来自（0，0）的三角形：

（9）

如果（0，0）在三角形之外，其中两个特殊面积可能是负的－但是总和仍然是正确的。实际的问题是说明来自（0，0）的三角形面积。

为什么 | x1y2-x2y1|/2 是三角形的面积？我们移除 1/2 的因子当成平行四边形（两倍大，因为平行四边形包含两个相等的三角形），我们现在证明平行四边形面积是行列式 x1y2-x2y1，在图 5.2 的面积是 11，因此三角形面积是 11/2。

（x2， у2）

（1， 3）

平行四边形

面积 =|=11

（0，0）

（x1， y1）

（0， 0）

（4， 1）

三角形：面积 =

图 5.2：三角形是平行四边形的一半，面积是行列式的一半。

证明：从（0，0）开始的平行四边形的面积 = 2×2 行列式

有很多种证明的方法，但是这一个最适合本书，我们证明面积与行列式一样的性质 1-2-3，则面积 = 行列式！记得这 3 个定义行列式的规则然后得到全部其他性质。1 当 A=I，平行四边形变成单位方形，面积是 detI=1。

2 当出现行的交换，行列式反转符号，绝对值（正的面积）保持不变－相同的平行四边形。

3 若行 1 乘 t，图 5.3a 显示面积也乘 t。假设一个新行（xi，yi）加到（x，y）（行 2 保持固定），图 5.3b 显示实线平行四边形面积加到点线平行四边形面积（因为这两个点线完成的三角形相同）。

当我们应用了平面几何，这是一个奇异的证明，但是这个证明有一个主要的吸引カー它用在 n 维。原点出发的 n 个边是 nxn 矩阵的行盒子会有更多的边，就好像平行四边形一样。

请尊重版权与译者的劳动成果，侵权必究！ 278

点线面积 = 实线面积 = A+A

全部面积 = tA

A＇

（2， y2）

（x1+x1，y1+y1）

area

A

A

（ta1， ty1）

（x1，y1）

（x1，y1）

（0， 0）

（0，0）

图 5.3：面积在边 1 遵守线性规则（保持边（x2，y2）不变）。

图 5.4 显示一个三维盒子－- 边都不是直角，体积等于 detA 的绝对值。我们的证明再度检查行列式的规则 1-3 是否也被体积遵守。当一个边被拉伸一个因子 t，体积也乘 t。当边 1 加到边 1＇，体积是两个原始体积的总和。这是图 5.3b 提升到 3 维或是 n 维，我想画出这些图，但是纸张只有二维。

Z （a31， a32， a33）

盒子的体积

=| 行列式 |

y

（a11， a12， a13）

（a21， a22， a23）

x.

图 5.4：来自 A 的三个行形成的三维盒子。

单位盒子的体积是 1，就是 detI。行交换或是边交换得到相同的盒子以及相同的绝对值体积。行列式改变符号会指出边是「右手三重（right-handed triple）」（det A>0）或是「左手三重（left-handed triple）」（detA<0）。盒子的体积遵守行列式的规则，所以 detA 的体积 = 绝对值。

范例 5 假设矩形盒子（90° 角）的边长是 r，s 与 t，它的体积是 r 乘 s 乘 t。对角矩阵 A 的对角线单元 r，s 与 t 产生这三个边，则 detA 也等于体积 rst。

网址：linear.neocities.org 邮箱：876152660@qq.com 279

范例 6 微积分中，盒子当做超级无限小！要针对一个圆积分，我们要把 x 与 y 变成 r 与 0，这些是极坐标转换：x=rcos0，y=rsin0。「极盒（polarbox）」的面积是 J 的行列式乘 drd0:

在小面积 dA=rdrdθ 的行列式是 r，拉伸因子 J 进入双重积分，就好像 dx/du 进入正常积分 dx=（dx/du）du。在三重积分中，有 9 个导数的雅克比矩阵是 3×3。

叉积

叉积（cross product）是额外（可选择的）应用，特别是对于三维。从向量 u=（u1，u2，u3）与 ν=（v1，V2，V3）开始，不像点积是一个数字，叉积是一个向量 — 也是在三维，写成 u×ν，读作 ucrossv。叉积的分量是 2×2 的余子式，我们会解释一些性质，这些性质使得 u×ν 在几何学与物理学非常有用。

现在我们硬着头皮在性质之前写下公式。

定义 u=（u1，u2，u3）与 v=（v1，v2，v3）的叉积是一个向量：

i j k

uxv= и1 u2 uz =（u2V3-u³v2）i+（u3-uv3）j+（u1ν2-u2）k

（10）

V1 V2 V?

向量 uxy 与 u 及垂直，叉 v×u=-（ux）。

注解 3×3 行列式是记忆 u×ν 最容易的方法，它不是特别合法，因为第一行包含向量 i，j，k，而其他行包含数字。在行列式中，向量 i=（1，0，0）乘 u2v3 与－u3v2，结果是（u2v3-u3v2，0，0），这个就是叉积的第一分量。

注意下标的循环模式：2 与 3 得到 u×v 的分量 1，然后 3 与 1 得到分量 2，再然后 1 与 2 得到分量 3，这样完成了叉积的定义。现在我们列表叉积的性质：性质 1 ν×u 反转行列式的行 2 与 3，所以等于－（u×v）。

性质 2 叉积 u×v 与 u 垂直（与 v 也垂直），直接的证明是观察项的消除，得到零点积： u.（u×v）=u1（u2v3-u3v2）+u2（u3v1-u1v3）+u3（u1v2-u2v1）=0

（11）

u·（u×v）的行列式有三个行：u，u 与 ν（两个相等的行），所以是零。

请尊重版权与译者的劳动成果，侵权必究！ 280

性质 3 任意向量与自己的叉积（两个相等的向量）是 u×u=0。

当 μ 与 ν 平行，叉积是零。当 u 与 ν 垂直，点积是零。一个与 sinθ 有关，另一个与 cosθ 有关：

（12）

范例 7u=（3，2，0）与 ν=（1，4，0）在 xy 平面，u×ν 会在 z 轴上：

u×ν 的长度等于两边是与 ν 的平行四边形面积，这个很重要：本例面积是 10。范例 8u=（1，1，1）与 ν=（1，1，2）的叉积是（1，－1，0）:

向量（1，－1，0）与（1，1，1）及（1，1，2）如预测一般的垂直。面积是√2。

范例 9i=（1，0，0）与 j=（0，1，0）的叉积遵守「右手规则」，叉积 k=i×j 往上不是往下：

ixj =k

规则当手指头从 u 到 ν

卷曲，u×ν 会指向你的

u=i

v=j

右拇指方向。

于是 i×j=k。右手规则也会得到 j×k=i 与 k×i=j，注意循环的顺序。在相反顺序（反循环）的情形下，拇指反向且叉积走到另一个方向：k×j=-i 与 i×k=-j 与 j×i=-k。你可以从 3×3 行列式看到 3 个正号与 3 个负号。

u×ν 可以基于向量定义，而不是他们的分量：

定义叉积是长度 | u‖‖ν‖|sinθ| 的向量，它的方向与及 ν 垂直。依据右手规则决定指上或指下。

这个定义很吸引物理学家，他们讨厌轴与坐标。他们看（u1，u2u3）就是质量的位置，看（Fx，Fy，F2）就是作用在质量的力。

网址：linear.neocities.org 箱：876152660@qq.com 281

如果 F 与 u 平行，则 u×F=0 - 没有转动。叉积 u×F 是转动力或是转矩（torque），

它的指向是沿着转动轴（与 u 及 F 垂直），它的长度‖u‖‖F‖sinθ 是产生转动的「矩」

的量测值。

三重积 = 行列式 = 体积

由于 u×ν 是一个向量，可以把它与第三向量 w 做点积，得到三重积（u×v）·w。

它被称为「纯量」三重积（triple product），因为它是一个数字。事实上它是一个行

列式－- 它给出 u，v，w 盒子的体积： W2

11 и2 u3

三重积

（u x v）· w

u1 u2

＼

V2 V3

（13）

V1 V2 V3

W1 W2

W3

我们可以把 w 放在顶端或是底部，这两个行列式相等，这是因为从一个到另一个

的行交换。注意当行列式为零时：

（u×v）·w=0 当 u，v，w 确实在同一个平面上。

第一个理由 u×ν 与那个平面垂直，所以它与 w 的点积为零。

第二个理由平面上的三个向量是相关，矩阵是奇异（det=0）。

第三个理由当 u，v，w 的盒子展开成平面，体积是零。

（u×v）·w 等于 u，v，w 作为边的盒子的体积，这个性质非常重要，这个 3×3

行列式承载了大量信息。比如 2×2 矩阵的 ad-bc，它分离了可逆与奇异。第六章

会探索奇异的性质。

主要观念的复习

1. 克拉默规则利用比值求解 Ax=b，就像 x1=|B1|/|A|=|ba2.an|/|A|。2. 当 C 是 A 的余子式，逆矩阵 A1=CT/detA。

3. 当盒子的边是 A 的行时，盒子的体积是 | detA|。

4. 在双重与三重积分中，面积与体积需要变换变数。

5. 在 R3 中，叉积 u×v 与 u 及 ν 垂直。注意 i×j=k。

请尊重版权与译者的劳动成果，侵权必究！ 282

已解范例

5.3A 若 A 是奇异，方程式 ACT=（detA）I 变成 ACT = 零矩阵，则 CT 的每一列在 A 的零空间中。这些列包含沿着 A 的行的余子式，所以余子式快速的求出秩 2 的 3×3 矩阵的的零空间。我很抱歉这个来的太晚！

对于秩 2 的奇异矩阵，利用 x 等于沿着一个行的余子式来求解 Ax=0:

余子式得到零空间

解第一个矩阵沿着第一行的余子式（注意每个负号）是：

则 x=（6，2，-2）是 Ax=0 的解。沿着第二行的余子式是（-18，－6，6）刚好是－3x，这也是 A 的一维零空间。

第二个矩阵沿着第一行都是零余子式，零空间 x=（0，0，0）不够吸引力。行 2 的余子式得到 x=（1，-1，0）是 Ax=0 的解。

从问题 3.3.12 知道每个秩 n-1 的 n×n 矩阵，最少有一个非零的余子式，但是对秩 n-2 来说所有的余子式都是零，我们只能找到 x=0。

5.3B 利用克拉默规则的比值 detB1/detA 求解 Ax=b，也求出 A-1=CT/detA。当 b=（0，0，1），解 x 是 A1 的列 3。计算列 x=（x，y，z）时，哪些余子式有参与？

A1 的列 3

求出两个盒子的体积：边是 A 的列与以及边是 A1 的行。

解 B 的行列式（右侧 b 放在列 j）是

这些是行 3 的余子式 C31，C32，C33，他们与行 3 的点积是 detA=2。

detA=a31C31+a32C32+a33C33=（5，9，0）·（4，-2，2）=2

三个比值 det B/detA 得到 x=（2，-1，1）的三个分量，这个 x 是 A 的第三列，因为 b=（0，0，1）是 I 的第三列。

网址：linear.neocities.org 箱：876152660@qq.com 283

沿着 A 的其他行的余子式，除以 detA，得到 A 的其他列：

计算验证 AA-1=I

来自 A 的列的盒子有体积 = detA=2，由于 | AT|=|A|，来自行的盒子也有体积 2。

来自 A1 的行的盒子有体积 1/|A|=1/2。

问题集 5.3

问题 1-5 有关 x=Ab 的克拉默规则。

1 利用克拉默规则 x=det B/detA 求解：

2x1+x2=1

（b）x1+2x2+x3=0

x2+2x3=0

2 利用克拉默规则只求 y，称呼 3×3 行列式为 D:

ax + by + cz =1

（b）dx+ey+fz=0

gx+hy+iz=0

3 当 detA=0，克拉默规则崩溃。例题（a）无解，例题（b）无限多解。两个例子中

的比值 x= det B/detA 为何？

（）+=（平行线）（）=2 同一条线）

4 克拉默规则的快速证明。行列式是列 1 的线性函数，如果两个列相同，行列

式是零。当 b=Ax=x1a1+x2a2+x3a3 进入 A 的第一列，矩阵 B1 的行列式是

|ba2 a3|=|x1a1+x2a2+x3a3 a2 a3|=x1|a1 a2 a3|=x1detA

（a）左侧等于右侧可以得到 x1 的什么公式？

（b）哪个步骤得到中间的方程式？

5 若右侧 b 是 A 的第一列，求解 3×3 系统 Ax=b。克拉默规则中的每个行列式

如何得到解 x?

请尊重版权与译者的劳动成果，侵权必究！ 284

问题 6-15 有关 A1=CT/detA，记得转置 C。

6 从余子式公式 CT/detA 求出 A-1。利用（b）的对称。

·

7 如果所有的余子式都是零，你如何知道 A 没有逆矩阵？如果所有的余子式都

不是零，A 一定可逆吗？

8 求出 A 的余子式，计算 ACT 求出 detA:

以及 ACT=

如果你把 4 改成 100，为什么 detA 不变？

9 假设 detA=1，你也知道 C 中的所有余子式，如何求 A?

10 从公式 ACT=（detA）I 证明 detC=（detA）＂-1。

11 如果 A 的全部单元都是整数，且 detA=1 或－1，证明 A 的全部单元都是整

数。给出一个全部单元都不是零的 2×2 范例。

12 如果 A 与 A 的全部单元都是整数，证明 detA=1 或－1。

提示：detA 乘 detA 等于什么？

13 利用余子式完成范例 5 中 A~ 的计算。

14L 是下三角，S 是对称，假设都是可逆：

逆反

三角矩阵 L

对称矩阵 S

（a）L 的哪三个余子式是零？L - 也是下三角矩阵。

（b）S 的哪三对（pair）余子式相等？S 也是对称矩阵。

（c）正交 Q 的余子式矩阵 C 会是

。为什么？

15 当 n=5，矩阵 C 有＿_个余子式。每个 4×4 余子式有＿_项，每项有＿_次乘

法。段落 2.4 中计算 A 的高斯－乔丹法需要 53=125，比较两者的差异。

问题 16-26 有关利用行列式求面积与体积。

16（a）平行四边形的边是 v=（3，2）与 w=（1，4），求面积。

（b）三角形的边是 v，w 与 v+w，求面积并画出图形。

（c）三角形的边是 v，w 与 w-v，求面积并画出图形。

网址：linear.neocities.org 箱：876152660@qq.com 285

17 一个盒子的三边分别从（0，0，0）到（3，1，1）与（1，3，1）与（1，1，3），求盒子的体积。

利用 | u×| 也求出每个平行四边形的面积。

18（a）三角形的角是（2，1）与（3，4）与（0，5），求面积。

（b）在（-1，0）加入一个角得到倾斜区域（4 个边），求面积。

19 平行四边形的边是（2，1）与（2，3），与边是（2，2）与（1，3）的平行四边形有相同的面

积，利用 2×2 行列式求出面积，并且说明为什么两个图形的面积必须相等？（我

从图形看不出相等，如果你可以，麻烦写信告诉我。）

20 哈达玛矩阵 H 有正交的行，盒子是超立方体（hypercube）！

21 如果 4×4 矩阵的列有长度 L1，L2，L3，L4，则最大可能的行列式（基于体积）值是

多少？如果矩阵的单元都是 1 或－1，这些列的长度是多少？最大行列式是多

少？

22 利用图形证明：面积 x1y2 的矩形减去面积 x2y1 的矩形，会得到相同面积的平

行四边形。

23 当边向量 a，b，c 互相垂直，盒子的体积是 | a | 乘 | b | 乘 | c|。矩阵 ATA 是

，

求 detATA 与 detA。

24 盒子的边分别是 i 与 j 与 w=2i+3j+4k，盒子的高度是

。体积是多少？

具有此行列式的矩阵为何？i×j 为何？i×j 与 w 的点积为何？

25n 维立方体有几个角？几个边？几个（n-1）- 维的面？R」的一个立方体的边是

2I 的行，立方体的体积是

。超立方体电脑在角有平行处理器，有边连

接这些角。

26 三角形的角在（0，0），（1，0），（0，1），面积是 1/2。R3 的锥体有四个角（0，0，0），（1，0，

0），（0，1，0），（0，0，1），体积是多少？R4 的一个锥体，它的 5 个角在（0，0，0，0）

以及 I 的行，体积是多少？

问题 27-30 有关微积分的面积 dA 与体积 dV。

27 极坐标满足 x=rcosθ 与 y=rsin0，极面积是 Jdrdθ：

两个列是正交，他们的长度是＿__，于是 J=____。＿

请尊重版权与译者的劳动成果，侵权必究！ 286

28 球坐标 p，φ，θ 满足 x=psinφcosθ 与 y=psinósinθ 与 z=pcosφ。求出 3×3 部分导数矩阵：在行 1 有 0x/0p，0x/0φ，0x/00。简化行列式得到 J=p2sinφ，则球坐标的 dV 是 p2sinodpdφd0，这是一个「无限小坐标盒」的体积。

29 问题 27 展示连接 r，θ 到 x，y 的矩阵，求 2×2 矩阵的逆矩阵：

很讶异的 0r/0x=0x/0r（微积分，Gilbert Strang，p.501），J 与 J 的矩阵乘积得到链条规则 дx ＿ дxдr， дx д0

âx ôr ôx 0 ôx

=1.

30 三角形的角在（0，0）与（6，0）与（1，4），面积是

。当你把三角形旋转 θ=60°，

面积是

。旋转矩阵的行列式是

J=cos0-sing=1/2?

sin0 cos0??

问题 31-38 有关在三维的三重积（u×v）·w。

31 盒子的底面积是 | u×v|，它的垂直高度是 | w|cosA，盒子的底面积乘高 = 体积 = ‖ lux vll lwllcos，这就是（ux）·w。当 u=（2，4，0），=（-1，3，0），w=（1，2，2），计算底面积，高与体积。

32 同样盒子的体积可以更直接从 3×3 行列式求得，计算这个行列式。

33 利用 u1，u2，u3 的行的余子式，扩展方程式（13）的 3×3 行列式，这个扩展是 u 与向量的点积。

34（u×w）·v 与（w×u）·v 与（v×w）·u 中，哪个与（u×v）·w 相同？什么样的行 u，v，w 顺序，可以得到正确的行列式？

35 令 P=（1，0，-1）与 Q=（1，1，1）与 R=（2，2，1），选择 S 使得 PQRS 是一个平行四边形，计算它的面积。选择 T，U，V 使得 OPQRSTUV 是一个倾斜盒，计算它的体积。

36 假设（x，y，z）与（1，1，0）与（1，2，1）落在一个通过原点的平面，什么样的行列式是零？什么样的方程式可以得到这个平面？

37 假设（x，y，z）是（2，3，1）与（1，2，3）的一个线性组合，什么样的行列式是零？什么样的方程式可以产生所有组合形成的平面？

38（a）对于 n×n 矩阵，借由体积解释为什么 det2A=2detA?

（b）什么样大小的矩阵会使得错的叙述 detA+detA=det（A+A）变成正确？

网址:linear.neocities.org 箱：876152660@qq.com 287

39 如果你知道 4×4 可逆矩阵 A 全部 16 项的余子式，你如何求出 A?

40 假设 A 是 5×5 矩阵，它的行 1 的单元乘来自行 2-5 的行列式（余子式）得到行列

式。「雅克比公式」把来自行 1 与 2 的 2×2 行列式，乘上来自行 3-5 的 3×3

行列式得到 detA。你能猜想「雅克比公式」吗？

412×2 矩阵 AB=（2×3）（3×2）有一个求取 detAB 的「Cauchy-Binet 公式」：

detAB=（A 的 2×2 行列式）乘（B 的 2×2 行列式）的总和

（a）猜想会用到哪些来自 A 与 B 的 2×2 行列式。

（b）当 A 的行是［1，2，3］与［1，4，7］且 B=AT，测试你的公式。

42 大公式有 n！项，但是如果 A 有一个单元是零，（n-1）！项会消失。如果 A 只

有 3 条对角线单元，会留下多少项？

当 n=1，2，3，4 时，三对角行列式有 1，2，3，5 项，这些是段落 6.2 的斐波那契

数字！证明为什么三对角 5×5 行列式有 5+3=8 个非零项（再次是斐波那契数

字），利用 a1 与 a12 的余子式。

请尊重版权与译者的劳动成果，侵权必究！ 288

第六章

特征值与特征向量

6.1 特征值引论

1 特征向量 x 与 Ax 在同一条直线上：Ax=x，λ 是特征值。

2 若 Ax=x，则 A2x=λ2x 与 A1x=λ1x 与（A+cD）x=（λ+c）x：相同 x。3 若 Ax=λx，则（A-2D）x=0 且 A-2I 奇异，det（A-2）=0。n 个特征值。4 检验 A＇s:detA=（1）（22）.（2n）与对角总和 a11+a22+.+ann=2＇s 总和。5 投影有 2=1 与 0，镜射有 1 与－1，旋转有 ei 与 e-10：复数。

本章加入线性代数的新内容，第一部分是有关 Ax=b：平衡与均衡与稳定状

态。现在第二部分是有关改变，时间进入蓝图 — 连续时间的微分方程式 du/dt=Au

或是离散方程式的 uk+1=Auk，这些方程式无法由消元求解。

关键概念在于避免矩阵 A 带来复杂性，假设解向量 u（t）保持在固定向量 x 的

方向，我们只需要找出乘 x 的数字（随时间变化），一个数字比一个向量容易。我

们希望特征向量（eigenvector）x 在被 A 乘时不会改变方向。

一个好的模式来自矩阵的次方 A，A2，A3，..，假设你需要 100 次方 A100，它的

列会非常接近特征向量（.6，.4）:

A100 是利用 A 的特征值（eigenvalue）求得，不是矩阵乘 100 次。这些特征值（此处是

λ=1 与 1/2）是看见矩阵核心的新方法。

网址：linear.neocities.org 邮箱：876152660@qq.com 289

要说明特征值，我们首先说明特征向量。大部分的向量被 A 乘之后都会改变方向，某些例外向量 x 与 Ax 在同一个方向，他们是特征向量。A 乘一个特征向量，得到向量 Ax 等于一个数 λ 乘原始的 x。

基本方程式是 Ax=λx，数字 λ 是 A 的一个特征值。

特征值 2 会告诉我们这个特殊向量 x 是被拉伸或收缩或反向或保持不变－当 x 被 A 乘。我们可以发现 1=2 或 1/2 或－1 或 1，特征值 λ 也可以是零！于是 Ax=0x 表示特征向量 ⅹ 在零空间中。

若 A 是单位矩阵，每个向量都有 Ax=x，所有的向量都是 I 的特征向量。所有的特征值是 1=1，这是不寻常的。大部分 2×2 矩阵有两个特征向量的方向以及两个特征值，我们会展示 det（A-AI）=0。

这个段落说明如何计算 x＇s 与 2＇s，这个可以来的这么早是因为我们我们只需要 2×2 矩阵的行列式。让我用 det（A-2I）=0 找出第一个范例的特征值，然后在方程式（3）正确的推导。

范例 1 矩阵 A 有两个特征值 = 1 与 2=1/2，检视 det（A-2D）:

｛52-u）

我把二次式分解成 A-1 乘 λ－1/2，得到两个特征值是 = 1 与 1=1/2。这些数字使得矩阵 A-I 变成奇异（零行列式），特征向量 x1 与 x2 就在 A-I 与 A-2I 的零空间中。

（A-I）x1=0 得到 Ax1=x1 以及第一个特征向量是（.6，.4）。

（A-I/2）x2=0 得到 Ax2=（1/2）x2 以及第二个特征向量是（1，－1）。

与 Ax

=x

（Ax=x 表示 λ1=1）

与 12 ［］［［-3

（这是 x2/2 所以 2=1/2）

如果 x1 再次被 A 乘，我们仍然得到 x1，A 的每个次方都得到 A」x1=x1。x2 被 A 乘得到 x2，如果再次被 A 乘我们得到（）2 乘 x2。

当 A 变成平方，特征向量保持不变，特征值变成平方。

因为特征向量维持自己的方向（如图 6.1）而且不会被混淆，模式持续下去，A100 的特征向量是相同的 x1 与 x2。A100 的特征值是 1100=1 与（）100 = 非常小的数字。其他向量确实会改变方向，但是其他的向量都是这两个特征向量的组合。A 的第一列是 x1+（.2）x2 的组合：

分开特征向量，然后被 A 乘 ［x+2×

（1）

请尊重版权与译者的劳动成果，侵权必究！ 290

Α¦==［］

2=1

A2x1= （1）²x1

=1

λ2=25

=.5

Α2= λ2=［3］

A2x2=（5）2x2=［2］

Ax = λx

²2-=［¦］

A2x=A2x

图 6.1：特征向量维持方向。A2x=22x，其中 A2=12 与（0.5）2。

当我们分开乘 x1 与（.2）x2，A 乘 x2 就是它的特征值乘 x2:

乘每个 x

是 +（2）2=+｝-

当我们左乘 A 时，每个特征向量被自己的特征值乘。在每一个步骤 x1 都没有改变而 x2 被乘，所以 99 步之后得到很小的数（）:

就是 x1+（2）（）x2=+ 的

这是 A100 的第一列，我们原始写的.6000 不是很精确，我们省略了（.2）（），这个数字在小数点 30 位数还不会出现。

特征向量 x1 是一个不会改变的「稳定状态」（因为 λ1=1），特征向量 x2 是一个几乎消失的「衰减模式」（因为 2=.5）。A 的次方越高，它的列趋近稳定状态。这个特殊的 A 是一个「马尔可夫矩阵」，最大特征值是 2=1，它的特征向量 x1=（.6，.4）是稳定状态 —－A 的所有的列都会趋近它。段落 10.3 说明马尔可夫矩阵如何在谷歌搜寻时出现。

对于投影矩阵，我们可以看到 Px 什么时候平行 x。对应 1=1 与 A=0 的特征向量形成列空间与零空间。列空间没有移动（Px=x），零空间移到零（Px=0x）。

网址：linear.neocities.org 箱：876152660@qq.com 291

范例 2

投影矩阵 P .5

5 有特征值 = 1 与 = 0。

它的特征向量是 x1=（1，1）与 x2=（1，-1）。对于这些向量，Px1=x1（稳定状态）与 Px2=0（零空间）。这个例子阐述了马尔可夫矩阵与奇异矩阵与（最重要）对称矩阵，这些矩阵都有特殊的 λ＇s 与 x＇s:

1. 马尔可夫矩阵：P 的每个列总和是 1，所以 1=1 是一个是特征值。

2.P 是奇异，所以 1=0 是一个是特征值。

3.P 是对称，所以它的特征向量（1，1）与（1，－1）垂直。

投影矩阵的特征值只有 0 与 1，对应 λ=0 的特征向量（表示 Px=0x）得到零空间，对应 λ=1 的特征向量（表示 Px=x）得到列空间。零空间投影到零，列空间投影到自己，投影维持列空间而摧毁零空间。

每个部分的投影

投影到 Pv=

投影有 λ=0 与 1，排列的所有 | 2|=1。下个矩阵 R 是镜射同时也是排列，R 也有特殊的特征值。

范例 3

镜射矩阵 R= 0 有特征值 1 与－1。

0

R 不会改变特征向量（1，1），第二个特征向量是（1，－1）--R 会反转它的符号。一个没有负数单元的矩阵仍然可以有负数的特征值！R 的特征向量与 P 的特征向量相同，因为镜射 = 2（投影）－I:

R=2P-I

［-3］-［q］

（2）

当一个矩阵被 Ⅰ 平移，每个 2 平移 1，特征向量没有改变。

x2

Px1=X1

X2

Rx1 = X1

Px2 = 0x2

投影在蓝色线

°Rx2=-X2

横跨直线的镜射

图 6.2：投影 P 有特征值 1 与 0，镜射 R 有特征值 1=1 与－1。典型的 x 改变方向，但是特征向量保持沿着同一直线。

请尊重版权与译者的劳动成果，侵权必究！ 292

特征值的方程式

我们对投影矩阵利用几何方法找出 2＇s 与 x＇s:Px=x 与 Px=0。对其他矩阵我们使用行列式与线性代数，这是本章的关键计算 — 几乎所有的应用都是从求解 Ax=λx 开始。

首先把 x 移到左侧，把方程式 Ax=2x 写成（A-M）x=0，矩阵 A-I 乘特征向量 x 得到零向量，特征向量构成 A-I 的零空间。当我们知道一个特征值 λ，我们求解（A-λD）x=0 得到一个特征向量。

首先是特征值。如果（A-）x=0 有非零解，A-I 不可逆，A-I 的行列式必须等于 0，这是求出特征值的方法：

特征值

数字 λ 是 A 的一个特征值，当且仅当 A-I 奇异。

特征值方程式

det （A －.l） = 0

（3）

「特性多项式」det（A-2）只跟 A 有关，与 x 无关。当 A 是 n×n，方程式（3）的次数是 n，A 有 n 个特征值（可能有重复！），每个 λ 得到 x:

对于每个特征值 λ 求解（A-A）x=0 或 Ax=λx 得到一个特征向量 x。

范例 4-2 足行列式求出它首与

当 A 奇异，A=0 是一个特征值，方程式 Ax=0x 有解，他们是对应 A=0 的特征向量。但是 det（A-2）=0 是找出所有 2＇s 与 x＇s 的方法，都是从 A 减去 I：从对角线减去 λ 得到

4-u-242）

（4）

计算 2×2 矩阵的行列式「ad-bc」，「ad」的部分是 1-λ 乘 4-λ 等于 λ2-5λ+4， 不包含 A 的部分「bc」是 2 乘 2。

（5）

令行列式 λ2-5λ=0，一个解是 λ=0（如预期，A 是奇异），分解得到 λ 乘 λ－5，另一个根是 λ=5:

det（A-AD）=22-5λ=0 得到 λ1=0 与 λ2=5

网址：linear.neocities.org 箱：876152660@qq.com 293

现在找出特征向量。分开 λ1=0 与 λ2=5 求解（A-λ）x=0:

=0D4 - 得到个特征向最：］-［?

= 到个向

矩阵 A-0I 与 A-5I 都是奇异（因为 0 与 5 是特征值），特征向量（2，－1）与（1，2）在零空间中：（A-λD）x=0 就是 Ax=λx。

我们需要强调：1=0 并不是特殊情形，好像其他数字一样，零可能是特征值也可能不是。如果 A 是奇异，λ=0 对应的特征向量产生零空间：Ax=0x=0。如果 A 可逆，零就不是特征值。我们把 A 平移 I 的倍数使得 A 奇异。

这个例子中，平移矩阵 A-5I 是奇异，5 是另一个特征值。

摘要对 n×n 矩阵求解特征值问题，依循下列步骤：

1. 计算 A - 的行列式。对角线减去，这个行列式从或－x 开始，它是

λ 的 n 次多项式。

2. 找出多项式的根。求解 det（A-AI）=0，这 n 个根是 A 的 n 个特征值，他

们使得 A - 奇异。

3. 对每个特征值 A，求解（A-λD）x=0 得到一个特征向量 x。

一个 2x2 矩阵特征向量的注解。当 A - 奇异，两个行都是一个向量（a，b）的倍数，特征向量是（b，-a）的任意倍数。这个例子有：

=0:A-0I 的行在方向（1，2）；特征向量的方向是（2，－1）。

λ=5:A-5I 的行在方向（-4，2）；特征向量的方向是（2，4）。

在前面我们把最后一个特征向量写成（1，2），两个向量（1，2）与（2，4）都是正确的，一整条线都是特征向量－-x 的任意非零倍数与 x 有同样性质。MATLAB 的 eig（A）会除以自己的长度使得特征向量变成单位向量。

我们必须加上一个警告，某些 2×2 矩阵只有一条直线的特征向量，这个只会发生在两个特征值相等的情形下。（另一方面 A=I 有相等的特征值以及非常多的特征向量。）缺乏一整组的特征向量，我们就没有一组基底，我们不可能把每个向量 ν 写成特征向量的组合。下一章的内容说明在没有 n 个无关的特征向量时，我们无法对角化一个矩阵。

请尊重版权与译者的劳动成果，侵权必究！ 294

行列式与迹

首先是坏消息：如果你把 A 的某一行加到另一行，或是交换行，通常都会改变特

征值，消元法不能维持＇s。三角 U 在对角线上有自己的特征值－他们是主元，

但是他们不是 A 的特征值！当行 1 加到行 2，特征值会改变：

v--0-

好的新消息：从矩阵可以快速的找出 1 乘 2 的乘积与 1+22 的总和，对 A 来说乘

积是 0 乘 7，这个与行列式一致（行列式是 0）。特征值的总和是 0+7，这个与主

对角线的总和一致（迹（trace）是 1+6），这些快速检验都是可用的：

n 个特征值的乘积等于行列式。

n 个特征值的总和等于 n 个对角线单元的总和。

主对角线单元的总和称为 A 的迹：

1+λ2+.+λn = 迹 = a11+a22+.+ann

（6）

这些检验非常有用，他们的证明在问题 16-17，下个段落也会再出现。他们没有

消除计算 s 的痛苦，但是计算错误时，他们会如此告诉我们。要计算正确的＇s，

回到 det（A-2I）=0。

当矩阵是 2×2 时，迹与行列式确实告诉我们每件事情，我们从来都不想弄错！

此处迹 = 3 与 det=2，所以特征值是 1=1 与 2:

3

（7）

下列是最佳矩阵找出特征值的问题：三角矩阵。

为什么三角矩阵的特征值都在对角线上？

虚数特征值

再来一点消息（不是太可怕），特征值可能不是实数。

范例 5 旋转 90° 的 o-［9 0）没有实数特征值，它的特征值是 λ1=i 与

2=-i，则 1+2 = 迹 = 0 且 12 = 行列式 = 1。

旋转之后，没有实数向量 Qx 留在与 x 相同的方向（x=0 没有用），除非我们使

用虚数，否则就不存在特征向量，我们会这么做的。

295

看看 i=√－1 有什么帮助，检视 Q2=-I，如果 Q 旋转 90°，Q2 就旋转 180°，它的特征值是－1 与－1。（当然－Ix=-1x）。对 Q 平方也会对 1 平方，所以我们必须有 λ2=-1，因此 90° 旋转矩阵 Q 的特征值是 + i 与－i，因为 i2=-1。

这些 i＇s 也来自 det（Q-2）=0，方程式得到 22+1=0，它的根是 i 与－i。我们在特征向量也会看到虚数：

复数特征向量

［¯］］-］［］-］

也许这些复数向量 x1=（1，i）与 x2=（i，1）在旋转之后仍然维持原来的方向，不要问我怎么回事。这个例子指出最重要的一点，就是实数矩阵很容易有复数特征值与特征向量。这些特殊的特征值 i 与－i 也说明了 Q 的两个特殊性质：

1.Ω 是正交矩阵所以每个 A 的绝对值 | 2|=1。

2.Q 是反对称矩阵所以每个 1 是纯虚数。

对称矩阵（ST=S）可以比喻成实数，反对称矩阵（AT=-A）可以比喻成虚数，正交矩阵（QQ=I）对应 | 2|=1 的复数。对于 S 与 A 与 Q 的特征值来说，他们不只是类比－段落 6.4 证明了他们是事实。

所有这些特殊矩阵的特征向量都互相垂直，（i，1）与（1，i）也是一种垂直（第九章说明复数的点积）。

AB 与 A+B 的特征值

第一个有关 AB 的特征值的猜想是错误的，A 的一个特征值 A 乘 B 的一个特征值 β 通常不会得到 AB 的一个特征值：

错误的证明 ABx=Aβx=βAx=βλx

（8）

似乎 B 乘 A 是一个特征值，当 x 同时是 A 与 B 的特征向量，这个证明是正确的。这个错误在于期待 A 与 B 自动地共享同样的特征向量 x，一般来说这是不可能的，A 的特征向量通常不会是 B 的特征向量。当 1 是 AB 的一个特征值，A 与 B 会有全零的特征值：

4-|| 与 8-|｝：则 AB=|| 与 4+B=|

相同的理由，A+B 的特征值通常不是 A+β。当 A+B 有特征值 1 与－1 时（至少他们相加得到零），此时 λ+B=0。

请尊重版权与译者的劳动成果，侵权必究！ 296

前面错误的证明也提供了一些信息，假设 x 真的是同时 A 与 B 的特征向量，我们确实有 ABx=λβx 与 BAx=λBx，当所有的特征向量都共享，我们可以乘特征值。共享特征向量的测试 AB=BA 在量子力学非常重要－- 说明线性代数应用的时间到了：A 与 B 共享同样 n 个无关的特征向量当且仅当 AB=BA。

海森堡的不确定原理在量子力学中，位置矩阵 P 与动量矩阵 Q 不能交换，事实上 QP-PQ=I（这些是无限矩阵）。要同时有 Px=0 且 Qx=0，必然需要 x=Ix=0。如果我们确切的知道位置，我们就不可能确切的知道动量。问题 36 推导海森堡不确定原理 IPal l ll k.

主要观念的复习

1.Ax=2x 表示 x 被 A 乘时，x 维持同样的方向。

2.Ax=x 也表示 det（A-2D）=0，这个决定了 n 个特征值。

3.A2 与 A1 的特征值是 λ2 与 λ－1，而且有相同的特征向量。

4.2＇s 的总和等于 A 主对角线单元的总和（迹），2＇s 的乘积等于 A 的行列式。5. 投影 P，镜射 R，90° 旋转 Q 有特殊的特征值 1 与 0 与－1 与 i 与－i。奇异

矩阵 = 0，三角矩阵有 s 在对角线

6. 矩阵的特殊性质得到特殊特征值与特殊特征向量，这是本章的主题（在最

后制成一张表）。

已解范例

6.1A 求出 A 与 A2 与 A1 与 A+4I 的特征值与特征向量：

检验迹 1+2=4 与行列式 12=3。

解 A 的特征值来自 det（A-2）=0:

4-［］det4=||=x2-4x+3=0

分解得到（A-1）（A-3）=0 所以 A 的特征值是 λ1=1 与 λ2=3。对迹来说，总和 2+2 与 1+3 一致，行列式 3 与 λ12 的乘积一致。

网址：linear.neocities.org 箱：876152660@qq.com 297

特征向量分别来自求解（A-）x=0 也就是 Ax=λx:

A=1:（A-Dx

得到特征向量 x1 ｛｝

=3：（A-31）x

得到特征向量 x2

A2 与 A1 与 A+4I 维持与 A 相同的特征向量，特征值是 λ2 与 λ1 与 + 4:

4 1=1 3=9 41 4+41 114=5

3+4=7

后面段落的注解：A 有正交的特征向量（段落 6.4 的对称矩阵）。由于 λ1≠2，A 可以对角化（段落 6.2）。与任何特征值是 1 与 3 的 2×2 矩阵相似的 A（段落 6.2）。由于 A=AT 且 2＇s 都是正数，A 是正定（positive definite）矩阵（段落 6.5）。

6.1B 你如何估测任意矩阵 A 的特征值？Gershgorin 给了答案。

A 的每一个特征值必颁与最少一个的对角线单元 a 很「接近」。很「接近 an」表示 | aii- λ| 不大于 Ri，其中 Ri 是矩阵行 i 其他的 | aj | 的总和，则 Ri= ∑j≠i|aij | 是以 a＃为圆心的圆半径。

每一个落在环统一个或更多个对角单元 a 的圆：an-4≤R0

下列是推理过程：如果 2 是特征值，则 A-I 不可逆，那么 A-I 就不可能是对角支配（见段落 2.5），所以最少有一个对角单元 a＃-2 不大于 R，其中 R1 是行 i 中其他单元 | a|（我们取绝对值！）的总和。

范例 1A 的每个特征值 2 落在一个或是同时落在两个 Gershgorin 圆中，圆心是 a 与 d，半径是 R1=|b | 与 R2=|c|。

第一个圆： －a｜b

第二个圆： x-d｜｜c

这些是复数平面的圆，因为 λ 当然可能是复数。

范例 2A 的所有特征值 A 落在一个半径 R=3 的圆中，这个圆环绕一个或是更多的对角线单元 d1，d2，d3:

－d1｜1+2=R1

－d2≤2+1=R2

－d3|>1+2=R

在这个例子中，你看到的「接近」表示距离 d1 或 d2 或 d3 不超过 3。

请尊重版权与译者的劳动成果，侵权必究！ 298

6.1C 求出对称 3×3 矩阵 S 的特征值与特征向量：

对称矩阵

奇异矩阵

迹 1+2+1=4

解 S 的所有行的总和都是零，向量 x=（1，1，1）得到 Sx=0，这是 λ=0 对应的一

个特征向量。要求得 λ2 与 A3，我会计算 3×3 的行列式：

0=（1-2）（2-）（1-2）-2（1-）

这三个因子得到 = 0，1，3，每个特征值对应一个特征向量（或是特征向量的直线）：

我再次注意到当 S 对称时特征向量互相垂直。我们很幸运求出 2=0，1，3，对于大

型矩阵我会用 eig（A），从来不碰行列式。

完整的指令［X，E］=eig（A）在 Ⅹ 的列会得到单位特征向量。

问题集 6.1

1 本章开头的例子有 A 的次方：

与与

求出这些矩阵的特征值，所有的次方有相同的特征向量。

（a）从 A 说明行交换或如何得到不同的特征值。

（b）为什么零特征值在消元步骤下不会改变？

2 求出这两个矩阵的特征值与特征向量:

541

A+I 有与 A___的特征向量，它的特征值是＿___多 1。

3 计算 A 与 A 的特征值与特征向量，检验迹！

A1 有与 A__的特征向量，当 A 有特征值 λ1 与 λ2，逆矩阵有特征值＿__。＿____

网址：linear.neocities.org 箱：876152660@qq.com 299

4 计算 A 与 A2 的特征值与特征向量：

与

A2 有与 A__的特征向量，当 A 有特征值 A1 与 λ2，则 A2 有特征值＿__。本＿___例子中，为什么 h12+2=13?

5 计算 A 与 B（三角矩阵很容易）与 A+B 的特征值：

4-|| 与－| 与 4+8-|

A+B 的特征值（等于）（不等于）A 的特征值加 B 的特征值。

6 计算 A 与 B 与 AB 与 BA 的特征值：

4-| 与 8-|｝与 48-| 与 84-|｝

（a）AB 的特征值等于 A 的特征值乘 B 的特征值吗？

（b）AB 的特征值等于 BA 的特征值吗？

7 消元法得到 A=LU，U 的特征值在对角线上，他们是

。L 的特征值在

对角线上，他们全部是

。A 的特征值与

不相等。

8（a）若你知道 x 是特征向量，找出 1 的方法是

（b）若你知道是特征值，找出 x 的方法是

9 为了证明（a），（b）与（c），你会对 Ax=λx 做什么动作？

（a）λ2 是 A2 的特征值，如同问题 4。

（b）λ1 是 A1 的特征值，如同问题 3。

（c）λ+1 是 A+I 的特征值，如同问题 2。

10 计算马尔可夫矩阵 A 与 A 的特征值与特征向量，从答案说明为什么 A100 很接近 A」？

112×2 矩阵的特征值 λ1≠22 时，有一个奇怪的事实：A-λ1I 的列是特征向量 x2 的倍数，有什么想法为什么它会这样？

请尊重版权与译者的劳动成果，侵权必究！ 300

12 找出矩阵 P（投影矩阵有 = 1 与 0）的 3 个特征向量：

我影

如果两个特征向量共享同一个 1，他们所有的线性组合也是。找出 P 的一个不含零分量的特征向量。

13 单位向量 u=（1，1，3，5），利用 u 创建秩一投影矩阵 P=uuT。因为 uTu=1，这个矩阵有 P2=P。

（a） Pu=u 来自（uuT）u=u（

），则 u 是对应 λ=1 的特征向量。

（b）若 ν 与 u 垂直，证明 Pv=0，则 1=0。

（c）找出对应 A=0 的 P 的三个无关特征向量。

14 利用二次公式求解 det（Q-2）=0，得到 1=cos0±isinθ：

旋转 xy 平面角度 θ，没有实数 λ＇s。

求解（Q-2D）x=0 找出 Ω 的特征向量，使用 i2=-1。

15 每个排列矩阵使得 x=（1，1，.，1）保持不变，则 λ=1。利用 det（P-λI）=0 找

出下列排列矩阵的另外两个＇s（可能是复数）:

010

P=

16A 的行列式等于乘积 12.n，从多项式 det（A －）开始，分解它的 n 个因子（一定可以），然后令 λ=0:

det（A-2）=（1-λ）（2-2）.（n-）所以 detA=

检查范例 1 的规则，其中马尔可夫矩阵有 = 1 与 1/2。

17 对角线单元的总和（迹）等于特征值的总和：

二次公式得到特征值 λ=（a+d+√）/2 与 λ=

，他们的总和是

如果 A 有 λ1=3 与 λ2=4，则 det（A-λI）=

18 如果 A 有 21=4 与 22=5，则 det（A-2D）=（λ－4）（1-5）=22-9λ+20。找出三个矩阵使得迹 a+d=9 与行列式 20 与 λ=4，5。

网址：linear.neocities.org 箱：876152660@qq.com 301

19 一个 3×3 矩阵 B 已知有特征值 0，1，2，这个信息足够找出下列哪三个（可能的话给出答案）:

（a）B 的秩。

（b）BTB 的行列式。

（c）BTB 的特征值。

（d）（B2+I）1 的特征值。

20 选择 A 与 C 的最后一行，使得特征值是 4，7 与 1，2，3:

伴随（companion）矩阵 －∷｝

C=

21A 的特征值与 AT 的特征值相同，这是因为 det（A-A）=det（AT-A）。因为

，这是成立的。举出例子说明 A 的特征向量与 AT 的特征向量不相同。22 创建任意的 3×3 马尔可夫矩阵：正的单元且每个列的总和是 1。证明 M（1，1，1）=（1，1，1）。使用问题 21，λ=1 也是 MT 的特征值。挑战：一个 3×3 奇异马尔可夫矩阵的迹是 1/2，它有什么样的特征值＇s?

23 找出三个 2×2 矩阵使得 1=22=0，迹是 0，行列式是 0。A 可能不是零矩阵，但是请检验 A2=0。

24 矩阵是奇异且秩一，找出三个＇s 与三个特征向量：

212

25 假设 A 与 B 有相同的特征值 λ1，.，n，而且有相同对应的特征向量 x1，..，xn，则 A=B。理由：任意向量 x 是 C1x1+.+Cnxn 的组合，则 Ax=?Bx=?26 方块 B 有特征值 1，2 且 C 有特征值 3，4 且 D 有特征值 5，7。求出 4×4 矩阵 A 的特征值。

0130

0 0 1 6

27 求出 A 与 C 的秩以及四个特征值：

1 01 0

A=

与 C= 0 10 1

1 0 1 0

0 1 0 1

请尊重版权与译者的劳动成果，侵权必究！ 302

28 从 I 减去前面的 A，求出＇s 与行列式：

0-1-1-17

29（复习）求出 A，B，C 的特征值：

30 当 a+b=c+d 证明（1，1）是一个特征向量并找出两个特征值：

－［｝

31 如果我们交换行 1 与 2，交换列 1 与 2，特征值不会改变。若 2=11 求出 A 与

B 的特征向量。秩一得到 λ2=λ3=0。

32 假设 A 有特征值 0，3，5，对应的无关特征向量是 u，v，w。

（a）求出零空间的一组基底与列空间的一组基底。

（b）求出 Ax=v+w 的一个特定解，求出全部的解。

（c）Ax=u 无解。如果有解，

会在列空间。

挑战问题

33 证明是秩一的 2×2 矩阵 A=uvT 的一个特征向量，找出 A 的两个特征值，

检验 1+λ2 与迹 u1v1+u2v2 一致。

34 从 det（P-2）=0 求出排列矩阵 P 的特征值。哪些向量不因排列而改变？他

们是对应 λ=1 的特征向量。你能够找出三个以上的特征向量吗？

0 0 0 1

10 0 0

P=0 1 0 0

0010

网址:linear.neocities.org 箱：876152660@qq.com 303

35 有 6 个 3×3 的排列矩阵 P，P 的行列式可以是什么数字？主元可以是什么数字？P 的迹可以是什么数字？哪 4 个数字可以作为 P 的特征值，如同问题 15?36（海森堡不确定原理）无限矩阵会有 AB-BA=I，其中 A=AT 与 B=-BT，则

xTx=xTABx-xTBAx≤2|Ax|Bx|

说明最后一个步骤使用了苏瓦兹不等式 | uv|≤‖u‖‖ν|‖，则海森堡不等式说明了 Ax/x 乘 Bx/x 最小是 1/2，所以不可能同时得到位置误差与动量误差都很小。

37 求出一个 2×2 旋转矩阵 A（不是 I）使得 A3=I，它的特征值必须满足 3=1，他们可以是 e2mi/3 与 e-2mi/3，矩阵的迹与行列式为何？

38（a）找出 A 的特征值与特征向量，他们与 c 有关：

（b）当 c=1.6，证明 A 只有一条线的特征向量。

（c）当 c=.8 这是一个马尔可夫矩阵，则 A」会趋近哪个矩阵 A°？

MATLAB 的 eigshow

MATLAB 有一个展示（键入 eigshow），会显示 2×2 矩阵的特征值问题。它从单位向量 x 开始，鼠标使得向量环绕单位圆，同时屏幕显示 Ax，不同颜色也在移动。Ax 可能超前 x 也可能落后 x，有时候 Ax 与 x 平行。

在平行的时候，Ax=λx（在第二图的 x1 与 x2）。

y = （0， 1）

4-3

X2

Ax1=x1

Ay = （Q.3，0.7）

Ax2 = 0.5x2

Ax = （0.8，0.2）

Ax＇s 的椭圆

x =（1，0）

x＇s 的圆

他们不是特征向量

在特征向量时，Ax 与 x 平行

当单位向量 x 共线时，特征值 λ 是 Ax 的长度。A 的内建选择有三种可能性：当 x 与 Ax 交会时有 0，1 或 2 个实数向量。

椭圆的轴是段落 7.4 的奇异向量－若 AT=A，轴也是特征向量。

请尊重版权与译者的劳动成果，侵权必究！ 304

6.2 对角化矩阵

1AX=XA 的列是 Axk=AAxk。特征值矩阵 A 是对角矩阵。

2X 的 n 个无关的特征向量可以对角化 A:|A=XAX1 与 A=X1AX。3 特征向量矩阵 X 同样可以对角化所有的次方 A:A=XAX1。

4 利用 uk=Akuo=XAkx1uo=c1（1）kx1+.+cn（n）kxn，求解 uk+1=Auk。5 没有相等的特征向量→X 是可逆且 A 可以对角化。

有相等的特征向量→A 的无关特征向量可能不足，则 X` 失败。

6 每个矩阵 C=BAB 与 A 有相同的特征值，这些 C 与 A「相似」。

当 x 是一个特征向量，被 A 乘只是乘一个数字 λ：Ax=λx。矩阵的所有困难

一扫而空，我们可以分开处理特征向量，而不是处理一个互联系统。如同对角矩

阵一样－没有非对角线的互联，对角矩阵的 100 次方非常容易。

本段落的重点非常直接，我们使用特征向量的性质，使得矩阵 A 变成对角矩

阵 A，这个矩阵形式是我们的关键概念。我们立即开始一个重要的计算，下一页

会解释为什么 AX=XA。

对角化假设 n×n 矩阵 A 有 n 个线性无关的特征向量 x1，..，xn，把他们放在特征

向量矩阵 X 的列，则 X1AX 就是对角矩阵 A:

固有向量矩阵 X

X¹AX=Λ=

（1）

固有值矩阵 Λ

2n

矩阵 A 被「对角化」，我是使用大写的 A 代表特征值矩阵，是因为小写的 2＇s（特

征值）用在对角线上。

范例 1A 是三角矩阵，所以它的特征值在对角线上：λ=1 与 λ=6。

特征向量进入 X

［¦］［］］［＇8］

A

X = A

换言之，A=XAX1，检视 A2=XΛX1XAX1，所以 A2 是 XA2X1。

A2 有跟 X 中的相同特征向量，以及在 A2 的特征值平方。

网址：linear.neocities.org 箱：876152660@qq.com 305

为什么 AX=XA?A 乘自己的特征向量，这些特征向量是 X 的列，AX 的第一列是 Ax1，就是 λ1x1。X 的每一列被自己的特征值乘：

A 乘 X

= 作］

技巧在于把矩阵 AX 分割成 XA:

X 乘 Λ

［］J

n

这些矩阵保持右序！则 1 乘第一列 x1，如所示。现在完成对角化，我们可以把 AX=XA 写成两个方式：

AX=XA 是 X＇AX=Λ 或 A=XAX1

（2）

矩阵 X 可逆，这是因为它的列（A 的特征向量）假设是线性无关，没有 n 个无关的特征向量，我们不能对角化。

A 与 Λ 有相同的特征值 λ1，..，λn，特征向量则不同。原始特征向量 x1，.，xn 的工作是对角化 A，X 中的特征向量产生 A=XAX1。你会很快看到它们的简洁性，重要性以及意义。第 k 个次方是 Ak=XAX1，这个很容易计算：

Α＊=（XΛX＇）（XлX＇）..（XX＇）=XΛ＊X

范例 1 的 A 的次方

＇-［］［＇］［-［＊］-

k=1 我们得到 A；k=0 我们得到 A0=I（A0=1）；k=-1 我们得到 A-1。你可以看到 A2=［135；036］是如何适配 k=2 的公式。

在范例 2 再次使用 Λ 之前，下列是 4 个小注解。

注解 1 假设特征值 1，..，n 都不相同，则特征向量 x1，..，xn 自动是无关，特征向量矩阵可逆。任何没有重复特征值的矩阵都可以对角化。

注解 2 我们可以使用任意非零乘数乘特征向量，A（cx）=2（cx）仍然成立。范例 1 中，我们可以把 x=（1，1）除以√2 产生单位向量。

MATLAB 以及其他代码都是得到长度 | x|=1 的特征向量。

请尊重版权与译者的劳动成果，侵权必究！ 306

注解 3X 特征向量的顺序与 A 特征值的顺序相同，要反转 A 的顺序，把 X 的特征向量（1，1）放在（1，0）之前：

新顺序 6，1

［［］］［］-¸

要对角化 A，我们必须使用特征向量矩阵，从 XAX=A 我们知道 AX=XA。假设 X 的第一列是 x，则 AX 与 XA 的第一列是 Ax 与 λ1x，这些要相等，x 必须是特征向量。

注解 4（重复特征值的重复警告）有些矩阵的特征向量不足，这些矩阵不能对角化，下列是两个例子：

不能对角化

－｛〓｝58-|

他们的特征值刚好是 0 与 0，λ=0 没有什么特殊，问题是重复的 A。第一个矩阵的所有特征向量是（1，1）的倍数：

只有精证向量直线表 Hx

没有第二个特征向量，所以这个不寻常的矩阵 A 不能对角化。

这些矩阵是检验特征向量叙述的最佳例子，在许多是非题中，不能对角化的矩阵会导致测试失败。

请记住可逆与可对角化之间没有关联：

－可逆与特征值有关（λ=0 或 λ≠0）。

－可对角化与特征向量有关（X 的向量不足或足够）。

每个特征值对应最少一个特征向量！A-2I 是奇异，如果（A-λ）x=0 引导你得到 x=0，使得不是特征值，这是求解 det（A-2）=0 的一个错误。

对应 n 个不同 2＇s 的特征向量是无关，则我们可以对角化 A。

对应不同 λ 的无关 x 对应相异（全部不同）特征值的特征向量 x1，.，xn 必然是线性无关；一个具有不同特征值（没有重复的 λ＇s）的 n×n 矩阵必然可以对角化。证明假设 C1x1+C2x2=0，被 A 乘得到 C1λ1x1+C2λ2x2=0，被 2 乘得到 C1λ2x1+C2h2x2=0，现在两式相减：

相减得到（λ1-λ2）C1x1=0，因此 C1=0

由于 A＇s 不相同且 x1≠0，我们强迫得到 C1=0 的结论。同理 C2=0，只有 C1=C2=0 的组合才能得到 C1x1+C2x2=0，所以特征向量 x1 与 x2 必须是无关。

网址：linear.neocities.org 箱：876152660@qq.com 307

这个证明可以直接延伸至 j 个特征向量，假设 c1x1+..+Cx=0，左乘 A，左乘，然后相减，得到（A1-λ）=0 乘 x，于是 x 消失。现在左乘 A，左乘 λ－1，然后相减，移除 x-1。最终只剩下 x1:

我们得到（1-2）.（1-）C1x1=0 强制使得 C1=0

（3）

同理，每个 c1=0。当所有的 A 都不相同，特征向量是无关。一整个特征向量的集合可以进入特征向量矩阵 X 的列。

范例 2A 的次方前一个段的马尔可大阵 A 有特征值 = 1 与 =.5，此时 A=XAX1 使得特征值在 A 的对角线上：

马尔可夫范例

［3-［¡］［9］［-.5］-＇

特征向量（.6，.4）与（1，－1）在 X 的列，他们也是 A2 的特征向量。观察 A2 如何有相同的 X，且 A2 的特征值矩阵是 Λ2:

A2 有相同的 X

A² =XлΧ¹ΧΛΧ¹= ΧΛ²Χ¹

（4）

继续前进，你会看到为什么高次方 A 趋近一个「稳定状态」：

＇=xx＇-］［4

当 k 变大，（.5）变小，它在极限时完全消失，这个极限是 A」：

^-［¦［O］［［］

这个极限的两个列是特征向量 x1，我们在第六章的第一页已经看过 A」，现在我们知道它来自类似的 A100=XΛ100X-1。

问题

何时 A→零矩阵？

答案

所有的 | 2|<1

相似矩阵：相同特征值

假设特征值矩阵 A 固定，当我们改变特征向量矩阵 X，我们得到不同矩阵 A=XAX1 构成的一整个家族－全部矩阵都有与 A 相同的特征值。所有的这些矩阵 A（对应相同的 Λ）称为：「相似（similar）」。

这个概念可以延伸至不能对角化的矩阵，我们再次选择一个常数矩阵（不需要是 A），我们观察整个家族矩阵 A=BCB，允许所有的可逆矩阵 B，这些矩阵 A 与 C 也是相似。

请尊重版权与译者的劳动成果，侵权必究！ 308

我们没有使用 A 而使用 C 是因为 C 可能不是对角，我们没有使用 X 而使用 B 是因为 B 的列可能不是特征向量。我们只需要 B 的可逆性质－— 它的列包含 R」的任意一组基底。相似矩阵的关键事实仍然成立。相似矩阵 A 与 C 有相同特征值。所有矩阵 A=BCB1 是「相似」，他们全部共享 C 的特征值。

证明假设 Cx=x，则 BCB 有相同的特征值对应新的特征向量 Bx:

相同 λ（BCB-1）（Bx）=BCx=Bλx=λ（Bx）

（5）

一个固定的矩阵 C 产生一个家族的相似矩阵 BCB，允许所有的 B。当 C 是单位矩阵，这个家族非常小，唯一的成员是 BIB1=I。单位矩阵是特征值 λ=1 唯一可以对角化的矩阵。

当 1=1 与 1 而且只对应一个特征向量（不可对角化），这个家族变大一点。最简单的 C 是若尔当形式（Jordan form）- 段落 8.3 会推导。所有的相似 A＇s 有两个参数 r 与 s，不同时为零：永远是行列式 = 1 与迹 = 2。

c--cg-

（6）

我会在一个重要例子中选择特征值 2=1 与 0（不重复！），现在整个家族有相同的特征值矩阵 A，而且可以对角化。我们取得每一个有特征值 1 与 0 的 2×2 矩阵，迹是 1 且行列式是零：

所有的相似 ^-|4-|| 或－或任意 A=

xīy

这个家族包含所有 A2=A 的矩阵，包含当 B=I 时 A=A。当 A 是对称时，这些也是投影矩阵，特征值 1 与 0 使得生活容易多了。

斐波那契数字（Fibonacci number）我们演示一个著名的例子，其中特征值会告诉我们斐波那契数字如何的快速增长。每个新的斐波那契数字是前两个斐波那契数字的总和。

序列 0，1，1，2，3，5，8，13，，.

来自

Fk+2=Fk+1+Fk

这些数字以神奇多样的方式出现，植物与树木以螺旋模式成长，一棵梨树每 3 转有 8 个成长。如果是柳树，这些数字是 13 与 5。冠军则是 Daniel O＇connell 的向日葵，在 144 圈有 233 个种子。这是斐波那契数字的 F13 与 F12，我们的问题比较基本。

网址：linear.neocities.org 箱：876152660@qq.com 309

问题：找出斐波那契数字 F100 最慢的方法是应用规则 Fk+2=Fk+1+Fk 一步一步计算，把 F6=8 加上 F7=13 得到 F8=21，最终我们来到 F100。线性代数有好方法。

关键从矩阵方程式 uk+1=Auk 开始，这是向量的「一步」规则，斐波那契数字是纯量的两步规则。两个斐波那契数字放在一个向量来适配这些规则，你会看到矩阵 A。

令 M=［］，规则 + 2=+1+Fk 是

－］

（7）

每个步左乘 A=B10 之后我们得到 =

这个问题就是特征值问题，从 A 的对角线减去：

A-x=［］得到 det（4-2）=x2-x-1

求解二次公式得到方程式－0 解（b2

特征值

518 与

这些特征值得到特征向量 x1=（A1，1）与 x2=（2，1）。步骤 2 找出这些特征向量的组合得到 u0=（1，0）:

（8）

步骤 3 把 A100 乘 u0 得到 100。特征向量 x1 与 x2 还是分开，分别乘（A1）100 与（A2）100:

来自 u 的第 100 步

00=（）00-（2）2

（9）

我们要的 F100 是 100 的第二分量，x1 与 x2 的第二分量是 1，λ1=（1+√5）/2 与 2=（1-√5）/2 之间的差是√5，且 2100≈0。

第 10 个波数字 =（= 最接近 1 + 的整数（10）

每个 Fg 都是一整个数字，F101/F100 的比值必须非常接近极限比值（1+√5）/2，希腊人称此为「黄金分割（golden mean）」。基于某些原因，矩形的边是 1.618 与 1 看起来特别优雅。

请尊重版权与译者的劳动成果，侵权必究！ 310

矩阵次方 A＊

斐波那契的例子是典型的差分方程式 uk+1=Auk，每个步骤左乘 A，解是 uk=Akuo。

我们想要弄清楚对角化矩阵如何得到快速计算 A 与 k 的方法，而且是在三个步

骤之内完成。

特征向量矩阵 X 得到 A=XAX1，这是矩阵的一种分解，好像 A=LU 或是 A=

QR。这个新分解完美的适配计算幂次方，因为每次 X1 乘 X 我们得到 I:

A 的次方 Akuo=（XAX1）.（XAX1）uo=XAX1uo

我会把 XAX1u 分割成三个步骤，展示特征值是如何工作的：

1. 把 u0 写成特征向量的组合 c1x1+.+Cnxn，则 c=X1uo。

2. 把每个特征向量 x1 左乘（）＊，现在我们有 AkX-1u

3. 累加所有的片段 c1（）kx1，求出解 uk=Akuo。这是 XAkX-1uo

uk+1=Auk 的解

uk=Aku0=c1（21）kx1+..+cn（n）kxn

（11）

以矩阵语言来说，A 等于（XAX1），也就是 X 乘 A 乘 X1。在步骤 1，X 的特征向

量得到组合 u0=C1x1+.+C，xn 的 c＇s:

步骤 1

表示 uo=Xc

（12）

步骤 1 的系数是 c=X1u0。然后步骤 2 左乘 A，步骤 3 的最终结果 uk=∑c（）x

是 X 与 Ak 与 X1uo 的乘积：

...［＂

C1

（13）

（） Cn

这个结果恰好是 uk=Aku0=c1（λ1）kx1+.+Cn（λn）kxn，是 uk+1=Auk 的解。范例 3 从 uo=（1，0）开始，计算快速斐波那契数字的 Auo:

4=| 有 = 2 与 x=|，=-1 与 x=|

除了规则改成 Fk+2=Fk+1+2Fk 之外，这个矩阵很像斐波那契数字，新的数字从 0，

1，1，3 开始。因为 λ=2，所以他们成长的比较快速。

网址：linear.neocities.org 箱：876152660@qq.com 311

三个步骤求出 иk=Aиo

u0=c1x1+c2x2 且 uk=Akuo=c1（21）kx1+c2（22）x2

步骤 1 uo= 869 所以 C1=C2=1/3

步骤 2 分别左乘（a）=2 与（2）=（1）

步骤 3 组合特征向量 C1（1）x1 与 C2（2）x2 进入 uk:

и=Aио

uk=

新的数字是 Fk=（2-（-1））/3，在 0，1，1，3 之后是 F4=15/3=5。

在这些数字范例背后有一个基础概念：追随特征向量。在段落 6.3，这是从线性代数到微分方程式（变成 e」）的重要连接。第八章会看到「转换至特征向量基底」的相同概念，其中的最佳范例是「傅里叶级数（Fourier series）」，创建自 d/dx 的特征向量 ex。

不可对角化矩阵（选读）

假设是 A 的特征值，我们从两个方面发现这个事实：

1. 特征向量（几何的）Ax=λx 有非零解。

2. 特征值（代数的）A-I 的行列式是零。

数字可能是单一特征值或是多重特征值，我们想要知道它的倍数值（ （multiplicity）大部分特征值的倍数值是 M=1（单一特征值），有一条特征向量直线，det（A-） 没有双重因子（double factor）。

有一些例外的矩阵，特征值可以重复，有两个不同的方式计算它的倍数值，对于每个 1，永远是 GM≤AM:

1.（几何倍数值 = GM）GM 计算 2 对应的无关特征向量的个数，GM 是 A-I

的零空间的维度。

2.（代数倍数值 = AM）AM 计算在特征值的重复次数，检视 det（A-）=0

的 n 个根。

若 A 有 λ=4，4，4，则这个特征值有 AM=3 与 GM=1，2 或 3。

下列的矩阵 A 是标准的麻烦范例，它的特征值有重复的 0，它是一个双重特征值（AM=2），却只有一个特征向量（GM=1）。

AM =2

λ=0，0 但是

GM =1

1 个固有向量

请尊重版权与译者的劳动成果，侵权必究！ 312

因为 12=0 有双重根，理论上应该有两个特征向量，双重因子 22 使得 AM=2，但是只有一个特征向量 x=（1，0）与 GM=1。当 GM 小于 AM 时，特征向量的不足使得 A 不能对角化。

下列三个矩阵的特征向量都不足，重根是 1=5，迹是 10，行列式是 25:

4 | 与 4|| 与 4

他们都有 det（A-2）=（1-5）2，代数倍数值是 AM=2。但是每个 A-5I 的秩是 1，几何倍数值是 GM=1，对应 1=5 只有一个特征向量直线，这个三个矩阵都是不可对角化。

主要观念的复习

1. 若 A 有 n 个无关的特征向量 x1，..，xn，他们进入 X 的列。

A 被 X 对角化 X`AX=Λ 与 A=XAX1

2.A 的次方是 A=XAX1，X 的特征向量保持不变。

3.A＊的特征值是矩阵 Λ＊中的（λ1），.，（n）k。

4. 从 uo 开始，uk+1=Auk 的解是 uk=Akuo=XΛkX1uo:

假设 u0=C1x1+.+Cnxn 则 uk=c1（21）x1+..+cn（2n）kxn

这些是步骤 1，2，3（c＇s 来自 X1u0，2 来自 Ak，x＇s 来自 X）

5. 如果每个特征值都足够的特征向量（GM=AM），则 A 可以对角化。

已解范例

6.2A 除了从 L1=1 与 L2=3 开始之外，卢卡斯数字很像斐波那契数字。使用相同的规则 Lk+2=Lk+1+Lk，后面卢卡斯数字是 4，7，11，18。证明卢卡斯数字 L100 是 1100+22100。

网址：linear.neocities.org 箱：876152660@qq.com 313

解与那契相同，因为 4 + 是同的则（是不

同的起始值），方程式变成 2×2 系统：

=［｝规则 x+2=+1 + 是

A - 的特征值与特征米自

2 = 且 x2=［2］

现在求解 C1x1+C2x2=u1=（3，1），解是 C1=λ1 与 C2=λ2。检查：

u100=A99u1 告知我们卢卡斯数字（L101，L100）。x1 与 x2 的第二分量是 1，所以 u100 的第二分量就是我们想要的答案：

点卡斯数字 L10012+c2=2000

卢卡斯开始比斐波那契快，最终大约比斐波那契大√5 倍。

6.2B 求出矩阵 A 的逆矩阵与特征值以及行列式：

描述一个特征向量矩阵 X 使得 X`AX=A。

解全 1 矩阵的特征值为何？它的秩当然是 1，所以 3 个特征值是 1=0，0，0。它的迹是 4，所以另一个特征值是 = 4。从 5 减去全 1 矩阵得到我们的矩阵 A:

从 5，5，5，5 减去特征值 4，0，0，0，得到 A 的特征值是 1，5，5，5

A 的行列式是 125，是 4 个特征值的乘积。对应 1=1 的特征向量是 x=（1，1，1，1）或（c，c，c，c），另一个特征向量与 x 垂直（因为 A 对称），最棒的特征向量矩阵 X 是对称正交哈达玛矩阵 H。因子 1/2 得到单位列向量。

请尊重版权与译者的劳动成果，侵权必究！ 314

逆矩阵 A 的特征值是 1，1/5，1/5，1/5，特征向量不变所以 A~1=HAH1，逆矩阵是令人意外的整洁有序：

A 是从 5I 变化而来的秩一矩阵，所以 A 是从 I/5 变化而来的秩一矩阵。

在具有 5 个节点的图形中，行列式 125 是「生成树（spanning tree）」（接触所有节点的树）的个数，树没有回圈（图形与树在段落 10.1）。

如果是 6 个节点，矩阵 6＊eye（5）-ones（5）有 5 个特征值 1，6，6，6，6。

问题集 6.2

问题 1-7 有关特征值矩阵与特征向量矩阵 Λ 与 X。

1（a）分解下列矩阵变成 A=XAX1:

4-［3］

与

（b）若 A=xAx，则 A=（）（）（）且 A=（）（）（）

2 若 A2 特 x - 与证向－

用 XAX1 求 A。没有其他矩阵有相同的 λ＇s 与 x＇s。

3 假设 A=XAX，则 A+2I 的特征值矩阵为何？特征向量矩阵为何？检查 A+ 2I=（）（）（ ）¯¹.

4 是非题：若 X 的列（A 的特征向量）是线性无关，则

（a）A 可逆

（b）A 可对角化

（c）X 可逆

（d）X 可对角化

5 若 A 的特征向量是 I 的列，则 A 是一个＿__矩阵。若特征向量矩阵 X 是三角形，则 X` 是三角形，证明 A 也是三角形。

6 描述能够对角化矩阵 A 的所有矩阵 X（求出所有特征向量）:

4—］

然后描述能够对角化 A~1 的所有矩阵。

有的的

网址：linear.neocities.org 箱：876152660@qq.com 315

问题 8-10 有关斐波那契与 Gibonaccis 数字。

8 计算 X 然后对角化斐波那契矩阵：

］-［］［］［］

计算 x 我分个字－

9 假设 Gk+2 是前两个数字 Gk+1 与 Gk 的平均：

0［］11］

（a）求出 A 的特征值与特征向量。

（b）求出 An=XA＂x1 在 n→的极限。

（c）若 G0=0 与 G1=1，证明 Gibonaccis 数字趋近 2/3。

10 证明斐波那契数字 0，1，1，2，3，.，每三个数字一定是偶数。

问题 11-14 有关可对角化。

11 是非题：若 A 的特征值是 2，2，5，则矩阵必然是

（a）可逆（b）可对角化（c）不可对角化

12 是非题：若 A 的特征向量只有（1，4）的倍数，则 A

（a）不可逆（b）重复的特征值（c）不可对角化，没有 XAX1。

13 完成下列矩阵使得 detA=25，检查 1=5 是重复特征值－迹是 10 所以 A-2 的行列式是（1-5）2。找出 Ax=5x 的特征向量。这些矩阵不可对角化，因为没有第二条特征向量直线。

4 - 与 | 与

14 矩阵 A=［］不可对角化，因为 A-3 / 的秩是。改变一个单元使得 A 可以对角化。你会改变哪个单元？

问题 15-19 有关矩阵的次方。

15A＊=XAX1 在 k→∞趋近零矩阵，当且仅当每个 2 的绝对值比＿_小。下列矩阵哪个有 A→0? 4-［4-［|

请尊重版权与译者的劳动成果，侵权必究！ 316

16（推荐）求 A 与 X 对角化问题 15 的 A1。A 在 k→∞的极限为何？XAX1 的极

限为何？在这个极限矩阵的列，你看到了什么？

17 求 A 与 X 对角化问题 15 的 A2。（A2）10uo 为何？uo 如下:

－| 与的与的：

18 对角化 A 并且计算 XAX1，证明 A＊的公式：

19 对角化 B 并且计算 XAX1，证明 B＊的公式：

.｝＊-＊

20 假设 A=XAX1，取行列式证明 detA=detΛ=λ12.n。这个快速证明只能

在 A 是

才有效。

21 把 XY 的对角线单元加到 YX 的对角线单元，证明 XY 的迹等于 YX 的迹：

现在选择 Y 等于 AX1，则 XAX1 与 AX`X=A 有相同的迹，这就证明了 A 的迹

=Λ 的迹 = 特征值的总和。

22 不可能存在 AB-BA=I，因为左侧的迹 =

，但是找出一个消元矩阵使

得 A=E 与 B=ET 得到

AB-BA=［］，迹等于零。

23 假设 A=XAX1，对角化方块矩阵 B=，求出特征值与特征向量（方块）

矩阵。

24 考虑可以被相同固定的特征向量矩阵 X 对角化的所有 4×4 矩阵 A，证明 A＇s

形成一个子空间（cA 与 A1+A2 有相同的 X）。当 X=I，这个子空间为何？维度

是多少？

25 假设 A2=A，在左侧是 A 乘 A 的每个列，我们 4 个子空间的哪一个包含对应

=1 的特征向量？哪个子空间包含对应 1=0 的特征向量？从这些子空间的维

度来看，A 有一整组的无关特征向量，所以 A2=A 的矩阵可以对角化。

网址：linear.neocities.org 箱：876152660@qq.com 317

26（推荐）假设 Ax=λx，若 λ=0 则 x 在零空间中。若 λ≠0 则 x 在列空间中。这

些空间有维度（n-）+r=n 所以为什么不是每个方形矩阵都有 n 个线性无关

的特征向量？

27A 的特征值是 1 与 9，B 的特征值是－1 与 9:

从 R=X√AX1，求出 A 的平方根矩阵。为什么 B 没有实数的平方根矩阵？28 若 A 与 B 有相同的 2＇s 与相同的特征向量，他们分解成

是相同的，所以

A=B.

29 假设相同的 X 同时对角化 A 与 B，在 A=XA1X1 与 B=XA2X1 有相同的特征

向量。证明 AB=BA。

300 若 4 - 则 4 - 的行列式是－- 小检「利汉密尔

定理」（A-aI）（A-dI）= 零矩阵。

（b）对斐波那契的 A = 测试凯利－汉密尔顿定理，定理预测 A2-A-I=0，

因为多项式 det（A-）是 x2--1。

31 把 A=XA1X1 代入乘积（A-λ1D）（A-λ2I）..（A-2nI），并且说明为什么这个乘

积是零矩阵。我们是把矩阵 A 代入多项式 p（A）=det（A-AI）的数字 λ，凯利－

汉密尔顿定理指出这个乘积永远是 p（A）= 零矩阵，纵使 A 不可对角化。

32 若 A=

且 AB=BA，证明 B

也是对角矩阵，B 与 A 有相同的特

征＿__，但是有不同的特征＿__。这些对角矩阵 B 形成一个二维矩阵空间

的子空间，AB-BA=0 得到 4 个有关 a，b，c，d 的方程式 — 求出这个 4×4 矩阵

的秩。

33 如果所有的 | 2|<1，次方 A 趋近零；如果任意的 ||>1，次方 A 会爆炸。彼

得雷克斯在他的线性代数的书中给出反例：

l1>1000B=1c0=-CID<1078

求出 B 与 C 的特征值 λ=ei0，证明 B4=I 与 C3=-I。

请尊重版权与译者的劳动成果，侵权必究！ 318

挑战问题

34 旋转确的 n 次方相当于旋转 n0:

利用对角化 A=XAX1 证明这个简洁公式。特征向量（X 的列）是（1，i）与（i，1）。

你需要知道欧拉公式 ei0=cos0+isinθ 。

35 A=XAX1 的转置是 AT=（X1）TAXT，ATy=2y 的特征向量是（X1）T 的列，他们

通常称为 A 的左特征向量，因为 yTA=yT。要如何矩阵相乘找出 A 的公式？

秩一矩阵的总和 A=XAX1=21x1y1T+.+λnxnynT

36 A=eye（n）+ones（n）的逆矩阵是 A-1=eye（n）+C＊ones（n）。执行 AA-1 求出数字

C（与 n 有关）。

37 假设 A1 与 A2 是 n×n 可逆矩阵，什么矩阵使得 A2A1=B（A1A2）B~1? 则 A2A1 与

A1A2 相似：相同的特征值。

38 什么时候矩阵 A 与它的特征值矩阵 A 相似？

A 与 A 永远有相同的特征值，但是相似性需要一个矩阵 B 使得 A=BAB1，则

B 是

矩阵且 A 必须有 n 个无关的

39（Pavel Grinfeld）不写出任何计算，你能够找出下列矩阵的特征值吗？你能够

找出下列矩阵的第 2017 次方 A2017 吗？

11055-164

A」=4221-62

88 44 －131

若 A 是 m×n 且 B 是 n×m，则 AB 与 BA 有相同的非零特征值。

证明从两个方形矩阵的等式开始（容易检验），第一矩阵是第三矩阵的逆矩阵。「大小矩阵」显示所有方块的形状。

［0［ °］［-［B ］

m×m m×n

nхm nxn

方程式 D`ED=F 说明 F 与 E 相似－他们有相同的 m+n 个特征值。

2 有的个征加上个

所以除了 | n －m | 个零之外，AB 与 BA 有相同的特征值。哇！

若 A=［1，1］且 B=A，则 AA=（注意 A=2 与 0）以及 AA=［2］。

网址：linear.neocities.org 邮箱：876152660@qq.com 319

6.3 微分方程式系统

1 若 Ax=2x 则 u（）=e2x 是 d=Au 的解，每个 A 与 x 得到一个解 e2x。2 若 A=XAX1 则 | u（1）=e4u（0）=XeX1u（0）=ce2x1+..+cne2xn3 当 A 的所有特征值的实部 < 0，则 A 是稳定且 u（t）→0 以及 e＃→0。4 若 A 可以对角化，则矩阵指数 e=I+At+..+（At）/n！+..=Xe^MX-15 二阶方程式

一阶方程式系统

+

特征值与特征向量与 A=XAX1 对于矩阵次方 A 非常完美，他们对于微分方

程式出－- 样元美本段落大部分是线性代数，但是你需要一个微分的事

实才能研读：e」的导数是 Ae」。本章的重点在于：把常数系数微分方程式转换成

线性代数。

常微分方程式 = u 与 = u 的解是指数形式：

－得到 c - 得到 c

（1）

在 t=0 这些解包含 e0=1，所以他们简化成 u（0）=C，这个「初始值」告诉我们

C 的正确选。在 t=0 的数字 u（O）开始的解是 u（t）=u（O）e 与 u（）=u（）e

我们只是求解了 1×1 的问题，线性代数要移到 n×n。未知数是一个向量 u（现

在是粗体字），它从给定初始值 u（0）开始。这 n 个方程式包含了一个方形矩阵 A，

我们期待从 n 个 λ＇s 得到在 u（t）的 n 个指数 e」：

n 个方程

u1（0）

dy-Au

在 t=0 从向量 u（0）= .... 开始

式的系统

（2）

un（0）

这些微分方程式是线性，若 u（t）与 v（t）是解，则 Cu（t）+Dv（t）也是解，我们需要类

似 C 与 D 的常数来适配 u（0）的 n 个分量。我们第一个工作是利用 Ax=x 找出 n

个「纯指数解」u=e」x。

注意 A 是常数矩阵，在其他线性方程式 A 随着 t 变化。在非线性方程式中，A

随着 u 变化。我们没有那些困难，du/dt=Au 是线性而且系数是常数。这样的微

分方程式，我们直接转换成线性代数，以下是关键：

当 Ax=λx，我们使用指数 ex 求解线性常数系数方程式。

请尊重版权与译者的劳动成果，侵权必究！ 320

我们的单纯指数解是 e」乘一个固定向量 x，你可以猜测 λ 是 A 的特征值，以及 x 是特征向量。把 u（t）=e」x 代入方程式 du/dt=Au 来证明你是正确的。因子 e」会被消除得到 x=Ax:

当 Ax=λx

d=ae＂x

与 Au=Ae」x 一致

（3）

选择 u=e＂x

这个特殊解 u=e」x 的所有分量共享相同的 e」，当 2>0 解会成长；当 1<0，解会衰减。若 λ 是一个复数，它的实数部分决定成长或衰减，虚数部分 ω 产生震荡 eiwt，如同正弦波。

范例 1 求解 = Au=［］从 n（O）=［2］开始。

这是一个 μ 的向量方程式，它包含分量 y 与 z 的两个纯量方程式。因为矩阵 A 不是对角，他们「耦合」在一起：

a］＊-…－

特征向量的概念是以某种方法结合这些方程式，然后反推得到 1×1 的问题。组合 y+z 与 y-z 可以做到这件事情，把两个方程式既加又减：

（y+z）=z+y 与（y-z）=-（y-z）

组合 y+z 如同 e＇成长，因为它的 λ=1。组合 y-z 如同 e-＇衰减，因为它的 λ=-1。这是重点：我们没必要去评断原始方程式 du/dt=Au 寻找这些特殊组合，A 的特征向量与特征值会帮我们做好这件事情。

矩阵 A 的特征值是 1 与－1，特征向量 x 是（1，1）与（1，－1），纯指数解 u1 与 u2 具有 ex 的形式，其中 = 1 与 2=-1:

m.）=e2x1=|

与

）=e=¢＂［＇¦］

（4）

注意这些 u＇s 满足 Au1=u1 与 Au2=u2，就好像 x1 与 x2 一样。因子 e＇与 e 随时间变化，这些因子得到 du1/dt=u1=Au1 与 du2/dt=-u2=Au2，对于 du/dt =Au 我们有两个解。要求出其他所有的解，把常数 C 与 D 乘上这些特殊解然后相加：

完整解 ）-；De＂［-＇］-［Cé－ De

（5）

网址：linear.neocities.org 箱：876152660@qq.com 321

du/dt=Au 的解

常数 C 与 D 可以适配任何的初始向量 u（0）=（u1（0），u2（0），令 t=0 且 e0=1，范

例 1 要求初始值是 u（0）=（4，2）:

O 定 C 与 DH 得到 C-35D1

方程式（5）的 C=3 与 D=5 完全解答了初始值问题。

求解 uk+1=Auk 的相同三个步骤现在求解 du/dt=Au:

1. 把 u（0）写成 A 的特征向量的组合 C1x1+..+Cnxn。

2. 每个特征向量左乘它的成长因子 e。

3. 方程式的解与单纯解 ex 有相同的组合：

dr =Au

u（t）=c1e2x1+..+cne31xn

（6）

不包含：若两个 2＇s 相等，而且只有一个特征向量，我们还需要另外一个解（它会

是 te」x）。步骤 1 需要对角化 A=XAX1:n 个特征向量形成一组基底。

范例 2 求解 = Au，已知 A 的特征值 λ=1，2，3:

典型范例

u 的方程式

初始值 u（0）

：‖..

特征向量是 x1=（1，0，0）与 x2=（1，1，0）与 x3=（1，1，1）。

步骤 1. 向量 u（0）=（9，7，4）是 2x1+3x2+4x3，于是（C1，C2，C3）=（2，3，4）。步骤 2. 因子 e」产生指数解 e‘x1 与 e2＇x2 与 e3＇x3。

步骤 3. 从 u（0）出发的组合是 u（t）=2e2x1+3e2＇x2+4e3＇x3。

系数 2，3，4 来自求解线性方程式 C1x1+C2x2+C3x3=u（0）:

·就是 Xc=u（0）

（7）

你现在已经有了基本概念 — 如何求解 du/dt=Au。本段落剩下的内容更深入，

我们求解包含第二导数的方程式，他们在应用中经常出现。我们也要决定 u（t）趋

近零或是爆炸还是震荡。

最后探讨矩阵指数 e，短公式 e「u（0）解答了 du/dt=Au，如同 A＊uo 解答了 uk+1

=Auk 一般。范例 3 会展示「差分方程式」如何协助求解微分方程式。

请尊重版权与译者的劳动成果，侵权必究！ 322

这些步骤都用到了 λ＇s 与 x＇s，这个段落求解转成线性代数的常数系数问题，它阐述了最简单却最重要的微分方程式 — 解是完全基于成长因子 e」。

二阶方程式

力学最重要的方程式是 my＂+by＇+ky=0，第一项是质量 m 乘加速度 a=y＂，ma 项平衡了力 F（牛顿定律），这个力引入了阻尼（-by）以及正比位移的弹性力（-ky）。这是一个二阶方程式，因为它包含第二导数 y＂=d2y/dt2，它仍然是常数系数 m，b，k 的线性系统。

在微分方程式的课程中，求解的方法是把 y=e」代入，每个 y 的导数提出一个因子 A，我们希望 y=e」解答下列的方程式：

m2y+b+k=0 变成（m2+b2+k）=0

（8）

dt² dt

一切都与 mλ2+b+k=0 有关，这个 A 的方程式有两个根 λ1 与 λ2，则这个 y 的方程式有两个单纯解 y1=e2 与 y2=e22。除非 λ1=22，否则单纯解的组合 C1y1+C2y2 产生完整解。

线性代数课程中我们期待矩阵与特征值，因此我们把纯量方程式（包含 y＂）转换成一个包含 y 与 y＇的向量方程式：只有第一导数。假设质量 m=1，两个 u=（y， y）的方程式得到 dudt=Au

dy

= y

dt

转换成

dy＇

：北｝

（9）

dt = ー y-by

第一方程式 dy/dt=y＇是平凡方程式（成立的），第二方程式是联结 y＂与 y＇及 y 的方程式（8），也联结了 u＇与 u。所以我们使用 A 的特征值求解 u＇=Au:

A-= －λ1

有行列式 x2+b+k=0

－k －b-λ

A 的方程式与（8）相同！由于 m=1，方程式还是 2+bλ+k=0，方程式的根 21 与 λ2 现在是 A 的特征值，所以特征向量以及解是

u（t）的第一分量有 y=c1e21+c2e2 - 与前面的解相同，不可能是其他解。你看到的 u（t）的第二分量是速度 dy/dt，速度问题与纯量问题完全一致。2×2 矩阵 A 称为伴随矩阵 — 一个有 y＂的二阶方程式的伴随。

网址：linear.neocities.org 箱：876152660@qq.com 323

范例 3 环绕圆的运动方程式 y＂+y=0 与 y=cost。

这是我们的主方程式，其中 m=1 与刚度系数 k=1 与 d=0：没有阻尼。把 y=e」代入 y＂+y=0 得到 λ2+1=0，根是 λ=i 与－i，e＂+e「的一半得到解 y=cost。

作为一阶系统，初始值 y（0）=1，y＇（0）=0 进入 u（0）=（1，0）:

使用 y＂=-y

（10）

A 的特征值还是同样的 λ=i 与 λ=-i（没有讶异），A 是反对称矩阵且特征向量 x1=（1，i）与 x2=（1，-i），适配 u（0）=（1，0）的组合是（x1+x2）/2。步骤 2 把 e「与 e「分别乘 x＇s，步骤 3 组合单纯震荡函数进入 u（t），如预期般得到 y=cost:

「（）=e」［］+e」［］-［］就是［］

都很棒。这个向量 u=（cost，-sin t）环绕一个圆（图 6.3），因为 cos2t+sin2t=1，得到半径是 1。

差分方程式（选读）

要在屏幕上显示一个圆，利用差分方程式取代 y＂=-y。使用 Y（t+△t）-2Y（t）+Y（t-Δt）有三种选择，除以（Δt）2 来近似 y＂。

F 从 n-1 前向

（11F）

C 中心在时间 n

（11C）

B 从 n+1 反向

（11B）

图 6.3 显示 y（t）=cost 确实在 t=2π 完成一个圆。在一个时间步阶（time step）长度△t=2π/32 的情况下，这三种差分方法在 32 个时间步阶不能完成一个完美的圆。我们用特征值来说明这些图形：

前向 | 2|>1（螺旋往外）

中心 | 2|=1（最佳）

反向 | 2|<1（螺旋往内）

2 步方程式（11 简化成 1 - 步系统 Un+1=AUn，我们不用 u=（y，y），而是使用离散未知数 Un=（Yn，Zn）。从 U（0）开始，我们取 n 个时间步阶△t:

前向（11F）

变成 ==4 （12）

这些很像 Y=Z 与 Z＇=-Y，他们是与时间 n 与 n+1 有关的一阶方程式。消去 Z 会回复「前向」二阶方程式（11F）。

请尊重版权与译者的劳动成果，侵权必究！ 324

我的问题很简单，点（YmZn）会停留在圆 Y2+Z2=1 吗？不会，他们一直朝着如图 6.3 的无限大成长。我们取的是 A」而不是 e，所以我们测试的是大小 | 2 | 而不是特征值的实数部分。

A 的特征值 =1±△t

则 ||>1 且 （Yn2Zn）螺旋往外 Y32

t=2π

Z32

t=0 y

cost

－sin t

图 6.3：精确的 u=（cost，sin t）在一个圆上，前向欧拉螺旋往外（32 步）

（11B）的反向选择会做出如图 6.4 相反的结果，注意新的 A:

反向（11B）

Z，+1 =Z，-Δt Y，+1

（13）

这个矩阵有特征值 1±i△t，但是我们要反过来从 Un 得到 Un+1，则 ||<1 可以说明为什么反向差的解是螺旋往内到（0，0）。

在图 6.4 的右侧你看到中心选择的 32 步，如果 t<1，解维持与圆很接近的状态（问题 28），这是经常使用的「跳背法（leapfrog）」，第二差 YA+1-2Yn+YA-1 跳过（11）的中心值 Yn。

这是化学家掌握分子运动的方法（分子动力学导致巨大的计算），计算科学一直生气勃勃，这是因为一维方程式可以被许多差分方程式取代 — 有些不稳定，有些稳定，有些持平。问题 30 有第四种（非常好的）方法可以精确维持在圆上。

实际的工程与实际的物理都在处理系统（不止是在一个点的单一质量），未知的 y 是一个向量；y＂的系数是有 n 个物体的质量矩阵 M；y 的系数是一个刚度矩阵 K，而不是一个数字 k；y＇的系数是可能为零的阻尼矩阵。

向量方程式 My＂+Ky=f 是计算力学的重要部分，它是由 Kx=Mx 的 M1K 的特征值所控制。＃

网址：linear.neocities.org 箱：876152660@qq.com 325

Y32

Z32

图 6.4：反向差分螺旋往内，跳背维持与正确圆接近

2×2 矩阵的稳定

对于 duldt=Au 的解有一个基础问题，在 t→∞时这个解超近 = 0 吗？这个问题依靠消耗能量而稳定？包含 e 的解不稳定，系统的解与 A 的特征值有关。

u（t）的完整解来自单纯解 ex，如果特征值 λ 是实数，我们确切知道 e 什么时候超近零：数字必颁是数。如果特征值是复数 = r+i，实数部分 r 必颁是数。当 et 分成 erteist，因子 eist 的绝对值固定在 1:

eist=cosst+isin st 有 leist2=cos2st+sin2st=1

2 的实数部分控制成长（r>0）或是衰减（r<0）。

问题是：哪些矩阵有负的特征值？更准确的说，什么时候＇s 的实数部分全部是负数？2×2 矩阵允许一个清楚的答案。

稳定当所有的特征值 A 有负的实数部分，A 是稳定且 u（t）→0。

2 阵 4 - 必通过两个试

1+2<0

迹 T=a+d 必须负数

12>0

行列式 D=ad-bc 必须正数

理由若＇s 是实数且是负数，他们的总和是负数，这是迹 T。他们的乘积是正数，这是行列式 D。这个论点也可以反向说明，若 D=12 是正数，则与 2 有相同的符号。如果 T=λ1+λ2 是负数，符号就是负。我们可以测试 T 与 D。

如果＇s 是复数，他们必然有这样形式 r+is 与 r-is，否则 T 与 D 不会是实数。因为（r+is）（r-is）=r2+s2，行列式 D 自动是正数。迹 T 是 r+is+r-is=2r，所以负数的迹表示实数部分 r 是负数且矩阵是稳定，证明完毕。

请尊重版权与译者的劳动成果，侵权必究！ 326 图 6.5 湿示抛物线ア 2=4D 分隔复数＇s 与实数＇s，求解 x2-T+D=0 与平方根√T2-4D 有关，这是在抛物线下方的实数与抛物线上方的虚数。稳定区域是图形的左上四分之一－有负数的迹 T 与正数的行列式 D。

行列式 D

1=2 且 T2=4D

两个 Reλ<0 两个 Reλ>0

不稳定

［=

稳定

两个 1<0

稳定

andT2=4D

迹 T ］中性

D<0 表示 λ1<0 与 22>0：不稳定

图 6.5：当迹 <0 与 det>0，2×2 矩阵稳定（u（t）→0）矩阵的指数

我们想要把解 u（t）写成新的形式 e＃u（0），首先我们要说一个矩阵当做指数 e＃代表什么，要定义矩阵 e＃，我们复制数字的 ex。

ex 直接的定义是无限级数 1+x+x2+x3+..，当你把 x 变成矩阵 At，下列的级数定义矩阵指数 e:

矩阵指数 e

e-I+ar+（ai ary ..

（14）

它的 t 导数是 Ae＃

4+fi++

它的特征值是 e

）

（At）」除的数字是「n 阶层」，就是 n！=（1）（2）.（n-1）（n），在 1，2，6 之后是 4！=24 与 5！=120，他们成长很快速。这个级数 e 永远收敛且它的导数永远都是

Ae＃，因此 e＃u（0）利用一个快速公式解答了微分方程式－纵使没有用到特征向量。我会在范例 4 用到这个级数，看它在没有特征向量时怎么工作，它会产生 te。首先让我在良好（可对角化）情况下完成 XeNX-1。

网址：linear.neocities.org 箱：876152660@qq.com 327

本章强调如何利用对角化得到 u（t）=eu（0），假设 A 确实有 n 个无关的特征向量，所以它可以对角化。把 A=XAX1 代入 e4 的级数，只要发生 XAX1XAX1，中间的 XX 可以消除：

使用级数

=I+ x^x＇+（xx-）（xx-）t.

提出 X 与 X1

（15）

e「完成对角化

e4l= XeAx-l

e＃与 A 有相同的特征向量矩阵 X，A 是一个对角矩阵，et 也是对角，数字 e4 在对角线上，乘积 XeMX-1u（0）得到 u（t）:

（16）

解 eu（0）与方程式（6）的三步骤答案相同：

1.u（0）=c1x1+.+Cnxn=Xc，此处我们需要 n 个无关的特征向量。

2. 每个 x2 左乘成长因子 e，x2 追随成长因子随时间前进。

3.e4u（0）的最佳形式是 u（t）=c1e2x1++ Cnealsn

（17）

范例 4 当你把 e 代入 y＂-2y＇+y=0，你得到有重根的方程式 2-2λ+1=0，其中 = 1，1。微分方程式的课程会建议与 te 作为两个无关解，此处我们探讨为什么：

线性代数简化 y＂-2y＇+y=0 变成 u=（y，y＇）的向量方程式：

［］-［］是 = 4=［2］

（18）

A 有重根 λ=1，1（迹 = 2 与 detA=1），只有一个特征向量是 x=（1，1）的倍数，不可以对角化。A 只有一条特征向量直线，所以我们从定义计算 e 的级数：

短级数

eAt=e＂e（4-I）：=e＇［I+（A-I）］

（19）

e（4 - 的「无限级数」很快结束，这是因为（A-D）2 是零矩阵！你可以在方程式（19）看到 te＇。e4＇u（0）的第一分量就是我们的答案 y（t）:

｝=2（0-20+2

请尊重版权与译者的劳动成果，侵权必究！ 328

范例 5 使用无限级数求 A = 的 te。注意 A4=I:

A5，A6，A7，A8 是 A，A2，A3，A4 的重复。A 的次方矩阵的右上角单元一直是 1，0，－1，0 的重复方式，所以 e 的无限级数的右上单元从 t-t3/6 开始，左上单元从 1-t2/2 开始：

=1+41+（4）2+（40）+=］

矩阵 e＃的上方行显示了余弦与正弦的无限级数！

c

（20）

A 是反对称矩阵（AT=-A），它的指数 e 是一个正交矩阵，A 的特征值是 i 与－i，e＃的特征值是 e＃与 e「。三个规则：

1.e＃永远有逆矩阵 e~「。

2.e 的特征值永远有是 e。

3. 当 A 是反对称，e 是正交，逆矩阵 = 转置 = e。

Antisymmetric 与 skew-symmetric 相同，这些矩阵都有纯虚数的特征值，例如 i 与－i，则 e 有如同 e「与 e」的特征值，他们的绝对值是 1：中性稳定，纯震荡，能量守恒，所以 | u（t）|‖=‖u（0）|‖。

我们的最后一个范例是一个三角矩阵 A，则特征向量矩阵 X 也是三角形，X 也是，e 也是。你会看到解的两个形式：特征向量的组合以及短形式 e＇u（0）。范例 6-～值在 o

解特征值 1 与 2 在 A 的对角线上（因为 A 是三角形），特征向量是（1，0）与（1，1）。开始的 u（0）是 x1+x2 所以 C1=C2=1，则 u（t）是单纯指数（当 λ=1 与 2，没有 te）的相同组合：

u＇=Au 的解 （）=e［｝+e2H

这是最清楚的形式，但是矩阵形式的 e＃可以从任意的 u（0）得到 u（t）:

最后的矩阵是 e」，它很棒，因为 A 是三角形，这个情况与 Ax=b 与逆矩阵相同。我们不需要 A~` 求解 x，也不需要 e 求解 du/dt=Au，但是作为解答的快速公式，A-1b 与 e4u（0）是不可击败的。

网址：linear.neocities.org 箱：876152660@qq.com 329

主要观念的复习

1. 方程式 u＇=Au 是线性且 A 的系数是常数，从 u（0）开始。

2. 它的解通常是指数的组合，与每个 A 及 x 有关：

无关的特征向量

u（1）=ce2x1+..+cne2xn

3. 常数 c1… 由 u（O）=C1x1.+Cxn=Xc 决定。

4. 若每个 λ 都有负数实数部分，则 u（t）趋近零（稳定）：所有 e→0

5. 解有短形式 e＃u（0），其中 e＃是矩阵指数。

6. 把 y 与 y＇组合成向量 u，则 y＂的方程式简化成 u＇=Au。

已解范例

6.3A 把 e 代入 y＂+4y＇+3y=0 求解，也使用线性代数求解。

解把 y=e 代入，得到（2+41+3）e=0。分解二次式得到 λ2+4λ+3=（λ+1）（A+3）=0，因此 λ1=-1 与 2=-3，单纯解是 y1=e 与 y2=e-3，完整解 y=c1y1 +C2y2 趋近零。

使用线性代数，我们令 u=（y，y＇），则向量方程式是 u＇=Au:

成－n

这个 A 是伴随矩阵，它的特征值再次是－1 与－3:

同样的二次式

det（A-D）=|34-|=x2+4x+3=0

A 的特征向量是（1，A1）与（1，A2），y（t）的衰减不是来自 e - 就是来自 e-3＇。因为是常数系数，微积分变成线性代数 Ax=λx。

注解在线性代数中，严重的危险是特征向量的不足，如果 1=2，我们的特征向量（1，1）与（1，2）相同，我们无法对角化 A，这种情况下我们无法得到 du/dt=Au 的两个无关解。

在微分方程式中，危险也是重复的 λ。在 y=e 之后，还需要第二个解，它会变成 y=te。这个「不单纯」的解（有额外的 t）出现在矩阵指数 e＃中，范例 4 会展示如何出现。

请尊重版权与译者的劳动成果，侵权必究！ 330

6.3B 求出 A 的特征值与特征向量，把 u（0）=（0，2√2，0）写成特征向量的组合，求解两个方程式 u＇=Au 与 u＂=Au:

u＇=Au u/ot=ou/ox.

它的解 u（t）会衰减（A 有负数特征值）。

u＂ =Au：u/or=ou/ox.

它的解会震荡（λ 的平方根是虚数）。

解特征值与特征向量来自 det（A-AI）=0:

－2-λ

当－2-1=0，一个特征值是 A=-2。另一个因子是 12+41+2，所以其他的特征值（也是负数实数）是 λ=-2±√2。找出特征向量：

010

=-2

（+2-x ア = 000

x=-2-√2

000 得到 x2=

x=-2+√2

特征向量是正交（在段落 6.4 会证明所有对称矩阵都是这样），全部三个都是负数，这个 A 是负定（negative definite）且 e「衰减到零（稳定）。

起始值 u（0）=（0，2√2，0）是 x3-x2，解是 u（t）=e3x3-e2＇x2。

热方程式在图 6.6a，中心点的温度从 2√2 开始，热扩散至相邻的盒子然后到盒子外部（在 0° 冰冻），在盒子之间的热流率是温度差。从盒子 2，热流向左与右的流率是 u1-u2 与 u3-u2，所以流出是 Au 的第二行 u1-2u2+u3。

波方程式 d2u/d2=Au 有相同的特征向量 x，但是现在特征值 λ 产生震荡 etx 与 eatx，频率来自 2=-

（ex）A（ex）变成（o）2ex-xex 且 o2=-x

－A 有两个平方根，所以我们有 eitx 与 e-iwtx。三个特征向量得到 u＂=Au 的六个解，某个组合会适配 u（0）与 u（0）的六个分量。由于本问题的 u＇（0）=0，eitx 与 e-iwtx 得到 2cos atx。

【原文少了（0）】

网址：linear.neocities.org 箱：876152660@qq.com 331

t=0

t=0

1>0

0

1

2

3

4

0

1

2

3

4

t>0

图 6.6：热从盒子 2 往外扩散（左），波从盒子 2 传播（右）

6.3C 依据顺序求解 4 个方程式 da/dt=0，db/dt=a，dc/dt=2b，dz/dt=3c，从 u（0）=（a（0），b（0），c（0），z（0）出发。利用矩阵指数 u（t）=eu（0）求解同样的方程式。

4 个方程式

1 0 0 0

=0， 0， 0， 0

s

0200 OUN 是 dr-Aw

固有值在对角线

0 030

首先求出 A2，A3，A2 与 e4=1+At+（A2+（A1），为什么级数停止了？为什么（e）（e）=（e2）是正确的？e＊乘 e 永远是 e+

解 1 积分 da/dt=0 然后 db/dt=a 然后 dc/dt=2b 然后 dz/dt=3c:

a（t）=a（0）

4×4 矩阵乘

b（t）=ta（0）+b（0）

a（0），b（0），c（0），z（0）

c（t）=t2a（0）+2tb（0）+c（0）

产生 a（t），b（t），c（t），z（t）

z（t）=t3a（0）+3t2b（0）+3tc（0）+z（0）

必须是与下方相同的 e

解 2A 的次方（严格三角形）在 A3 以后都是零。

【上方原文 z 写成 d，错误】

0 0 0 0

0 0 0 0

1 0 0 0

A=

A2=

A=

A4=0

0 2 0 0

20 0 0

0 0 3 0

0600

6 0

每一个步骤对角线往下移，所以 e 的级数在 4 项后停止：

与解 1 相同的 e＃

15

e4 的平方是 e2，但是 ee 与 e5e 与 e+t 可以是完全不同。

请尊重版权与译者的劳动成果，侵权必究！ 332

问题集 6.3

1 求出两个＇s 与 x＇s 使得 ex 解答

｝

从 u（0）=（5，-2）出发，会有什么样的组合 u（t）=ce2x1+c2e2∵x2?

2 利用反向代入法，先 z 后 y 求解问题 1 的 u=（y，z）:

从 x0=2 求解－然后从 O5 求解－+

y 的解是 e「与 e＇的组合，λ＇s 是 4 与 1。

3（a）若 A 的每一列相加等于零，为什么 1=0 是一个特征值？

（b）负数对角线单元与正数非对角线单元相加等于零，u＇=Au 是「连续」的

马尔可夫方程式，求出特征值与特征向量，以及 t→∞的稳定状态。

从 0 求 w-2 为？

4 一扇门在两个房间之间开启，保持 v（0）=30 人与 w（0）=10 人。两个房间之间

的移动正比于 ν－w：=w-v 与 = v-w

证明总数 v+w 保持常数（40 人），求出 du/dt=Au 的矩阵以及它的特征值与特

征向量。在 t=1 与 t=∞时，ν 与 w 为何？

5 反转问题 4 的人潮扩散问题变成 du/dt=-Au:

=v-w 与 = w-v

总数 ν+w 仍然保持常数，现在 A 变成－A，2＇s 会如何变化？证明 v（t）从 v（0）=

30 成长至无限大。

6A 有实数特征值但是 B 有复数特征值：

（a 与 b 是实数）

求出 a 与 b 的条件使得在 t→∞时， duldt=Au 与 dvdt=B 全部的解都趁近

零：所有的特征值 Reλ<0。

网址：linear.neocities.org 箱：876152660@qq.com 333

7 假设 P 是在 R2 的 45° 直线 y=x 的投影矩阵，它的特征值为何？如果 du/dt=-Pu（注意号），你可以找出从 u（0）=（3，1）出发的 u（t）在 t→时的极限吗？

8 兔子的总数显示成长快速（来自 6r），但是被狼吃掉的损失（来自－2w）。狼的总数一直以这种模式成长（-w2 会控制狼）:

=-2 与－+w

求出特征值与特征向量。若 r（0）=w（0）=30，在时间 t 时，总数各是多少？在很长时间之后，兔子对狼的比值是多少？

9（a）把（4，0）写成 A 的两个特征向量的组合 C1x1+C2x2:

［°］］-［］［＇.］-［＇

（b）从（4，0）开始，du/dt=Au 的解是 u（t）=c1e「x1+c2e-「x2，代入 e＃=cost+

isint 与 e「=cost-isint，求出 u（t）。

问题 10-13 简化二阶方程式至（，y）的一阶系统。

10 求 A 使得纯量方程式 y＂=5y+4y 变成 u=（y，y）的向量方程式：

A 的特征值为何？也利用 y=eM 代入 y＂=5y＇+4y 求出特征值

11 y＂=0 的解是一条直线 y=C+Dt，转换成矩阵方程式：

矩阵 A 的 = 00 且不能对対角化。求出并计算。－1+A+4 + 执行 e＃乘（y（0），y＇（0），检验直线 y（t）=y（0）+y＇（0）t。

12 把 y=e 代入 y＂=6y＇-9y，证明 1=3 是重根。这是一个麻烦；在 e3＇之后我们需要第二个解。矩阵方程式是：

证明矩阵的 λ=3，3 且只有一条特征向量直线，也是一个麻烦。证明 y＂=6y＇-9y 的第二个解是 y=te3。

请尊重版权与译者的劳动成果，侵权必究！ 334

13（a）写下两个熟悉的函数可以求解 d2y/dt2=-9y，哪一个解是从 y（0）=3 与 y＇（0）=0 出发？

（b）二阶方程式 y＂=-9y 产生向量方程式 u＇=Au:

·÷

利用 A 的特征值与特征向量求出 u（t）:u（0）=（3，0）。

14 方程式中的矩阵是反对称（AT=-A）:

и1＇= cu2-bu3

＇=bu1-au2

（a）‖u（t）|12=u2+u2+u 的导数是 2u1u1＇+2u2u2＇+2u3u3＇，代入 u1＇，u2＇，u3＇得

到零，则 |‖u（t）‖2 维持与‖u（0）‖2 相等。

（b）当 A 是反对称矩阵，Q=e＃是正交。从 Q=e＃的级数证明 QT=e-A，

则 QQ=I。

15 若 A 可逆，则 du/dt=Au-b 的一个特定解是 u=A~1b。du/dt=Au 的一般解得到 un，求出完整解 u=up+un:

－4

（b） a-）＂-［＆

16 若 c 不是 A 的特征值，代入 u=edv，求出 du/dt=Au-edb 的一个特定解。当 c 是 A 的一个特征值，它是如何崩溃的？du/dt=Au 的「零空间」包含平常解 ex1。

17 求出矩阵 A 说明图 6.5 的每个不稳定区域：

（a）不 1<0 与 22>0（b）1>0 与 2>0

（c）λ=a±ib，a>0

问题 18-27 有关矩阵的指数 e「。

18 写出 e 的无限级数的前 5 项。对每一项取 t 的导数。说明你有 4 项的 Ae＃。结论：e＇u（0）可以解答 u＇=Au。

19 矩阵 B-- 有ー 0 从短无限级数求出。校验的导数是 BP

20 从 u（0）出发，在时间 T 的解是 e4Tu（0），再走额外的时间 t 得到 ee4Tu（0）。在时间 t+T 的解也可以写成

。结论：e 乘 eAT=_____

21 把 A6 写成 X 的形式，从 xx 求出

网址：linear.neocities.org 箱：876152660@qq.com 335

22 若 A2=A，证明无限级数 e=1+（2-1）A，当 A=［（问题 21），求 e。23 通常 e4e8≠e8e4，他们都与 e4+B 不同。利用问题 21-22 与 19，检验这个结果。（若 AB=BA，这三者都相同）。

－|-|4.8-|

24 把 A - 写成 X 执行 x 求出矩阵指数在时检与

e＃的导数。

25 把 A - 代入无限级数求，先计算然后

^-［＇］［］［］·－［］

26（推荐）给出两个理由，为什么矩阵指数 e「绝对不是奇异？

（a）写出逆矩阵。

（b）为什么特征值不是零？若 Ax=x 则 ex=x。

27 找出解 x（），y（）在 t→时解变得很大。为了避免不稳定，科学家交换两个方程式：

变成

dy1dt=-2x+2y

dx/dt=0x-4y

现在矩变成］是稳定它的特征值是数这是怎么做到的？

挑战问题

28 范例 3 的中心化 y＂=-y 会产生 Yn+1-2Yn+Yn-1=-（At）2Yn，这个可以改写成

1 - 步差分方程式 U=（Y，Z）:

逆反左侧的矩阵写成 Un+1=AUn，证明 detA=1。选择大的时间步阶△t=1，找出 A 的特征值 λ1 与 λ2=:

4- 1l-IAl=1，

在 6 步之后的 t=6，U6=U0。在 t=2π，确切的 y=cost 回到 1。

请尊重版权与译者的劳动成果，侵权必究！ 336

29 问题 28 的中心选择（跳背方法）对于小的时间步阶非常有用，对于△t=√2 与 2 求特征值：

两个矩阵都有 | 2|=1。两个情况下计算 A4 然后找出 A 的特征向量。第二个△t=2 落在不稳定的边境，任何时间步阶△t>2 导致 | 2|>1，所以 Un=A」U0 的次方会爆炸。

注解你可能说没有人会在 Δt>2 时计算，但是如果一个原子的震荡是 y＂=-1000000y，则△t>.0002 会导致不稳定。跳背有个非常严格的稳定极限，Yn+1=Yn+3Zn 与 Zn+1=Zn-3Yn+1 会爆炸的原因是△t=3 太大，这个矩阵有 | 2|>1。30 另一个关于 y＂=-y 的好概念是梯形方法（半前向 / 半反向），这个可能是确切维持（Yn，Z，）在一个圆上的最佳方法。

梯形

（a）逆反左侧的矩阵，把方程式写成 Un+1=AUn，证明 A 是一个正交矩阵：ATA=I。这些点 Un 不会离开这个圆。若 BT=-B，则 A=（I-B）1（I+B）永远是正交矩阵。

（b）（选读 MATLAB）从 U0=（1，0）取 32 个时间步阶到 U32，其中△t=2π32。U32 等于 U0 吗？我想会有一个小误差。

31 矩阵的余弦的定义如同 e4，利用复制 cost 的级数：

cosA=1=A2+4

（a）若 Ax=λx，每项乘 x 求 cosA 的特征值。

（c）cos（At）的二次导数是－A2cos（At）。

u0 - 的解从 0=0 开始

利用针对特定 A 的三步骤，创建 u（t）=cos（At）u（0）:

1. 扩展成特征向量组合 u（0）=（4，2）=C1x1+C2x2。

2. 使用与左乘这些特征向量（不用 e）。

3. 把解相加得到 u（t）=C1x1+C2x2。

网址：linear.neocities.org 箱：876152660@qq.com 337

32 下列三个都是 e4 的平方等于 e24 的证明，选择其中一个说明。

1. 从 t=0 到 1 然后 1 到 2 求解 e4，结果与从 0 到 2 的 e24 相同。

2. 级数的平方（1+A+A2+…）适配 1+2A+（24+=2A。

3. 若 A 可以对角化，则（Xe^X1）（Xe^X1）=Xe2^X1。

微分方程式课程的注解

常数系数线性方程式当然最容易求解，本书的段落 6.3 介绍了微分方程式课程的

一部分，但是还有更多：

1. 二阶方程式 mu＂+bu＇+ku=0 在应用上非常重要。解 u=e」的指数 λ 是 mλ2+

bA+k=0 的解，阻尼系数非常重要：

欠（ （under）阻尼 b2<4bk 临界（ critical 阻尼 b2=4bk 过（over）阻尼 b2>4bk 这个决定了 1 与 2 是实数根，或重根，或复数根。如果 A＇s 是复数，解 u（t）会

边震荡边衰减。

2. 我们的方程式没有外力项 f），我们是在找「零空间的解」。除了 un（t）之外，我们需要加上一个平衡外力 / 的特定解 u（）:

在时间 s 输入 f（s）

成长因子 eA（t-s）

upar = edl（-s）f（s）ds

累加得到时间 t 的输出

我们也可以使用拉普拉斯转换得到并研读这个解－- 这是著名的从线性微分方程式转换成线性代数的方法。

在实际应用上，非线性微分方程式采用数值方法求解。有一个标准而且精确

的方法是「Runge-Kutta」— 以发现者命名。分析可以发现 du/dt =f（u）的常数

解，这些是 u（t）=Y 且 f（Y）=0 及 du/dt=0 的解：没有移动。我们也可以了解

靠近 u=Y 是稳定或不稳定。远离 Y，让电脑接管。

这项基础课程是我的「微分方程式与线性代数」教科书（伴随这本）的一个主题： math.mit.edu/dela. 请尊重版权与译者的劳动成果，侵权必究！ 338

6.4 对称矩阵

1 一个对称矩阵 S 有 n 个实数特征值与 n 个正交单位特征向量 q…n

2 每一个实数对称 S 可以被对角化：S=QAQ1=QAQT。

3S 的正数特征值的个数与正数主元的个数相等。

4 反对称矩阵 A=-A 有虚数 s 与正交单位（复数）q＇s

5 段落 9.2 说明为什么 S=ST 的测试，在复数矩阵时变成 S=5T。

s - 有实数 －- 有 λ=i，-i。

不夸张的说对称矩阵 S 是世界上能看到的最重要的矩阵－在线性代数原理

也在实际的应用。我们马上提出对称的关键问题，不只是问题，也是两部分的答

案。当 S 是对称，Sx=2x 有什么特殊？

当 S=ST，我们寻找特征值 A 与特征向量 x 的特殊性质，对角化 S=XAX-1 会

反映 S 的对称性。我们从转置 ST=（X1）TAXT 获得一些提示，因为 S=ST 所以这

些是相同的，第一形式的 X-1 可能等于第二形式的 XT 吗？这样就会有 XTX=I。

当 S=ST，这会使得 X 的每个特征向量与其他特征向量垂直。下列是关键事实：

1. 对称矩阵只有实数特征值。

2. 特征向量可以选成正交单位。

这 n 个正交单位特征向量 x1 进入 X 的列，每个对称矩阵都可以对角化，它

的特征向量矩阵 X 变成正交矩阵 Q。正交矩阵有 Q1=QT-- 我们怀疑的特征向量

矩阵的性质是正确的。要记忆它，当我们「选择」正交单位特征向量时，我们不

写 X 而是写成 Q。

为什么我们要用「选择」这个词？因为特征向量不需要是单位向量，他们的

长度随我们处理，我们会选择单位向量－长度 1 的特征向量，不只是正交还是正

交单位，则 A=XAX-1 是自己的独特形式，S=QAQT 则是关于对称矩阵的特定

形式。

网址：linear.neocities.org 箱：876152660@qq.com 339

（光谱定理）每个对称矩阵的分解是 S=QAQT，且在 A 中有实数特征值，在 Q 的列中有正交单位特征向量：

S=ONO=QAO ， H.1=O

（1）

很容易看出 QAQT 是对称，取转置，你得到（QT）TATQT，再次是 QAQT。比较困难的部分是证明每一个对称矩阵都有实数＇s 与正交单位 x＇s，这就是数学的「光谱（spectral）定理」以及几何学与物理学的「主轴（principal axis）定理」。我们必须证明它，没有选择！我会用三个步骤来阐述这个证明：

1. 找一个例子，显示在 A 中的实数 λ＇s 以及在 Q 中的正交单位 x。

2. 当特征值没有重复时，证明这些事实。

3. 证明允许有重复的特征值（在本段落的结束）。

范例 1 当 S=［与 S-A=22，求 2s 与 xs

解 S-AI 的行列式是 λ2-5A，特征值是 0 与 5（都是实数）。我们可以直接看出：2=0 是一个特征值，因为 S 是奇异，以及 1=5 适配 S 对角线的迹：0+5 与 1+4 一致。

两个特征向量是（2，－1）与（1，2）-- 正交但还不是正交单位。λ=0 对应的特征向量在 A 的零空间中，1=5 对应的特征向量在列空间中。我们问问自己，为什么零空间与列空间垂直？基础定理告诉我们零空间与行空间垂直－而不是列空间，但是我们的矩阵是对称！它的行空间与列空间相同，它的特征向量（2，－1）与（1，2）必须（也的确是）垂直。

这些特征向量的长度是√5，把他们除以√5 得到单位向量。把这些单位特征向量放进 Q 的列，则 Q-1SQ 是 A 而且 Q-1=QT。

现在讨论 n×n 的情形，当 S=ST 且 Sx=λx，λ＇s 是实数。

实数特征值一个实数对称矩阵的所有特征值都是实数。

证明假设 Sx=x，直到我们确认之前，可能是一个复数 a+ib（a 与 b 实数）， 它的共轭（conjugate）是 λ=a-ib。相似的，x 的分量也可能是复数，把虚数部分反转符号得到 x。

请尊重版权与译者的劳动成果，侵权必究！ 340

好消息是 λ 乘 x 永远是 1 乘 x 的共轭，所以我们可以取 Sx=x 的共轭，记得 S 是实数：

Sx=Ax 导致 Sx = 转置得到 xTS=xT

现在取第一方程式与 x 的点积，以及最后方程式与 x 的点积：

xTSx=xTλx 以及 xTSx=xTx

（2）

左侧相同所以右侧相等，一个方程式有 A，另一个有。xTx=|x1|2+|x2|2+..= 长度平方且不是零，因此 λ 必须等于 λ，且 a+ib=a-ib，所以 b=0 且 λ=a = 实数，证明完毕。

特征向量来自求解实数方程式（S-）x=0，所以 x＇s 也是实数，重要的事实是他们互相垂直。

正交特征向量一个实数对称矩阵的特征向量（对应不同的 s）永远垂直。

证明假设 Sx=h1x 与 Sy=λ2y，我们假设此处的 λ1≠λ2。取第一方程式与 y 的点积，以及第二式与 x 的点积：

利用 S=ST（4x）Ty=（Sx）Ty=xTSy=xTh2y

（3）

左侧是 xTλ1y，右侧是 xTλ2y，由于 λ1≠λ2，证明了 xTy=0，特征向量 x（对应 λ1）与特征向量 y（对应 λ2）垂直。

范例 2 一个 2×2 对称矩阵的特征向量有一个特殊形式：

不是广为人知 S=［］有 x1=［］与 x2=［］

（4）

这个在问题集里面。重点是 x1 与 x2 垂直：

x1x2=b（2-c）+（21-a）b=b（h1+2-a-c）=0

因为 λ1+λ2 等于迹 a+c，所以上式是零，于是 x1x2=0。鹰眼可能会注意到特殊情形 S=I，此时 b 与 λ1-a 与 λ2-c 与 x1 与 x2 都是零，λ1=λ2=1 是重复。但是当然 S=I 有垂直的特征向量。

对称矩阵 S 有正交特征向量矩阵 Q，再次检视：

对称 S=XAX1 变成 S=QAQT 且 QTQ=I

表示每一个 2×2 对称矩阵是（旋转）（拉伸）（反旋转）：

（5）

列 1 与 2 乘行 1g1 与 2g2 得到 S=911+24242

网址：linear.neocities.org 邮箱：876152660@qq.com 341

每个对称矩阵

S=OAo！ =Agigi +Angn aT.

（6）

记住这些伟大结果的步骤（光谱定理）。

段落 6.2 写成 Ax1=x1 的矩阵形式

AX=AX 或 A=XAX1

段落 6.4 正交单位 x1=q 得到 X=QS=QAQ1=QAQT

方程式（6）的 QAQT 有 QA 的列乘 QT 的行，下列是直接的证明。

S 有正确的固有向量

Sqi=（219191T+..+2n9n qnT）qi=2qi

（7）

这些 q＇s 是正交

实数矩阵的复数特征值

任意实数矩阵有 Sx=x 得到 Sx=，如果是对称矩阵，λ 与 x 变成实数，这两个方程式变成相同。但是非对称矩阵很容易有复数的 λ 与 x，则 Ax=x 成立但是与 Ax=λx 就不相同。我们得到另一个复数特征值（就是 λ）以及一个新的特征向量 （就是 x）：实数矩阵的复数 λ＇s 与 x＇s 都是「共轭配对」一起出现。

A=a+ib

若 Ax=1x 则 Ax=x

（8）

A=a-ib

范例 3

这些特征值是彼此的共轭，他们是 1 与。特征向量必须是 x 与 x，因为 A 是实数：这是 λx

（9）

这是衣

因为 A 是实数，这些特征向量（1，－i）与（1，i）是共轭复数。

这个旋转矩阵的特征值的绝对值 | 2|=1，因为 = cos20+sin20=1。每一个正交矩阵 Ω 的特征值都有这个事实 ||=1。

我们很抱歉不小心插进来复数，纵使矩阵是实数也无法避免。第九章会超越复数与复数 x 来到复数矩阵，到时候你就可以一窺全貌。

我们以两个选读的讨论作为结束。

请尊重版权与译者的劳动成果，侵权必究！ 342

特征值对比主元

矩阵 A 的特征值与主元非常不同，我们求解 det（A-2）=0 得到特征值，我们使

用消元法得到主元，到目前为止唯一的关联是：

主元的乘积 = 行列式 = 特征值的乘积

我们假设一整组主元 d1，.，dn，还有 n 个实数特征值 λ1，.，n，这些 d＇s 与 λ＇s 不同，

但是他们来自相同的对称矩阵。这些 d＇s 与 λ＇s 有隐藏的关联，对称矩阵的主元与

特征值有相同的符号：

S=ST 的正数特征值的个数等于正数主元的个数。

特殊情形：S 所有的 2>0 当且仅当所有的主元是正数。

这个特殊情形是段落 6.5 的「正定矩阵（positive definite）」的最重要事实。范例 4 下列对称矩阵有一个正数特征值与一个正数主元：

适配符号

s

主元 1 与－8

特征值 4 与－2

主元的符号与特征值的符号是适配的，一个正与一个负。如果矩阵不对称，这个

结论可能是错的：

相反符号

主元 1 与 2

特征值－1 与－2

对角线单元是第三组数字，只是我们没有什么可以说的。

当 S=ST 时，下列是主元与特征值适配符号的证明。

当主元从 U 的行用除法提出来是最佳视觉，则 S=LDLT。对角主元矩阵 D 在三

角矩阵 L 与 LT 中间：

B］［＇-］［° 这是 S=LDLT，它是对称

当 L 变成 I，观察 LDLT 的特征值，此时 S 变成 D

LDLT 的特征值是 4 与－2，IDI 的特征值是 1 与－8（主元！），当 L 里面的「3」移

动到 0，特征值改变了。但是要改变符号，实数的特征值必须跨越零，在这个时

候矩阵是奇异的。我们的变化矩阵永远有主元 1 与－8，所以它不会是奇异，当 2＇s

移动到 d＇s，符号不可能改变。

我们针对任意的 S=LDLT 重复证明。借由非对角线单元移动到零，我们把 L

朝着 I 移动，主元没有改变且不是零，LDLT 的特征值 A 变成 IDIT 的特征值 d。由

于特征值在移动到主元的过程中不能跨越零，他们的符号没有改变，2＇s 与 d＇s 的

符号相同。

这个结论把应用线性代数的两个半边联结在一起 — 主元与特征值。

网址：linear.neocities.org 箱：876152660@qq.com 343

所有对称矩阵可对角化

当 A 没有重复的特征值，特征向量确定是无关，则 A 可以对角化。但是重复的特

征值使得特征向量不足，有时候会发生在非对称矩阵。但是对称矩阵一定不会，

永远有足够的特征向量对角化 S=ST。

这是证明的一个概念，利用对角矩阵 diag（c，2c，.，nc）稍微改变 S，如果 c 很

小，新的对称矩阵没有重复的特征值，我们知道它有一整组的正交单位特征向量。

当 c→0，我们得到原始矩阵 S 的 n 个正交单位特征向量 — 纵使 S 的某些特征值

是重复的。

每个数学家都知道这样的论点是不完全的，我们如何确保小的对角矩阵会分

隔特征值？（我确信这是真的。）

有一个不同的证明来自一种有效的分解法，可以应用到所有的方形矩阵 A，

不论对称与否。当 S 是任意实数对称矩阵，这个新的的分解很快的得到 S=QAQT，

而且有一整组的实数正交单位特征向量。

每个方形 A 分解成 QTQ，其中 T 是上三角且 Q=Q。如果 A 有实数特征值，则 Q 与 T 可以选成实数：QTQ=I。这是舒尔定理，它的证明在网址 math.mit.edu/linearalgebra。此处我会证明当 S 对称时，T 如何成为对角（T=A），则 S 是 QAQT。

我知道每个对称 S 有实数特征值，而且舒尔允许重复的＇s：舒尔的 S=QTQ1 表示 T=QTSQ，转置之后还是 QTSQ。当 ST=S，三角 T 是对称，则 T 必须是对角矩阵且 T=Λ。这个证明了 S=QAQ，对称 S 有 n 个在 Q 中的正交单位特征向量。

注解我在本书段落 7.2 加了另一个证明，这个证明说明如何同时描述特征值 1。

最大的 1 是 xSx/x①x，如果我们只允许与第一个特征向量垂直的向量 x，则 λ2（第

二大）还是这个相同的极大值。第三个 A3 来自 xTq1=0 与 xTq2=0.

这个证明在第七章，这是因为相同的「同时」概念也可以应用在任意矩阵 A

的奇异值（singular value）。奇异值来自 ATA 与 AAT。

主要观念的复习

1. 每个对称矩阵 S 有实数特征值与垂直特征向量。

2. 对角化变成 S=QAQT，Q 是正交特征向量矩阵。

3. 所有的对称矩阵都可以对角化，纵使是重复的特征值。4. 当 S=ST，特征值的符号适配主元的符号。

5. 借由 A=QTQ`，每个方形矩阵可以「三角化」。若 A=S 则 T=Λ。

请尊重版权与译者的劳动成果，侵权必究！ 344

已解范例

6.4A 什么矩阵 A 有特征值 λ=1 与－1 以及特征向量 x1=（cos0，sinθ）与 x2=（-sin0，cosθ）? 哪些性质可以事先预测？

A=AT A²=A

det A=-1

主元是 + 与－

A¯`=A

解所有的性质都可以预测！实数特征值 1，－1 以及正交单位的 x1 与 x2，矩阵 A=QTQT 必须是对称。特征值 1 与－1 告诉我们 A2=I（因为 22=1）与 A1=A（相同意思），以及 detA=-1。两个主元必须跟特征值一样是一正一负，因为 A 对称。

矩阵是镜射矩阵，在 x1 方向的向量被 A 乘时保持不变（因为 λ=1），在垂直方向的向量被反向（因为 λ=-1）。镜射矩阵 A=QAQT 横跨「0 - 线」，用 c 代替 cosθ 与 s 代替 sinθ：

注意 x=（1，0）得到在 20 - 线的 Ax=（cos 20，sin 20），而且（cos 20， sin 20）横跨 0 - 线回到 x=（1，0）。

6.4B 求出 A3 与 B4 的有特征值与特征向量（离散正弦与余弦）：

1-1

两个矩阵的－1，2，－1 模式是「第二差分」，很像第二导数。Ax=Ax 与 Bx=Ax 很像 d2x/dt2=λx，会有特征向量 x=sin kt 与 x=cos kt，这些是傅里叶级数的基底。

An 与 Bn 得到「离散正弦」与「离散余弦」，这些是离散傅里叶转换的基底。DFT 绝对是数字信号处理各个领域的中心，图像处理中最受欢迎的选择 JPEG 就是大小 n=8 的 B8。

解 A3 的特征值是 A=2-√2 与 2 与 2+√2（见 6.3B），他们的总和是 6（A3 的迹），他们的乘积是 4（行列式）。特征向量矩阵得到「离散正弦转换」，而且这些特征向量落在正弦波上：

正弦矩阵 = A3 的特征向量

余弦矩阵 = B4 的特征向量

B4 的特征值是 A=2-√2 与 2 与 2+√2 与 0（与 A3 相同，加一个零特征值），迹还是 6，但是行列式现在是零。特征向量矩阵得到 4 点的「离散余弦转换」，网络上展示前两个特征向量如何落在余弦波上。（B 的所有特征向量都是。）这些特征向量适配在半途点 π18，3π18，5π18，7π18 的余弦。

网址：linear.neocities.org 箱：876152660@qq.com 345

问题集 6.4

1 哪些 ASB 矩阵是对称且特征值是 1 与－1?

］＇-］［¦］［＇］［¦［¯］＇-］［］ B=AT 做不到。B=A-1 做不到。B=___=____会成功，所以 B 必须是一个

矩阵。

2 假设 S=ST，什么时候 ASB 也是对称且与 S 有相同的特征值？

（a）转置 ASB 并检视当 B=

时，它维持对称。

（b）当 B=

时，ASB 与 S 相似（相同特征值）。

把（a）与（b）放在一起，与 S 相似的对称矩阵看起来好像（__）S（__）。

3 把 A 写成 S+N，对称矩阵 S 加反对称矩阵 N:

1 － ལ ང

对于任意方形矩阵，S=（A+AT）/2 与 N=

，两者相加等于 A。

4 若 C 对称，证明 ATCA 也是对称。（取转置）当 A 是 6×3，C 与 ATCA 的形状为何？

5 求出特征值与单位特征向量:

6 求出个可角化 s9 的正交阵什么？

7 求出一个可以对角化下列对称矩阵的正交矩阵 Q:

8 出所有对角化 58

9 间找出～个有征值的阵｛

（b）你怎么知道它一定有一个负数主元？

（c）你怎么知道它不能有两个负数主元？

请尊重版权与译者的劳动成果，侵权必究！ 346

10 若 A3=0 则 A 的特征值必须是。给出一个例子且 A≠0。但是如果 A 是

对称，把它对角化，证明 A 必须是个零矩阵。

11 若 λ=a+ib 是实数矩阵 A 的特征值。则它的共轭 λ 也是一个特征值。（若 Ax=

Ax 则 Ax=x；共轭对与 λ）。说明为什么每个 3×3 矩阵最少有一个实数特征值。

12 此处是一个关于每个实数矩阵的特征值都是实数的快速「证明」：

错误的证明 Ax=x 得到 xTAx=AxTx 所以 λ=

实数

xTx 实数

找出这项推理的错误 — 有一个隐藏的假设没有被证实。你可以在 90° 旋转矩

阵［0-1；10］测试这些步骤，其中旋转矩阵的 1=i 与 x=（i，1）。

13 把 S 与 B 写成光谱定理 QAQT 的 A1x1x1T+2x2x2T 的形式。

（保持 | x1|‖=|x2|=1）。

14 每个 2×2 对称矩阵是 21x1x1T+2x2x2T=1P1+2P2，说明 P1+P2=x1x1T+x2x21

=I，这是 Q 的列乘行。为什么 P1P2=0?

15 A- ［-］

的特征值为何？创建一个 4×4 反对称矩阵（AT=-A），并验证它所

有的特征值都是虚数。

16（推荐）下列矩阵 M 是反对称，也是，则所有的特征值是纯虚数，而且

有 | 2|=1。（对于每个 x 有 |‖Mx‖=|‖x|，所以对特征向量有 |‖λx‖=|x|‖。）从 M

的迹求出全部 4 个特征值：

011

只能有特征值 i 与－i

17 证明 A（对称但是复数）只有一条特征向量直线：

甚至是不可对角化：特征值 1=0，0

对于复数矩阵而言，AT=A 不是什么特殊性质，好的性质是 AT=A（段落 9.2），

则所有的 2＇s 是实数且特征向量是正交。

18 纵使 A 是矩形，方块矩阵 S =

是对称：

Sx=x 是

就是 Az=1y

ATy=Az

网址:linear.neocities.org 箱：876152660@qq.com 347

（a）证明－1 也是特征值，对应特征向量（y，-z）。

（b）证明 AAz=λ2z，所以 A2 是 ATA 的特征值。

（c）若 A=I（2×2），求出 S 的 4 个特征值与特征向量。

19 若问题 18 的 A=，求出 S 的所有特征值与特征向量。

20 当 S=ST，特征向量互相垂直的另一个证明，两个步骤：

1. 假设 Sx=Ax 与 Sy=0y 且 λ≠0，则 y 在零空间中且 x 在列空间中，因为，所以互相垂直。仔细研究 — 为什么这些子空间正交？

2. 若 Sy=By，应用前面的论点至 S-βI，S-βI 的一个特征值会移到零，特征向量 x，y 保持不变－所以他们互相垂直。

21 找出 S 的特征向量矩阵 Q，与 B 的特征向量矩阵 X。证明纵使 1=1 重复，在 d=1 时，X 不会崩溃。这些特征向量互相垂直吗？

0 d 0

－d 0

有 = 1，d，-d

001

）0a

22 写成一个 2×2 复数矩阵使得 ST=S（「厄米矩阵」），求出你的矩阵的 A1 与 2。检查 xTx2=0（这是复数正交性。）

23 是（说明理由）非（举出例子）题。

（a）有实数特征值以及 n 个特征向量的矩阵是对称。

（b）有实数特征值以及 n 个正交单位特征向量的矩阵是对称。

（c）可逆对称矩阵的逆矩阵是对称。

（d）对称矩阵的特征向量矩阵是对称。

24（讲师的悖论）若 AAT=ATA，则 A 与 AT 共享相同的特征向量（正确），A 与 AT 共享相同的特征值。找出这项结论的错误：A 与 A 必须有相同的 X 与相同的 A，因此 A 等于 AT。

25（推荐）A 与 B 属于：可逆，正交，投影，排列，可对角化，马尔可夫矩阵？A 与 B 可能的分解是：LU，QR，XAX1，QAQT?

26 矩阵 A=

中什么样的 b 使得 A=QAQT 是可能？什么数字使得 A 不能对角化？什么数字使得 A 奇异？

请尊重版权与译者的劳动成果，侵权必究！ 348

27 找出所有正交且对称的 2×2 矩阵。哪两个数字可以是这两个矩阵的特征值？

28 这个 A 是近似对称，但是它的特征向量远离正交：

4-［+］有固有向量［］与［2］

特征向量的夹角是多少？

29MA）选取两个有不同特征向量的对称矩阵例如－2 与 B

画出特征值 λ1（A+tB）与 λ2（A+tB）的图形，其中－8<t<8。PeterLax 在线性代数 113 页说在某个时间 t，1 与 2 会出现可能的碰撞，「在最后一分钟他们会偏离。」λ1 与 λ2 会有多么接近？

挑战问题

30 对于复数矩阵，对称性 S=ST 得到实数特征值，在段落 9.2 必须改成 ST=S。从 det（S-2）=0，找出 2×2 的厄米矩阵 S=［42+i；2-i0］=ST 的特征值.

31 正态矩阵有 NTN=NNT。对实数矩阵来说，这是 NTN=NNT，正态包含对称，反对称与正交（实数，虚数 x，与 = 1），其他正态矩阵可以有任意的复数特征值。

关键点：正态矩阵有 n 个正交单位特征向量，这些向量 x2 可能有复数分量。在复数情况下（第九章），正交性表示 xTx1=0，内积（点积）xy 变成 xy。Q 的 n 个正交单位列的测试变成 QTQ=I，而不是 QTQ=I。

N 有 n 个正交单位特征向量（N=QAOT）当且仅当 N 是正态。

（a）从 N=QAOT 开始，且 QTQ=I，证明 NTN=NNT:N 是正态。

（b）现在从 NTN=NNT 开始，舒尔发现对每个矩阵 A，A=QTQT，其中 T 是三角形。对于正态矩阵 A=N，我们必须证明（三个步骤）三角形矩阵 T 实际上是对角矩阵，则 T=Λ。

步骤 1. 把 N=QAQT 放进 NTN=NNT 找出 TTT=TTT。

步骤 2. 假设 T=

有 TTT=TTT，证明 b=0。

步骤 3. 延伸步骤 2 到大小为 n，任意正态三角 T 必须是对角矩阵。

网址：linear.neocities.org 箱：876152660@qq.com 349

32 若 2max 是对称矩阵 S 的最大特征值，没有对角单元比 2max 大。S=QAQT 的第一个单元 a11 为何？说明为什么 a11≤λmax?

33 假设 AT=-A（实数反对称矩阵），说明 A 的这些事实：

（a）对于每个实数向量 x，都有 xTAx=0。

（b）A 的特征值是纯虚数。

（c）A 的行列式是正或零（非负）。

对（a），实际计算一个 xAx，观察项的消除，或是逆反 xT（Ax）变成－（Ax）Tx。对（b），Az=Az 得到 zTAz=zTz=1|z|2。（a）显示 zTAz=（x-iy）TA（x+iy）T 有零的实数部分，则（b）可以帮助（c）。

34 若 S 是对称且所有的特征值是 1=2，你如何知道 S 必定是 2I? 关键点：对称确保 S=QAQT，A 为何？

35 哪些对称矩阵 S 也是正交？则 ST=S1。

（a）说明对称与正交得到 S2=I。

（b）S 可能的特征值为何？

（c）矩阵 A 可能的特征值为何？对于这些 A 与任意正交 Q，S 必须是 QAQT。

36 若 S 是对称，证明 ATSA 也是对称（取 ATSA 的转置）。此处的 A 是 m×n 且 S 是 m×m，S 的特征值 = ATSA 的特征值吗？

如果 A 是方形可逆，ATSA 称为「全等于（congruent to）」S。他们有相同的正特征值的个数，负特征值的个数与零特征值的个数：惯性法则（law of inertia）。

37 有一个方法证明 a 在 S 的特征值 A1 与 λ2 之间：

det （S-λI）=2²－aλ－cλ+ac-b²

是开口朝上的抛物线（因为 2）

证明在 1=a 时，det（S-AI）是负数，所以抛物线在 λ=a 的左侧与右侧跨越轴，跨越点是 S 的两个特征值，所以他们必须包住 a。

A 的个低远落在［的征值之间

请尊重版权与译者的劳动成果，侵权必究！ 350

6.5 正定矩阵

1 对称 S：所有特征值 > 0 所有主元 > 0 所有的左上行列式 > 0。2 矩阵 S 是正定（positive definite），能量测试是对所有的 x≠0 都有 xTSx>0。3 正定的另一个测试：S=ATA，且 A 有无关的列。

4 正半定 S 允许 = 0，主元 = 0，行列式 = 0，能量 xTSx=0。

5 当 S 是对称正定，方程式 xTSx=1 得到 R」的一个椭圆。

本段落聚焦在具有正数特征值的对称矩阵，如果对称性使得矩阵重要，这个额外的性质（全部 > 0）使得矩阵更特殊。我们说特殊并不代表稀有，有正数特征值的对称矩阵是所有应用的中心，他们称为正定。

第一个问题是确认正定矩阵，你可以说就是找出所有的特征值然后测试 1>0，这正是我们想要避免的。计算特征值很费劲，当我们需要 2＇s 时我们可以计算他们，但是如果我们只是想要知道全部的 2s 是正数，有很多快速的方法。下列是本段落的两个目标：

·找出对于对称矩阵确保正数更重要的快速测试法。

·说明正定性的重要应用。

因为矩阵是对称，每个特征值都是实数。

从 2 开什么时 g 有在 > 0 且 0

测试：S 的特征值是正数当且仅当 a>0 且 ac-b2>0。

不是正定，因为 ac-b2=1-4<0。

是正定，因为 a=1 且 ac-b2=6-4<0。

不是正定（纵使 detA=+2），因为 a=-1。

S1 的特征值 3 与－1 确认 S1 不是正定，正数迹 3-1=2，但是负数行列式（3）（-1）=-3。S3=-S2 是负定，S2 有两个正数特征值，S3 有两个负数特征值。

当 A1>0 且 2>0，证明可以通过 2×2 的测试。他们的乘积 12 是行列式所以 ac-b2>0，他们的总和 λ1+λ2 是迹，所以 a+c>0。

网址：linear.neocities.org 箱：876152660@qq.com 351

则 a 与 c 同时是正数（若 a 或 c 不是正数，ac-b2>0 会失败）。问题 1 逆反推理证

明 a>0 与 ac>b2 的测试，可以确保 A1>0 且 2>0。

这项测试使用了 1×1 行列式 a 与 2×2 行列式 ac-b2，当 S 是 3×3，detS>0 是

测试的第三部分。

测试：S 的特征值是正数当且仅当主元是正数:

a>0

a>0 在两个测试中都是必要的，所以对于行列式测试以及现在的主元测试，ac>

b2 也是必要的。重点是确认 S 的第二主元的比值：

第一枢轴是 a

第二枢轴是

乘数是 b/a

这个联结了线性代数的两大部分，正数特征值代表正数主元，反之亦然。每个主

元是左上角行列式的比值，对于 2>0，主元提供了一个快速测试，他们比计算特

征值要快很多。看到主元与行列式与特征值在课程中走在一起，心情非常满足。

M 例 5 - 是正定固有值 1 与 1 与 4

行列式 2 与 3 与 4

枢轴 2 与 3/2 与 4/3

S-I 会是正半定：特征值 0，0，3。S-2I 是未定（indefinite）因为 λ=-1，－1，2。

现在用不同的方式检视具有正数特征值的对称矩阵。

能量基定义

从 Sx=λx，左乘 xT 得到 xTSx=2xTx，右侧是正数 λ 乘一个正数 xTx=|x|2，所以

对于任意的特征向量，左侧的 xTSx 是正数。

重点：新的概念是对于所有非零向量 x，都有 xTSx 是正数，不只是特征向量。

在很多应用中，数字 xTSx（或 xTSx/2）是系统的能量（energet）。正能量的必要性给出

正定矩阵的另一个定义，我想这个能量基（energy-based）的定义是基本的方式。

特征值与主元是测试新要求 xTSx>0 的两个等效方法。

请尊重版权与译者的劳动成果，侵权必究！ 352

定义若对于所有非零向量 x 都有 xTSx>0，则 S 是正定：

2x2 xSx=［xy］=ax2+2bxy+cy2>0

（1）

4 个单元 a，b，b，c 给出 xSx 的 4 个部分，从 a 与 c 得到纯平方 ax2 与 cy2，从非对角线的 b 与 b 得到交叉项 bxy 与 byx（相同）。把 4 个部分相加得到 xSx，这个能量基定义导出一个基本事实：

若 S 与 T 是对称正定，S+T 也是。

理由：xT（S+T）x 就是 xTSx+xTTx，这两项是正数（当 x≠0）所以 S+T 也是正定。当矩阵相加时，主元与特征值不容易追踪，但是能量只需要相加。

xTSx 也可以联结我们确认正定矩阵的 4 种方法，从任意矩阵 A 开始，可能是矩形。我们知道 S=ATA 是方形且对称，不止如此，当 A 有无关列时 S 是正定：

测试：若 A 的列是无关，则 S=ATA 是正定。

再次提出特征值与主元并不容易，但是数字 xTSx 与 xTATAx 相同，xTATAx 就是（Ax）（Ax）=‖|Ax|2 - 另一个利用括号的重要证明！当 x≠0，向量 Ax 不是零（这是无关列的意义），则 xTSx 是正数 |‖Ax|2 且矩阵 S 是正定。

让我把原理收集起来，变成关于正定的 5 个等效叙述。你会看到关键概念如何联结线性代数的整个主题：主元，行列式，特征值，以及最小平方（从 ATA），然后是应用。

当一个对称矩阵 S 有下列 5 种性质之一，就会有全部的性质：

1.S 的所有 n 个主元都是正数。

2. 所有 n 个左上行列式都是正数。

3.S 的所有 n 个特征值都是正数。

4. 除了 x=0 之外，xTSx 是正数，这是能量基的定义。

5.S=ATA，其中矩阵 A 有无关的列。

「左上行列式」是 1×1，2×2，..，n×n，最后一个是全部的矩阵 S 的行列式。这个定理把全部线性代数课程都结合在一起。

网址：linear.neocities.org 箱：876152660@qq.com 353

范例 1 测试下列对称矩阵 S 与 T 的正定性：

与

解 S 的主元是 2，3/2，4/3 都是正数。它的左上行列式是 2，3，4 都是正数。S 的特

征值是 2-√2，2，2+√2 都是正数。完成了测试 1，2，3，任何一种都有决定性！

我有三个候选矩阵 A1，A2 与 A3 作为 S=ATA 的建议，他们都显示 S 是正定。A1 是第一差分矩阵，4×3，产生 S 的－1，2，－1:

A1 的三个列是无关，所以 S 正定。

A2 来自 S=LDLT（S=LU 的对称版本），消元法得到主元是 D 的 2，3/2，4/3，以

及乘数是 L 的－1/2，0，－2/3。就让 A2=（L√D）。【原文少了「（）T」，错误】

2

A2 是 S 的乔列斯基因子

A 的三角选择出现平方根（不美丽），它是 S 的乔列斯基因子且 MATLAB 的指令是

A=chol（S）。在应用中，矩形 A1 是我们如何建立 S，乔列斯基 A2 是我们如何把它

分离。

特征值给出对称选择 A3=Q√AQT 也是可以成功，其中 A3TA3=QAQT=S。所有的测试显示－1，2，－1 矩阵 S 是正定。

要看出能量 xTSx 是正数，我们改写成平方的总和。三个选择 A1，A2 与 A3 产生

三种不同的方法来分割 xTSx:

xTSx=2x12-2x1x2+2x22-2x2x3+2x32

改写成平方

|‖A1x|2=x12+（x2-x1）2+（x3-x2）2+x32

使用 A1 的差

A2x|2=2（x1-x2）2+3（x2-x3）2+x32 使用 S=LDLT

3x12=（1x）2+2（92x）2+2（93x）2

使用 S=QAQT

现在转到 T（本页的上方），（1，3）与（3，1）单元从 0 变成 b，b 必颁不能太大！行

列式的测试很容易。1×1 行列式是 2，2×2 行列式还是 3.3×3 行列式与 b 有关：

【原文不该出现「T」】

对 T 的测试

detT=4+2b-2b2=（1+b）（4-2b）必须是正数在 b=-1 与 b=2 我们得到 detT=0。在 b=-1 与 b=2 之间，矩阵 T 是正定。S

矩阵的角落单元 b=0 在－1 与 2 之间，所以是安全的。

请尊重版权与译者的劳动成果，侵权必究！ 354

正半定矩阵

通常我们会落在正定的边缘，行列式是零，最小的特征值是 0，它的特征向量的能量是 xTSx=xT0x=0。这些在边缘的矩阵称作正半定（semidefinite），下列是两个例子（不可逆）： ＊

S 有特征值 5 与 0，它的左上行列式是 1 与 0，它的秩只有 1。这个矩阵 S 分解成 ATA，其中 A 有相关的列：

A 的相关列

正半定 S

］］［］-

如果 4 稍微变大一点点，矩阵 S 变成正定。

循环 T 也有零行列式（当 b=-1，前面计算过），T 是奇异。特征向量 x=（1，1，1）有 Tx=0 以及能量 xTTx=0，向量 x 在其他方向确实有正的能量。这个 T 有很多方式可以改写成 ATA，但是 A 一定会有相关的列，因为（1，1，1）在它的零空间：

第二差 T

来自第一差 A

循环 T 来自循环 A

正半定矩阵的所有 1≥0 且所有的 xTSx≥0，这些弱不等式（≥而不是 >）包含正定 S 与边缘的奇异矩阵。

椭圆 ax2+2bxy+cy2=1

思考如图 6.7 所示倾斜的椭圆 xTSx=1，它的中心是（0，0）。把椭圆旋转与坐标轴对齐（X 与 Y 轴），这是图 6.7b。这两个图显示 S=QAQ-1=QAQT 的分解背后的几何意义：

1. 标题的椭圆对应 S，它的方程式是 xTSx=1。

2. 对齐的椭圆对应 A，它的方程式是 XTAX=1

3. 使得椭圆对齐的旋转矩阵是特征向量矩阵 Q。

范例 2 求出倾斜椭圆 5x2+8xy+5y2=1 的轴。

解从适配这个方程式的正定矩阵开始：

方程式是［xy1］=1 矩阵是 s-

网址：linear.neocities.org 邮箱：876152660@qq.com 355

y

Y

↑

（0， 1）

（六）

（.）

1>x

－1

－1

xTSx=1

X^Χ=1

1（）

图 6.7：标题椭圆 5x2+8xy+5y2=1，对齐后是 9X2+Y2=1。

特征向量是除以得到单位向 y

现在左剩到 N

x25x = 平方的总和 5x2+8y÷5y2=9）+1（）

（2）

系数不是来自 D 的主元 5 与 9/5，他们是来自 A 的特征值 9 与 1。在平方里面的是特征向量 q1=（1，1）/√2 与 q2=（1，-1）/√2。

倾斜椭圆的轴指向特征向量。这个解释了为什么 S=QAQT 称为「主轴定理」－它显示了轴，不只是轴方向（来自特征向量），还有轴长度（来自特征值）。要看见全貌，使用大写字母作为对齐椭圆的新坐标：

对齐

=x 与 = Y 与 9x2+x2=1

X2 的最大值是 1/9，较短轴的端点有 X=1/3 与 Y=0。

注意：较大的特征值 1 得到短轴，一半长度是 1/1=1/3。较小特征值 2=1 得到较大的长度 1/√2=1。

在 xy 系统中，轴是沿着 S 的特征向量。在 XY 系统，轴是沿着 A 的特征向量 —－坐标轴。全部都来自 S=QAQT。

请尊重版权与译者的劳动成果，侵权必究！ 356

当所有的 A1>0，S=QAQT 是正定，xTSx=1 的图形是个椭圆：

椭圆［×eAe-xA=x2+2=1

（3）

轴指向 S 的特征向量，椭圆的半长是 1/√与 1/√2。

S=I 得到圆 x2+y2=1。如果一个特征值是负数（交换 S 的 4＇s 与 5＇s），椭圆变成双曲线，平方总和变成平方的差：9X2-Y2=1。例如 S=-I 这种负定矩阵，两个 2＇s 都是负数，－x2-y2=1 的图形就是一个点都没有。

若 S 是 n×n，xTSx=1 是 R」的一个椭球面，它的轴是 S 的特征向量。

重要应用：极小值测试

若在点（x，y）=（0，0）时，∂F1∂x=0 且∂F1∂y=0，F（x，y）有极小值吗？

对 f（x）来说，极小值的测试来自微积分：df/dx 是零且 d2f/dx2>0。F（x，y）的两个变数产生一个对称矩阵 S，它包含 4 个二次导数，正数 d2f/dx2 变成正定 S:

二次 8＆°

y

F≈xTSx>0

若∂F10x=∂F1∂y=0 且 S 是正定，则 F（x，y）有一个极小值。

理由：S 显示靠近（x，y）=（0，0）的最重要项 ax2+2bxy+cy2，F 的二次导数是 2a，2b，2b，2c。对于 F（x，y，z）的 S 矩阵会是 3×3。

主要观念的复习

1. 正定矩阵有正数特征值与正数主元。

2. 左上行列式是一个快速测试：a>0 且 ac-b2>0。

3. 能量 xTSx 是一个从 x=0 朝上的「碗（bowl）」

除了在（x，y）=（0，0）之外，xTSx=ax2+2bxy+cy2 是一个正数。

4. 若 A 有无关的列，则 S=ATA 自动是正定。

5. 椭圆 xTSx=1 的轴沿着 S 的特征向量，长度 1/√。

6. 若∂F10x=∂F1∂y=0 且二次导数矩阵是正定，则 F（x，y）有一个极小值。

网址：linear.neocities.org 箱：876152660@qq.com 357

已解范例

6.5A 对称矩阵的伟大分解是来自主元与乘数的 S=LDLT，以及来自特征值与特

征向量的 S=QAQT。尝试对于 n×n 的测试，例如 pascal（6），ones（6），hilb（6）以及其

他 MATLAB 展览馆的矩阵。

pascal（6）是正定，因为所有的主元都是 1（已解范例 2.6A）。

ones（6）是正半定，因为它的特征值是 0，0，0，0，0，6。

H=hilb（6）是正定，纵使 eig（H）显示特征值非常靠近零。

希尔伯特矩阵 xTHx=f（x1+x2s+..+xs5）2ds>0，H=1/（i+j-1）。

rand（6）+rand（6）＇可以是正定也可以不是，试验显示 20000 次只有 2 次是正定。

n = 20000； p = 0； for k= 1:n， A= rand（6）； p = p+ all（eig（A +A＇） >0）； end， p/n63 什么时候方知 M-「g 是正定？

解从 M 的第二行减去 BTA1 乘第一行得到方块零，舒尔补充 S=C-BTA1B 会

出现在角落： I-B＇］［］-［ c-B］-［

（4）

这两个方块 A 与 S 必须是正定，他们的主元是 M 的主元。

6.5C 求出－1，2，－1 三对角 n×n 矩阵 S（我的最爱）的特征值。

解最佳方法是猜测 λ 与 x，然后检验 Sx=2x。对大部分矩阵来说可能猜不了，

但是特殊案例是数学的一大部分（纯数学与应用）。

关键隐藏在一个微分方程式，第二差分矩阵 S 好像是二次导数，这些特征值

更容易了解：

固有值么，λ2，..

－88

（5）

固有函数 y1，y2，..

尝试 y=sin cx，它的二次导数是 y＂=-c2 sin cx。假设 y=sin cx 满足端点条件 y（0）

=0=y（1），方程式（5）中的特征值会是 A=-c2，

当然 sin0=0（其中余弦被消除），另一个端点 x=1，我们需要 y（1）=sinc=0，

数字 c 必颁是 k，一个的倍数。则是－k22:

固有值 =-k2-x2

（6）

固有函数 y=sin kx

现在回到矩阵 S 并且猜测它的特征值，在 n 个点 x=h，2h，.，nh，sin kx 是 0

与 1 之间的相等等空间点，距离△x 是 h=1/（n+1），所以第 n+1 个点是（n+1）h=

1。把 S 乘正弦向量 x:

S 的固有值是正数

Sx =λx = （2-2cos kπh） x

S 的固有向量是正弦向量

x = （sin kπh，.， sin nkπh）

（7）

请尊重版权与译者的劳动成果，侵权必究！ 358

问题集 6.5

问题 1-13 有关正定的测试。

1 假设通过 2×2 测试 a>0 与 ac-b2>0，则 c>b2/a>0.

（1）与 2 有相同的符号，因为乘移 12 等于

（）上面的符号是正，因为 + 2 等于

结论：测试 a>0 与 ac-b2>0 确保正数特征值 λ1 与 λ2。

2S1，S2，S3，S4 哪一个矩阵有两个正数特征值？使用测试法，不要计算 A＇s。同

时求出一个 x 使得 xTSx<0，所以 S1 不是正定。

3 什么数字 b 与 c 使得下列矩阵是正定？

－［，］-［］`-［；］

把主元放在 D 与乘数放在 L，把每个 A 分解成 LDLT。

4 下列矩阵的函数 f^=ax2+2bxy+cy2 为何？完成平方项使得每个 f 写成一个或

两个平方的总和 f=d1（）2+d2（）2。

s-|；＆:-|｝1-xs|

5 把 /x，y）=x2+4xy+3y2 写成平方的差，并求出一个点（x，y）使得∫是数。级

使 f 有正数系数，在（0，0）还是没有极小值。

6 函数 f（x，y）=2xy 确定有一个鞍点（saddle point）并且在（0，0）没有极小值。什么

样的矩阵 S 得到这个 f? 特征值为何？

7 对于下列矩阵测试 AA 是否正定？A 需要无关的列。

与与

8 函数 f（x，y）=3（x+2y）2+4y2，除了在（0，0）之外都是正数。f=［x y］S［x y］T

的矩阵为何？检查 A 的主元是 3 与 4。

网址：linear.neocities.org 箱：876152660@qq.com 359

9 求出 3×3 矩阵 S 以及它的主元，秩，特征值，行列式：

10 哪个 3×3 对称矩阵 S 与 T 产生下列二次式:

xTSx=2（x12+x22+x32-x1x2-x2x3），为什么 S 是正定？

xTTx=2（x12+x22+x32-x1x2-x1x3-x2x3），为什么 T 是正半定？

11 计算 S 的三个左上行列式建立正定性。验证他们的比值得到第二与第三主元。

主元 = 行列式的比值

12 哪些数字 c 与 d 使得 S 与 T 正定？测试他们的三个行列式:

13 给定 a>0 与 c>0 与 a+c>2b，找出有一个负数特征值的矩阵。

问题 14-20 有关测试的应用。

14 若 S 是正定则 S1 是正定。最佳证明：S1 的特征值是正数，因为

第二种证明（只能是 2×2）：

s 的单元通过行列式測试

15 若 S 与 T 是正定，他们的总和 S+T 也是正定，主元与特征值对 S+T 不方便，

最好使用 + x>0. 同时 S - 与－8 得到 S

有无关列。

16 正定矩阵不能有一个零（更糟的是有一个负数）在对角线，证明这种矩阵不可

能有 xTSx>0:

（）

不是正定。

17 一个对称矩阵的某个对角线单元 s 不会比所有的 A＇s 小，如果它是，则 S-sI

会有特征值并且是正定。但是 S-sI 会有一个在对角线上。

请尊重版权与译者的劳动成果，侵权必究！ 360

18 若 Sx=Ax 则 xSx=__。当 > 0，为什么这个数字是正数？

19 逆反问题 18，证明若所有的 1>0 则 xTSx>0。我们必须对每一个非零 x 做

这件事情，不只是特征向量，所以把 x 写成特征向量的组合然后说明为什么

所有的的交叉项 xTx=0。则 xTSx 是

（c1x1+..+cnxn）T（c121x1+..+cn2nxn）=c121x1+x1+.+cn2nxnTxn>0

20 给出快速的理由说明为什么下列叙述都是正确的：

（a）每一个正定矩阵是可逆。

（b）唯一的正定投影矩阵是 P=I。

（c）对角线单元都是正数的对矩阵是正定。

（d）正数行列式的对称矩阵不一定是正定。

问题 21-24 使用特征值；问题 25-27 基于主元。

21 什么样的 s 与 t 使得 S 与 T 的全部 A>0（所以是正定）?

与

22 从 S=QAQT，计算下列每个矩阵的正定对称平方根 Q√AQT。验证这个平方

根得到 ATA=S。

与 s-［

23 你可能看过椭圆方程式 x2/a2+y2/b2=1，当方程式写成 λ1x2+λ2y2=1 时，a

与 b 为何？椭圆 9x2+4y2=1 的轴的半长是 a=__与 b=__。

24 画出倾斜椭圆 x2+xy+y2=1 的图形，从对应矩阵 S 的特征值求出轴的半长。

25D 有正数主元，S=LDLT 的分解变成 L√DDLT（主元的平方根得到 D=

√D√D），则 C=√DLT 得到乔列斯基分解 A=CTC，称为「对称化 LU」：

¢－2＊s.

从 5 - 求 C=chol（）

26 Cholesky 分解 S=CTC，其中 C=√DLT，主元的平方根在 C 的对角线。求

C（上三角）:

与

网址:linear.neocities.org 箱：876152660@qq.com 361

27 对称分解 S=LDLT 表示 xTSx=xTLDLTx:

［x y］

左侧是 ax2+2bxy+cy2，右侧是 a（x+by/a）2+__y2。第二主元完成平方项！

使用 a=2，b=4，c=10 进行测试。

28 不要乘开 =，

（a）S 的行列式（b）S 的特征值

（c）S 的特征向量（d）一个理由：为什么 S 是对称正定？

29F1（x，y）=x4/4+x2y+y2 与 F2（x，y）=x3+xy-x，求出二次导数矩阵 S1 与 S2:

极小值测试

是正定

S1 是正定，所以是凹向上（= 凸函数），求 F1 的极小点。求 F2 的鞍点（只寻找一

次导数是零的地方）。

30 z=x2+y2 的图形是一个开口朝上的碗，z=x2-y2 的图形是一个鞍形（saddle），

z=-x2-y2 的图形是一个开口朝下的碗。针对 z=ax2+2bxy+cy2 的图形，如

果在（x，y）=（0，0）有一个鞍点，求 a，b，c 的条件？

31 针对 z=4x2+12xy+cy2 的图形，什么样的 c 得到一个碗以及什么样的 c 得到

一个鞍点？描述图形在边界线的 c 值。

函数 F（x，y，z）的极小值

对于极小点你会期待什么样的测试？首先是零斜率:

在极小点的一次导数是零 дF дF дF =0

ax y 6z

然后是常用微积分测试 d2f/dx2>0 的线性代数版本：

二次导数矩阵 S 是正定

此处 Fy=

（）=F 是「混合」二次导数。

请尊重版权与译者的劳动成果，侵权必究！ 362

挑战问题

32 一群非线性矩阵如果包含 A 与 B，则包含 AB 与 A。「乘积与逆矩阵保持在群内」，下列哪些是群（如同 2.7.37）？

对于两个群发明一个「子群」（不是 I 本身 = 最小的群）。

（a）正定对称矩阵 S。

（b）正交矩阵 Q。

（c）一个固定矩阵 A 的所有指数 e4。

（d）有正数特征值的矩阵 P。

（e）行列式是 1 的矩阵 D。

33 当 S 与 T 是对称正定，ST 甚至可能不是对称，但是它的特征值仍然是正数。从 STx=Ax 开始，然后计算与 Tx 的点积，证明 1>0。

34 从已解范例 6.5C 写下 5×5 正弦矩阵 Q，包含当 n=5 与 h=1/6 的 S 的特征向量。执行 SQ 查看这 5 个 A＇s。

2＇s 的总和应该等于迹 10，他们的乘积应该是 detS=6。

35 假设 C 是正定（只要 y≠0，yTCy>0）以及 A 有无关的列（只要 x≠0，Ax≠0）。对于 xTATCAx 应用能量测试，证明 S=ATCA 是正定：工程的重要矩阵。36 重要！假设 S 是正定且有特征值 1≥2≥.2

（a）矩阵 λ1I-S 的特征值为何？它是正半定吗？

（b）如何推论：对每一个 x 都有 λ1xTx≥xTSx。

（c）得出结论：xTSx/xTx 的极大值是

37 什么样的 a 与 c 使得矩阵是正定？什么样的 a 与 c 使得它是正半定（包含正定）?

a a a

所有五个测试都可能

S= a a+c a-c

能量 xTSx 等于

a a-c a+c

a（x1+x2+x3）2+c（x2-x3）2

网址：linear.neocities.org 箱：876152660@qq.com 363

特征值与特征向量表

反映在特征值与特征向量的矩阵性质有哪些？这个问题贯穿了第六章的根本，如果有一个表来组织这些关键事实会有很大的帮助。下列是特征值与特征向量 x2 的特殊性质。

对称：ST=S=QAQT

实数特征值

正交 xx1=0

正交：QT=Q-1

所有的 | 2|=1

正交 x1Tx1=0

反对称：AT=-A

虚数 s

正交 xTx1=0

复数厄米：ST=S

实数＇s

正交 xTx1=0

正定：xTSx>0

所有的 1>0

由于 ST=S，正交

马尔可夫：m>0

∑=1m=1

Âmax = 1

稳定状态 x>0

相似：A=BCB-1

2（A）=（C）

B 乘 C 的特征向量

投影：P=P2=PT

^=1；0

列空间；零空间

平面旋转：余弦－正弦

eioe-i0

x=（1，i）（1，-i）

镜射：I-2uuT

^=-1， 1，..， 1

u；整个平面 u1

秩一：uvT

λ=vи； 0，.，0

u；整个平面 u1

逆矩阵：A-1

1/（A）

维持 A 的特征向量

平移：A+cI

2（A） +c

维持 A 的特征向量

稳定次方：A＂→0

全部 | A|<1

任意特征向量

稳定指数：e＃→0

全部 Reλ<0

任意特征向量

2πik

循环排列：P1，i+1=1，Pn1=1 hk=en=（1 的根） xk=（1，N3…，An-1）

循环行列式：coI+c1P+.

2k=co+c1e2mkn+.. xk=（1，Ak3，…，Akn-1）三对角：对角线是－1，2，－1 k=2-2cos

x-sin cos）

可对角化：A=XAX1

Λ 的对角线

X 的列是无关

舒尔：A=QTQ-1

三角 T 的对角线若 ATA=AAT，Q 的列

若尔当：A=BJB-1

J 的对角线

每个方块一个特征向量

SVD：A= UΣVT

在 Σ 有 r 个奇异值在 V，U 的 ATA，AAT 的特

征向量

请尊重版权与译者的劳动成果，侵权必究！ 364

第七章

奇异值分解（SVD）

7.1 线性代数做图像处理

1 一个图像是一个灰度值的大型矩阵，每个对应一个像素与颜色。

2 当邻近像素相互关联（不是随机）时，可以压缩图像。

3SVD 可以分解任意矩阵 A 成为秩一片段 uvT=（列）（行）。

4 列与行是对称矩阵 AAT 与 ATA 的特征向量。

A 的奇异值定理是 ATA 与 AAT 的特征值定理。

这是你在本章看到内容的快速预习。A 有两个奇异向量的集合（ATA 与 AAT 的特征向量），有一个正数奇异值的集合（因为 ATA 与 AAT 有相同的正数特征值）。A 通常是矩形，但是 ATA 与 AAT 是方形，而且是正半定。

奇异值分解（SVD）可以分解任意矩阵成为简单的片段（pieces）。

每个片段是一个列向量乘一个行向量。一个 m×n 的矩阵有 m 乘 n 个单元（当矩阵代表图像时是个很大的数字），但是一个列与一个行只有 m+n 个分量，远远小于 m 乘 n。这些（列）（行）片段是可以用超快速度处理的满大小（full size）矩阵－他们只需要 m+n 个数字。

通常来说，SVD 的图像处理应用在它依靠的线性代数之前来到，我会从只包含一个或两个片段的简单图像开始。现在我把一个图像想象成一个大型的矩形矩阵，单元 a 告诉我们图像的全部像素的灰度。把像素想象成一个小方形，从左下角开始横跨 i 步以及往上 j 步，它的灰度是一个数字（通常在 0≤a<256=28 的范围内）。一个全白的像素有 a=255=11111111，电脑把 255 写成 2 进位表示法时，这个数字有 8 个 1＇s。

网址：linear.neocities.org 邮箱：876152660@qq.com 365

你已经知道一个图像为什么有 m 乘 n 个像素，每个像素用 8 比特（0 或 1）表示它的灰度，变成一个 m×n 的矩阵，其中每个单元有 256 种的可能值。

简单的说，一个图像是一个大型矩阵，要完美复制它，我们需要 8（m）（n）比特的信息。高分辨率电视通常有 m=1080 与 n=1920，每秒通常有 24 帧，而且你可能喜欢看彩色画面（3 个颜色度），总共需要传输（3）（8）（48，470，400）比特 / 秒。这个太昂贵也不可行，传输器跟不上表演的速度。

当压缩做的很好时，你是看不出来与原始的差别。图像的边（edge）（灰度的突然改变）是最难压缩的部分。

如果每个 a＃都是无关的随机数字，压缩就不可能成功。我们完全依靠这个事实：邻近像素通常都有相似的灰度。当你跨越边的时候，它会产生一个突跳。实际世界的图像到处是边，所以动画更容易压缩。

对视频来说，数字 a 在帧之间不太会改变，我们只传输小变化，这是 H.264 视频压缩标准（本书的网站）的不同编码方法，我们用线性代数压缩每个变化矩阵（也用非线性「量子化」变成电脑最有效率的整数）。

我们每天看到的自然图像绝对可以而且准备好被压缩 — 但是没有变得容易。

低秩图像（范例）

最简单压缩的图像是全黑或全白或是常数的灰度 g，矩阵 A 的每个单元都是相同的 g:ay=g。当 g=1 且 m=n=6，下列是一个图像处理的极端例子，这个例子是中央 SVD 教义派：

1 1 1 1 1 1］

范例 1 不要传送 A=

传送这个 A=

1 1 1 1 1 1

111111 ［111111］

36 个数字变成 12 个数字，300×300 个像素，90000 个数字变成 600 个。如果我们事先定义好全 1 向量 x，我们只需要传送一个数字，这个数字就是常数灰度 g 使得 xxT 得到这个矩阵。

当然第一个是极端的例子，但是它给出一个重点，如果有可以事先仔细定义的特殊向量，例如 x=ones，图像处理就可以超级快速。需要战斗是在由图像决定的事先选定基底（preselected bases）（傅里叶基底允许从 FFT 加速）与适应性基底（adaptive bases）之间做选择。SVD 产生来自图像本身的基底－- 这是适应性的，可能不便宜。

我不是说 SVD 永远或是通常给出实际上最有效率的演绎方法，下面例子的目的是指引而不是产生。请尊重版权与译者的劳动成果，侵权必究！ 366

范例 2

aa c cee

「王牌旗」

a a cc ee

法国国旗 A

不要传送 A= aa cc ee

传送 A=

aa cc ee

意大利国旗 A

11111 ［aaccee］

aa cc ee

德国国旗 AT

aa c cee

国旗有 3 个颜色但是秩还是 1，我们仍然有一个列乘一个行。假设这 36 个单元保持秩 1 的模式 A=u1v1T，他们甚至可以全部不相同。但是当秩变成 r=2，我们需要 u1v1T+u2v2T，下列是一种选择：

范例 3

等于

嵌入方形

4-］11-］1011

A 的 1＇s 与 0 可以是 1＇s 的方块与 0 的方块，我们仍然有秩 2，我们仍然只需要两个项 1V1T+2v2T。一个 6×6 图像可以压缩成 24 个数字，一个 N×N 图像（N2 个数字）可以压缩成来自 4 个向量 u1，v1，u2，v2 的 4N 个数字。

我有做出 u＇s 与 v＇s 的最佳选择了吗？这个不是来自 SVD 的选择！我注意到 u1=（1，1）与 u2=（1，0）没有正交，且 v1=（1，1）与 v2=（0，1）也没有正交。原理告诉我们正交性会产生较小的第二片段 c2u2v2T。（SVD 按重要顺序选择秩 1 片段。）

若 A 的秩远大于 2，如同我们预期实际图像一般，A 会是很多秩 1 片段的总和。我们希望小东西是真正的小－小到可以被丢弃而无损视觉品质。图像压缩变成有损，但是好的图像压缩实际上是无法被人类的视觉系统侦测。

问题变成：来自 SVD 的正交选择是什么？

SVD 的特征向量

我想要介绍特征向量的用途，但是大部分图像的特征向量不是正交。此外，特征向量 x1 与 x2 只给出一个向量集合，而我们需要两个集合（u＇s 与 v＇s）。这两个困难的答案正是 SVD 的概念：

使用 AAT 的特征向量 u 与 ATA 的特征向量 v。

由于 AAT 与 ATA 自动是对称（但是通常不相等！），u＇s 会是一个正交集合，而且 v＇s 会是另一个正交集合。我们可以也会让他们变成单位向量：|u|=1 且 | v|=1，则我们的秩 2 矩阵会是 A=u1+02u22。这些数字 1 与 2 的大小会决定他们在压缩时能不能被忽略。我们保存大的 σs，我们丢弃小的 σs。

网址：linear.neocities.org 箱：876152660@qq.com 367

SVD 的 u＇s 称为左奇异向量（AAT 的单位特征向量），v＇s 称为右奇异向量（ATA 的单位特征向量），σ＇s 是奇异值，就是 AAT 与 ATA 的相同特征值的平方根：

来自 SVD 的选择

AAu；= σ；u； ΑΑν；= σν； Aν； = σui

（1）

范例 3 中（嵌入方形），下列是对称矩阵 AAT 与 ATA:

^-］［］4＇^-［¦）］-

他们的行列式是 1，所以 λ1λ2=1，他们的迹（对角线的总和）是 3:

025

与的为是 0

最接近 A 的秩 1 矩阵是 u11，误差只有の 0.6 = 最佳可能。

AAT 与 ATA 的正交单位特征向量是

M=［］「2=［］=［］v2=［n］全部除以 1+on2

（2）

每位读者都知道在实际生活中这些计算是由计算机完成！（当然不是依赖不可靠的教授，我都是用 MATLAB 的 svd（A）来更正自己。）借由 1u1v1T+2u2v2T，我们可以检验正确的回复到矩阵 A:

或更简单的 A［v1v2］=［1u102u2］

（3）

重要关键点不是图像趋向有低的秩，不是的，图像通常有满秩，但是他们确实有低效率的（low effective）秩，这就表示：很多奇异值很小，可以被设定成零。我们传输的是低秩的近似。

范例 4 假设旗子有两个不同颜色的三角形，左下的三角形有 1＇s，右上的三角形有 0＇s，主对角线都是 1＇s。下列是 n=4 的图像矩阵，它有满秩 r=4 所以可逆：

10 0 0

0 00

三角形

A=

旗子矩阵

00-1 1

请尊重版权与译者的劳动成果，侵权必究！ 368

矩阵有满秩，所以 A 有一整组 n 个奇异值 σ（都是正数），SVD 会产生 n 个秩一的

片段 ouvT，完美重建需要 n 个片段。

压缩时我们丢弃小的 σ＇s 不会严重损失图像的品质，我们希望了解并且画出 n

=4 以及更大 n 的 σ2s 的图形。注意范例 3 是三角形范例 4 的特殊例子 n=2。

用手算，我们从 AAT 开始（电脑会有不同的处理）：

（4）

因为这个－1，2，－1 逆矩阵的特征值都有 2-2cosθ 的形式，所以它被引进，我们

就可以知道 AAT 的 A＇s 与 A 的 σ2＇s:

4＂2-0 47） NM o-- 2mlor）

（5）

n 个不同角度 0 是等距离，使得这个例子如此特殊：

这个特殊例子得到 AAT 在 n=4 的特征值 λ=1，所以 σ=√=1 是 A 的一个奇异

值。你可以检查向量 u=（1，1，0，-1）时，AAIu=u（真正的特例）。

重点是画出 A 的 n 个奇异值的图形，这些数字逐渐减少（不像 A 的特征值全部

是 1），但是不是很陡的减少，所以 SVD 只是适度的压缩这个三角形旗子。希尔

伯特伟大的压缩。

102

105

tril（ones（40）的奇异值

100

hilb（40）的奇异值

101

105

10-10

100

10-15

101

↑

0

10

20

10-20

30

40

0

10

20

30

40

图 7.1：范例 3-4 中三角 1 矩阵的奇异值（不可压缩）与段落 8.3 的邪恶希尔伯特矩

阵 H（i，j）=（i+j-1）~1：压缩后使用。

网址：linear.neocities.org 箱：876152660@qq.com 369

你忠实的作者一直从事国旗秩的研究，有很多是基于水平或是垂直条纹，这些秩 1 - 所有的行或列都是 1 向量（1，1，.，1）的倍数。亚美尼亚，奥地利，比利时，保加利亚，乍得，哥伦比亚，爱尔兰，马达加斯加，马里，荷兰，尼日利亚，罗马尼亚，俄罗斯（还有更多）都有 3 个条纹。印尼与波兰有两条！利比亚在卡扎菲时代 1977 到 2011 是最极端的案例（正面国旗都是绿色）。

另一种极端是很多国旗含有对角线，好像英国国旗的长对角线，或是具有来自星星的边的短对角线－- 例如美国国旗。本书的三角形 1 的例子显示了国旗矩阵如何拥有很大的秩，秩增加至无限大，像素变得非常小。

其他国旗有圆形或月牙形或是不同的曲线形状，他们的秩很大也会一直增加至无限大，但是他们仍然可以压缩！压缩的图像不完美，但是我们的眼睛看不出差别（来自 SVD 足够的项 ouvT），这些例子真正引出图像压缩的主要目的：

很大的秩简化仍然可以维护视觉品质。

为了好玩，我们回头看看有限秩的国旗，他们可以有条纹也可以有交叉线 — 假设横跨边是水平或是垂直。某些国旗有薄框环绕交叉线，这些艺术触感会增加秩。现在我的冠军是下列所示的希腊国旗，有交叉线也与条纹，它的秩是 3×（我的计数，三个不同的列数）。我没有看到有限秩的美国国旗！

读者可以去 GOOGLE「national flags」看看不同的设计与颜色，我会很高兴知道任何 n>3 的有限秩的例子。各种类型的好例子可以到本书的网站 math.mit/linearalgebra（有全颜色的国旗）。

请尊重版权与译者的劳动成果，侵权必究！ 370

问题集 7.1

1 求出单元 i，j 是 i 乘 j 与 i+j 的矩阵的秩。把 A 与 B 写成 r 个片段 uvT 的总和，

不需要 u1Tu=vvT=0。

1234

2345

2468

3456

A=

B=

481216

5 67 8

2 我们通常把单位矩阵 I 想成是最简单的，但是为什么 I 完全不可压缩？画出有

一条交叉线而且是秩 5 的国旗。

3 这些国旗的秩 2，把 A 与 B 写成 u1v1T+u2v2T。

4 求出问题 3 中 BBT 与 BTB 的迹与行列式，B 的奇异值接近 σ12=28-1/14 与 σ22

=1/14，B 可以压缩吗？

5 使用［U，S，V］=svd（A）求出 A 瑞典的两个正交片段 ouvT。

6. 求出 2×2 矩阵 A 的特征值与奇异值。

A 的特征向量（1，2）与（1，－2）没有正交，你如何知道 ATA 的特征向量 v1 与 v2 是

正交？注意 ATA 与 AAT 有相同的的特征值（25 与 0）。

7 方程式（3）的第二形式 AV=U∑是如何来自第一形式 A=UZVT? 这是 SVD 最

著名的形式。

8AV=U∑的两个列是 Av1=ō1u1 与 Av2=2u2，所以我们希望

|a 与 |.

第一需要 σ1+1=σ12 且第二需要 1-σ1=-2，这些是正确吗？

9MATLAB 的指令 A=rand（20，40）与 B=randn（20，40）产生 20×40 的随机矩阵，

A 的单元在 0 与 1 之间是均匀概率，B 的单元有一个正态的「钟形」概率分

布。使用 svd 指令，求出并画出他们的奇异值到 20 的图形。为什么他们有

20 个 σ2s。

网址：linear.neocities.org 箱：876152660@qq.com 371

7.2SVD 的基底与矩阵

1SVD 产生 4 个基础子空间的 v＇s 与 u＇s 的正交单位基底。

2 使用这些基底，A 变成对角矩阵∑且 Av1=ōu1:σ1 = 奇异值。。

3 双基底对角化 A=UZVT 通常拥有比 A=XAX1 更多的信息。

4U∑VT 把 A 分成秩 1 矩阵 ou1v1T+.+o，u，v，T，o1u1v1T 是最大！

奇异值分解是线性代数的一个亮点，A 的任意 m×n 矩阵，方形或矩形，它的秩是 r。我们会对角化 A，但不是用 XAX，X 里面的特征向量有三个大问题：他们通常不是正交，不一定有足够的特征向量，而且 Ax=x 要求 A 是方形。A 的奇异向量以完美的方式解决了全部的问题。

让我描述我们想要从 SVD 得到什么：4 个子空间的直角基底，然后我会依据重要顺序写下求出基底向量的步骤。

我们付出的代价是两组奇异向量 u＇s 与 v＇s 的集合，u＇s 在 Rm 而且 v＇s 在 Rn，他们会是 mxm 矩阵 U 以及 n×n 矩阵 V 的列。我首先会利用这些基底来描述 SVD，然后我也会用正交矩阵 U 与 V 来描述 SVD。

（使用向量）u＇s 与 v＇s 产生 4 个基础子空间的基底：

u1，..，ur

是列空间的一组正交单位基底

ur+1， .， Um

是左零空间 N（AT）的一组正交单位基底

V1，…，r

是行空间的一组正交单位基底

V+1，…n

是零空间 N（A）的的一组正交单位基底

不只是正交，这些基底向量可以对角化 A:

「对角化 A」Av1=ō1u1

Av2=02u2.Av，=ōu，

（1）

这些奇异值 1 到 o 是正数：σ1 是 Av 的长度。这些 s 进入一个对角矩阵，这个矩阵其他单元都是零，就是矩阵∑。

（使用矩阵）由于 u＇s 是正交单位，有个列的矩阵 U 会有 U，JU=1。由于＇s 是正交单位，矩阵 V，会有 V，TV，=I。则方程式 Av1=ō1u 会一列一列的告诉我们 AV，=U，Σ，：

（2）

请尊重版权与译者的劳动成果，侵权必究！ 372

这是 SVD 的心脏，但是还有更多。这些 v＇s 与 u＇s 负责 A 的行空间与列空间，我们还有 n-r 个 v＇s 与 m-r 个 u＇s，分别来自零空间 N（A）与左零空间 N（AT）。他们自动与前面 v＇s 与 u＇s 正交（因为整个零空间是正交）。我们现在引入 V 与 U 的所有 v＇s 与 u＇s，所以矩阵变成方形，我们仍然有 AV=U∑。

（mxn）（nxn）

OY

AV=UΣ

A［v·v，·vn］=［u·u，·un］

（3）

（mxm）（mxn）

新的∑是 m×n，它就是方程式（2）的 r×r 矩阵加上 m-r 个额外零行以及 n-r 个零列，真正的改变在于 U 与 V 的形状。这些是方形矩阵且 V1=VT，所以 AV=U∑变成 A=U∑VT，这就是奇异值分解。我可以把 VT 的行乘来自 UΣ 的列 u1:

SVD

A=UΣV= σιuιν+.+ σu，ν，

（4）

方程式（2）是一个简化 SVD，具有行空间与列空间的基底。方程式（3）是包含零空间的完整 SVD，他们两者都把 A 分解成相同的 r 个秩 1 的 ouvT 矩阵。列乘行是第四种矩阵相乘的方法。

我们看到每个 σ2 是 ATA 的特征值，也是 AAT 的。当我们把奇异值以降序的方式排列，σ1≥02≥.≥0，>0，方程式（4）的分割得到 A 的 r 个依据重要顺序排序的秩 1 片段，这个很重要。

范例 1 什么时候 A=UZVT（奇异值）与 XAX1（特征值）相等？

解 A 需要正交特征向量才能允许 X=U=V。如果 A=∑，A 也需要特征值 1≥0，所以 A 必须是一个正半定（或是正定）对称矩阵。只有在这个时候 A=XAX1，也就是 QAQT，才能与 A=UΣVT 一致。

范例 2 若 A=xyT（秩 1）有单位向量 x 与 y，A 的 SVD 为何？

解方程式（2）的简化 SVD 就是 xyT，其中秩 r=1，它有 u1=x 与 v1=y 与 1=1。对于完整 SVD 来说，让 u1=x 作为 u＇s 的一组正交单位基底，让 v1=y 作为 v＇s 的一组正交单位基底，不存在新的 σ2s，只有 σ1=1。

SVD 的证明

我们需要展示这些惊人的 u＇s 与 v＇s 是如何创建的，v＇s 会是 ATA 的正交单位特征向量，这个必须成立，因为我以下列方程式为目标

ATA=（UVT）T（UEVT）=V2TUTUVT=V2TEVT

（5）

在右侧你会看到对称正定（正半定）矩阵 ATA 的特征向量矩阵 V，以及（∑T∑）必须是（ATA）的特征值矩阵：每个 2 是 A（ATA）。

网址：linear.neocities.org 箱：876152660@qq.com 373

现在 Av1=ō1u1 告诉我们单位向量 u1 到 u，这是关键方程式（1）。重要的部分－SVD 能够成功的理由－就是这些 u1 到 u，自动是彼此正交（因为 v＇s 正交）： （6）

v＇s 是 A①A（对称）的特征向量，他们是正交而且现在 u＇s 也是正交，实际上这些 u＇s 会是 AAT 的特征向量。

最终我们完成了 v＇s 与 u＇s 至 n 个 v＇s 与 m 个 u＇s 具有任何 N（A）与 N（A①）的正交单位基底，我们求出了 A=U∑VT 的 V 与∑与 U。

SVD 的一个例子

下列是一个展示计算 A=UΣVT 的三个矩阵的例子。

范例 3A=3，秩是 2，找出 U，X，V.

秩是 2，这个 A 有正数奇异值 1 与 2，我们会看到 01 比 2max=5 大，2 比 min=3 小。从 ATA 与 ATAT 开始：

这些矩阵有相同的迹（50）与相同的特征值 2=45 与 2=5，平方根是 1=45 与 02=√5 则 0102=15 而且这是 A 的行列式。

一个关键步骤是求出 AA 的特征向量（对应特征值 45 与 5）：

［26 ²］］-«；］［0 295］［¯¦］-5［¦］

则 v1 与 v2 是重设比例成为长度 1 的正交向量，除以√2。

右奇异向量的左奇异向量

现在计算 Av1 与 Av2，这些会等于 O1u1=√45u1 与 2u2=√5u2:

A===01m

除以√10 使得 u1 与 u2 正交单位，则如同预期的 o1=√45 与 2=√5，A 的奇异值分解是 U 乘∑乘 VT。请尊重版权与译者的劳动成果，侵权必究！ 374

（7）

U 与 V 包含列空间与行空间的正交单位基底（两个空间都是 R2），实际的成果是这两组基底可以对角化 A:AV=U∑。矩阵 A 分割成两个秩 1 矩阵的组合，列乘行：

一个极端矩阵

下列是一个较大系统，当 u＇s 与 v＇s 恰好是单位矩阵的列，所以计算容易，但是要注意列的顺序。矩阵 A 是极度不平衡（严格三角形），所有的特征值都是零。AAT 与 AA 不接近，矩阵 U 与 V 会是正确修正那些问题的排列。

0100

固有值 λ=0，0，0，0 全部是 0

0020

A=

只有一个固有向量（1，0，0，0）

0 0 0 3

奇异值 σ=3，2，1

0 0 0 0

奇异向量是 I 的列

ATA 与 AAT 是对角（有简单的特征向量，但是不同顺序）：

0 0 0 O

1 0 0 0

ATA= 0 1 0 0

AAT= 0 4 0 0

0 0 40

0 0 9 0

0009

0 0 0 0

他们的特征向量（u＇s 对应 AAT 与 v＇s 对应 ATA）依据特征值的降序排列 o12>o22>o32，这些特征值是 σ2=9，4，1。

0 0 10

3

0 0 0 1

0100

2

0 0 1 0

U=

=

V=

10 00

1

0 1 0 0

0 0 0 1

0

1 0 0 0

U 与 V 的第一列 u1 与 v1 有 1＇s 在位置 3 与 4，则 u1ōv1T 选出原始矩阵 A 的最大数字 A34=3。SVD 的三个秩 1 矩阵（针对这个极端矩阵）确实来自 A 中的 3，2，1。

A= UΣV=3u1ν1 + 2u2vT + 1uzν3T

注解假设我移除 A 的最后一行（都是零），则 A 是一个 3×4 矩阵且 AAT 是 3×3— 它的第四个行与列会消失，我们在 ATA 与 AAT 是对角中仍然有特征值 A=1，4，9，在∑中得到相同的奇异值 σ=3，2，1。

网址：linear.neocities.org 箱：876152660@qq.com 375

移除 A 的零行（现在 3×4）就是移除了 Σ 的最后一行也是 U 的最后一行与最后一列，则（3×4）=UV=（3×3）（3×4）（4×4），SVD 完全可以适应矩形矩阵。

好消息，因为资料矩阵 A 的行与列通常有完全不同的意义（好像电子计算表），如果我们有全部课程的成绩，就会有一列对应每个学生，一行对应每个课程：单元 a 就是成绩，则 u1V1T 会有 1 = 课程的组合与 v1 = 学生的组合，且 1 会是这些组合的成绩：最高的成绩。

矩阵 A 可以计数在期刊的关键字的频率：一个不同文章对应 A 的每个列，一个不同的字对应每个行，全部文章使用矩阵做索引，最重要的信息放在 11v1T，则 σ1 是对应在伪文章 ν1 的一个伪字（字的组合 1）的频率。

段落 7.3 会应用 SVD 至金融与遗传与搜寻引擎。

奇异值稳定对比特征值不稳定

4×4 范例 A 提供了一个特征值不稳定的例子（一个极端案例），假设 4，1 单元从零轻微的变成 1/60000，秩还是 4。

0100

0020

只有 1/60000 的变化

A=0003

产生固有值很大的跳动

60000

2=00，00 变成 2=10°10°10°10

4 个特征值会从零变成落在环绕零的圆上，当新单元只是 1/60000，圆半径是 1/10。当 AAT 远离 ATA，这个情形显示了特征值严重的不稳定。在另一个极端，若 ATA=AAT（一个「正态矩阵」），A 的特征向量是正交而且 A 的特征值全部稳定。

相对来说，任意矩阵的奇异值都是稳定，他们的改变不会比矩阵的改变多。在这个例子中，新的奇异值是 3，2，1 与 1/60000，矩阵 U 与 V 维持不变，A 的新的第 4 片段是 4u4，有 15 个零与小单元 04=1/6000

A 的奇异向量与 S=A①A 的特征向量

方程式（5-6）一口气「证明」了 SVD，奇异向量 v 是 S=ATA 的特征向量 q1，S 的特征值 λ 与对应 A 的 σ2 相同，S 的秩等于 A 的秩。特征向量与奇异向量的扩展是完美对应。

对称 S

S=QAQT=219191++229292T+..+2，9，9，

任意矩阵 A

A=UΣVT=ō1u1v1+σ2u2v22+..+σ，u，v，

请尊重版权与译者的劳动成果，侵权必究！ 376

q＇s 是正交单位，u＇s 是正交单位，v＇s 是正交单位。美丽极了。

但是我想要再看一次，有两个理由。一个是修正一个在特征值部分的弱点，

这个在第六章没有完全处理好。如果 1 是 S 的一个双重根，我们可以也必须找出

两个正交单位的特征向量。另一个理由是看看 SVD 如何在 O2u2v2T 之前选中最大

项 11VIT。我们想要一次一个的了解这些特征值 A（S 的）与奇异值 σ（A 的），而不

是同时进行。

从 S 最大的特征值 A1 开始，它解答了下列问题：

= 大比值，性向 x = 且 = g

（8）

比较 A 的最大奇异值 σ1，它解答了下列问题：

（9）

这个「一次一个的方法」也应用在 λ2 与 σ2，但是不是全部的 x 都是允许的：= 大比值，共中满足 g0x 公获胜

（10）

2 = 极大比值，其中 x 满足 v2x=0，x=v2 会获胜

（11）

当 S=ATA 我们发现 A1=σ12 与 2=022。为什么这个方法会成功？

从比值 r（x）=xSTx/xTx 开始，这个称为「拉里商（Rayleigh quotient）」。要想

极大化 r（x），令它的部分导数为零：Or/0x1=0，其中 i=1，.，n。这些导数很凌乱，

下面是它的结果：针对致胜 x 的一个向量方程式:

当 x 则的导数是零

（12）

所以致胜 x 是 S 的一个特征向量，最大比值 r（x）是 S 的最大特征值 λ1，一切都很

好。现在回到 A - 注意与 S=AA 的关联！

极大化也会极大化（

所以（9）的致胜 x=v1 与（8）的 S=ATA 的最高特征向量 q1 相同。

现在我必须解释为什么 q2 与 v2 是（10）与（11）的致胜向量，我们知道他们与 q2

及 v2 正交，所以允许他们加入竞争。如果读者只想专注在 SVD 的动作（段落 7.3），

这些章节可以作为选读。

网址：linear.neocities.org 箱：876152660@qq.com 377

从任意正交矩阵 Q1 开始，其中 q1 是 Q1 的第一列，其他 n-1 个正交单位列都与

q1 正交，然后使用 Sq1=1q1:

Se1=S12J=112］=2［］

（13）

左乘 Q1T，记得 Q1TQ1=I，确认 Q1TSQ1 如同 S 是对称：

2.se=［

的对称性强迫 w=0 且 Sn-1T=Sn-1

q1x=0 的要求会简化极大值问题（10）变成大小 n-1，Sn-1 的最大特征值会是 S 的

第二大，它是 λ2。（10）的致胜下列会是特征向量 q2，其中 Sq2=λ292。

我们继续前进 — 或是使用神奇的字词「归纳（induction）」－产生所有的特征向

量 q1，.，qn 与对应的特征值 λ1，..，λn。纵使有重复特征值，光谱定理 S=QAQT 仍

然成立，所有的对称矩阵可以对角化。

相似的，从（9）与（11）以及后续方程式，SVD 是一次一个步骤求得，段落 7.4

会展示几何－- 我们在找的椭圆的轴。这里我问一个不同的问题：实际上 λ＇s 与 σ＇s

是如何计算的？

计算 S 的特征值与 A 的奇异值

A 的奇异值 σ1 是 S=ATA 的特征值的平方根，这个会把 SVD 与对称特征值问题

产生关联（很棒），但是最终我们不想计算 ATA（平方很花时间：不好）。

第一个概念是在没有改变任何 s 与 s 的情况下，产生在 A 与 S 的零，奇异

向量与特征向量都会改变－没有问题。相似矩阵 Q~SQ 与 S 有相同的 2＇s，如果 Q

是正交，这个矩阵是 Q①SQ 而且仍然是对称。

段落 11.3 会展示如何从 2×2 旋转建立 Q，使得 QTSQ 是对称而且是三对角（很

多零）。但是旋转无法一路产生对角矩阵，要得到 S 的全部特征值需要一个新概念

以及更多的工作。

针对 SVD，什么会与 QTSQ 对应？现在我们不想改变 A 的任和奇异值。自然

答案：你可以用两个不同的正交矩阵 Q1 与 Q2 去乘 A，利用他们产生 Q1TAQ2 的零，

o＇s 没有改变：

（Q1TAQ2）T（Q1TAQ2）=Q2TATAQ2=Q2TSQ2 得到相同的（A）与 A（S）。

两个 Q＇s 的自由度允许我们得到 Q1AQ2 = 双对角矩阵（bidiagonal）（2 条对角线），

这就完美的达成了 QTSQ=3 对角。注意两者之间的关联是很棒的事情：

（双对角）T（双对角）= 三对角。

对角 A 与对角 Σ 的最终步骤需要更多点子，这个问题不简单，因为表面上我们

在求解 det（S-A）=0，实际上多项式的次数是 n=100 或 1000 或更多，我们的人

不会使用这些多项式。请尊重版权与译者的劳动成果，侵权必究！ 378

在 LAPACK 求取＇s 与 σ＇s 最爱的方法，是使用简单的正交矩阵得到 QTSQ=A

以及 UAV=∑。当非常接近 A 与∑时，我们就停止。

这个两步骤方法（零在前）收录到 eig（S）与 svd（A）。

主要观念的复习

1.SVD 把 A 分解成 U∑VT，其中有 r 个奇异值 σ≥.≥o>0。

2. 数字 σ12，.，σ，2 是 AAT 与 ATA 的非零特征值。

3.U 与 V 的正交单位列是 AAT 与 AA 的特征向量。

4. 这些列支撑了 A 的 4 个基础子空间的正交基底。

5. 这些基底使得矩阵对角化：Av1=σu1，其中 i≤r，这就是 AV=UΣ。

6.A=σ1u1v1T+.+σ，u，v，T 且 σ1 是比值 | Ax|/|x | 的极大值。

已解范例

7.2A 依据名字鉴别下列使得 A 变成列乘行的总和的分解：

1. 正交列

u1ō1，.，u，ō，乘

正交单位行

v1I，..，v，T

2. 正交单位列

91，…4r

乘

三角行

rI，..，r，T

3. 三角列

l1，..，l 乘

三角行

u1T，..，u，T

A 的秩与枢轴与奇异值落在图形的哪儿？

解这三种分解是线性代数的基础，纯数学或是应用数学：

1. 奇异值分解 A=U∑VT

2. 格莱姆－施密特正交化分解 A=QR

3. 高斯消元法 A=LU

你可能偏好分离奇异值 σ1 与高度 h1 与枢轴 d；:

1.A=U∑VT 在 U 与 V 有单位向量，r 个奇异值 σ2 在∑中。

2.A=QHR 在 Q 有单位向量，在 R 有对角线的 1＇s，r 个高度 h；在 H 中。

3.A=LDU 在 L 与 U 对角线的 1＇s，r 个枢轴 d；在 D 中。

每个 h 告知列 i 在列 1 至列 i-1 的平面上方的高度，完整 n 维盒子的体积（r=m=

n）来自 A=UΣVT=LDU=QHR:

|detA|=| o＇s 的乘积 |=|d＇s 的乘积 |=|h＇s 的乘积 |

网址：linear.neocities.org 邮箱：876152660@qq.com 379

7.2B 证明 σ1≥|2|max。最大的奇异值支配所有的特征值。

解从 A=U∑VT 开始，记得左乘一个正交矩阵不会改变长度：‖Qx‖=‖x‖，因为 |‖Qx‖2=xTQTQx=xTx=|‖x|2。这个性质应用到 Q=U 与 Q=VT，在中间的是对角矩阵∑：

‖ Ax ll=ll UEVTxl=ll EVx ll s o ll Vx ls1I

（14）

特征向量 AI|I|IIx|，（14）明 xI||］），］이

同样应用到单位向量 x=（1，0，..，0），现在 Ax 是 A 的第一列，依据（14），这个列的长度≤σ1，每个单元必须有 | aj|≤σ。

方程式（14）再次展示 |‖Ax‖/|2|‖x|‖的极大值等于 σ1。

段落 11.2 会说明在求解 Ax=b 时，比值 omax/omin 掌管舍去误差。如果这个「条件数字」太大，MATLAB 会警告你，这个 x 就不可靠。

问题集 7.2

1 求出下列矩阵的特征值，再从 A①A 求出奇异值：

4-

4-［］

对每个 A，从 ATA 的特征向量创建 V，从 AAT 的特征向量创建 U，检验 A=U∑VT。2 求出 ATA 与 V 与∑与 u1=Av/σ1 以及全部的 SVD:

A=［］-U2v

3 在问题 2，展示 AAT 是对角，它的特征向量 u1，u2 是＿_，它的特征值 12，22 是

。A 的行是正交但是他们不是

，所以 A 的列不是正交。

4 计算 ATA 与 AAT 以及他们对应 U 与 V 的特征值及单位特征向量。

矩形库－3

检验 AV=U∑（这个决定 U 中的 ± 号），∑有与 A 相同的形状：2×3。

5 的行空间足个维，求出在行的与在列空间的

1 为何？为什么没有 2。

请尊重版权与译者的劳动成果，侵权必究！ 380

（b）选择 V 与 U 中的 v2 与 u2，则 A=U∑VT=u1ō1v1T（只有一项）。

【原文是 Uand V，换过来比较合适】

6 把 A 与 AT 的 SVD 代入，展示 ATA 的特征值在∑T∑中，AAT 的特征值在∑∑T 中。对角矩阵∑T∑与∑∑T 有相同的非零数字，我们再次看到 AA 与 AAT 有相同的非零特征值。

7 若（AA）v=2v，左乘 A，移动括号得到（AAT）Av=2（Av）。若 ν 是 ATA 的特征向量，则＿_是 AAT 的特征向量。

8 求出 ATA 的特征值与单位特征向量 v1 与 v2，然后求出 1=Av1/O1:

验证 u1 是 AA①的单位特征向量，计算矩阵 U，∑，V。

SVD

4=［］=n2］［］nw2

9 写下这个 A 的 4 个基础子空间的正交单位基底。

10（a）为什么 AA 的迹等于所有的 a2 的总和？在范例 3 它是 50。

（b）对于每个秩 1 矩阵，为什么 12 等于所有的 a2 的总和？

11 求出 ATA 与 AAT 的特征值与单位特征向量，使得每个 Av=ou。然后创建奇异值分解并且验证 A 等于 U∑VT。

费氏矩阵 A=

12 使用 MATLAB 展示 eigshow 的 SVD 部分求出 v＇s 的图形。

13 若 A=U∑VT 是方形可逆矩阵，则 A-1=_________。检查 A-1A。这个展示了 A1 的奇异值是 1/σ。

注解：A-1 的最大奇异值是 1/min（A），最大的特征值 | 2（A-1）|max 是 1/|（A-1）|min， 则方程式（14）说明了 omin（A）≤|（A-1）|min。

14 假设 u1，..，un 与 v1，.，n 是 Rn 的正交单位基底，创建矩阵 A=UΣVT，把每个 v 变换成 uj 得到 Av1=u1，.，Avn=un。

15 创建秩 1 矩阵使得 Av=12u，其中 v=％（1，1，1，1）与 u=⅓（2，2，1）。它的唯一奇异值是 σ1=__。

16 假设 A 有正交列 w1，w2，.，wn，长度分别是 σ1，σ2，..，σn。SVD 中的 U，∑，V 为何？

17 假设 A 是 2×2 对称矩阵，它的单位特征向量是 u1 与 u2。如果它的特征值是 1=3 与 λ2=-2，则 SVD 中的 U，∑，VT 为何？

网址:linear.neocities.org 箱：876152660@qq.com 381

18 若 A=QR，Q 是正交矩阵，A 的 SVD 几乎与 R 的 SVD 相同。因为 Q，这三个矩阵 U，∑，V 何者产生变化？

19 假设 A 是可逆（1>2>0），对 A 进行尽可能小的改变得到奇异矩阵 A0。提示：U 与 Ⅴ 不变。

从 A=2］［］［v2 求最接近的 An

20 从指令 svd（A）或是手算，求出 A 的奇异值。

为 4 么有

21 为什么 A+I 的 SVD 直接使用∑+I?

22 若 A=UE 则 Q14Q2=（Q1 の「（Q2。为什么任意的正交矩阵 Q1 与 Q2 会使得 Q1U = 正交矩阵且 Q2V = 正交矩阵？然后∑在奇异值中看不到变化：Q1AQ2T 与 A 有相同的 σ＇s。

23 若 Q 是正交矩阵，为什么它的所有奇异值都是 1?

远是 A 的特征向量吗？

26 每个矩阵 A=U∑VT 使得圆变成椭圆。AV=U∑说明圆的半径向量 v1 与 v2 来到椭圆的半轴（semi-axes）o1u1 与 1u2。画出这个圆以及 θ=30° 的椭圆：

段落 7.4 会从关于 2×2 矩阵的一个重要的 SVD 图形开始：

A=（旋转）（拉伸）（旋转），且对称 S=（旋转）（拉伸）（旋转回去）

27 这个问题在寻找所有的矩阵 A，其中 A 给定一个在 Rm 的列空间以及给定一个在 Rn 的行空间。假设 c1，.，c，与 b1，..，b，是这两个空间的基底，然后分别进入 C 与 B 的列，我们的目的是展示 A 有下列形式：

A=CMBT，其中 M 是 rxr 的可逆矩阵。提示：从 A=U∑VT 开始。

U 与 V 的前 r 个列必须借由可逆矩阵与 C 及 B 产生关联，因为他们包含对应相同列空间（在の与行空间（在の的基底。＆

请尊重版权与译者的劳动成果，侵权必究！ 382

7.3 主要分量分析（SVD 做 PCA）

1 资料通常写成矩阵：n 个样本，每个样本有 m 个量测值。

2 减去来自每个量测值的平均使得 A 的每个行中心化。

3SVD 求出包含最多信息的资料的组合。

4 最大的奇异值 1 分最大的方差←u1 中最多的信息。

这个段落说明 SVD 在统计与资料分析的主要应用。我们的例子会来自人类遗

传学与辨识与金融，问题在于了解一个大型的资料（= 量测值）矩阵。我们对 n 个样

本的每一个样本量测 m 个变数，资料矩阵 Ao 有 n 列 m 行。

从图形来看，A0 的列是 Rm 的 n 个点，在减去每一行的平均值之后得到 A，这

n 个点通常会沿着一条直线聚集，或是接近一个平面（或是其他 Rm 的低维子空间）。

这些直线或平面或子空间为何？

让我从图形而不是数字开始，当 m=2 个变数，例如年纪与身高，这 n 个点

落在 R2 的平面。减去平均年纪与平均身高使得资料中心化，如果 n 个重置中心

点沿着直线聚集，线性代数要如何找出这条直线？

A 是 2×n（大的零空间）

× ×

AAT 是 2×2（小矩阵）

+

×

ATA 是 n×n（大矩阵）

×

两个奇异值 σ1>0 の 2>0

× 图 7.2:A 中的资料点通常靠近 R2 的直线或是 R」的子空间。

让我仔细一点来创建资料矩阵。从 A0 的量测值开始，找出每一行的平均值（平

均数 mean），2，..，m，从行 i 减去每个平均数 μ 使得资料中心化，现在中心化

矩阵 A 的每个行的平均值变成零，所以图 7.2 的点（0，0）现在是 n 个点的真正中心。

样本协方差矩阵（covariance matrix）的定义是 S=44

n-1

A 显示来自每个量测值与行平均值 μ 的距离 aj-μi。

（AAT）11 与（AAT）22 显示距离平方的总和（样本方差 s12，s2）。

（AAT）12 显示样本协方差 512=（A 的行 1）（A 的行 2）。

方差是贯穿统计学的关键数字，一个考试的平均成绩 μ=85 告诉你这是一个

相当不错的考试。一个 s2=25（标准差 s=5）的方差表示大部分的成绩都在 80 左

右：密集堆积。一个样本的方差 s2=225（s=15）表示分数是宽广分散。第十二章

会说明方差。

网址：linear.neocities.org 箱：876152660@qq.com 383

数学考试与历史考试的协方差（covariance）是 A 的那些行的点积，这里事先把平均成绩减去。协方差小于零表示：一个科目强另一个科目弱。高的协方差表示：两者都强或是都弱。

我们除以 n-1 而不是除以 n，是基于已知对统计学最好的理由。他们告诉我平均值用掉了一个自由度，剩下 n-1 个。（我想最好的计划是同意他们），任何情况下 n 应该是一个大的数字来得到可靠的统计。既然 A 的行有 n 个单元，AAT 的大小成长的像 n，除以 n-1 维持他们的稳定性。

范例 1 六个数学与历史的成绩（注意每个行的零平均）

4 = 有样本协方

A 的两个行是高度关联：512=25，高于数学平均会有低于历史平均，改变行 2 所有的符号得到负数协方差 s=-25。注意 S 有正数迹与正数行列式；AA 是正定。S 的特征值接近 57 与 3，所以第一个秩 1 片段√57u1v1T 比第二个片段√32v2 大很多。你在图 7.2 的聚集图形看到的是带头特征向量 1 的方向，那个特征向量接近 u1=（.6，.8），而且图形里面的方向近似得到 6-8-10 或是 3-4-5 的直角三角形。

A（中心化资料）的 SVD 展示在聚集图的支配方向。

第二奇异向量 u2 与 1 垂直，第二个奇异值 2≈√3 在量测横跨支配线的散布（spread）情况。如果 A 中的资料点确切落在直线上（u1 的方向），则 σ2 会是零，实际上只有一个 σ1。

主要分量分析（PCA）的重要性

PCA 给你一个方法去了解在维度 m = 量测变数的个数（此处是年纪与身高）的资料图，减去平均年纪与平均身高（n 个样本，每个样本 m=2）得到中心化的 m×n 矩阵 A。这个与线性代数的重要关联在于 A 的奇异值与奇异向量，他们来自特征值 λ=2 以及样本协方差矩阵 S=AAT/（n-1）的特征向量 u。

·资料的总方差（total variance）是所有特征值的总和，也是样本方差 s2 的总和：

总方差 T=12+.+om2=s12+.+sm2 = 迹（对角线的总和）

·S 的第一个特征向量 u1 指向资料最显著的方向，这个方向代表（或是说明）总方差的一个分数 12/T。

·下一个特征向量 u2（与 u1 正交）代表較小的分数の 2/T。

·当这些分数很小时我们就停止，你有 R 个方来向说明大部分的资料。这 n 个资料点非常接近 R - 维子空间，子空间有基底 u1 到 u。这些 u＇s 是在 m - 维空间的主要分量（principal component）。

·R 是 A 的「有效秩」，真正的秩 r 可能是 m 或 n：满秩矩阵。

请尊重版权与译者的劳动成果，侵权必究！ 384

垂直最小平方

有件事情并不广为人知，图 7.2 的最佳直线（直线在 1 的方向）也可以求解垂直最小平方的问题（= 正交回归（regression）:

点到线的距离平方的总合是个极小值。

证明：把每个列 a 分成沿着 u1 线分量与沿着 u2 线的分量:

直角三角形 la，-laJuau

（1）

左侧来自资料点 a（A 的列）的总和是固定的，右侧的第一个总和是 u1TAATu1，所以当我们依据选取特征向量 1 来极大化 PCA 中的总和时，我们要极小化第二个总和，第二个总和（从资料点到最佳线的距离平方）就是垂直最小平方的极小值。

第四章的正常最小平方得到一个线性方程式 AAx=Ab，使用的是点到最佳线的铅锤线（vertical）距离。PCA 产生一个对应 u1 的特征值问题，使用的是垂直（perpendicular）距离。「总最小平方」会允许 A 的误差，如同 b 的误差一般。

【vertical 是铅锤线距离】

样本关联矩阵

资料分析通常是在处理 A（中心化资料），但是 A 的量测值可逆有不同的单位，例如时，磅，年，元。改变一组单位（时到米或年到秒）对于 A 与 S 的行会有巨大影响。如果调整比例是个问题，我们把协方差矩阵 S 改成关联（correlation）矩阵 C:

一个对角矩阵 D 调整 A 的比例，DA 的每一行的长度是√n-1。

样本关联矩阵 C=DAATD/n-1 有 1＇s 在对角线上。

第十二章的概率与统计会介绍期望（expected）协方差矩阵 Ⅴ 以及期望关联矩阵（1＇s 在对角线），这些不是使用实际量测值而是使用概率。协方差矩阵预测未来量测值环绕平均值的分布，此时 A 与样本协方差 S 以及重调比例的关联矩阵 C=DSD 都是使用实际的资料。全部都很重要 — 在统计与正定矩阵的线性代数与 SVD 是一个很大的联结。【SNP：单核苷酸多态性】

遗传变异

我们可以检视染色体（genomes）来追踪人口数量的变异，要管理这么大量的资料件，有一个好方法是从 SNP＇s 观察遗传变异（genetic variation）。不寻常的对偶基因（alleles）（基于来自父亲与母亲的 A/C/T/G 配对）由 SNP 计数：

SNP=0 没有来自人口数量普通基准的改变：正常基因型。

SNP=1 基准配对显示有一个来自正常配对的改变。

SNP=2 两种基准都比普通基因型少。

未中心化的矩阵 A0 有一列对应每个人，有一行对应每个基准配对，矩阵的单元大部分是 0，很多 1，不多的 2。我们不测试全部 300 万个配对。从 A0 减去每行的平均值之后，AA 的特征向量是极端发人深思的。在图 7.4，A 的第一个奇异向量几乎重建了整个欧洲地图。

网址：linear.neocities.org 箱：876152660@qq.com 385

这个表示：来自法国与德国与意大利的 SNP＇s 有很大的不同，就算是来自法

国与德国与瑞士的意大利部分，这些「snips」都不一样！只有西班牙与葡萄牙是

惊讶的混淆并且难以分开。通常来说，每个个人的 DNA 会显示他在 300 公里或

200 英里内的出生地。祖父辈的混合通常安置孙子辈在他们的原始出身之间。

利用小圆

鉴别国家

图 7.3：自然（2008）Novembre et al：vol. 456 pp.98-101/doc：1038/nature07331 什么是最显著的信息？如果我们测试染色体组取去了解他们与疾病的关联，

我们不能忘记他们的空间变异。没有进行地理校正之下，那些看起来医疗上的特

殊意义会有误导性。在医疗基因上混淆是一个严重的问题，PCA 与人口基因可以

帮助求解 — 移除来自没有重要医疗的地理性。

事实上「空间统计」是难以应付的世界。例子：每个有三个对角 1，C，1 的矩

阵显示一个不令人惊讶的影响，其中的影响来自下一个隔门的邻居（来自 1＇s）。但

是它的奇异向量在交叉地图上有正弦与余弦震荡，与 C 无关。你可能想到这些是

真实的「像波」震动，但是他们可能是没有意义的。

也许统计学比数学产生更多的理论？简化大资料成为小信号「P 值」具有指

导性或是极端的误导性。这个 P 值表示法出现在许多矩阵，P 代表与零假设（null

hypothesis，纯机会）一致的概率。如果你在一个行看到 5 个人头的概率是 P=1/32，

这个来自公平铜板的机会（或是 2/32，如果你的观察是连续 5 个人头或是 5 个尾巴）。

通常 P 值小于 0.05 使得零假设是可疑的－- 可能一个骗子在反转铜板。在这里，P

值不是统计学中最可靠的指引－但是他们非常方便。

请尊重版权与译者的劳动成果，侵权必究！ 386

人脸辨识乍看之下 — 第一印象 — 与线性代数无关，但是 SVD 一个早期并且公开

的应用就是人脸辨识。我们不压缩图像，我们辨识它。

计划是从「训练集合」A0 开始，其中 A0 有 n 个变化剧烈的图像。把所有的像

素灰度堆积在一个列，每个图像变成一个非常长的向量，然后 A0 必须中心化：减

去 A0 的每一列的平均值得到 A。

这个 A 的奇异向量 vν1 告诉我们已知人脸的组合，这些组合是新的人脸辨识的

最佳，然后 ν2 告诉我们下一个最佳组合。

我们可能会使用 R 个最佳向量 ν1，.，VR，具有 A 的最大的奇异值 σ1≥.≥σR，

这些在辨识新的人脸会比其他 R 个向量更精确。也许 R=100 个固有人脸

（eigenface）Av 会捕捉在训练集合中几乎所有的变异，这些 R 个固有人脸生成「人

脸空间」。

这个攻击计划是由 Matthew Turk 与 Alex Pentland 所提出，它开发了 Sirovich

与 Kirby 使用 PCA 在压缩人脸图像的成果。我在网上学习了很多来自 Jeff

Jauregui＇s 的描述，他的注解是：PCA 提供透过代数平均值的一个机制去辨识几

何的 / 光度的相似。他组合了第一主要分量（第一奇异向量）进入第一固有人脸，当

然每一列的平均值要加回去否则你看不到一张脸。

注解在一封给 Nature 的信中，PCA 与 NMF 相提并论（Lee 与 Seung， vol. 401，

21Oct.1999）。非负矩阵分解不允许永远出现在奇异向量 ν 的负数单元，所以每

个东西都相加 — 需要更多的向量但是他们通常更有意义。

图 7.4：固有人脸筛选发际线与嘴与眼睛与形状。

网址：linear.neocities.org 箱：876152660@qq.com 387

固有人脸的应用

PCA 人脸辨识的第一个商业用途是法律执行与安全，在 Tampa 举行的超级碗 35

的初期测试得到来自群众非常负面的反应！球迷并不知道这项测试，报纸开始称

它是「窥探（snooper）碗」。我不认为原始固有人脸概念还在商业使用（甚至是保密）。SVD 方法的新应用引来新的鉴定问题：固有声音，固有步伐，固有眼睛，固

有表情。我从 Matthew Turk（现在 Santa Barbara，原来是 MIT 的研究生，他告诉

我他曾经上过我的课。）学习了这个，在它的论文里面固有人脸遇到面部图像的旋

转，比例与光线的问题。但是关键概念还在。

最终，人脸空间是非线性的，所以我们还是需要非线性 PCA。

模型降阶

对于大型规模动态系统，计算成本会变得无法管理，「动态」表示解 u（t）随着时

间变化。流体，化学反应，波传导，生物成长，电子系统，这些问题无所不在。

简化的模型试着去鉴别系统的重要状态，从简化的问题我们计算所需信息的成本

大大的降低。

模式简化在计算方法非常重要，很多优质概念被提出来降低原始大型规模的

问题，一个简单又有用的概念是取得流体的「快照（snapshot）」把他们放进矩阵 A，

找出主要分量（A 的左奇异向量），然后在小很多的子空间中工作：

快照是一个列向量，用来描述系统的状态。

它可以是典型真实状态 u（t）的近似

从 n 个快照，建立一个矩阵 A，它的列生成状态的有用值域

现在求出 A 的前 R 个左奇异向量 u1 到 uR，他们是「本征（proper）正交分解」

的一组基底（POD 基底）。实际上我们选择 R 使得

方差≈能量 σ12+.+σR2 是 99％或 99.9％的 σ12+.+on2

这些向量是重建 A 的快照的最佳基底，如果这些快照选择良好，u1 到 uR 的组合

在预想的时间 t 与参数 p 会很接近确切解 u（t）。

很多都与快照相关！SIAM Review 2015 包含由 Beiner，Gugercin 与 Willcox 提

出的非常棒的总论。SVD 压缩资料也压缩图像。

网络搜寻

我们相信谷歌建立一个追踪网页链接的等级系统，当路径经常到一个网址，等级

就高。访问的频率给出「网页矩阵」的引导特征向量（2=1）- 曾经求解的最大特

征值问题。

马可夫矩阵有超过 30 亿的行与列，来自 30 亿个网址。

请尊重版权与译者的劳动成果，侵权必究！ 388

谷歌持有很多重要科技，他们可能从早期的特征向量开始作为近似值，然后快速进行随机路径。为了得到较高等级，你希望从重要网址得到很多链接。

这是 SVD 在搜寻引擎的一个应用，当你搜寻一个字词，依据重要性你得到一个网址列表，你可以试着键入「4 个子空间」。

HITS 演绎法是较早得到等级列表的方法，它从关键字的索引的大约 200 个网站开始，之后我们只观察页与页之间的链接，搜寻引擎是链接基而不是内容基。

从 200 个网站开始与所有链接他们以及他们链接的网站，这是我们义序放置的列表，可以使用连入与连出来衡量重要性。

1. 网站可能是权威：有很多进入的链接，特别是从核心来的链接。

2. 网站可能是核心：有很多列表中外出的链接，特别是到权威。

我们希望数字 x1，.，xN 去衡量权威的等级以及 y1，..，yN 去衡量核心的等级。从一个简单的计数开始：x0 与 y0 计数网站 i 的连入与连出。

此处是重点：一个优质权威有从重要网站来的链接（比如核心），从大学来的链接比来自朋友的链接比重大一点。一个优质核心要链接到重要网站（比如权威）。链接到 amazon.com 不幸的比 welleseleycambridge.com 来的重要。初步计数 x 与 y0 借由优质链接更新成 x1 与 y1（利用 x0 与 y0 量测他们的品质）:

权威 / 核心 x1/y3=y°/x° 的累加，对所有的连入 i / 从 i 连出

（2）

用矩阵语言来说这些是 x1=ATy0 与 y1=Ax0，矩阵 A 包含 1＇s 与 0＇s，其中 a=1 当 i 连到 j。用图形的语言来说，A 是一个网络的「相邻矩阵」（巨大的矩阵）。新的 x1 与 y1 给出较好的等级，但不是最佳。再走像（2）的一步，从 ATAx° 与 AATy 到达 x2 与 y2:

权威 x2=ATy1=ATAx0 核心 y2=Ax1=AATy

（3）

在两步内我们用 ATA 与 AAT 去乘，20 步用（ATA）10 与（AAT）10 去乘。当我们取次方时，最大的特征值 2 开始支配，向量 x 与 y 会跟 ATA 与 AAT 的带头特征向量与 1 对齐。我们在计算 SVD 的顶端项，利用会在段落 11.3 讨论的次方方法，它是线性代数协助了解网络的奇妙方法，

这个 HITS 演绎法在 1996 科学美国（Jan16）有描述，但是我不认为有提到 SVD。最佳的书籍是 Langville 与 Meyer 写的」谷歌页等级与之上」，说明了搜寻引擎的详细科学。

网址：linear.neocities.org 箱：876152660@qq.com 389

金融中的 PCA：利率的动力学

金融数学持续使用线性代数与 PCA，我们选择一种应用：国库债券的收益曲线。收益是指国债，票据与债券的利率支付。利率与到期时间有关，长期国债（3 年到 20 年）的利率随长度增加，美联储调整短期收益来减慢或刺激经济。这是收益曲线，被风险管理师与证券商与投资者广泛使用。

这是 2001 年前 6 个营业日的资料－每一列是在某个特定日的投资收益曲线，到期时间是「期限」，在左边的 6 列是利率，每天都在变化。右侧的 5 列是天与天之间的利率差分，其中每行已经减去各行的平均差值。这是中心化矩阵 A，它的行的总和是零。一个实际世界的应用可能从 252 个营业日开始，而不是只有 5 或 6 天（一年而不是一星期）。

表 1 美国国债收益：6 天与 5 个中心化每日差

2001 年美国国债收益

基底点（0.01％）的矩阵 A

期限 Jan 3 Jan 4 Jan 5 Jan 6 Jan 7 Jan 10 Jan 4 Jan 5 Jan 6 Jan 7 Jan 10

3 MO 5.87 5.69 5.37 5.12 5.19 5.24 －5.4-19.4-12.4 19.6 17.6

6 MO 5.58 5.44 5.20 4.98 5.03 5.11 －4.6-14.6-12.6 14.4 17.4

1YR 5.11 5.04 4.82 4.60 4.61 4.71 1.0-14.0-14.0 9.0 18.0

2 YR 4.87 4.92 4.77 4.56 4.54 4.64 9.6-10.4-16.4 2.6 14.0

3 YR 4.82 4.92 4.78 4.57 4.55 4.65 13.4 －10.6 －17.6 1.4 13.4

5YR 4.76 4.94 4.82 4.66 4.65 4.73 18.6-11.4-15.4-0.4 8.6

7 YR 4.97 5.18 5.07 4.93 4.94 4.98 20.8-11.2-14.2 0.8 3.8

10 YR 4.92 5.14 5.03 4.93 4.94 4.98 20.8-12.2-11.2-0.2 2.8

20 YR 5.46 5.62 5.56 5.50 5.52 5.53 14.6 －7.4 －7.4 0.6 －0.4

MO：月；YR：年； Jan：一月

从这 5 列我们可以预期 5 个奇异值，但是这 5 个列向量的总和是零向量（由于 A 的每一行在中心化之后的总和是零行），所以 S=AAT/（5-1）有 4 个非零特征值 12>02>o32>42。下列是奇异值 o；与它们的平方 o，2 以及全部方差 T=2+.+σ42=S 的迹的比例，由每个主要分量（S 的每个特征向量 u2）来解释：

σi

σ？

2/T

主要分量 1 36.39

1323.9

.7536

主要分量 2 19.93

397.2

.2261

13 5.85

34.2

.0195

主要分量 L4 1.19

1.4

.0008

主要分量 5 0.00

0.0

.0000

T= 1756.7

1.0000

「陡坡图」画出这些比例 σ2/T 很快掉落到零，在大问题中你通常会看到在底部的平坦部分之后快速的衰减（接近 2=0）。在这两部分之间标示肘部（显著与不显著 PC＇s）非常重要。

请尊重版权与译者的劳动成果，侵权必究！ 390

我们的目标在了解每个主要分量，这些 A 的奇异向量 u2 是 S 的特征向量，这些向量的单元是「负载」。下列是对应范例收益曲线的 u1 到 u5（Su5=0）。

41

u2

u4

us

3 MO

0.383

0.529 －0.478

0.060

0.084

6 MO

0.336

0.436 －0.046

0.210 －0.263

1 YR

0.358

0.263

0.225 －0.491

0.237

2 YR

0.352 －0.028

0.460

0.096

0.242

3 YR

0.371

－0.131

0.430

－0.555

5 YR

0.349

－0.293

0.117 －0.188

0.446

7 YR

0.323

－0.365

－0.228

0.459

0.081

10 YR

0.297

－0.378

－0.351

－0.579

－0.470

20 YR

0.184

－0.280 －0.361

0.227

0.268

这 5 个 u＇s 是正交，他们给出 A 的 4 维列空间的一组基底以及 AT 的 1 维零空间的基底。他们有什么样的金融意义？

1 量测 9 个收益每天变化的权重平均

2 量测长期与短期债券之间的收益分布的每天变化

u3 显示曲线的每天变化（短期债券对中期）

这些图形展示 u1，u2，u3 的 9 个负载，从 3 个月到 20 年。

来自典型指令（以 R 撰写）的输出会包含额外两个表－这些我们的书本网站。一个会展示 A 的右奇异向量 v2，这些是 ATA 的特征向量，他们与向量 ATu 成正比，他们有 5 个分量，他们显示收益的移动以及本周的短－长分布。

全部方差 T=1756.7（S 的迹 12+22+32+42）也是 S 对角线单元的总和，这些是 A 的行的样本方差，他们是：s12+..+s92=

313.3+225.8+199.5+172.3+195.8+196.8+193.7+178.7+80.8=1756.7。每个 s2 小于 12，且 1756.7 也是 ATA/（n-1）的迹：列方差。

注意段落 7.3 的 PCA 是处理 A 的中心化行，在某些应用（例如金融），通常会转置矩阵以及中心化列，然后样本协方差矩阵 S 使用 ATA，以及 v＇s 是更重要的主要分量。实用说明的线性代数告诉我们这么多。

网址：linear.neocities.org 箱：876152660@qq.com 391

问题集 7.3

1 假设 A0 保持 5 个样本的 2 个量测值：

找出每行的平均值然后减去得到中心化矩阵 A，计算样本的协方差矩阵 S=AA（n-1）以及它的特征值与。哪条通过原点的直线与 A 的列的 5 个样本最接近？

2 针对下列矩阵 A0，使用问题 1 的步骤：

3 木方差与以及か方差是的年元当－求出 S 去平均值之后），σ1 为何？

4 从 S=AAT 的特征向量，求出与三维空间中的这 4 个点最接近的直线（通过中心点的 u1 方向）以及平面（u1，u2 的方向）:

5 从样本的协方差矩阵 S，找出关联矩阵 DSD，其中有 1＇s 沿着主对角线。D 是产生这些 1＇s 的正数对角矩阵。

6 选择对角矩阵 D 产生 DSD，求出关联 C:

卡 25

7 假设 A0 是一个 5×10 的矩阵，其中包含 5 个课程 10 年的平均成绩，你如何建立中心化矩阵 A 以及样本协方差矩阵 S? 当你发现 S 的带头特征向量，它会告诉你什么？请尊重版权与译者的劳动成果，侵权必究！ 392

7.4SVD 的几何

1 典型方形矩阵 A=UZVT 分解成为（旋转）（拉伸）（旋转）。

2 几何显示 A 如何把圆上的向量 x 变换到椭圆上的 Ax。

3A 的范数（norm）是 | A|=σ1，这个奇异值是它的最大的成长因子 | Ax|/|x|。4 极分解把 A 分解成 QS；旋转 Q=UVT 乘拉伸 S=V∑VT。

5 伪逆（pseudoinverse）A+=V∑+UT 把列空间的 Ax 带回行空间的 x。

SVD 把一个矩阵分成三个步骤：（正交）×（对角）×（正交）。潜藏的几何可以用平常的

字词表示：（旋转）×（拉伸）×（旋转）。UZVx 从旋转开始得到 VTx，然后 Z 拉伸向量

来到∑VTx，然后 U 旋转到 Ax=U∑VTx。以下是图形。

A

VT

Σ

บ

U2

σ2

σ1

σ2U2

01

σ1U1

图 7.5:U 与 V 是旋转与可能的反射。∑把圆拉伸成椭圆。

不可否认，这个图是应用在 2×2 矩阵，而且表示每一个 2×2 矩阵，因为 U 与 V

不允许反射－全部三个矩阵都有行列式 > 0。A 必须是可逆，因为所示的三个步

骤都是可逆：

（1）

矩阵 A 的 4 个数字 a，b，c，d 得到在 SVD 的 4 个数字 6，σ1，σ2，φ。

图形会引导我们领悟在矩阵代数的三个简洁概念：

1 矩阵的范数 | 4|‖— 它的最大的成长因子。

2 极分解 A=Qs— 正交 Q 乘正定 S。

3 伪逆 A+— 当矩阵 A 不可逆时的最佳逆矩阵。

网址：linear.neocities.org 箱：876152660@qq.com 393

如果让我在图形中选择一个重要数字，它会是 σ1，这个数字是对于任意向量 x 的最大成长因子。如果你追踪在左侧的向量 v1，你会看到它旋转到（1，0）然后拉伸到（1，0），最终旋转到 1u1，这个叙述 Av1=1u1 就是 SVD 方程式。这个最大的奇异值 σ1 是矩阵 A 的范数（norm）。

（2）

MATLAB 使用 norm（x）求向量长度以及相同的词 norm（A）求矩阵的范数。数学符号有两个竖棒：|x | 与 | A|，此处 | x | 表示向量的标准长度 | x|2=|x1|2+.+|xm|2。当 x =v1 且 Ax=1u1 且 | Ax|/|x|=1 = 最大比值 =|A | 时，矩阵范数来自向量范数。数字 norm（A）有两个直接来自定义的重要性质：

三角不等式 |A+B|≤|A|‖+‖B‖|

乘积不等式 ILABI ILAI IBII

（3）

定义（2）说明对于每个 x，‖|Ax‖≤|A|‖|x|，这是我们知道的！向量的三角不等式得到矩阵的三角不等式：

手向量 IIA+B）||IBI|III

除以 | x|，取对于所有 x 的极大值，则 | A+B|≤|A|‖+‖B|‖。

乘积不等式快速来自‖|ABx|‖≤‖A|‖|‖Bx|‖≤‖A‖‖B|‖|‖x|‖

再次除以 | x|，取对于所有 ⅹ 的极大值，结果是 | AB‖≤‖|A‖‖B|‖。

范例 1 最基本可以得到的秩 1 矩阵是 A=u，它有一个非零特征值与一个非零奇异值 σ1。简单的说，特征向量是 μ 且它的奇异向量（左与右）是与 ν。

特征向量

Au = （uv）u = u（νu） =λιu

所以 λ1=vTu

奇异向量

A＇Av=（vu＇） （uv）v= v（u＇ u）（vv） = av

所以 이IlIl

它使得你感觉良好，因为 | h1|≤σ1 就是施瓦茨不等式 | vu|≤|u‖‖v|。

们如何知道 | 21|≤σ？Ax=λ1x 的特征向量会得到比值 | Ax|‖/|x|=‖21x|/|x | 就是 | 21|。最大的比值 σ1 不可能比 | 21 | 小。

|2|≤σ2 也是正确吗？不是！这是完全错误。事实上一个 2×2 矩阵会有 | detA|= |2122|=102。在 | 21|≤σ 的情况下，必然强迫 | 2|≥02。

请尊重版权与译者的劳动成果，侵权必究！ 394

最接近 A 的秩 k 矩阵是 Ak=1u1v1T+..+kukVkr。

这是矩阵近似的关键事实：Eckart-Young-Mirsky 定理说明

|A-B|≥|A-Ak|=σk+1，对所有的秩 k 矩阵 B

对我来说这个完成了线性代数的基础定理，v＇s 与 u＇s 给出了 4 个子空间的正交单位基底，前 k 个 v＇s 与 u＇s 与 σ＇s 给出了近似 A 的最佳矩阵。

极分解 A=QS

每个复数 x+ⅳ 有极形式 rei0，一个数字 r≥0 乘一个在单位圆的数字 eiθ，我们有 x+iy=rcos0+irsin0=r（cos0+isin0）=rei0。把这些数字当成 1×1 矩阵，则 ei 是一个正交矩阵 Q 以及 r≥0 是一个正半定矩阵（称为 S）。极分解（polardecomposition）延伸这个概念到 n×n 矩阵：正交乘正半定，A=QS。

每个实数方形矩阵可以分解成 A=QS，其中 Q 是正交且 S 是对称正半定。

若 A 是可逆，则 S 是正定。

为了证明我们在 SVD 的中间插入 VTV=I:

极分解 A=UZVT=（UVT）（V2VT）=（Q）（S）

（4）

第一个因子 UVT 是 Q，正交矩阵的乘积是正交。第二个因子是 VΣVT 是 S，它是正半定，因为它的特征值在 Σ 中。

若 A 可逆，则∑与 S 也是可逆，S 是 ATA 的对称正定平方根，这是因为 S2=V22VT=ATA，所以 S 的特征值是 A 的奇异值，S 的特征向量是 A 的奇异向量。

还有一种相反顺序的极分解 A=KQ，Q 相同，但是现在 K=UZUT，则 K 是 AAT 的对称正定平方根。

范例 2 段落 7.2 的 SVD 范例是 A==U2V。求出极分解 A=QS 的因子 Q 与 S（旋转与拉伸）。

解我只是从段落 7，2 复制 U 与∑与 V:

Q-UVT--

s2 部 |｝则 A=QS

在力学中，极分解把旋转（在 Q）与拉伸（在 S）分开，S 的特征值给出拉伸因子如图 7.5 所示，S 的特征向量给出拉伸方向（椭圆的主轴）。正交矩阵 Q 包含两个旋转 U 与 VT。

此处有个关于旋转的事实。Q=UV 是 A 的最近（nearest）正交矩阵，Q 使得范数 | Q-A | 尽可能最小，对应的事实是 e 是在单位圆上与 re 最接近的数字。

网址：linear.neocities.org 箱：876152660@qq.com 395

SVD 告诉我们一个有关最近奇异矩阵更为重要的事实：

A 的最近奇异矩阵 A0 等于把最小的 min 变成零

所以 omin 在于量测从 A 到奇异的距离，等于范例 2 的矩阵，这个距离 omin=√5。如果我把 min 改成零，这个排除了在 A=1u1v1T+O2u2v2T 中最后（最小）一个片段，这个最小的改变有范数の 2=√5（小于 3）

在计算实践时我们通常会排除一个非常小的 σ，处理奇异矩阵要比与零太接近而未注意好得多。

伪逆 A+

为了选择优质基底，A 乘行空间中的 v 得到列空间中的 u，A 必须做相反的事情！若 Av=ou 则 A-u=v/o，A1 的奇异值是 1/o，就如同 A1 的特征值是 1/2。基底逆反了，u＇s 在 A~` 的行空间，v＇s 在列空间。

直到现在我们还没有加上「若 A~ 存在」，现在还不要！乘 u 得到 v/σ1 的矩阵确实存在，它是伪逆矩阵 A+:

A 的伪逆：A+=V∑+UT=［v1.V.Vn］

［u1..u，..um］T

0

nxn

n×m

m×m

伪逆 A + 是一个 n×m 的矩阵，若 A-1 存在（再说一次），则 A + 与 A~1 相同。在这个情况下 m=n=r，我们是在逆反 UΣVT 得到 V∑－1UT。新符号 A + 在 r<m 或 r<n 才需要，则 A 没有双边逆矩阵，但是它有一个伪逆矩阵 A+，秩也一样是 r:

A+u1=v:/o；，其中 i≤r 且 A+u1=0，其中 i>r

在 A 的列空间中的向量 u1，.，u，回到行空间中的 v1，.，vr。其他向量 u，+1，.，um 在左零空间中，而且 A 把他们变成零。当我们知道这些基底发生什么事情，我们就了解 A+。

注意对角矩阵∑的伪逆，∑的每个 σ 被∑+ 的 σ1 取代，乘积∑+∑是尽可能的接近单位矩阵，它是一个投影矩阵，∑∑是一定程度上的 I 而且其他是零。我们可以逆反 s，但是我们不会对零行与零列做任何事情。这个例子有 o1=2 与 02=3:

0

伪逆 A + 是 n×n 矩阵使得 AA + 与 A+A 成为投影。

请尊重版权与译者的劳动成果，侵权必究！ 396

A 行空间到列空间

A 列空间到行空间

列空间

行空间

Atp=x+

x+

= Ax+

=AA+b

A+b=x+

6

0

0

A+e=0

e

AT 的

伪逆 A+

零空间

零空间

AA=［68 行空间

零空间

图 7.6：列空间中的 Ax + 回到行空间中的 A+Ax+=x+。

学试 A=AA=1

AA+= 在 A 的列空间的投影矩阵

A+A = 在 A 的行空间的投影矩阵

范例 3 每个秩 1 矩阵是一个列乘一个行，在与 ν 是单位向量的情况下就是 A=ouvT，它的伪逆是 A+=vuT/σ，乘积 AA+=uuT，就是在通过 u 的直线的投影。乘积 A+A=vνT。

范例 4 求出 A - 的这阵这个矩阵不可，秋楚 1，唯一的奇异值是 1=2，在∑+（也是秩 1）中变成 1/2。

A 也是秩 1，它的列空间永远是 A 的行空间。

相关列的最小平方

段落 4.3 关于最小平方有一个有 4 个 1＇s 的矩阵 A，它打破了无关列的要求。当我们同时在 t=1 制作两个量测值是，这个矩阵出现了。最接近的直线是沿着量测值 3 与 1 之间的直线，但是没有办法决定最佳线的斜率。

在矩阵语言来说，ATA 是奇异，方程式 ATAx=ATb 有无限多解，伪逆矩阵给出一个方法去选择一个「最佳解」x+=A+b。

网址：linear.neocities.org 邮箱：876152660@qq.com 397

让我重复无解的 Ax=b 于 1 无限多解的 AAx=A1b:

任意向量 x=（1+c，1-c）会是这些正态方程式 ATAx=ATb 的解。伪逆矩阵的目的是选择一个解 x=x+。

x+=A+b=（1，1）是 ATAx=ATb 与 Ax =p 的最短（shortest）解。

你可以看到 x+=（1，1）比其他解 x=（1+c，1-c）都要短，的长度平方是（1+c）2+（1-c）2=2+2c2，最短的选择是 c=0，得到解 x+=（1，1）在 A 的行空间中。

几何告诉我们 A 应该做的事情：把 A 的列空间带回到行空间，两个空间都有维度 r，把误差向量 e 扼杀在 A 的行空间。

伪逆 A + 与最佳解 x 在统计学非常重要，因为实验通常有相关列的矩阵，也会有相关行。

主要观念的复习

1. 向量 Ax 的椭圆有轴沿着奇异向量 u1。

2. 矩阵范数 | A|=σ1 来自向量长度：极大化 | Ax|/|x|。

3. 可逆矩阵 =（正交矩阵）（正定矩阵）：A=QS。

4. 每个 A=U∑VT 有一个伪逆 A+=V∑+UT，会把 N（AT）送到 Z。

已解范例

7.4A 若 A 有秩 n（满列秩），则它有一个左逆矩阵 L=（ATA）-1AT，矩阵 L 给出 LA=I，说明为什么这个情况下伪逆是 A+=L。

若 A 有秩 m（满行秩），则它有一个右逆矩阵 R=AT（AAT）1，矩阵 R 给出 AR=I，说明为什么这个情况下伪逆是 A+=R。

求出对应 A1 的 L 与对应 A2 的 R。求出所有 3 个矩阵 A1，A2，A3 的 A+:

A=

4-2 习 4-〖

请尊重版权与译者的劳动成果，侵权必究！ 398

解若 A 有无关列，则 ATA 可逆 — 这是段落 4.2 的重点。当然 L=（ATA）1AT 乘 A 得到 LA=I：一个左逆矩阵。

AL=A（ATA）1AT 是在列空间的投影矩阵（段落 4.2），所以 L 满足 A + 的要求：LA 与 AL 是在 C（A）与 C（AT）的投影。

若 A 有秩 m（满行秩），则 AAT 可逆，当然 A 乘 R=AT（AAT）1 得到 AR=I。相反的顺序之下，RA=AT（AAT）1A 是在行空间（AT 的列空间）的投影矩阵，所以 R 等于伪逆矩阵 A+。

例子 A1 有满列秩（对应 L）以及 A2 有满行秩（对应 R）:

A+=（41A）A=［22］42+=42（A2）=［］

注意 A1+A1=［1］以及 A2A2+=［1］，但是 A3 没有左或右逆矩阵，它不是满秩，它的伪逆把 A3 的列空间带回到行空间：

4

问题集 7.4

问题 1-4 计算并使用特定矩阵（不是可逆）的 SVD。

1（a）计算 ATA 以及特征值与单位特征向量 v1 与 v2。求出 σ1。

秩 1 矩阵 A=［］

（b）计算 AAT 以及特征值与单位特征向量 u1 与 u2。

（c）验证 Av1=1u1。把数字放进 A=UEVT（这是 SVD）。

2（a）从问题 1 的 u＇s 与 v＇s 写出矩阵 A 的 4 个基础子空间的正交单位基底。（b）描述拥有相同 4 个子空间的所有矩，是 A 的倍数吗？

3 从问题 1 的 U，V 与∑，求出正交矩阵 Q=UVT 与对称矩阵 S=VZVT。验证极分解 A=QS，S 只有正半定，这是因为＿__。测试 S2=A。

4 计算伪逆 A+=V∑+UT，对角矩阵∑+ 包含 1/1。重新命名图 7.6 的 4 个（A 的）子空间成为 A + 的 4 个子空间。计算在 A 的行空间与列空间的投影 A+A 与 AA+。

网址：linear.neocities.org 箱：876152660@qq.com 399

问题 5-9 有关可逆矩阵的 SVD。

5 计算 AA 以及特征值与单位特征向量 v1 与 v2。求出矩阵 A 的奇异值 1 与 2:6AAT 与 ATA 有相同的特征值 O12 与 O22，求出 AAT 的单位特征向量 u1 与 u2。把数字放进 SVD：=｝=4 的「。n

7 在问题 6，计算列乘行展示 A=1u1v1T+2u2v2T。由 A=UVT 证明每个秩 r 的矩阵是 r 个秩 1 矩阵的总和。

8 从 U，V 与 E，求出正交矩阵 Q=UVT 与对称矩阵 K=UZUT。验证相反顺序的极分解 A=KQ。

9A 的伪逆 A + 与相同，这是因为

问题 10-11 计算并使用 1×3 矩形矩阵的 SVD。

10 当矩阵 A=［340］，计算 AA 与 AA 以及他们的特征值与单位特征向量。A 的奇异值为何？

11 把数字放进 A 的奇异值分解:

A=［3 4 0］=［µ1］［σ¡ 0 0］［ν1 ν² ν3］

把数字放进 A 的伪逆 V∑+UT，计算 AA + 与 A+A:

伪逆

12 唯一没有枢轴且没有奇异值的 2×3 矩阵为何？这个矩阵的∑为何？A 是零矩阵，但是它的形状为何？

13 若 detA=0，为什么 detA+=0? 若 A 有秩 r，为什么 A + 有秩 r?

14 在单位圆 | x|=1 的向量，在椭圆的向量 y=Ax 会有 | A~y|=1，这个椭圆有沿着奇异向量的轴，其中长度是 σ，.，σ，（如图 7.5）。对于 A=［21；12］，扩展 yP2=1

请尊重版权与译者的劳动成果，侵权必究！ 400

问题 15-18 带出 A + 的重要性质以及 x+=A+b。

15 本题的所有矩阵都有秩 1，向量 b 是（b1，b2）。

（a）方程式 ATAx=ATb 有很多解，这是因为＿__。

（b）验证 x+=A+b=（.2b1+.1b2，.2b1+.1b2）是 ATAx=ATb 的解。

（c）把 x + 加上（1，－1）得到另一个 ATAx=ATb 的解，证明 | x|2=|x+|2+2 并且 x + 比较短。

16 向量 x+=A+b 是 ATAx=ATb 最短的可能解。理由：x-x + 的差在 ATA 的零空间中，这也是 A 的零空间，与 x + 正交。说明如何推论 ||2=|x+|2+‖－x+|2。17 Rm 中的每个 b 是 p+e，这是列空间的部分加上左零空间的部分。R＂中的每个 x 是 x2+xn，这是行空间的部分加上零空间的部分。则

AA+p=_AA+e=___A+Ax+=__A+Axn=____

18 对于矩阵 A=U∑VT 与下列的 b，求出 A + 与 A+A 与 AA + 与 x+:

4--｝-5-［3

19 一个普通的 2×2 矩阵 A 由 4 个数字决定。如果是三角形，由 3 个数字决定。如果是对角，由 2 个决定。如果是旋转，由 1 个决定。如果是单位特征向量，也是由 1 个决定。检验 A 的每个分解，所有的计数都是 4 个：

4 个数字在 LU LDU QR UZVT XAX1

20 追踪问题 18，检验 LDLT 与 QAQT 是由 3 个数字决定。这是正确的，因为矩阵现在是。

21 由 A 与 A，证明 AA 是正确并且（AA）2=AA = 投影

A-on 4 － 44-Xv A4-an

2 异向量 m 与 y 的每个配对都有与证明双重向进｜是对 A 的对

角化。

网址：linear.neocities.org 箱：876152660@qq.com 401

第八章

线性变换

8.1 线性变换的概念

1 线性变换 T 使得每个向量 ν 变成 T（v），线性需要 T（cv+dw）=cT（v）+dT（w）。注意 T（0）=0，所以 T（v）=v+u0 不是线性。

2 输入向量 ν 与输出 T（v）可以在 R」或是矩阵空间或是函数空间。

3 若 A 是 m×n，T（x）=Ax 是从输入空间 R＂到输出空间的 R」的线性。

4 导数 T（f）=df/dx 是线性，积分 T+（f）=f（t）dt 是它的「伪逆」。

5 两个线性变换的乘积 ST 仍然是线性：（ST）（v）=S（T（v）。

当一个矩阵 A 乘一个向量 v，矩阵把 v 变换成另一个向量 Av，输入 v 输出 T（y）=Av。变换 T 遵循函数的概念，输入一个数字 x，输出 f（x）。对于一个向量 ν 或是一个数字 x，我们左乘矩阵或是计算函数。更深的目标是同时看到所有的向量 ν，当我们把 A 乘上每个 ν，我们在变换整个空间 V。

再次从矩阵 A 开始，它把 ν 变换成 Av，把 w 变换成 Aw，我们知道对于 u=v+w 会发生什么，毫无疑问是 Au，它必须等于 Av+Aw。矩阵乘法 T（v）=Av 得到线性变换：

一个变换 T 指定一个输出 T（v）给 Ⅴ 中的每个向量 ν。如果它满足下列对于

所有 ν 与 w 的要求，则这个变换是线性：

（a） T（v+w）=T（v）+T（w）。（b）T（cv）=cT（v），对所有的 c

请尊重版权与译者的劳动成果，侵权必究！ 402

如果输入 v=0，输出必须是 T（v）=0。我们结合（a）与（b）得到一项要求：

线性变换

T（cv+dw）必须等于 cT（v）+dT（w）

我再次测试矩阵乘法的线性：A（cv+dw）=cAv+dAw 成立。

线性变换非常严格，假设 T 把 u0 加到每个向量，则 T（v）=v+uo 且 T（w）=w+u0。这个不好，或至少它不是线性。把 T 应用在 ν+w 得到 v+w+uo，这个与 T（v） +T（w）不相同：

平移不是线性 v+w+u 不是 T（）+T（）=（v+u）+（w+u0）

当 u0=0 会是例外，变换简化成 T（v）=v，这是单位变换（没有改变，好像左乘单位矩阵），这个当然是线性。在此情形下，输入空间 V 与输出空间 W 相同。线性加平移变换 T（v）=Av+u0 称为「仿射（affine）」，直线维持直线，虽然 T 不是线性。段落 10.6 介绍电脑利用仿射变换处理图形。

范例 1 选择一个固定向量 a=（1，3，4），令 T（v）是点积 a·v:

输入是 v=（V1，V2，V3）

输出是 T（v）=a.v=v1+3v2+4v3

点积是线性，输入 ν 来自三维空间，所以 V=R3，输出只是个数字，所以输出空间是 W=R1。我们是左乘行矩阵 A=［134］，则 T（v）=Av。

你将会精通辨识哪些变换是线性，如果变换包含平方或乘积或长度，v12 或 v1v2 或 |ν‖|，则 T 不是线性。

范例 2 长度 T（v）=‖ν| 不是线性，线性的要求（a）是 | v+w‖=‖v‖+‖w‖，要求 （b）是 |‖cv‖=c|‖ν|‖，两者都失败。

不满足（a）：三角形的边长满足不等式‖+wII‖II‖

不满足（b）：长度 |‖－v‖=‖ν‖不是－|‖ν‖，对于负数 c，失败。

范例 3（旋转）T 是把每个向量旋转 30° 的变换，T 的「定义域（domain）」是 xy 平面（所有的输入向量 v），T 的「值域（range）」也是 xy 平面（所有旋转后的向量 T（v）。我们没有用矩阵来描述 T：把平面旋转 30°。

旋转是线性吗？是的。我们可以旋转两个向量，以及把结果相加。旋转的总和 T（v）+T（w）与总和的旋转 T（v+w）相同。整个平面在这个线性变换中一起转动。

网址：linear.neocities.org 邮箱：876152660@qq.com 403

直线到直线，三角到三角，基底说明一切

图 8.1 显示输入空间中从 ν 到 w 的直线，它也显示了输出空间中从 T（v）到 T（w）的直线。线性告诉我们：输入直线的每个点映射到输出线，更多的是：等空间点映射到等空间点。中点 u=⅓v+⅓w 映射到中点 T（u）=2T（v）+2T（w）。

第二个图形提升了一个维度，现在我们有三个角点 V1，V2，V3，这些输入有三个输出 T（v1），T（v2），T（v3）。输入三角形映射到输出三角形，等空间点仍然是等空间点（沿着边，在两个边之间），中点 u=（v1+V2+v3）映射到中点 T（u）=（T（v1）+T（v2） +T（v3）。

T（V3）

T（v1

T（

T（и

T（и）

и

U3

и

T（w 02

T（V2）

图 8.1：直线到直线，等空间到等空间，u=0 到 T（u）=0。

线性的规则延伸到三个向量或是 n 个向量：

线性

u=C1V1+C2v2+.+CnVn 必须变换到

T（u）=c1T（v1）+c2T（v2）+..+cnT（vn）

（1）

两个向量的规则开始三个向量的证明：T（cu+dv+ew）=T（cu）+T（dv+ew），同时对两侧使用线性规则，得到 cT（u）+dT（v）+eT（w）。

n - 向量规则（1）得到线性变换最重要的事实：

假设你知道一组基底的向量 v1，..，vn 的变换 T（v）

则你会知道在空间中的每个 u 的 T（u）。

你看到理由：空间中的每个是基底向量 v 的一个线性组合，线性告诉我们 T（u）是输出 T（ッ）的相同组合。

请尊重版权与译者的劳动成果，侵权必究！ 404

范例 4 变换 T 取得输入的导数：T（u）=du/dx。

你如何求得 u=6-4x+3x2 的导数？你从 1，x 与 x2 的导数开始，这些是基底向量。他们的导数是 0，1，2x，然后你使用线性求出这些导数的任意组合：

du=6（1 的导数）-4（x 的导数）+3（x2 的导数）=-4+6x

dx

所有的微积分都依靠线性！初级微积分有一些对于 x」与 sinx 与 cosx 与 e 的关键导数，然后应用线性到他们所有的组合。

我会说微积分唯一比较特殊的规则是链条规则（chain rule），产生链条函数 f（g（x）的导数。

T（u）=du/dx 的零空间。我们求解 T（u）=0 得到零空间，当 u 是常数时它的导数是零，所以一维零空间是函数空间中的一条直线 — 这个特殊函数 u=1 的所有倍数。T（u）=du/dx 的列空间。我们的例子中，输入空间包含所有的二次式 a+bx+cx2，输出（列空间）是所有的线性函数 b+2cx。注意：「计数定理」仍然成立：r+（n- r） = n. 维度（列空间）+ 维度（零空间）=2+1=3 = 维度（输入空间）

d/dx 的矩阵为何？我不能离开导数而不提矩阵，我们有一个线性变换 T=d/dx，我们知道 T 对基底函数做了什么：

v1，v2v3=1，x，x2=0=1=v1=2x=2v2

（2）

三维输入空间 V（= 二次式）变换到二维输出空间 W（= 线性函数），如果 V1，v2，v3 是向量，我会知道这个矩阵。

4-|-（-）

的矩阵形式

（3）

线性变换 du/dx 完美复制矩阵乘法 Au。

输入 u:a+bx+cx2 乘法

轴出

从 T 到 A 的关联（我们会把每个变换关联到一个矩阵）与选择基底有关，输入基底 1，x，x2 与输出基底 1，x。

我们现在检视积分，他们产生导数的伪逆 7！当 1 的导数是 0，我不能写成 T`，也不能说「T 的逆」。

网址：linear.neocities.org 箱：876152660@qq.com 405

范例 5 积分 T 也是线性：（D+Ex）dx=Dx+Ex2。

现在输入基底是 1，x，输出基底是 1，x，x2，T 的矩阵 A + 是 3×2:

输入 v:D+Ex

微积分基础定理告诉我们积分是微分的「伪逆」，对于线性代数来说，矩阵 A 是矩阵 A 的伪逆矩阵：

（4）

常数函数的导数是零，零在 AA 的对角线，没有 T=d/dx 的一维零空间，微积分就不再是微积分。

变换的例子（大多是线性）

范例 6 把每个三维向量投影在水平面 z=1 上，向量 v=（x，y，z）变换到 T（v）=（x，y，1），这个变换不是线性。为什么不是？它甚至都没有把 ν=0 变换到 T（v）=0。范例 7 假设 A 是可逆矩阵，当然 T（v+w）=Av+Aw=T（v）+T（w）。另一个线性变换是左乘 A，得到逆变换 T，这个变换把每个向量 T（带回 v:

T1（T（v）=v 适配矩阵乘法 A-1（Av）=v

若 T（v）=Av 与 S（u）=Bu，则乘积 T（S（u）适配乘积 ABu。

我们遇到一个不可避免的问题，从 V=R＂到 W=R」所有的线性变换都可以利用矩阵达成吗？当一个线性 T 描述成:「旋转」或「投影」或「..」，一定存在矩阵 A 隐藏在 T 背后吗？T（v）永远是 Av 吗？

答案是「对的」。这是线性代数里面一种不从矩阵开始的方法，我们仍然在结束的时候用到矩阵 — 在我们选择了输入基底与输出基底之后。

注解变换有自己的语言。对于矩阵，列空间包含所有的输出 Av，零空间包含所有使得 Av=0 的输入。这些语言翻译后变成：「值域（range）」与「核（kernel）」：

T 的值域 = 所有输出 T（v）的集合，值域对应到列空间。

T 的核 = 所有使得 T（v）=0 的输入的集合，核对应到零空间。

值域在输出空间 W 中，核在输入空间 V 中。当 T 是左乘一个矩阵，T（v）=Av，则值域是列空间以及核是零空间。

请尊重版权与译者的劳动成果，侵权必究！ 406

平面的线性变换

了解一个变换要比定义它有趣多了，当一个 2×2 矩阵 A 乘所有 R2 的向量，我们

可以看出它是如何动作。从一个有 11 个端点的「房子」开始，我们变换 11 的向

量 ν 到 11 个向量 Av，v＇s 之间的直线变成变换后向量 Av 之间的直线。（从房子到

房子的变换是线性！）应用 A 至一间标准房子得到一间新房子－- 可能拉伸或旋转

或其他不适合居住的动作。

本书这个部分是视觉化的，不是理论的，我们会展示四间房子以及产生他们

的矩阵。H 的列是第一间房子的 11 个角，（H 是 2×12，所以问题 25 的 plot2d 会

关联第 11 个与第 1 个角。）A 乘房子矩阵 H 的 11 个点得到其他房子的角 AH。

4［］

cos 35-sin 35

A= sin 35°cos 35°

图 8.2：一间房子的线性变换，利用 plot2d（A＊H）作图。

主要观念的复习

1. 变换 T 把输入空间的每个 ν 带到输出空间的 T（v）。

2. 若 T（v+w）=T（v）+T（w）且 T（cv）=cT（v），则 T 是线性：直线到直线。3. 组合到组合：T（C1v1+.+Cnvn）=c1T（v1）+.+CnT（vn）。

4.T = 导数与 T = 积分是线性，从 R」到 R」的 T（v）=Av 也是线性。

网址：linear.neocities.org 箱：876152660@qq.com 407

已解范例

8A 消元生个人

如果填满一个方形，画出变换之后的方形。

解在 x 轴的点（1，0）与（2，0）被 T 变换到 45° 直线上的（1，1）与（2，2），在 y 轴的点不会移动：T（0，y）=（0，y）= 特征向量（1=1）。

（1， 2）

垂直线往上斜

A=［¦¦］

（1， 1）

T（u）

这是剪切

ข

（1， 1）

平面变成平行四边形

（1， 0）

8.1B 若输出空间的每个 b 来自输入空间中唯一的 x:T（x）=b 永远只有一个解，则非线性变换 T 是可逆。下列哪些变换（对于实数 x）是可逆，T 为何？没有线性的变换，就算是 T3 也不是。当你求解 T（x）=b，你是在逆反 T。

Ti（x）=x T（x） =.x T3（x）=x+9 Ta（x）= Ts（x）=1/x， xz0

解 T1 不可逆：x2=1 有两个解且 x2=-1 无解。

T4 不可逆，因为 =-1 无解。（如果输出空间变成正数 b＇s，则 e=b 的逆反

是 x=lnb。）

注意 T32 = 单位。但是 T32（x）=x+18，T32（x）与 T42（x）为何？

T2，T3，T5 可逆：x3=b，x+9=b，1/x=b 只有一个解 x?

x=T（b）=x3 x=T3（b）=b-9 x=T；（b）=1/b

问题集 8.1

1 一个线性变换必须保持零向量固定：T（0）=0。选择 w=__，从 T（v+w）=T（v）

+T（w）证明 T（0）=0（完成证明）。也选择 v=___，从 T（cv）=cT（v）证明。

2 要求（b）得到 T（cv）=cT（v）以及 T（dw）=dT（dw），利用加法，要求（a）得到 T（）=

（ ）. T（cv + dw + eu）= ？

3 下列哪些变换不是线性？输入是 v=（1，2）:

（a）T（v）=（v2，v1）

（b）T（v）=（v1，v1）

（c）T（v）=（0，v1）

（d）T（v）=（0，1）

（e）T（v）=v1-v2

（f）T（v）=v1v2

请尊重版权与译者的劳动成果，侵权必究！ 408

4 如果 S 与 T 是线性变换，T（S（v）是线性还是二次式？

（a）（特殊案例）若 S（v）=v 且 T（v）=v，则 T（S（v）=v 或 v2?

（b）（一般案例）S（v1+v2）=S（v1）+S（v2）且 T（v1+v2）=T（v1）+T（v2）组合成

T（S（v1+v2）=T（__）=__+__。

5 假设除了 T（0，v2）=（0，0）之外 T（v）=v，证明这个变换满足 T（cv）=cT（v），但是

不满足 T（v+w）=T（v）+T（w）。

6 下列哪些变换满足 T（v+w）=T（v）+T（w）? 哪些变换满足 T（cv）=cT（v）?

（a）T（v）=vv

（b）T（v）=v1+v2+v3

（c）T（v）=（v1，2v2，3v3）

（d）T（v）=v 的最大分量

7 对下列 V=R2 到 W=R2 的变换，求出 T（T（v）。证明当 T（v）是线性，则 T（T（v）

也是线性。

（a）T（v）=-v

（b）T（v）=v+（1，1）

（c）T（v）=90° 旋转 =（-v2，v1）

（d）T（v）= 投影 = 2（v1+v2，v1+v2）

8 求出 T 的值域与核（如同列空间与零空间）：

（a）T（v1，v2）=（v1-v2，0）

（b）T（v1，v2，V3）=（V1，V2）

（C）T（v1，v2）=（0，0）

（d）T（v1，v2）=（v1，v1）

9「循环」变换 T 的定义是 T（v1，v2，v3）=（v2，v3，v1），T（T（v）=?T3（v）=?T100（v）=?

对使用 T 一百次。

10 当线性变换的值域是全部的 W 且核只有 ν=0 时，从 V 到 W 的线性变换转

存在从到 Ⅴ 的逆变换，则对于每一个中的 w，T（v）=w 有一个解 v。为

什么下列的 T 不可逆？

（a）T（v1，v2）=（v2，v2）

W=R²

（b）T（v1，V2）=（V1，V2，v1+V2）

W=R³

（C）T（V1，V2）=V1

W=RI

11 如果 T（v）=Av 且 A 是 m×n，则 T 是「左乘 A」

（a）输入与输出空间 V 与 W 为何？

（b）T 的值域 = A 的列空间 =?

（c）T 的核 = A 的零空间 =?

网址:linear.neocities.org 邮箱：876152660@qq.com 409

12 假设线性变换 T 把（1，1）转到（2，2）以及把（2，0）转到（0，0），求 T（v）：（a）v=（2，2）（b）v=（3，1）（c）v=（-1，1）（d）v=（a，b）

问题 13-19 会困难一些，输入空间包含所有的 2×2 矩阵 M。

13M 是任意 2×2 矩阵且 A=，变换 T 的定义是 T（M）=AM。什么样的矩阵

乘法证明 T 是线性。

14 假设 A - 证明 T 的域是整个角库空间 V 核阵

（1）若 AM=0 证明 M 必须是零矩阵。

（2）对于任意 2×2 矩阵 B，求出一个 AM=B 的解。

15 没证明单位矩降不在 T 的域，求出一个降 M 使

得 T（M）=AM 是零。

16 假设 T 把每个 2×2 矩阵 M 转置，尝试找出一个矩阵 A 使得 AM=M，证明没

有矩阵 A 做得到。给教授：这个线性变换不是来自一个矩阵？这个矩阵应该

是 4×4！

17 把每个 2×2 矩阵转置的变换 T 肯定是线性，下列哪些额外的性质是正确的？

（a）T2 是单位变换。

（b）T 的核是零矩阵。

（c）每个 2×2 矩阵在 T 的值域中。

（d）T（M）=-M 是不可能。

18xM-8g 求出－个矩使 7M0 所有使得

T（M）=0 的矩阵（核）以及所有的输出矩阵 T（M）（值域）。

19 如果 A 与 B 可逆且 T（M）=AMB，求出（）M（）形式的 T1（M）。问题 20-26 有关房子变换，输出是 T（H）=AH。

20 你如何从 T（房子）的图形分辨 A 是

（a）对角矩阵？

（b）秩 1 矩阵？

（c）下三角矩阵？

21 对于下列矩阵画出 T（房子）的图形：

D-｛］与 4-［］与 V-｛｝］

请尊重版权与译者的劳动成果，侵权必究！ 410

22A=［］在什么条件下使得 T（房子）会

（a）坐直朝上？

（b）所有方向都扩大 3 倍？

（c）不改变形状的旋转？

23 当 T（v）=-v+（1，0），描述 T（房子），这个 T 是「仿射」。

24 改变房子矩阵 H 多出一个烟囱。

25 标准房子可以用 plot2d（H）来画图，o 代表圆，－代表线：

x=H（1，:）＇；y=H（2，:）＇；

axis（［-10 10-10 10］）， axis（‘square＇）【原文错误，少了空格】

plot（x， y， ＇o＇， x， y，＇-）；

测试 plot2d（A＇＊H）与 plot2d（A＇＊A＊H），房子是图 8.1 的矩阵。

26 对下列矩阵 A，不用电脑画出房子 A＊H 的图形：

10

与

0.50.5

与

0.50.5

与

00.1

0.5 0.5

－ 0.5 0.5

27 这个代码建立一个 0 分成 50 个角度的向量，它画出单位圆然后画出 7（圆）= 椭

圆，T（v）=Av 把圆变换成椭圆。

A=［21；12］％可以改变 A

theta = ［0:2 ＊ pi/50:2 ＊ pi］；

circle ［cos（theta）； sin（theta）］；

ellipse A circle；

axis（［-4 4 －4 4］）； axis（＇square＇）

plot（circle（1， ：） circle（2， ：） ellipse（1，：） ellipse（2，:））

28 把问题 27 的圆加上两个眼睛以及一个微笑，（如果一个眼睛深色另一个就用

浅色，当脸横跨 y 轴产生反射时，你才能分辨。）左乘矩阵 A 得到新的脸。

29 什么样的条件 detA=ad-bc，可以确保输出房子 AH 会

（a）挤压成一条线？

（b）顺时针方向保持它的端点（不是反射）？

（a）与原始房子有相同的面积？

30 为什么每个从 R2 到 R2 的线性变换 T，会把方形变成平行四边形？矩形也是

变成平行四边形（如果 T 不可逆，会被挤压。）

网址：linear.neocities.org 箱：876152660@qq.com 411

8.2 线性变换的矩阵

1 给定一组输入基底 v1，..，vn，如果我们知道 T（v1），..，T（vn），则我们知道所有的

T（v）：使用线性。

2「对应 T 的矩阵」的列 j 来自应用 T 到输入基底向量 v。

3 使用 w＇s 的输出基底把变换写成 T（v）=a1jw1+..+amjwm，这些 aij 进入列 j。4 若输入与输出基底 = Inxn 的列与 Imxm 的列，则对应 T（x）=Ax 的矩阵是 A。5 当基底变成 s 与 w＇s，相同 T 的对应矩阵从 A 变成 WAV

6 最佳基底：V=W = 特征向量以及 V，W 等于得到对角 A 与 Σ 的奇异向量。

下一页会指定一个矩阵给每一个变换 T。对于一般的列向量，输入 ν 在 V=R」中且输出 T（v）在 W=Rm 中，这个变换的矩阵 A 是 m×n，我们在 V 与 W 中选择的基底会决定 A。

R」与 R」的标准基底是 I 的列，这个选择得到一个标准矩阵，则 T（v）=Av 在正常的方式。但是这些空间会有其他基底，所以其他矩阵也可以代表相同的变换 T。线性代数的主题是选择基底得到对应 T 的最佳矩阵（对角矩阵）。

所有的向量空间 V 与 W 有很多基底，每个基底的选择产生一个对应 T 的矩阵。当输入基底与输出基底不同时，对应 T（v）=ν 的矩阵就不是单位 I，它会是「基底矩阵的变化」。下列是关键概念：

假设我们知道输入基底 v1，.，vn 的 T（v），

矩阵的列 1 到列 n 会包含这些输出 T（v1）到 T（vn）。

A 乘 c = 矩阵乘向量 = 这 n 个列的组合

Ac 是正确组合 c1T（v1）+.+cnT（vn）=T（v）。

理由每个 ν 是基底向量 ν 的唯一组合 C1v1+.+Cnvn，由于 T 是线性变换（线性的时刻来临），T（v）必须有与在列中的输出 T（vj）的相同组合 c1T（v1）+.+cnT（vn）。我们的第一个例子给出对应在 R2 与 R3 的标准基底的矩阵 A。

范例 1 假设 T 把 v1=（1，0）变换到 T（v1）=（2，3，4），假设第二个基底向量 v2=（0，1）变成 T（v2）=（5，5，5）。若 T 是从 R2 到 R3 的线性变换，它的「标准矩阵」是 3×2，这些输出 T（v1）与 T（v2）进入 A 的列：

请尊重版权与译者的劳动成果，侵权必究！ 412

基底变换

范例 2 假设输入空间 V=R2，输出空间 W 也是 R2。假设 T（v）=ν 是单位变换，你会预期这个矩阵是 I，但是这个只会发生在输入基底与输出基底相同的时候。我会选择不同的基底来看看矩阵如何创建。

对于这个特例 T（v）=v，我会把矩阵称为 B 而不是 A，我们只需要从 v＇s 到 w＇s 做基底变换，每个 ν 是 w1 与 w2 的组合。

输入基出基叫－』

请注意！我利用输出基底 w1 与 w2 来表示输入基底 vV1 与 V2，这是因为我们的关键规则。我们把单位变换 T 应用到每一个输入基底向量：T（v1）=v1 与 T（v2）=v2，然后我们利用输出基底 w1 与 w2 来表示这些输出 v1 与 V2。这些粗体数字 1，1，2，3 告诉我们矩阵 B 的列 1 与列 2（基底矩阵的变换）：WB=V 所以 B=W1V。

基底变换的矩阵 B ［］［B］ －［］］3］38

（1）

当输入基底在矩阵 V 的列，输出基底在矩阵 W 的列，对应 T=I 的基底变换矩阵是 B=W-1V。

关键我看到一个了解 B=WV 的清晰方法，假设相同的向量 u 写成输入基底 v＇s 的组合以及输出基底 w＇s 的组合，我会用三种方式来进行： Vc= Wd

u=d，w +.+d，w，

w＇s 新基底的系数 d 是 d=W1Vc，则 B 是 W1V

（2）

这个公式 B=WV 产生世界上最伟大的奥秘之一：当标准基底 V=I 变换成不同基底 W，基底变换矩阵不是 W 而是 B=W1。较大的基底向量有较小的系数！标准的在与的长有数 w

网址：linear.neocities.org 箱：876152660@qq.com 413

矩阵的建立

现在我们对任意的线性变换创建矩阵。假设 T 把空间 V（n 维）变换到空间 W（m 维），我们选择 Ⅴ 的一组基底 v1，.，n 以及的一组基底 w1，..，wmm，矩阵会是 m×n。要求得 A 的第一列，应用 T 到第一个基底向量 v1，输出 T（v1）在中。

T（v1）是中的输出基底的一个组合 a11W1 + . +am1Wm°

这些数字 a1….，m 进入 A 的第一列，从 1 变换到 T（1）透配 A 乗（1，0，.），它得到矩阵的第一列。当 T 是导数以及第一个基底向量是 1，它的导数是 T（v1）=0，所以对于下列的导数矩阵，A 的第一列全部是零。

范例 3 输入 ν 的基底是 1，x，x2，x3，输出 w 的基底是 1，x，x2。

T 取导数：T（v）=dv/dx 以及 A=「导数矩阵」

若 C1+C2x+c3x2+c4x3

0100

则 = 1c2+2cx+3cx2

即

关键规则：A 的第 j 列是应用 T 到第 j 个基底向量 v

T（v）= 输出基底向量的组合 = a11w1+.+am1wm

（3）

这些数字进入 A，矩阵的创建要得到正确的基底向量，然后线性得到其他正确的向量。每个 ν 是一个组合 c1v1+..+cnvn，而且 T（v）是 w＇s 的一个组合。当 A 乘在 ν 组合的向量 c=（C1，.，Cn），Ac 得到在 T（v）组合的系数。这是因为矩阵乘法（组合列）跟 T 一样是线性。

矩阵 A 告诉我们 T 在做什么，每个从 V 到 W 的线性变换可以变换成一个矩阵，这个矩阵与基底有关。

范例 4 对于分 T（y），第一个基底函数还是 1，它的分是第二个基底函数 x，所以「积分矩阵」A + 的第一列是（0，1，0，0）。

0 0 0

0

d1+d2x+d3x2 的积分是

100

Atd=

444

以妈锅

请尊重版权与译者的劳动成果，侵权必究！ 414

如果你积分一个函数再微分，你得到原来的函数，所以 AA+=I。但是如果你先微分再积分，常数项丢失了，所以 AA 不是 I。1 的导数的积分是零：

TT（1）= 零函数的积分 = 0

这个结果适配 AA，它的第一列全部是零。导数 T 有一个核（常数函数），它的矩阵 A 有一个零空间。再说一次主要概念 Av 复制了 T（v）。

导数与积分的范例说明了三点，第一，线性变换 T 无所不在 — 在微积分，微分方程式与线性代数。第二，R」以外的空间很重要－我们有函数在 V 与 W。第三，如果我们先微分再积分，我们可以执行矩阵相乘 A+A。

矩阵乘积 AB 适配变换 TS

现在有些东西很重要－矩阵乘法规则的真正理由，最终我们发现了为什么！两个线性变换 T 与 S 由两个矩阵 A 与 B 代表，现在比较 TS 与乘积 AB:

当我们应用 T 去变换来自 S 的输出，我们根据下列规则得到 TS:

（TS）（u）的定义是 T（S（u），输出 S（u）变成 T 的输入。

当我们矩阵 A 到来自 B 的输出，我们根据下列规则得到乘积 AB:

（AB）（x）的定义是 A（Bx），输出 Bx 变成 A 的输入。

矩阵乘法得到正确的矩阵 AB 来代表 TS。

变换 S 是从空间 U 到 V，它的矩阵 B 使用 U 的一组基底 u1，.，u 以及 V 的一组基底 v1，..，vn。变换 T 仍然是从 V 到 W，它的矩阵 A 必须使用相同的 V 的基底 V1，..，Vn— 这是 S 的输出空间，也是 T 的输入空间。则矩阵 AB 适配 TS。

乘法线性变换 TS 从 U 中任意的向量 u 开始，来到 V 中的 S（u），然后到 W 中的 T（S（u）。矩阵 AB 从 RP 任意的 x 开始，来到 R」的 Bx，然后到 R」的 ABx。矩阵 AB 正确的代表 TS:

TS：U-VW

AB:（m×n）（nxp）=（m×p）

输入是 u=x1u1+.+xpup，输出 T（S（u）适配输出 ABx。变换 TS 的乘积适配矩阵的乘积 AB。

最重要的情况是当空间 U，V，W 完全相同，他们的基底也完全相同，此时 m=n=p 我们有方形矩阵可以相乘。

范例 5S 把平面旋转 0，T 也把平面旋转 0，则 TS 旋转 20。变换 T2 对应旋转矩阵 A2，角度是 20:

T=SA=BT2 = 旋转 20A2=c20-sn20

（4）

网址：linear.neocities.org 邮箱：876152660@qq.com 415

把（变换）2 适配（矩阵）2，我们选出 cos20 与 sin26 的公式，执行 A 乘 A:

Cane oe mne o e snese o sn e

（5）

比较（4）与（5）得到 cos20=cos20-sin20 与 sin20=2sin0 cos0。三角函数（二倍角规则）来自线性代数。

范例 6S 旋转 0，T 旋转－0，则 TS=I 产生 AB=I。在这个情况下 T（S（u）是 u，我们往前旋转又往后旋转。矩阵要适配，ABx 必须等于 x，这两个矩阵是逆矩阵。把 cos（-0）=cosθ 以及 sin（-0） =-sinθ 代入反向旋转矩阵 A:

cos e sne

选择最佳基底

现在来到本书这个段落的最后一个步骤，选择基底对角化矩阵。有了标准基底（I 的列）我们的变换 T 产生某些矩阵 A - 可能不是对角矩阵，当我们选择不同的基底，不同的矩阵可以代表相同的 T，这两个伟大的选择是特征向量与奇异向量。

特征向量若 T 是从 R＂到 R＂的变换，它的矩阵是方形。但是使用标准基底

时，矩阵 A 可能不是对角矩阵。如果存在 n 个无关特征向量，选择这些向

量作为输入与输出的基底，在这个好基底之下，对应 T 的矩阵是对角特征

值矩阵 Λ。

范例 7 投影矩阵 T 把 R2 的每个向量 v=（x，y）投影到直线 y=-x，使用标准基底， v1=（1，0）投影到 T（v1）=（2，-％），v2=（0，1）投影到 T（v2）=（-2，2）。这些是 A 的列：

投影矩阵

标准基底

非对角矩阵

有－4 以及术－4

现在特征向量的重点来了，让他们作为基底向量！对角化！

请尊重版权与译者的劳动成果，侵权必究！ 416 当基底向量是特征向量时，矩阵变成对角矩阵。

v1=w1=（1，-1）投影到本身：T（v1）=v1 与 λ=1

v2=w1=（1，1）投影到零：T（v2）=0 与 λ=0

固有向量基底

对角矩阵

新矩阵是 ［］-［］-А

（6）

特征向量是最佳基底向量，他们产生特征值矩阵 Λ。

其他输入基底 = 输出基底的选择又如何？把这些基底向量放进 B 的列，我们在上面看到的基底矩阵变换（在标准基底与新基底之间）是 Bim=B 与 Bout=B1，T 的新矩阵与 A 相似（similar）:

在新基底 bs 的 Anw=BAB 与标准基底的 A 相似：

Ab＇s 到 b＇s=B-1 标准到 b＇sA 标准 Bb＇s 到标准

（7）

对于变换 ITI 我使用乘法规则，对应 I，T，I 的矩阵是 B，A，B，矩阵 B 包含标准基底的输入向量 b。

最终我们允许不同的空间 V 与 W，以及不同的基底 v＇s 与 w＇s。当我们知道 T 以及选择的基底，我们得到一个矩阵 A，A 可能不是对称，甚至不是方形，但是我们永远可以选择 v＇s 与 w＇s 得到对角矩阵，这个会是在 A=UZVT 的奇异值矩阵∑= 对角线（o1…）

奇异向量 SVD 说明了 UAV=∑，右奇异向量 v1，..，vn 会是输入基底，左

奇异向量 u1，..，um 会是输出基底。基于矩阵乘法规则，在新基底中对应相同

变换的矩阵是 B1outABin=U1AV=∑。

我不能说∑与 A 相似，我们现在处理两个基底，输入与输出，两者都是正交单位基底，而且他们维持了向量的长度。遵循 David Vogan 的好建议，我建议我们说： ∑与 A 是「等距映射（isometric）」。

定义若 Q1 与 Q2 是正交矩阵，则 C=Q1AQ2 与 A 是等距映射。

范例 8 针对变换 T=4 创建矩阵 A，我们选择输入基底 1，x，x2，x3 以及输出基底 1，x，x2。矩阵 A 很简单，不幸的是它不是对角矩阵，但是我们可以反序基底。现在输入基底是 x3，x2，x，1 以及输出基底是 x2，x，1，基底变换矩阵 Bin 与 Bout 是排列矩阵。对应 T（u）=du/dx 的矩阵在新基底之下是

对角的奇异值矩阵 B1outABin=∑，其中 σ2s=3，2，1

1

1 0 1 0 0

3 00 0

B-1out ABin=

1

1

0 0 2 0

0200

1

（8）

1

00 03

0010

1

嗯，这是一个艰难的段落，我们发现 x3，x2，x，1 的导数是 3x2，2x，1，0。

网址：linear.neocities.org 箱：876152660@qq.com 417

主要观念的复习

1. 如果我们知道基底的 T（v1），..，T（vn），线性会决定所有的 T（v）。

线性转换 T

矩阵 A（m×n）

2.

→

在这些基底

输出基底 w1，..，w

代表 T

3. 基底变换矩阵 B=W1V=B-1outBin，代表单位变换 T（v）=v。4. 若 A 与 B 代表 T 与 S，对应 S 的输出基底是 T 的输入基底，则矩阵 AB 代

表变换 T（S（u）。

5. 最佳输入－输出基底是 A 的特征向量与 / 或奇异向量，则

BAB=Λ= 特征值

B- out ABin=E = 奇异值

已解范例

8.2A2×2 矩阵的空间有 4 个「向量」作为一组基底：

＂［］＂-［］＂，-［¦8］＂¸－［°］T 是转置每个 2×2 矩阵的线性变换，在此基底（输出基底 = 输入基底）下，什么矩阵

代表 T? 逆矩阵 A1=? 逆反转置运算的变换 T1=?

解转置这 4 个「基底矩阵」再交换 v2 与 v3:

T（）=

10 00

T（v2）=v3

得到 A 的 4 个列

A=

T（v3）=v2

0100

r（v4）=4

0 0 0 1

逆矩阵 A 与 A 相同，逆变换 T 与 T 相同。如果我们转置再转置，最终的矩阵

等于原始的矩阵。

注意 2×2 矩阵的空间是 4 维，所以矩阵 A（对应转置 T）是 4×4。A 的零空间是

Z 以及 T 的核是零矩阵－唯一转置后得到零的矩阵。A 的特征值是 1，1，1，－1。

哪条矩阵线有 T（A）=AT=-A，其中特征值 λ=-1?

请尊重版权与译者的劳动成果，侵权必究！ 418

问题集 8.2

问题 1-4 延伸第一导数的范例到高阶导数。

1 变换 S 取得二次（第二）导数，维持 1，x，x2，x3 作为输入基底 V1，V2，V3，V4，也作

为输出基底 w1，w2，w3，w4。使用 w＇s 写出 S（v1），S（v2），S（v3），S（v4），求出对应 S

的 4×4 矩阵 A2。

2 什么函数有 S（v）=0? 他们落在二次导数 S 的核。什么向量落在问题 1 中 S 的

矩阵 A2 的零空间？

3 给定一次导数矩阵 A1 与二次导数矩阵 A2，其中 A2 不是矩形矩阵 A1 的平方：

0100

A1=0020，不允许 A12=A2

0003

加入一个零行 4 到 A1，使得输出空间 = 输入空间，比较 A12 与 A2。结论：我们

希望输出基底 = 基底，则 m=n。

4（a）一次与二次导数的乘积 TS 产生三次导数，加入零得到 4×4 矩阵，然后计

算 A1A2=A3。

（b）矩阵 A22 对应 S2=4 次导数，为什么这个是零？

问题 5-9 有关特定变换 T 与它的矩阵 A。

5 基底 v1，v2，v3 与 w1，w2，w3，假设 T（v1）=w2 与 T（v2）=T（v3）=w1+w3，T 是一

个线性变换。求矩阵 A 然后乘向量（1，1，1）。当输入是 v1+V2+v3 时，来自 T

的输出为何？

6 由于 T（v2）=T（v3），T（v）=0 的解是 v=___。什么向量在 A 的零空间中？求

出 T（v）=w2 的全部解。

7 找出一个不在 A 的列空间中的向量。求出一个不在变换 T 的值域的 w＇s 组合。8 你没有足够的信息来决定 T2，为什么它的矩阵不一定是 A2? 你还需要什么更

多的信息？

9 求出 A 的秩。这个秩不是整个输出空间 W 的维度，它是 T 的＿_的维度。问题 10-13 有关特定变换 T 与它的矩阵 A。

10 假设 T（v1）=w1+w2+w3 与 T（v2）=w2+w3 与 T（v3）=w3，利用这些基底向量求

出对应 T 的矩阵 A。什么样的输入向量 ν 使得 T（v）=w1?

11 逆反问题 10 的矩阵 A，同时逆反变换 T-T1（w1）与 T1（w2）与 T1（w3）=?

12 下列哪些是正确？为什么其中一个是荒谬的？

（a）T1T=I

（b）T1T（v1）=v1

（c）T1T（w1）=w1

网址：linear.neocities.org 箱：876152660@qq.com 419

13 假设空间 V 与 W 有相同的基底 v1 与 v2，

（a）描述一个变换到本身的变换 T（不是 I）。

（b）描述一个 T=T2 的变换（不是 I）。

（c）为什么相同的 T 不能同时用在（a）与（b）。

问题 14-19 有关基底变换。

14（a）什么矩阵 B 把（1，0）变换到（2，5）以及把（0，1）变换到（1，3）?

（b）什么矩阵 C 把（2，5）变换到（1，0）以及把（1，3）变换到（0，1）?

（c）为什么没有矩阵把（2，6）变换到（1，0）以及把（1，3）变换到（0，1）?

15（a）什么矩阵 M 把（1，0）变换到（0，1）以及把（，）变换到（，）?

（b）什么矩阵 N 把（a，c）变换到（b，d の以及把（1，0）变换到（0，1）?

（c）什么样的 a，b，c，d 的条件使得（b）不可能？

16（a）问题 15 中，M 与 N 然后产生一个矩阵可以把（a，c）変换到（r，）以及把（b，d）

变换到（s，u）?

（b）什么矩阵把（2，5）变换到（1，1）以及把（1，3）变换到（0，2）?17

17 如果你维持相同的基底但是放置成不同顺序，基底变换矩阵 B 是一个矩

阵。如果你维持基底向量在原来顺序却改变长度，B 是一个矩阵。

18 把轴向量（1，0）与（0，1）旋转一个角度 0 的矩阵是 Q，在新的（旋转后）轴之下，原

始（1，0）的坐标为何？如何逆反是个棘手的问题，画出图形或是求解 a 与 b：19 把（1，0）与（0，1）变换到（1，4）与（1，5）的矩阵 B 是＿。组合 a（1，4）+b（1，5）

等于（1，），求（a，b）=（，）。（1，0）的新坐标与 B 或 B 的关联为何？

问题 20-23 有关二次多项式 y=A+Bx+Cx2 的空间。

20 在 x=1 时抛物线 w1=2（x2+x）=1，在 x=0 与 x=-1 时抛物线是零。求出

抛物线 w2 与 w3，然后使用线性求出 y（x）。

（a）x=0 时 w2=1；x=1 与 x=-1 时 w2=0。

（b）x=-1 时 w3=0；x=0 与 x=1 时 w3=0。

（c）x=1 时 y（x）=4；x=0 时 y（x）=5，x=-1 时 y（x）=6。使用 w1，w2，w3。21 二次多项式的一组基底是 v1=1 与 v2=x 与 v3=x2，另一组基底来自问题 20

的 w1 与 w2 与 w3。求出两个基底变换矩阵，分别从 w＇s 到 v＇s 以及 v＇s 到 w＇s。

请尊重版权与译者的劳动成果，侵权必究！ 420

22 如果抛物线 y=A+Bx+Cx2 在 x=a 时抛物线 = 4，在 x=b 时抛物线 = 5，在

x=c 时抛物线 = 6，则 A，B，C 的三个方程式为何？求出 3×3 矩阵的行列式，

这个矩阵把 4，5，6 的数值变换到抛物线 — 还是有其他方式？

23 在 m1，m2，..，m9 的什么条件下，下列三个抛物线构成所有抛物线 a+bx+cx2

空间的一组基底？

v1=m1+m2x+m3x2，v2=m4+m5x+m6x2，v3=m7+m8x+m9x2

24Gram-Schmidt 程序把 a1，a2，a3 变成正交基底 q1，q2，q3，这些是 A=QR 的列。

证明 R 是从 as 到 q＇s 的基底变换矩阵（当 A=QR，a2 是 qs 的什么组合？）25 消元法使用 A=LU 把 A 的行变成 U 的行，A 的行 2 是 U 的行的什么组合？

写成 AT=UTLT 处理列，基底变换矩阵是 B=LT，如果矩阵是

，我们就

有了基底。

26 假设 v1，v2，v3 是对应 T 的特征向量，这个表示 T（vi）=1v1，i=1，2，3。当输入

与输出基底都是 v＇s 时，对应 T 的矩阵是什么？

27 每个可逆的线性变换可以用 I 作为它的矩阵！选择任意输入基底 v1，.，vn，选

择 w1=T（v；）作为输出基底。为什么 T 必须是可逆？

28 利用 v1=w1 与 v2=w2，求出下列 T＇s 的标准矩阵：

（a）T（v1）=0 与 T（v2）=3v1（a）T（v1）=v1 与 T（v1+v2）=v1

29 假设 T 把 xy 平面横跨 x 轴做反射，S 把 xy 平面横跨 y 轴做反射。若 v=（x，y），

则 S（T（v）为何？找出对于乘积 ST 的简单描述。

30 假设 T 是跨越 45° 直线的反射，S 是横跨 y 轴的反射。若 v=（2，1）则 T（v）=（1，

2）。求 S（T（v）与 T（S（v），通常 ST≠TS。

31 两个反射的乘积是一个旋转。把反射矩阵相乘求出旋转矩阵：

32 假设 A 是秩 r=2 的 3×4 矩阵且 T（v）=Av，从 A 的行空间选择 v1 与 v2 以及从

零空间选择 ν3 与 ν4 作为输入基底。选择列空间的 w1=AV1，w2=Av2 以及来

自 AT 的零空间的 w3 作为输出基底向量。在这些基底下，什么样特别简单的

矩阵可以代表 T?

33 已解范例 82A 中，2x2 矩阵的空间 M 有基底，2，，4 假设 T 是用

去乘每个基底矩阵，当 w＇s 等于 v＇s 时，什么样的 4×4 矩阵 A 在矩阵空间中可

以代表变换 T?

34 是非题：如果我们知道 R」中 n 个相异非零向量的 T（v），则我们知道 R」中每

个向量 ν 的 T（v）。

网址：linear.neocities.org 箱：876152660@qq.com 421

8.3 搜寻好基底

1 在新的输入基底 Bm 与新的输出基底 Bout 下，每个矩阵 A 变成 BoutABin。2Bin=Bout=「A 的广义特征向量」产生乔丹形式 J=B1AB。

3 傅里叶矩阵 F=Bin=Bout 对角化每个循环矩阵（使用 FFT）。

4 正弦与余弦，勒让德与契比雪夫：这些是函数空间的伟大基底。

这是本书的重要段落，我害怕大部分读者会跳过去 — 或是没有精读，这是说明基底概念的第一章。第六章介绍特征向量 x 与第七章找出奇异向量 ν 与 u，这是两位胜利者，但是很多其他的选择是非常有价值的。

首先是段落 8.2 的纯代数，然后是好基底，输入基底向量是 Bm 的列，输出基底向量是 Bout 的列。Bin 与 Bout 永远是可逆 — 基底向量无关！

纯代数若 A 是在标准基底下对应变换 T 的矩阵，则

BoutABin 是新基底下的矩阵

（1）

标准基底向量是单位矩阵的列：Bin=Inxn 与 Bout=Imxm。

我们现在选择特殊的基底使得矩阵比 A 更清楚更简单，当 Bin=Bout=B，方形矩阵 BAB 与 A 相似。

应用代数应用都与选择优质基底有关，下列是 4 个重要的向量选择以及 3 个函数的选择。段落 8.2 说明特征向量与奇异向量产生 A 与∑，乔丹形式是新的：1Bin=Bout = 特征向量矩阵 X，则 XAX = 特征值在 A。

这个选择需要 A 是方形矩阵且有 n 个无关的特征向量，「A 必须可以对角化」，当 Bin=Bout 是特征向量矩阵 X 时，我们得到 Λ。

2 Bin=V 与 Bout=U:A 的奇异向量，则 U1AV = 对角∑。

当 Bin=Bout 是奇异向量矩阵 V 与 U 时，∑是奇异值矩阵（有 σ1，.，σ，在对角线）。回顾这些 Bin 与 Bout 的列是 ATA 与 AAT 的正交单位特征向量，则 A=UZVT 得到∑=U`AV。

3Bin=Bout=「A 的广义特征向量」，则 BAB = 乔丹形式 J。

A 是方形矩阵但是它可能只有 s 个无关的特征向量，（若 s=n，则 B 是 X 而且 J 是 A。）所有情形下乔丹创建 n-s 个额外的「广义（generalized）」特征向量，目标在使得乔丹形式 J 尽可能是对角：

i）沿着 J 的对角线有 n 个方形的方块。

ii）每个方块有一个特征值 A 与一个特征向量以及在对角线上方的 1＇s。好案例：有 n 个 1×1 的方块，每个方块有一个特征值，则 J 就是 A（对角）。

请尊重版权与译者的劳动成果，侵权必究！ 422

范例 1 乔丹矩阵 J 有特征值 1=2，2，3，3（两个双重特征值），因为 J 是三角形。这些特征值落在对角线。对于 λ=2 有两个无关特征向量，但是对应 λ=3 只有一条特征向量直线。对于每个矩阵 C=BJB~` 与 J 相似是成立的。

两个 1×1 方块

一个 2×2 方块

三个固有向量

固有值 2，2，3，3

对应 A=2 的特征向量是 x1=（1，0，0，0）与 x2=（0，1，0，0），对应 λ=3 的一个特征向量是 x3=（0，0，1，0）。这个乔丹形式的「广义特征向量」是第四个标准基底 x4=（0，0，0，1），J 的特征向量（正常与广义）刚好是单位矩阵 I 的列 x1，x2，x4，x4。

注意（J-3Dx4=x3，广义向量 x4 与真正的特征向量 x3 产生关联，真正的 x4 会有（J-3I）x4=0，但是这里没有出现。

每个与 J 相似的矩阵 C=BB 会有真正的特征向量 b1，b2，b3 在 B 的前三列，B 的第四列会是一个 C 的广义特征向量 b4，并且紧扣真正的 b3。下列是一个快速证明：利用 Bx3=b3 与 Bx4=b4 说明第四列 b4 借由（C-3I）b4=b3 紧扣 b3。

（BJB--31）64=BJx4-3Bx4=B（J-3I）x4=Bx3=b3

（2）

乔丹定理的重点是每个方形矩阵 A 有一整组的特征向量与广义特征向量，当这些向量进入 B 的列，矩阵 B~AB=J 是乔丹形式。基于范例 1，下列是 J 的描述。

乔丹形式

对于每个 A，我们想要选择 B 使得 B~AB 是尽可能对角。当 A 有一整组的 n 个特征向量，他们进入 B 的列，则 B=X，矩阵 XAX 是对角矩阵，句号。这是 A 的乔丹形式 — 当 A 可以对角化。在广义情况下，特征向量缺失，无法得到 A。

假设 A 有 s 个无关的特征向量，则它与有 s 个方块的乔丹矩阵相似，每个方块有一个特征值在对角线，而且有 1＇s 在特征值的上方。这个方块对应 A 的确切的一个特征值，则 B 既有正常的特征向量也有广义特征向量。

当有 n 个特征向量时，全部 n 个方块都是 1×1，这个情况下 J=Λ。

对于任意方形矩阵 A=BJB~1，乔丹形式是微分方程式 du/dt=Au 的解。其中解 e4u（0）变成 u（t）=BetB-1u（0），J 是三角形，它的矩阵指数 et 包含 et 乘次方 1，t，.，ts-1。

网址：linear.neocities.org 箱：876152660@qq.com 423

（乔丹形式）如果 A 有 s 个无关的特征向量，则它与有 s 个乔丹方块在

对角线的乔丹矩阵相似，某个矩阵 B 把 A 放进乔丹形式：

√

乔丹形式

B＇АB=

=J

（3）

J

每个方块 J 有一个特征值与一个特征向量与位于对角线上方的 1＇s:

； 1

乔丹方块

J1=

1

（4）

A

如果他们共享相同的乔丹形式 J，则矩阵相似 — 否则就不相似。

乔丹形式对于每个丢失的特征向量有一个非对角线的 1（1＇s 就在特征值旁边），在每个相似矩阵的家族中，我们选择一个杰出的成员称为 J，它是近乎对角（可能的话是完全对角），我们可以快速求解 du/dt=Ju 然后取次方。这个家族其他的矩阵都有 BJB1 的形式。

乔丹定理在我的教科书「线性代数与应用」中有证明，请参考那本书（或是更进阶的书）的证明。这项推理相当错综复杂，乔丹形式在实际计算上也不是那么流行－- 它的计算不稳定，A 的一点轻微变化就会分离重复的特征值，并且移除非对角线的 1＇s - 乔丹变回对角 Λ。

无论证明与否，你已经捕捉到相似性的中心概念－在保留重要性质下，使得 A 尽可能简单。最佳基底 B 得到 B~`AB=J。

问题若 A2 = 零矩阵，求出特征值以及所有可能的乔丹形式。

答案特征值必须全部是零，因为 Ax=Ax 得到 A2x=2x=0x。A 的乔丹形式有 2=0，因为 J2=（B-`AB）（B-`AB）=B-1A2B=0。J 的每个方块有 λ=0 在对角线，检视方块大小是 1，2，3 的 J2:

τογ－τοι β－［σβ ：σ 8:

结论：若 2=0 则所有的方块大小必须是 1 或 2，2 在 3×3 时不是零。

J 的秩（与 A）会是 1＇s 的全部个数，最大的秩是 n/2，这个发生在有 n/2 个方块，每个方块的大小是 2 而且秩是 1。

请尊重版权与译者的劳动成果，侵权必究！ 424

现在应用数学最伟大的基底来了，他们的离散形式是 R」中的向量，连续形式

是函数空间中的函数。由于他们是一劳永逸的选择，不需要知道矩阵 A，这些基

底 Bin=Bout 可能无法把 A 对角化，但是对应用数学的许多重要矩阵来说，矩阵

BAB 已经接近对角。【下方的 4 是接 421 页的 3】

4Bin=Bout = 傅里叶矩阵 F，则 Fx 是 x 的离散傅里叶变换。

这些字词告诉我们：方程式（6）的傅里叶矩阵有（1，，2，13）的列是非常重要，

这些是容易处理的优质基底。

我们会问：哪些矩阵被 F 对角化？这次我们从特征向量（1，A，A2，A3）开始，然

后找出拥有这些特征向量的矩阵：

0 1 0 0

若 14=1 则 Px= 0 0 1 0

=λ 1223 =x

0 0 0 1

（5）

1 0 0 0

P 是排列矩阵，方程式 Px=λx 说明 x 是特征向量而且 λ 是 P 的特征值。注意

向量方程式的第 4 行是如何变成 1=λ4，这个 2 的规则使得所有事情有效。

这个给出了 4 个不同的特征值 A? 是的！这 4 个数字 A=1，i，-1，-i 全部都满足

A4=1。（你知道 i2=-1，两边平方得到 4=1。）所以这 4 个数是 P 的特征值，

每个特征值对应它的特征向量 x=（1，A，λ2，λ3）。特征向量矩阵 F 对角化排列

矩阵 P:

1

1 1 1 1

特征值矩阵 Λ

i

固有向量矩阵是 1i －1 －i

（6）

－1

傅里叶矩阵 F

－i

这些 F 的列是正交，因为他们是 P 的特征向量（一个正交矩阵），不幸的是傅

里叶矩阵 F 是复数（它是世界上最重要的复数矩阵），利用快速傅里叶变换，

可以很快速的执行乘法 Fx 百万次。FFT 在段落 9.3。

关键问题：除了 P 之外的其他矩阵有相同的特征向量矩阵 F 吗？我们知道 P2

与 P3 与 P4 有与 P 相同的特征值，相同的的矩阵 F 可以对角化所有 P 的次方，并

且 P2 与 P3 与 P4 的特征值是数字 λ2 与 λ3 与 λ4。例如 P2x=λ2x:

0 0 1

p2x= 0 0 0 1

=x2

=2x，当 4=1

1 0 0 0

0 1 0 0 1222

1223

网址：linear.neocities.org 箱：876152660@qq.com 425

4 次方是特殊情况，因为 P4=I。当我们进行 4 次的「循环排列」，P4x 与我们开始的 x 相同，P4=I 的特征值就是 1，1，1，1，而且这个数字 1 与 P 的所有特征值的 4 次方是一致的：14=1 且 i4=1 且（-1）4=1 且（-i）4=1。

多一个步骤带来更多的矩阵，若 P 与 P2 与 P3 与 P4=I 有相同的特征向量矩阵 F，则任意的组合 C=c1P+C2P2+c3P3+c0I 也有相同的 F:

C0 C1 C2 C3

有固有向量在傅里叶矩阵 F

循环矩阵 C= C3 C0 C1 C2 有 4 个固有值 co+1+c2+c2

C2 C3 C0 C1 来自 4 个数字 λ=1，i，-1，-i

C1 C2 C3 C0 来自 = 1 的固有值是 co+C1+C2+C3

这是一大步，我们发现所有的矩阵（循环矩阵 C）的特征向量是 F 中的傅里叶向量，我们也知道 C 的 4 个特征值，但是直到现在我们还没有给出一个公式或是一个名称：C 的四个

Co

C0 + C+C2+ C3

固有值来自

Fc

Co +ic-C2-ic3

=

C1

1

傅里叶转换 Fc

C

C0- C1+C2- C3

－i －1

C

Co-ic-C2 +ic3

范例 2 相同的概念一样适用于傅里叶矩阵 F 与一个任意大小的循环矩阵 C，2×2 的矩阵看起来很平凡但是他们很有用。现在 P 的特征值是 λ2=1 而不是 λ4=1，而且不需要复数 i:λ=±1。

傅里叶矩阵 F 来自 F

P 与 C 的固有向量

—［］

循环

coI+c1P

C 的特征值是 C0+C1 与 C0-C1，当向量 C 是（C0，C1），这些特征值来自傅里叶变换 Fc，变换 Fc 给出任意大小的 C 的特征值。

注意循环矩阵有常数对角线，相同的数字 c 沿着主对角线，数字 c1 在对角线上方，而且包围或是环绕对角线直到 C 的东南角，这说明了「循环」的名字，它可以指出矩阵是周期性或是循环性。甚至 1 的次方也是循环的，因为 14=1 得到 3， ，，x8=，2，x3，4。

常数沿着对角线是 C 的一个主要性质，它对应微分方程式的常数系数，这正是傅里叶的完美工作！

方程式

d2u/dt2=-u 的解是 u=cocost+c1sint

方程式

d2u/dt2=tu 无法由基础函数求解

这些方程式是线性，第一个是简单弹簧的震荡方程式，它是牛顿定律 f=ma，其中质量 m=1，a=d2u/dt2，以及力 f=-u。常数系数产生你实际可以求解的微分方程式。

请尊重版权与译者的劳动成果，侵权必究！ 426

方程式 u＂=tu 有一个变数系数 t，这是物理学与光学的「埃里（Airy）」方程式（它的推导可以解释彩虹），当 t 通过零，解会完全改变，这些解需要无限级数。在此我们不讨论。

重点是常数系数的方程式有简单解 e，你把 e 代入微分方程式求出 1，这个数字 2 就好像特征值。对于 u=cost 与 u=sint，这个数字就是 λ=i。欧拉伟大的公式 e「=cost+isint 引入复数，就好像我们在 P 与 C 看到的特征值一样。

函数空间的基底

对于 x 的函数，第一个基底我会想到包含次方的 1，x，x2，x3，..，不幸的是，这是一组很糟糕的基底。这些函数 x＂只是刚好无关，x10 几乎就是其他基底向量 1，x，..，x9 的组合，实际上不可能使用这些劣质的「病态」基底去计算。

如果我们有的是向量而不是函数，对于优质基底的测试要检视 BTB，这个矩阵包含基底向量（B 的列）之间的全部内积，当 BIB=I，基底是正交单位，这是最好的可能。但是基底 1，x，x2，. 产生邪恶的希尔伯特矩阵：B①B 的最大特征值与最小特征值之间的比值超级巨大，一个巨大的条件数（condition number）表示一个不快乐的基底选择。

注解现在 B 的列是函数而不是向量，我们仍然使用 BTB 去测试无关性质，所以我们需要知道两个函数的点积（内积是比较好的名字）－— 这些是 BB 中的数字。

向量的点积就是 xy=x1y1+.+xnyn，函数的内积使用积分而不是相加，但是概念是完全适用：

内（g）=

ff（«）g（x）dx

复数内（g）=∫f）gx，f = 共复数

加权内（g）。=）（）gx，w = 加权函数

当积分从 x=0 到 x=1，x2 与 x2 的内积是

借由变成 x=-1 到 x=1 对称的区间，我们立刻得到全部偶函数与全部奇函数的正交性：区间［-1，1］ x2xdx=0 even（x）odd（x）dx=0

这项改变使得一半的基底函数与另一半的基底函数正交。继续使用对称区间－1 到 1（或是－π 到 π）是如此简单，但是我们想要一组比次方项 x」更好的基底－希望是正交基底。

网址：linear.neocities.org 箱：876152660@qq.com 427

函数空间的正交基底

下列是针对理论与计算的三个领先的偶－奇基底：

5. 傅里叶基底

1， sin x， cos x， sin 2x， cos 2x， ...

6. 勒让德基底

I.-

7. 契比雪夫基底 1，x，2x2-1，4x3-3x，..

傅里叶基底函数（正弦与余弦）全部都是周期性，他们每隔 2π 的区间一再重复，这是因为 cos（x+2π）=cosx 与 sin（x+2π）=sinx。所以这些基底对于函数 f（x）特别的好，使得他们本身也是周期性：f（x+2π）=f（x）。

这组基底也是正交，每个正弦与余弦跟其他的正弦与余弦都是正交，我们当然不期待基底函数 cos nx 与本身正交。

最重要的是正弦－余弦基底对于近似也是特别的棒，如果我们有一个平滑的周期函数，则一些正弦与余弦（低频率）是我们全部需要的。f（x）的突跳以及信号中的杂讯会在较高频率看到（较大的 n），我们希望并且期待信号不会被杂讯淹没。

傅里叶变换把 /（x）与自己傅里叶级数中的系数 a 与 bk 产生关联：

傅里叶级数 f（x）=ao+b1sinx+a1cosx+b2sin2x+a2cos2x+.

我们看到函数空间是无限维度，它利用无限多的基底函数去完美捕捉一个典型函数 f（x），但是每个系数的公式（例如 a3）就像向量 b 在通过 a 的直线的投影一样的 bTa/aTa。

现在我们把函数 f（x）投影在函数空间中通过 cos3x 的直线：

傅里叶系数 a2=d

（7）

范例 3 三角学里面的二倍角公式是 cos2x=2cos2x-1，这个告诉我们 cos2x=⅓+⅓cos 2x，一个非常短的傅里叶级数，所以 sin2x=⅓－⅓cos2x。

傅里叶级数就是函数空间的线性代数。我会在第十章有关应用的章节作为亮点，好好的说明。

请尊重版权与译者的劳动成果，侵权必究！ 428

勒让德多项式与契比雪夫多项式

勒让德多项式是应用格莱姆－施密特概念的结果（段落 4.4），计划是正交化这些次方项 1，x，x2，..。首先在－1 到 1 的区间，奇函数 x 已经与偶函数 1 正交，他们的乘积（x）（1）=x 的积分是零。但是 x2 与 1 的内积是 x2dx=2/3:

（x2，1）fx2dx_2/3_1

（1，1）［1dx~2~3 格莱姆－施密特得到 x2-= 勒让德

同理奇数次方 x3 在奇函数 x 的方向上有一个分量 3x/5:

（x3，x）x4dx_2/5_3

（x，x）x2dx2135

格莱姆－施密特得到 x3-3x = 勒让德

继续对 x2，x3，. 使用格莱姆－施密特，得到每个勒让德函数 — 一组优质基底。

最终我们转移到契比雪夫多项式 1，x，2x2-1，4x3-3x，他们不是来自格莱姆－施密特，而是与 1，cos 0，cos 20，cos3θ 有关，这个给出了巨大的计算优势－- 我们可以使用快速傅里叶变换。当我们令 x=cos，会出现契比雪夫与傅里叶的关联：

契比雪夫

2x2-1=2（cos0）2-1=cos20

到傅里叶

4x3-3x=4（cos0）3-3（cosθ）=cos30

第 nh 次的契比雪夫多项式 Tn（x）变换成傅里叶的 cos n0=Tn（cos）。

注解这些多项式是一个大型软件计划「chebfun」的基础，每个函数 f（x）被一个超级精确的契比雪夫近似取代，你可以积分 f（x），可以求解 f（x）=0，可以求出极大值与极小值。不止如此，你可以求解关于 f（x）的微分方程式－- 快速又高度精确。当 chebfun 利用多项式取代了 f（x），你已经准备好解决问题了。

主要观念的复习

1. 若矩阵 B 是良好条件（well-conditioned），就是好基底。正交基底是最佳。2. 若 A=BAB 是对角矩阵，也是好基底，但是乔丹形式 J 非常不稳定。3. 傅里叶矩阵可以对角化常数系数周期方程式：完美。

4. 基底 1，x，x2，. 得到 B①B = 希尔伯特矩阵：糟糕的计算。

5. 勒让德与契比雪夫多项式是函数空间的极佳基底。

网址：linear.neocities.org 箱：876152660@qq.com 429

问题集 8.3

1 范例 1 中，J-3I 的秩是多少？它的零空间的维度是多少？这个维度给出了 λ=3 对应的无关特征向量的个数。

代数倍数值是 2，因为 det（J-A）有重复因子（1-3）2。几何倍数值是 1，因为

只有一个无关的特征向量。

2 这些矩阵 A1 及 A2 与 J 相似，求解 A1B1=B1J 与 A2B2=B2J，找出基底矩阵 B1 与 B2，其中 J=B11A1B1 与 J=B2-1A2B2。

3 方块转置 JT 与 J 有相同的三重特征值 2（只有一个特征向量），求出基底变换矩阵 B 使得 J=B-1JTB（表示 BJ=JTB）:

2

20

J= 0 2 1

= 1 2

002

0 1 2

4J 与 K 是有相同的零特征值与相同的秩 2 的乔丹形式，但是请证明不存在可

逆的 B 可以求解 BK=JB，所以 K 与 J 不相似：

5 若 A3=0 显示所有的 1=0，以及所有的乔丹方块有 J3=0，且大小是 1 或 2 或 3，所以 rank（A）≤2n/3。若 A」=0，为什么 rank（A）≤n。

6 证解－共中 60-

7 证明差方程式 Vk+2-2Avk+1+22vk=0 的解是 vk=2k 以及 vk=kλk。这些对应到

问题 6 的 e」与 te」。

8x3=1 的 3 个解是什么？他们是复数 = cos+isin=ei。则 x3=ei=1，

其中角度 3θ 是 0 或 2π 或 4π。写出 3×3 傅里叶矩阵，其中列是（1，A，λ2）。9 从问题 8，确认任意 3×3 的循环 C 矩阵都有特征向量（1，2，22）。若你的矩阵 C

的对角线包含 C0，C1，C2，则它的特征值在 Fc 中。

的傅里叶级数中的 a3cos3x。

请尊重版权与译者的劳动成果，侵权必究！ 430

第九章

复数向量与矩阵

实数对比复数

R = 所有实数的线 －∞<x<∞ ←C = 所有复数 z=x+iy 的平面

x|=x 的绝对值→|z|=√x2+y2=r=（z 的绝对值）（或模量）

1 与－1 是 x2=1 的解→z=1，w，..，w＂-1 是 z＂=1 的解，其中 w=e2πi/n

的共复是を x げーー a

z=x+iy 的极形式是 |zei0 =rei0 =rcos0+irsin0，角度是 tan0=y/xR」：向量有 n 个实数分量

C」：向量有 n 个复数分量

长度：|x|2=x12+.+xn2

→

长度：|z|2=|21|2+.+|2m|2

转置：（AT）=Aj

→

共轭转置：（AH）=A

点积：xIy=x1y1+.+xnyn

→

内积：uHv=ū1v1+.+ūnvn

AT 的思考：（Ax）Ty=xT（ATy）

AH 的思考：（Au）Hv=uH（AHv）

正交性：xy=0

→

正交性:uHv=0

对称矩阵：S=ST

→

埃尔米特矩阵：S=SH

S=QAQ-1=QAQT（实数 A）

S=UAU-1=UAUH（实数 A）

反对称矩阵：KT=-K

→

反埃尔米特矩阵：KH=-K

正交矩阵：QT=Q-1

→

酉矩阵：UH=U-1

正交单位列：QTQ=I

→

正交单位列：UHU=I

（2x）T（Qy）=xy 且 | 2x|=|1x|

（Uxy（y）=xy 且 IUl=I』

线性代数完整的表述必须包含复数 z=x+iy，纵使矩阵是实数，特征值与特

征向量通常是复数。例子：一个 2×2 的旋转矩阵具有复数特征向量 x=（1，i）与 x=

（1，-i）。我会在段落 9.1 与 9.2 整理这些难忘的字词：当你转置一个向量或是一个

矩阵 A，取每个单元的共轭（i 变成－i）。段落 9.3 是有关复数最重要的矩阵－傅里

叶矩阵 F。

网址：linear.neocities.org 邮箱：876152660@qq.com 431

9.1 复数

从虚数 i 开始。每个人都知道 x2=-1 没有实数解。当你平方一个实数，答案不可能是负数，所以这个世界同意一个解称为 i。（除了电气工程师称它 j。）虚数遵守正常加法与乘法的规则，存在一个不同处，用－1 取代 2。

这个段落给出复数的主要结果，对某些学生来说是复习，对所有人是一种参考。每件事情都来自 i2=-1 与 e2πi=1。

一个复数（比如 3+2i）是一个实数（3）加一个虚数（2i）。加法时实数部分（以后简称实部）与虚数部分（以后简称虚部）分开，乘法使用 i2=-1:

加：（3+2i）+（3+2i）=6+4i

乘：（3+2i）（1-i）=3+2i-3i-2i2=5-i

如果我把 3+i 加上 1-i，答案是 4，实数 3+1 与虚数 i-i 分开计算，我们是把向量（3，1）与（1，－1）相加得到（4，0）。

数字（1+i）2 是（1+i）乘（1+i），运算规则得到惊讶的答案 2i:

（1+¡）（1+¡）=1+i+¿+；=2i

在复数平面上，1+i 在 45° 角，它很像向量（1，1），当我们把（1+i）平方得到 2i，角度变成 2 倍来到 90°，如果我们再平方，答案是（2i）2=-4，两倍 90° 角来到 180°，这个方向是负数实数。

一个实数就是一个虚部为零的复数 z=a+bi:b=0。

实部是 a=Re（a+bi）虚部是 b=Im（a+bi）

复数平面

复数对应平面的一个点，实数沿着 x 轴，纯虚数在 y 轴，复数 3+2i 是坐标（3，2）的点。数字零，就是 0+0i，在原点。

加减复数就好像加减平面的向量一样，实数分量与虚数分量维持分开，向量还是平常的头至尾。除了复数相乘之外，复数平面 C1 就好像平常的二维平面 R2，只是我们不做向量相乘。

重要概念：3+2i 的共轭复数是 3-2i，z=1-i 的共轭复数是 z=1+i。一般来说 z=a+bi 的共轭复数是 z=a-bi。（有些作者在数字上加横杠，有些作者使用星号＊:z=z＊。）z 与 z 的虚部是相反符号，在复数平面上，z 是 z 在实数轴的另一侧的影像。

请尊重版权与译者的劳动成果，侵权必究！ 432

2i 虚轴

z=3+2i

复数平面

i

r=|z|=√32+22

单位圆

－1

1

实轴

23

－i

－2i

共轭 = 3-2i

图 91a + 对应到点以及向

两个有用的事实。当我们把共轭 1 与 2 相乘，我们得到 12 的共轭。并且当我们把 1 与 2 相加，我们得到 z1+z2 的共轭：

1+2=（3-2i）+（1+i）=4-i，这是 z1+z2=4+i 的共轭。

1×2=（3-2i）×（1+i）=5+i，这是 z1×z2=5-i 的共轭。

加法与乘法是线性代数的必需。当 A 是实数，借由选取 Ax=Ax 的共轭，我们得到另一个特征值 λ 以及它的特征向量 x:

特征值 λ 与 λ

若 Ax=x 且 A 是实数，则 Ax=x

（1）

当 z=3+2i 与自己的共轭 z=3-2i 结合时会产生特殊的事情，两者相加 z+z 或相乘 zz 的结果永远是实数：

z+z = 实数

（3+2i）+（3-2i）=6（实数）

zz = 实数

（3+2i）×（3-2i）=9+6i-6i-4i2=13（实数）

z=a+bi 与自己的共轭 z=a-bi 的总和是实数 2a，z 乘 z 的乘积是实数 a2+b2:

z 乘 z 得到 | z2=r2（a+bi）（a-bi）=a2+b2

（2）

下个步骤的复数是 1/z。如何除以 a+ib? 最佳的概念是先乘 z/z=1，在分母产生 zz，这是 a2+b2:

a:，，-g

如果 a2+b2=1，就是说（a+ib）1 是 a-ib。在单位圆上，1z=。稍后我们会说：1/eiθ 是 e-i0。使用距离 r 与角度 0 去乘与除。

网址：linear.neocities.org 箱：876152660@qq.com 433

极形式 reiθ

a2+b2 的平方根是 | z|，这是数字 z=a+ib 的绝对值（或是模量），平方根 | z | 也写成 r，因为它是从 0 到 z 的距离。极形式的实数 r 给出复数 z 的大小：

z=a+ib 的绝对值是 z=vVa2+62，

称为 r

z=3+2i 的绝对值是 | z|=√32+22，这是 r=√13

极形式的另一个部分是角度 0，z=5 的角度是 0=0（因为 z 是正的实数），z=3i 的角度是 π2 弧度（radian），负数 z=-9 的角度是 π 弧度，数字取平方时角度变成两倍。极形式在复数乘法非常棒（加法就不好了）。

当距离是 r 且角度是 0，三角学给出三角形的另外两个边。实部（沿着底部）是 a=rcos0，虚部（上或下）是 b=rsin0，两者放在一起，矩形形式变成极形式 rei。

数字 z=a+ib 也是 z=rcos0+irsin0，这是 rei0。

注解：cos0+isin0 有绝对值 r=1，因为 cos20+sin20=1。于是 cos0+isin0 落在半径 1 的圆上 — 单位圆。

范例 1 求 z=1+i 与 z=1-i 的 r 与 0。

解 z 与 z 有相同的绝对值，它是 r=√1+1=√2:

|2|2=12+12=2 同时 | 2=12+（-1）2=2

从圆心出发的距离是 r=√2。角度 θ 又是多少？数字 1+i 是复数平面的点（1，1），到这个点的角度是 π/4 或是 45°，余弦是 1/√2，正弦也是 1/√2，结合 r 与 0 可以带回 z=1+i:

r cosθ+ ir sin0= （）+N2（） =1+i

到达共轭 1-i 的角度可以是正也可以是负，我们可以走 7π/4 这是 315°，或者我们可以反向走负的角度－π/4 弧度或是－45°。如果 z 在角度 θ，它的共轭 z 就会在 2π－0，同时也是－0。

我们可以自由的加 2π 或 4π 或－2π 到任意的角！这些角度走完整个圆所以终点是相同的，说明了为什么 θ 有无限多的选择。通常我们选择角度在 0 与 2π 之间，但是－0 对于共轭 z 非常有用，而且 1=e0=e2πi。

请尊重版权与译者的劳动成果，侵权必究！ 434

次方与乘积：极形式

计算（1+i）2 与（1+i）8 在极形式很快速，这个形式有 r=√2 与 0=π4（或 45°）。如

果我们把绝对值平方得到 r2=2，角度变成两倍得到 20=π2（或 90°），我们得到

（1+i）2。对于 8 次方我们需要 r8 与 80:

（1+）8r8=2.2.2.2=16 以及 80=2π

这表示：（1+i）8 有绝对值 16 以及角度 2π，所以（1+i）8=16。

次方在极形式很简单，复数乘法也是一样：

z=r（cos0+isin0） 的 n 次方是

z＂=r＂（cos n0+i sin n0）

（3）

上述情况是 z 乘自己。要得到 z 乘 z＇，各自的 r 相乘以及角度相加：

r（cos0+isin0）乘 r＇（cos0＇+isin0＇）=rr＇（cos（0+ 0＇）+isin（0+0＇）（4）

有一个方法是利用三角学来了解，为什么对于 z2 我们得到两倍角 20?

（cosθ+isinθ） x （cosθ+i sinθ）= cos²0+ sin20+ 2i sinθcosθ

实部 cos20- sin20 是 cos 20，虚部 2sin0cosθ 是 sin 20，这些是二倍角公式，他

们显示 z 的 θ 变成 z2 的 20。

还有第二种了解 z＂规则的方法，它使用了本段落最惊艳的公式。记得 cosθ+i

sinθ 的绝对值是 1，余弦是由偶数次方构成，从 1-02 开始。正弦是由奇数次

方构成，从 0-％03 开始。美丽的事实是 e 结合两个级数变成 cos0+isin0:

+i++

变成

把 i2 写成－1 看到 1-％02，复数 ei0 是 cos0+isin0:

欧拉（Euler）公式 e1=cos0+isinθ 得到 z=rcos0+irsin0=rei0（5）

特殊的－得到 u 跟级数 +++ 的

总和是 1。

现在计算 ei 乘 ei＇，因为指数相加所以角度也相加：

e2 乘 e3 是 e

eiθ 乘 eiθ 是 e2i0

ei0 乘 eie＂是 ei（+）

网址：linear.neocities.org 箱：876152660@qq.com 435

次方（rei）＂等于 rnein，当 r=1 以及 r」=1 时，他们在单位圆上。我们可以

找到 n 个不同的数字，他们的 n 次方都会等于 1:

令 w=e2ni/n，则 1，w，w2.n 次方全部等于 1。

这些是「1 的 n 次方根」，他们是方程式 z」=1 的解，他们是图 9.2b 单位圆上的

等距点，其中整个 2π 除以 n。他们的角度乘 n 得到 n 次方的角，就是 w＂=e2πi，

这就是 1。同时（w2）＂=e4π1=1。上述的每个数字取 n 次方都会环绕圆来到 1。

1 的 n 次方根是信号处理的关键，离散傅里叶转换使用 w=e2πi/n 以及它的次

方。段落 9.3 展示如何利用快速傅里叶转换分解一个向量（信号）成为 n 个频率。

2i0

e4πi/6

2xi/6

eie＇

eie

z6=1 的 6 个解

0

ei（0+6＇）

1

－1

e12πi/6= e2πi = 1

角度相加 0+0＇

e8πi/6

e10πi/6

图 9.2:（a）ei0 乘 eiθ′是 ei（0+0＇）（b）e2πi/n 的 n 次方是 e2πi=1。

主要观念的复习

1. 把 a+i 加到 c+d 就好像（a，b）+（c，）。使用 =-1 去乘。

2.z=a+bi=reiθ 的共轭是 z=z＂=a-bi=re-i0。

3.z 乘 z 是 rei0 乘 re-0，就是 r2=|z2=a2+b2（实数）。

4. 次方与乘积在极形式 z=rei 非常容易。乘 r＇s 以及加 θ＇s。

请尊重版权与译者的劳动成果，侵权必究！ 436

问题集 9.1

问题 1-8 有关复数的运算。

1 对下列配对的复数乘并且加：

（a）2+i， 2-i（b）-1+i，-1+i（c）cos0+isin0， cos0-isin0

2 在复数平面标示位置，有需要的话做简化：

（2+1（2+（2（2+

3 求出下列 4 个数的绝对值 r=|z|，若 0 是 6-8i 的角，其他 3 个数的角度为何？

6-806-8（6+8

4 若 | z|=2 与 | w|=3，则 | z×w|=__且 | z+w|≤＿_且 | z/w|=__且 | z-w|≤＿。＿____5 单位圆上角度是 30°，60°，90°，120° 的数字，求出他们的 a+ib? 若 w 在 30° 角，

检查 w2 在 60° 角。w 的多少次方等于 1?

6 若 z=rcos0+irsinθ，则 1/z 的绝对值是＿_且角度是＿_。它的极形式是

。执行 z×（1/z）得到 1。

7 复数乘法 M=（a+bi）（c+di）是一个 2×2 的实数乘法

［a］［］-［］

右侧包含 M 的实部与虚部，测试 M=（1+3i）（1-3i）。

8A=A1+iA2 是一个复数的 n×n 矩阵及 b=b1+ib2 是一个复数向量，Ax=b 的

解是 x1+x2。把 Ax=b 写成大小 2n 的实数系统：

问题 9-16 有关共轭 z=a-ib=re-i0=z。

9 把 i 改成－i，写下每个数的共轭复数：

（a）2-i（b）（2-i）（1-i）（c）ein/2（就是 i）

e-e（也是 1

10z+z 的总和永远是＿_，z-z 的差永远是＿__。假设 z≠0，z×z 的乘积永远

是＿_，比值 z/z 的绝对值是

网址：linear.neocities.org 箱：876152660@qq.com 437

11 一个实数矩阵，Ax=2x 的共轭是 Ax=x，这个证明两件事情：是另一个

特征值以及 x 是它的特征向量。若 A=［ab；-ba］，求出特征值，λ 与特

征向量 x，x。

12 一个实数 2×2 矩阵的特征值来自二次公式：

得到两个征 +『－4）2

（a）若 a=b=d=1，当 c=__，则特征值是复数。

（b）当 ad=bc，特征值为何？

13 当问题 12 的（迹）2=（a+d）2 比＿__小，则特征值不是实数。证明当 bc>0 时，

λ`s 是实数。

14 一个实数反对称矩阵（AT=-A）有纯虚数的特征值。首先证明：若 Ax=x 则

方块乘法得到

［］«

这个方块矩阵是对称，它的特征值必须是＿__！所以 λ 是

问题 15-22 有关复数 rcos0+ir sinθ 的 re10 的形式。

15 把下列数字写成欧拉形式 rei，然后取平方：

（a）1+√3i（b）cos20+isin20（c）-7i（d）5-5i

16（最爱）求出 z=sin0+icosθ（小心）的绝对值与角度，在复数平面标示这个 z。

把 cos0+isinθ 乘 z 得到＿___。

17 在复数平面画出 z8=1 的 8 个解，这些根 z=w=exp（-2πi/8）的矩形形式 a+ib

为何？

18 在复数平面标示 1 的立方根，标示－1 的立方根，放在一起是的 6 次方根。19 比较 e3i0 =cos30+isin3θ 与（ei0）3=（cos0+isin0）3，利用 cosθ 与 sinθ 求

出三倍角公式 cos3θ 与 sin30。

20 假设共轭 z 等于倒数 1/z，这些可能的 z＇s 为何？

21（a）为什么 ei 与 ie 都有绝对值 1?

（b）在复数平面上靠近 eí 与 ie 的地方放上＊号。

（c）数字 ie 可以是（ein/2）e 或（e5in/2）e，两者相等吗？

22 从 t=0 到 t=2π，画出下列数字在复数平面的路径：

（a） eit （b） e（-1+i）t = eteit （c） （-1）t = etni

请尊重版权与译者的劳动成果，侵权必究！ 438

9.2 埃尔米特与酉矩阵

本段落的重要内容可以用一句话来说明：当你转置一个复数向量或是矩阵 A，也要取他们的共轭复数。不要停在 zT 或是 AT，反转所有虚部的符号。一个列向量有 zj=a1+ibj，优质行向量 zT 是共轭转置，它的分量是 a；-ib:

共轭转置 zT=［z1..zn］=［a1-ib1..an-ibn］

（1）

有一个理由用到 z。实数向量的长度平方是 x12+.+xn2，复数向量的长度平方不是 z12+.+zn2。错误的定义使得（1，i）的长度是 12+i2=0，一个非零向量有零的长度 — 不好。其他的向量要有复数长度，我们不要（a+bi）2，而是想要绝对值的平方 a2+b2 - 这个是（a+bi）乘（a-bi）。

对每个分量，我们想要 z 乘 z，这是 | z2=a2+b2，这个会来自 z 分量乘ā的分量：长度平方 B 元 B++k 是 = 1

（2）

现在（1，i）的长度平方是 12+|i2=2，长度是√2，（1+i，1-i）的长度平方是 4。唯一有零长度的向量是零向量。

长度 z | 是 zTz=zHz=|z1|2+..+|2n2 的平方根。

在深入探讨之前，我们用一个符号取代两个符号。不用横杠代表共轭以及 T 代表转置，我们只使用一个上标 H，于是 zT=zH。这是「z 埃尔米特（Hermitian）」，z 的共轭转置，这个新字念做「Hermeeshan」。这个新符号也应用在矩阵：一个矩阵 A 的共轭转置是 AH。

另一个流行的记号是 A」，MATLAB 的转置指令「＇」自动取得共轭复数（z＇是 zH=zT 以及 A＇是 AH=AT）。

A 是「A 埃尔米特」若 A=［1］则 A=1 复数内积

实数向量的长度平方是 xTx - 这是 x 与自己的内积。复数向量的长度平方是 zz。如果 zz 是与自己的内积，这就是我们想要的。为了实现这件事情，复数内积应该使用共轭转置（不只是转置），这个对于实数向量没有影响。

网址：linear.neocities.org 箱：876152660@qq.com 439

定义实数或是复数向量 u 与 ν 的内积是 uHv:

（3）

复数向量的 uHv 与 v8u 不同，现在向量的顺序很重要，事实上 vHu=vu1+..+Vun 是 uv 的共轭复数。我们需要为了好东西而忍受一些不方便。

范列 1=|｝与 v=| 的内积是［一月［|=0.

范例 1 让人惊讶，向量（1，i）与（i，1）看起来不垂直，但是他们是垂直。零内积仍然表示（复数）向量正交。同理，向量（1，i）与（1，－i）是正交，他们的内积是 1-1。我们正确的得到零内积－我们也可能忘记取共轭，使得（1，i）的长度不正确的变成零。注解我们选择第一个向量的共轭，有些作者选择第二个向量 ν，他们的复数内积就是 uTv，我想这是自由选择。

Au 与 ν 的内积等于 u 与 AHν 的内积：

AH 也称为 A 的「伴随（adjoint）」

（Au）＂y= u＂（A＂y）

（4）

Au 的共轭是 Au，转置 Au 如同平常得到 TAT，这是 uHAH。每件事情应该有效也真的有效，H 的规则来自 T 的规则。

我们一直使用（a-ib）（c-id）是（a+ib）（c+id）的共轭的事实。

AB 的共轭转置是

（AB）H=BHAH

埃尔米特矩阵 S=SH

在实数矩阵中，对称矩阵形成最重要的特殊类别：S=ST，他们有实数特征值以及在正交矩阵 Q 中的正交特征向量。每个实数对称矩阵可以写成 S=QAQ，也可以是 S=QAQT（因为 Q-1=QT）。当 S 是实数，这些全部来自 ST=S。

请尊重版权与译者的劳动成果，侵权必究！ 440 在复数矩阵中，这个特殊类别包含埃尔米特矩阵：S=S，矩阵单元的条件是 sy=5，这种情况下我们称 S 是埃尔米特矩阵。每个实数对称矩阵都是埃尔米特矩阵，因为取共轭没有影响。下个矩阵也是埃尔米特，S=SH:

范例 25 = 主对角线必须是实数，因为 s=5

横跨对角线是共轭 3+3i 与 3-3i。

这个例子会说明所有埃尔米特矩阵的 3 个重要性质。

若 S=SH 且 z 是任意实数或复数列向量，则数字 zSz 是实数。

快速证明：zHSz 当然是 1×1，取它的共轭转置：

（5S）=（）＂再次是 z

所以数字 zHSz 等于自己的共轭，必须是实数。zHSz 是一种「能量」：

23325+5+-356+3）

2|z1|2 与 5|z2|2 这两项来自对角线而且都是实数，非对角线项是彼此的共轭－所以总和是实数（相加时虚部抵消）。整个表述 zHSz 是实数，这个会使得 A 是实数。

埃尔米特矩阵的每个特征值都是实数。

证明假设 Sz=Az，同时用 zH 乘两侧，得到 zHSz=1zHz。左侧 zHSz 是实数，右侧是长度的平方，是正数实数，所以比值ん = Szz 是实数，证明完华。上述的例子有实数特征值 A=8 与 A=-1，因为 S=SH:

=2-72+10-18=（-8）（2+1）

埃尔米特矩阵的特征向量是正交（当他们对应不同的特征值时）：

若 Sz=λz 且 Sy=βy，则 yHz=0。

证明在 Sz=z 的左侧乘 yH，在 yHSH=ByH 的右侧乘 z:

yHS=Ay yHsh=ByH

（5）

两式的左侧相等，所以 AyHz=βyHz，则 yHz 必须是零。

网址：linear.neocities.org 箱：876152660@qq.com 441

在我们的例子中，对应 λ=8 与 β=-1 的特征向量是正交：

（s-89- ［³=3］［=；］-［］-［:］

+-

正交特征向量 y2=［1+6-11［］=0.

这些特征向量的长度平方是 12+12+12=3，除以√3 之后变成单位向量。原来是正交现在是正交单位，他们进入特征向量矩阵 X 的列，可以对角化 S。

当 S 是实数对称，X 是 Q - 正交矩阵，现在 S 是复数而且埃尔米特，它的特征向量是复数并且是正交单位。特征向量矩阵 X 很像 Q，但是复数：QQ=I。我们指定 Q 一个新名字「酉（unitary）」但是仍然叫做 Q。

酉矩阵

一个酉矩阵 Ω 是一个（复数）方形矩阵具有正交单位的列。

酉矩阵可以对角化 S:

这个 Q 也是一个埃尔米特矩阵，我不期待这个！这个例子太完美了，我们会看到这个 Q 的特征值必须是 1 与－1。

实数正交单位的矩阵测试方式是 QTQ=I，零内积出现在非对角线。在复数情况下 QT 变成 QH，当 QH 乘 Q，这些列显示本身是正交单位。内积填满 QHQ=I：每个具有正交单位列的矩阵 Q 都有 Q＂Q=1。

若 Q 是方形，它是一个酉矩阵，则

假设 Q（有正交单位列）乘任意的 z，向量长度会维持不变，因为 zHQHQz=zHz。如果 z 是 Q 的一个特征向量，我们可以学到更多：酉（与正交）矩阵 Q 的特征值全部都有 | 2|=1。

若 Q 是酉，则 ‖z‖=1‖z|‖。因此 Qz=z 得到 ||=1

我们的 2x2 范例同时是埃尔米特（0=Q）与酉（02=），表示有实数特征值以及 | 2|=1。实数而且 | 2|=1 只有两种可能性：特征值是 1 或－1。Q 的迹是 0，所以 1=1 与 λ=-1.

请尊重版权与译者的劳动成果，侵权必究！ 442

范例 3 图 9.3 显示 3×3 的傅里叶矩阵，它是埃尔米特吗？是酉吗？F3 当然是对

称，它等于自己的转置，但是它不等于自己的共轭转置－- 不是埃尔米特。如果你

把 i 变成－i，你得到不同的矩阵。

e2πi/3 120° 1

傅里叶矩阵

e4πi/3

图 9.3:1 的立方根进入傅里叶矩阵 F=F3。

F 是酉？是的。每个列的长度平方是（1+1+1）/3（单位向量），第一列与第二

列正交，因为 1+e2πi/3+e4πi/3=0，这是图 9.3 标示的 3 个数的总和。

注意图形的对称，如果把它旋转 120°，这三个点还在相同的位置，因此他们

的总和 S 仍然在相同位置！旋转 120° 之后，在相同方向唯一可能的总和是 S=0。

F 的列 2 与列 3 正交吗？他们的点积看起来像

（1+ e6πi/3 + e6πi/3）/3=（1+1 + 1）/3

这不是零，因为我们忘了取共轭复数，答案是错误。复数内积要用而不是 T:

（列 2）H（列 3）=（1·1+e-2πi/3e4πi/3+e-4πi/3e2πi/3）/3

=（1 + e2πi/3 +e-2πi/3）/3=0

所以我们得到正交性，结论：F 是一个酉矩阵。

下个段落会学习 n×n 的傅里叶矩阵，在所有的复数酉矩阵中，他们是最重要

的。当我们用 F 乘一个向量，我们在计算它的离散傅里叶转换。当我们用 F` 乘

一个向量，我们在计算它的逆转换。酉矩阵的特殊性质是 F1=F，逆转换的差

别只在于把 i 变成－i:

把 i 变成－i:

一周出剑

每个处理 F 的人都知道它的价值，本章最后一个段落会把傅里叶分析与复数与线

性代数做结合。网址：linear.neocities.org 箱：876152660@qq.com 443

问题集 9.2

1 求出 u=（1+i，1-i，1+2i）与 v=（i，i，i）的长度。求出 uHv 与 vHu.2 计算 AHA 与 AAH，两者都是矩阵：

3 对于问题 2 的 A，求解 Az=0，找出 A 的零空间的向量 z。证明 z 与 AH 的列

正交，证明 z 与 AT 的列不正交。优质行空间不再是 C（AT），现在是 C（AB）。

4 问题 3 指出 4 个基础子空间是 C（AT）与 N（A）与与。他们的维度仍

然是 r 与 n-r 与 r 与 m-r，他们仍然是正交子空间。代号 H 取代 T。

5（a）证明 AHA 永远是埃尔米特矩阵。

（b）若 Az=0 则 AHAz=0。若 AHAz=0，左乘 zH 证明 Az=0。A 与 AHA 的零

空间是＿__，因此当 A 的零空间只包含 z=0 时，AHA 是一个可逆埃尔

米特矩阵。

6 是非题（理由或反例）：

（a）若 A 是实数矩阵则 A+I 是可逆。

（b）若 S 是埃尔米特矩阵则 S+iI 是可逆。

（c）若 Q 是酉矩阵则 Q+iI 是可逆。

7 当你对埃尔米特矩阵 S 乘上一个实数 c，cS 还是埃尔米特吗？当 S 是埃尔米

特矩阵，证明 S 是一个反埃尔米特矩阵。假设「纯量」是实数，则 3×3 埃尔

米特矩阵是一个子空间。

8 下列的 P 属于哪一类矩阵：可逆，埃尔米特，酉？

0i 0

P=00

i00

计算 P2，P3，P100。P 的特征值为何？

9 求出问题 8 的 P 的单位特征向量，然后把他们放进一个酉矩阵 Q 的列，P 的

什么性质使得这些特征向量正交？

10 写出 3×3 循环矩阵 C=2I+5P。它与问题 8 的 P 有相同的特征向量，求出特

征值。

11 若 Q 与 U 都是酉矩阵，证明 Q1 是酉，QU 也是酉。从 Q＂Q=1 与 UU=1

开始。

请尊重版权与译者的劳动成果，侵权必究！ 444

12 你如何知道每个埃尔米特矩阵的行列式是实数？

13 当 A 的列是无关，矩阵 AA 不只是埃尔米特也是正定。证明：若不是零则

zHAHAz 是正数，这是因为

14 对角化下列埃尔米特矩阵得到 S=QAQH:

s=［］

与

s-23

15 对角化下列反埃尔米特矩阵得到 K=QAQH，所有的 A＇s 是

x=［+］

16 对角化下列正交矩阵得到 U=QAQH，现在所有的＇s 是

17 对角化下列酉矩阵得到 U=QAQH，再次所有的 A＇s 是

18 若 ν1，..，vn 是 C」的一组正交单位基底，这些向量当做列的矩阵是＿__矩阵。

证明任意向量等于（v1Hz）v1+.+（vnHz）vn。

19 ν=（1，i，1），w=（i，1，0）与 z=

是

的一组正交基底。

20 若 S=A+iB 是埃尔米特矩阵，它的实部对称吗？虚部对称吗？

21C」的（复数）维度是＿_。求出 C」的一个非实数基底。

22 描述所有的 1×1 与 2×2 的埃尔米特矩阵与酉矩阵。

23AH 的特征值与方形矩阵 A 的特征值有什么关联？

24 若 uu=1，证明 I-2uuH 是埃尔米特也是酉。秩 1 矩阵 uuH 是在 C」的哪条

直线的投影？

27 证明一个埃尔米特矩阵的逆矩阵还是埃尔米特（转置 SS=I）。

28 一个具有正交单位特征向量的矩阵 A 有这样的形式 N=QAQ-1=QAQH，证

明 NNH=NHN。这些 N 恰好是正态矩阵，范例是埃尔米特，反埃尔米特与酉

矩阵。利用 A 中的复数特征值，从 QAQH 创建一个 2×2 的正态矩阵。

网址：linear.neocities.org 箱：876152660@qq.com 445

9.3 快速傅里叶转换

线性代数的许多应用需要时间发展，不容易在一个小时内说明清楚，教师与作者必须在完整原理与加入新应用之间做选择。通常原理获胜，但是本段落是例外，它说明了上个世纪最重要的数值演算法。

我们想要快速的左乘 F 与 F，他们是傅里叶矩阵与逆矩阵，这可以利用快速傅里叶转换达成。一个正常的乘积 Fc 使用 n2 次乘法（F 有 n2 个单元），FFT 只需要 n 乘 ⅓log2n。我们在后面会看到。

FFT 有革命性的信号处理技术，整个工业因为这个概念得到加速，电气工程师是第一个知道差别的 — 当他们看到你（如果你是一个函数），就取傅里叶转换。傅里叶的的概念是把 f 表示成泛音（harmonics）ckeikx 的总和。通过这些系数 ck 在频率空间中看到函数，而不是通过它的数值 f（x）在物理空间中看到。在 c＇s 与 fs 之间往返的通道就是使用傅里叶转换，快速通道使用 FFT。

1 的根与傅里叶矩阵

二次方程式有两个根（或是一个重根），n 次方程式有 n 个根（重复也计算在内），这是线性代数的基础定理，为了让它成立我们必须允许复数根。本段落是关于非常特殊的方程式 z」=1，它的解 z 是「1 的 n 次方根」，他们是复数平面上 n 个环绕单位圆的平均分布点。

图 9.4 显示 z8=1 的 8 个根，他们的距离是（360°）/8=45°。第一个根在 45° 或是 2π8 弧度，也就是复数 w=ei0=ei2π/8。我们称这个数 ws 来强调它是 8 次方根，你可以写成 cos（2π/8）与 sin（2π8），但是不要这么做。其他 7 个 8 次方根是 w2，w3，.，w8，环绕单位圆前进。w 的次方在极形式最佳，因为我们只处理角度 2π8， 4π/8，.，16π/8=2π，这 8 个角度是 45°，90°，135°，.，360°。

w2=i

w³.

w=e2ri/8- cos g +isin g

2π

w4=-1

8

u =1 Real axis

w5

w7-- cos g －isin g

u6=-i

图 9.4:z8=1 的 8 个解是 1，w，w2，.，w7，其中 w=（1+i）/√2。

请尊重版权与译者的劳动成果，侵权必究！ 4461 的 4 次方根也在图上，他们是 i，-1，-i，1，角度现在是 2π/4 或是 90°，第一个根 w4=ei2π/4 就是 i。甚至 1 的平方根也在，w2=ei2π/2=-1，不要忽视了平方根 1 与－1。FFT 背后的概念就是从一个 8×8 傅里叶矩阵（包含 ws 的次方）往下走到 4×4 的矩阵（包含 w4=i 的次方），相同的概念从 4 到 2。利用 Fg 往下到 F4 以及往上到 F16（还可以往上）的关联性，FFT 使得左乘 F1024 非常快速。

我们描述傅里叶矩阵，先从 n=4 开始，它的行包含 1 的次方与 w 的次方与 w2 的次方与 w3 的次方，这些是 1 的 4 次方根，他们有一个特殊的顺序。

傅里叶矩阵

［1 11 1］［11 1 1

n=4

w=i

卡组

矩阵是对称（F=FT），它不是埃尔米特，它的主对角线不是实数，但是 F/2 是一个 ＊

F 的列得到 4 它的矩是也就是 FF

逆矩阵从 w=i 变成 w=-i，让我们从 F 到 F。当快速傅里叶转换给你一个快速的方法左乘 F，F 与 F1 也会做同样的事情。

每个列的长度是√n，所以酉矩阵是 Q=F/√n 以及 Q1=F/√n。我们避免使用√n，只使用 F 与 F=Fin。重点是 F 乘 c，C

1 1 1 1

4 个点的

傅里叶级数

（1）

输入是 4 个复数系数 C0，C1，C2，C3，输出是 4 个函数值 yo，y1，y2，y3。第一个输出 y0=C0+c1+C2+C3 是傅里叶级数∑ckex 在 x=0 的值，第二个输出是级数∑ckex 在 x=2π/4 的值：

y=o+ce242co+22+3

第三与第四个输出 y2 与 y3 是∑ckex 在 x=4π/4 与 x=6π/4 的值，这些是有限傅里叶级数！他们包含 n=4 项以及在 4 个点计算函数值。这些点 0，2π/4，4π/4，6π/4 都是等距离。

下一个点是 x=8π/4 就是 2π，级数回到 yo，因为 e2πi 与 e0=1 相同，每件事情都是周期 4 的循环。这个世界 2+2 是 0，因为（w2）（w2）=w0=1。我们遵循方便性令 j 与 k 从 0 到 n-1（不是 1 到 n），F 的「第零行」与「第零列」都是 1。

网址：linear.neocities.org 箱：876152660@qq.com 447

n×n 矩阵包含 w=e2mn 的次方：

|

/ w

h2

Fc=

w

2（n-1）

C2 = y2 =y

（2）

a

w＂-1 w2（n-1）

w-12 Cn-1

yn-1

Fn 是对称但不是埃尔米特，它的列是正交，且 FF=nI，则 Fn1 是 F/n，逆矩阵包含 wn=e-2mn，检视 F 的模式：

在（行 j，列 k）的单元是 wik，行零与列零包含 w0=1。

当我们把 Fn 乘 c，我们取 n 个点的级数的总和。当我们把 Fn 乘 y，我们从函数值 y 求出系数 c。在 MATLAB 这个指令是 c=fft（y）。矩阵 F 从「频率空间」传送到「物理空间」。【w 是 omega】

重要注解。许多作者偏好处理の = e-2m，这是我们的 w 的共軛复数（他们通常使用希腊字母 omega，我会保持两种选择是分开。）这种选择之下，他们的 DFT 矩阵包含而不是 w，它是 F，我们的 F 的共轭，F 从物理空间到频率空间。

F 完全合理的选！ MATLAB 使用の = e2mN，DFT 矩阵 ff（eye（N）包含这个数の = w 的次方。傅里叶矩阵 F 使用 w＇s 从 c 重建 y，矩阵 F 使用 ws 计算傅里叶系数，如同 fft（y）。

同样重要。当 f（x）的周期是 2π。我们把 x 换成 ei，函数定义成环绕单位圆（其中 z= eiθ），离散傅里叶转换与插值法（interpolation）相同，找出多项式 p（z）=c0+c1z +.+Cn-1z」1 适配于 n 个值 fo，.，fn-1:

插值法

求出 co，..，cn 使得在 n 个点 z=1，.，wn-1 时，p（z）=f。

在这 n 个特殊点的内插值对应的范德蒙矩阵就是傅里叶矩阵。

快速傅里叶转换的一步

我们希望 F 乘 c 越快越好。正常情况下一个矩阵乘一个向量需要 n2 次个别乘法 — 矩阵有 n2 个单元，你可能认为没办法再快了。（如果矩阵有零单元，乘法可以跳过，但是傅里叶矩阵没有零！）利用单元的特殊模式 wk，F 可以用一种方法分解得到很多零，这就是 FFT。

关键概念是连接 Fn 与半幅傅里叶矩阵 Fn2，假设 n 是 2 的次方（比如 n=210=1024），我们会连接 F1024 与两个复制品 F512。

请尊重版权与译者的劳动成果，侵权必究！ 448

当 n=4，关键在于 F4 与两个复制品 F2:

F4

与

=

F2

1¡³¡¡°

11 17

左侧是 F4，没有零。右侧是一个一半是零的矩阵，工作量少了一半。但是等等，这两个矩阵不一样。我们需要两个稀疏又简单的矩阵来完成 FFT 分解：

1

1

1

i 1

FFT 的分解 F4=

1

－1

11 1

1

（3）

1

－i

i2

1

最后是一个排列矩阵，它把偶数 c＇s（c0 与 c2）放在奇数 c＇s（C1 与 C3）前面。中间的矩阵执行针对偶数 c＇s 与奇数 c＇s 的半幅（half-size）转换 F2，左边的矩阵组合两个半幅输出－以一种产生正确全幅（full-size）输出 y=Fc 的方式。

相同的概念可以应用在 n=1024 与 m=n/2=512，数字 w 是 ei2π/1024，它是在单位圆上角度 0=2π/1024。傅里叶矩阵 F1024 充满 w 的次方，FFT 的第一阶段是伟大的分解，是 Cooley 与 Tukey 所发现（1805 年高斯已经预示）:

（4）

I512 是单位矩阵，D512 是对角单元为（1，w，..，w511）的对角矩阵，两个复制品 F512 是我们预期的，不要忘了他们使用 1 的 512 次方根（就是 w2 而已！）排列矩阵把输入向量 c 的偶数与奇数分开得到 c＇=（C0，C2，..，C1022）与 C＂=（C1，C3，.，C1023）。

下列是与 F1024 的分解有相同意义的代数公式：

（FFT 的一步）令 m=n/2，y=Fnc 的前 m 个与后 m 个分量组合成半幅转换

y＇=Fmc＇与 y＂=Fmc＂。方程式（4）展示 n 到 m=n/2 的步骤，如同 Iy＇+Dy＂与 Iy＇-Dy＂:

y=+（wy，j=0…m-1

（5）

yj+m=y1＇-（wnyy1＂，j=0，..，m-1

把 c 分成 c＇与 c＂，利用 Fm 转换成 y＇与 y＂，然后（5）重建 y。

这些公式来自把 CO，.，Cn-1 分开成为偶 C2k 与奇 C2k+1:w 是 Wn。

（6）

网址：linear.neocities.org 箱：876152660@qq.com 449

偶数 c＇s 进入 c＇=（co，c2，..）与奇数 c＇s 进入 c＂=（c1，c3，.），得到了转换 Fmc＇与

Fmc＂。关键是 wn2=wm，得到 wn2k=wmk。

改写（6y=nye+（E（n=y+（ny

（7）

当 j≥m，（5）中的号来自从（wn）提出（wn）m=-1

MATLAB 很容易分开偶数 cs 与奇数并且用 w 去乘，我们使用 conj（F）或等

效 MATLAB 的逆转换 ift，因为 fft 是基于 ω=w=e-2πi/n。问题 16 显示 F 与 conj（F）

是利用行的排列做连接。

MATLAB 的

y＇= ifft （c（0:2:n-2）＊n/2；

FFT 步骤

y＂=ifft（c（1:2:n-1）＊n/2；

d=w.^（0：n/2-1）；

从 n 到 n/2

y = ［y＇+d. ＊y＂； y＇ －d.＊y＂］；

流向图显示 c＇与 c＂穿越半幅 F2，这些步骤依据形状称为「蝴蝶」，则输出 y＇

与 y＂组合（来自 D 的 1 与 i，以及来自－D 的－1 与－i）得到 y=F4c。

从 Fn 到两个 Fms 的简化几乎减去了一半的工作－在分解中看到的零，这个

简化很好但是不伟大，FFT 整体的概念更加有能量。它节省比一半还要多的时间。

00

Co

yo 00

c＇

y＇

1

10

C2

y1

10

－1

i

01

C1

y2 01

－1

c＂

＂

11

C3

y3 11

－1

－i

使用递归的完整 FFT

如果你已经阅读到这儿，你可能猜到接下来是什么。我们把 Fn 简化到 Fn2，然后

到 Fn/4。每个 F512 到 F256，然后 256 到 128，这是一种递归（recursion）

递归是很多快速演算法的基础，这里是步骤 2 的 4 个复制品 F256 与 D（w512 的

256 次方）。偶数的偶数 co，C4，，… 先出现

F

挑选 0，4，8，..

F512

HN

F

挑选 2，6，10，.

F512

HH

F

挑选 1，5，9，.

F 挑选 3，7，11，..

请尊重版权与译者的劳动成果，侵权必究！ 450

我们会计算个别的乘法次数来观察节省了多少。在 FFT 发明之前，计数通常是 n2=（1024）2，大概是一百万个乘法。我没有说这是一个很长的时间，当我们有越来越多的转换要做时成本变大很多－— 这是典型的事情，FFT 的节省也是变多：

大小 n=2 的最终次数从 n2 降低为 n1/2

数字 1024 是 210，所以 1=10，原始的次数是（1024）2 降为（5）（1024），节省因子是 200，一百万变成五千，这是为什么 FFT 有革命性的信号处理。

此处是 nl/2 背后的推理，有 1 层，从 n=2 降到 n=1，每层有 n/2 个来自对角线 D＇s 的乘法，重组来自较低层的半幅输出，这个得到最终次数 nl/2，就是 Ynlog2n。

最后一个关于这个惊人演算法的注解，c＇s 进入 FFT 的顺序有一个惊人的规则，在所有的偶－奇排列之后。写出 0 到 n-1 的二进制（例如 n=4 的 00，01，10，11），把每个位数反序：00，10，01，11，得到比特－反序 0，2，1，3，其中偶在奇之前（见问题 17。）完整图形显示 c＇s 在比特反序，l=log2n 步的递归，最终输出 yo，.，yn-1 就是 Fn 乘 c。

本章的结束是非常基础的概念，矩阵乘向量。

问题集 9.3

1 计算方程式（3）的 3 个矩阵乘积并与 F 做比较，哪 6 个单元你需要知道 i2=-1? 2 逆反方程式（3）的 3 个因子求出 F 的快速分解。

3F 是对称，转置方程式（3）求出新的快速傅里叶转换。

4F6 分解的所有单元与 w6=1 的 6 次方方根有关：

写出这些矩阵，其中 D 有 1，w6，w62 以及 F3 有 w3=w62。计算乘积！

5 若 v=（1，0，0，0）与 w=（1，1，1，1），证明 Fv=w 与 Fw=4v，因此 F`w=v 与

F¹v=__°

64×4 傅里叶矩阵 F2 与 F4 为何？

7 把向量 v=（1，0，1，0）通过 FFT 的 3 个步骤求出 y=Fc，对 c=（0，1，0，1）重做

一次。

8c=（1，0，1，0，1，0，1，0），利用 FFT 的 3 个步骤计算 y=F3c。对 c=（0，1，0，1，0，

1，0，1）重做一次。

网址：linear.neocities.org 箱：876152660@qq.com 451

9 若 w=e2πi/64，则 w2 与√w 在 1 的

次方根与

次方根之中。

10（a）在单位圆画出所有的 1 的 6 次方根，证明他们的总和是零。

（b）1 的 3 个立方根为何？他们的总和也是零？

11 傅里叶矩阵 F 的列是循环排列 P（见段落 8.3）的特征向量，计算 PF 求出特征值 λ1，2，A3，4:

0 1 0 0

λ1

0 0 1 0 11111i 记

135

11111i 记

1389

入 2 λ3

1 0 0 0

λ4

这是 PF=FA 或 P=FAF1，特征向量矩阵（通常是 X）是 F。

12 方程式 det（P-A）=0 是 4=1，再次显示特征值是 λ=

。哪个排列 P 有

特征值 = 1 的立方根？

13（a）C 的两个特征向量是（1，1，1，1）与（1，i，2，i3）

），求出特征值 e。

CO C1 C2 C3

C3 C0 C1 C2 1111 =e1

C2 C3 C0 C1

1111

与

1.23 =e2 1:23

C1 C2 C3 Co

（b）P=FAF1 立即得到 P2=FA2F1 与 P3=FA3F-1，则 C=cI+c1P+c2P2+c3P3

=F（coI+c1Λ+c2A2+c3Λ3）F-1=FEF1。括号中的矩阵 E 是对角矩阵，它包

含 C 的

14 从 E=2I-Λ－Λ3 求出「周期」－1，2，－1 矩阵的特征值，其中 P 的特征值在 Λ 中。角落的－1＇s 使得矩阵变成周期的：

2-10-1 有 co=2，c1=-1，2=0，=-1

15 卷积（convolution）=C 的快速乘法：计算 C 乘一个向量 x，我们可以计算 F（E（Fx），这个直接方法使用 n2 次个别乘法。已知 E 与 F，第二个方法只使用 nlog2n+n 次乘法。有多少来自 E，多少来自 F，多少来自 F1?

16 注意。为什么戸的行 i 与 F 的 N-i 行相同？（数字从 0 到 N-1。）

17 什么是数字 0，1，..，7 的比特－反序？将他们写成二进制（基底 2）的 000，001，.，111 然后反转每个比特的顺序，这 8 个数字现在是

请尊重版权与译者的劳动成果，侵权必究！ 452

第十章

应用

10.1 图形与网络

最近这几年我常常看到一个模型，我发现它很基本很有用，所以我经常把它放在前面。这个模型包含由边连接的节点，称为图形（graph）。

图形通常是显示类型的函数 f（x），点－边类型的图形产生矩阵。本段落主要讨论图形的「关联矩阵（incidence matrix，也有翻译成入射矩阵）」－- 这个告诉我们 n 个节点如何用 m 个边连接。通常 m>n，边比节点多。

对于 m×n 矩阵，有两个基础子空间在 R」，有两个在 Rm，他们是 A 与 AT 的行空间与零空间。他们的维度是 r，n-r 与 r，m-r，来自线性代数最重要的定理，定理的第二部分是行空间与列空间的正交性。我们的目的是展示图形的例子来阐述线性代数的基础定理。

当我建立一个图形与它的关联矩阵，子空间的维度很容易观察，但是我们想要子空间本身－- 正交性有很大帮助。把子空间与图形的来源结合起来是非常重要的，利用特殊化的关联矩阵，线性代数的法则变成基尔霍夫法则。不要被「电流」与「电压」分心，这些矩形矩阵是最佳的。

关联矩阵的每个单元是 0 或 1 或－1，在消元法过程仍然会维持。所有的枢轴与乘数是 ±1，因此 A=LU 的两个因子也只包含 0，1，－1，零空间矩阵也是如此！全部 4 个子空间的基底向量有意想不到的简单分量。这些矩阵不是教科书捏造出来的，他们来自一个在纯数学与应用数学都是绝对重要的模型。

关联矩阵

图 10.1 显示一个 m=6 个边与 n=4 个节点的图形，这个 6×4 矩阵 A 告诉我们哪些点被哪些边连接。第一行的－1，1，0，0 显示第一个边从节点 1 到节点 2（节点 1 的－1 表示箭头往外，节点 2 的 1 表示箭头往内。

A 的行数字是边的数字，列数字 1，2，3，4 是节点的数字。

网址：linear.neocities.org 箱：876152660@qq.com 453

节点

①

@®@

－1 1 0 0

边 1

边 2

－1 0 10

4

A= 0-1 10

－10 0 1

7

89

123456 边

5

6

②

③

边 3

图 10.1:m=6 个边与 n=4 个节点的完整图形：6×4 的关联矩阵 A。

观察图形你就可以写出矩阵。第二个图形有相同的 4 个点但是只有 3 个边，它的关联矩阵 B 是 3×4。

0234

行 1

边

行 3

>

③

行 2

图 10.1:3 个边与 4 个节与没有回圈的树，则 B 有独立的行。

第一个图形是完整－每个节点配对都有一个边相连，第二个图形是一个树（tree）— 图形没有闭回圈（closed loop），这是两个极端。边的最大个数是 n（n －1）/2=6 以及最小保持连接的个数是 n-1=3。

消元法把每个图形简化成树，回圈产生 A 的相关行以及在阶梯形式 U 与 R 的零行。检视第一个图形中由边 1，2，3 构成的大回圈，会产生 U 的一个零行：

－1

这些是典型的步骤，当边 1 与 2 共享节点 1 时，消元法得到没有节点 1 的「捷径（shortcut）边」。如果图形已经有这个捷径边制造出回圈，则消元法得到一整行的零。当灰尘清除我们看到树。

浮现一个概念：当边形成回圈，行是相关。无关的行来自树，这是行空间的关键。我们假设图形是连接的，箭头可以两边前进。在一个边，顺着箭头的流动是「正」，反方向的流动是负。这个流动可能是电流或信号或力量 — 甚至是油或是煤气或是水。

请尊重版权与译者的劳动成果，侵权必究！ 454

当 x1，x2，x3，x4 是节点的电压，Ax 给出电压差：

－1 1 0

0

x2-x1

－1 0 1 0

x3-x1

－1

0

Ax=

x2

x3-x2

－1

x3

（1）

0 /

x4-x1

0 －1 0 1 x4

x4-x2

0 0 －1

x4-x3

让我再说一次，关联矩阵 A 是差分矩阵，输入向量 x 给出电压，输出向量 Ax 给出电压差（沿着边 1 到边 6）。如果电压相等，差是零，这个就是 A 的零空间。1 零空间包含 Ax=0 的解，全部 6 个电压差都是零，表示：全部 4 个电压都相等。每个零空间中的 x 是一个常数向量：x=（c，C，c，c）。A 的零空间是 Rn 的一条直线 — 它的维度是 n-r=1。

第二个关联矩阵 B 有相同的零空间，它包含（1，1，1，1）:

一维零空间:

对应相同的树

－1 ！

我们可以把所有的电压增加或降低相同的量 c 而不会改变之间的差，电压存在一个「任意常数」。把这个跟相同的函数叙述相比，我们可以对函数增加或降低 C 而不会改变导数。

微分在不定秋分加一个「+C」，图形原理把（c，C，C，c）加到向量 x，线性代数把零空间中的任意向量 x2 加到 Ax=b 的一个特定解。

当定积分从一个已知点开始，微积分的「C+」消失。同理当我们设定 x4=0，零空间消失，未知数 x4 被移除，而且矩阵 A 与 B 的第四列也消失（这些列用来乘 x4）。电工程师会说节点 4 被「接地」了。

2 行空间包含全部 6 个行的组合，它的维度当然不是 6。方程式 r+（n-r）=n 必须是 3+1=4。我们从消元过程看到秩 r=3，3 个边之后我们开始形成回圈！新的行不是无关。

我们如何分辨 y=（v1，2，3，4）是否在行空间中？慢的方法是组合行，快的方法是利用正交性：

ν 在行空间中若且唯若它与零空间中的（1，1，1，1）垂直。

向量 ν=（0，1，2，3）测试失败－它的分量总和是 6。向量 ν=（-6，1，2，3）在行空间中：－6+1+2+3=0，这个向量等于 6（行 1）+5（行 3）+3（行 6）。

每个 A 的行的总和是零，对于行空间中的每个向量必须是成立的。

网址：linear.neocities.org 箱：876152660@qq.com 455

3 列空间包含全部 4 个列的组合，我们期待有 3 个无关列，因为它有 3 个无关行。A 的前 3 列无关（任意 3 列都是），但是加上第四列得到零向量，再次说明（1，1，1，1）在零空间。我们如何分辨一个特定向量 b 是否在关联矩阵的列空间中？

第一个答案：尝试求解 Ax=b，这样会错失所有的内在。像以前一样，正交性给出较好的答案。我们现在来到基尔霍夫电路原理的两个著名法则－- 电压法则与电流法则（KVL 与 KCL）。他们是线性代数「法则」的自然表述，很高兴在这里看到左零空间的关键角色。

第二个答案：Ax 是电压差 x1-x1 的向量，如果我们沿着图形的一个封闭回圈把所有的差相加，他们抵消之后留下零。环绕边 1，3，－2（箭头与边 2 的箭头反向）形成的大三角形，这些差会抵消：

差的总和是 0（x2-x1）+（x3-x2）-（x3-x1）=0

基尔霍夫电压法则：Ax=b 的分量，环绕每个回圈的总和是零。

环绕大三角形：

b1+b3-b2=0

测试每个回圈，电压法则决定 b 是否在列空间。只有在 b 的分量与 A 的行一样满足所有相同的相关性时，Ax=b 才有解，消元法得到 0=0，而且 Ax=b 是一致。4 左零空间包含 Ay=0 的解，它的维度是 m-r=6-3:

y

－1-10-100 y2

/ 0 －1 0 －1

y3 00

电流法则 Aly

0 0 －1

0

（2）

У4

0

0 0 / 1

ys 0

y6

真实的方程式个数是 r=3 不是 n=4，理由：4 个方程式的总和得到 0=0，第 4 个方程式自动来自前 3 个方程式。

这些方程式代表什么？第 1 个方程式说－y1-y2-y4=0，进入节点 1 的净流量是零。第 4 个方程式说 y4+y5+y6=0，进入节点 4 的流量减去离开的流量是零。方程式 Ay=0 非常著名而且很基本：

基尔霍夫电流法则：Ay=0 在每个节点，流进等于流出。

这个法则值得排在应用数学的第一位，它表述了「守恒」与「连纹」与「平衡」，没有流失也没有获得。当电流或是力量平衡时，要求解的方程式是 Ay=0。注意这个美丽的事实，平衡方程式中的矩阵是关联矩阵 A 的转置。

请尊重版权与译者的劳动成果，侵权必究！ 456

Ay=0 的真正解是什么？电流本身必须平衡，最简单的方法是环绕一个回圈流动。如果一个单位的电流环绕大三角形前进（前向边 1 与 3，反向边 2），这 6 个电流是 y=（1，-1，1，0，0，0），这个满足 ATy=0。每个回圈的电流是电流法则的解，在每个节点的流进等于流出。一个较小的回圈是前向边 1，前向边 5，反向边 4，则 y=（1，0，0，-1，1，0）也在左零空间。

我们预期 3 个无关 y＇s:m-r=6-3=3，图形中的 3 个小圈是无关。大三角形看起来是第 4 个 y，但是这个流量是较小圈流量的总和，环绕 3 个小圈的流量是左零空间的一组基底。

①

1

1

4

2

④

100110 + 001011 +

5

010101

－1

1

= 0

0

6

②

③

0

3

3 个小圈

大圈

关联矩阵 A 来自有 n 个节点与 m 个边的连接图形，行空间与列空间有维度

r=n-1，A 与 AT 的零空间有维度 1 与 m-n+1:

N（A）常数向量（c，c，.，c）构成 A 的零空间：维度 = 1。

C（A①）任意树的边给出 A 的 r 个无关行：维度 r=n-1。

C（A）

电压法则：环绕所有回圈的 Ax 的分量总和是零：维度 = n-1。

V（AT）电流法则：ATy=（流进）-（流出）=0，利用回圈电流求解。

对于平面的每个图形，线性代数得到欧拉公式：拓扑学第一定理！

（节点个数）-（边个数）+（小圈个数）=1

这是（n）-（m）+（m-n+1）=1。我们例子中的图形是 4-6+3=1。

一个单一的三角形有（3 个节点）-（3 个边）+（1 个回圈），在一个 9 边 10 节点无回圈的图形，欧拉计数是 10-9+0。所有的平面图形都会得到答案 1.

下个图形显示一个具有电流源的网络，基尔霍夫电流法则从 ATy=0 变成 Ay=f，目的在平衡来自外界的源 f。每个节点的流进仍然等于流出，这 6 个边有电导（conductance）c1，..，c6，以及电流源流进节点 1。电流源从节点 4 流出来保持整体的平衡（入 = 出）。问题是：求出 6 个边上的电流 y1，.，y6。

网络中的流量现在引导我们从关联矩阵 A 到拉普拉斯矩阵 ATA。

网址：linear.neocities.org 箱：876152660@qq.com 457

电压与电流与 AIAx=f

我们从节点电压 x=（x1，.，xn）开始，目前为止我们有 Ax 求出沿着边的差 xi-x1，我们也有电流法则 Ay=0 来求出边的电流 y=（y1，..，ym）。如果网络中所有的电阻是 1，欧姆法则会适配 y=Ax，则 ATy=ATAx=0。我们还未到达但是已经接近。如果没有电流源，Ax=0 的解会是无流量：x=0 且 y=0。我可以看到 3 种方法产生 x≠0 与 y≠0。

1 指定固定电压 x1 到一个或多个节点。

2 在一个或多个边加入电池（电压源）。

3 进入一个或多个节点加入电流源，如图 10.2。

x1

y1

y4

y2

ys

X4

y6

x2

X3

y3

图 10.2：从节点 4 到 1 有一个电流源 S 的网络电流 y1 到 y6。

范例图 10.2 引入一个从节点 4 到 1 的电流源 S，这个电流最终会通过网络回流到节点 4。某个电流 y4 直接在边 4 前进，其他电流会走比较远的路程，比如从 1 到 2 到 4，或是从 1 到 3 到 4。利用对称，我预期从节点 2 到 3 没有电流（y3=0），求解网络方程式会确认这个推论。这些方程式的矩阵是 AA，就是图形拉普拉斯矩阵：

0

－1 －1 0

［000111

3 －1 －1

1010

1001 0101 0011］

－1 3 －1 －1

=

－1 3 －1

－1 －1 3

ATA

请尊重版权与译者的劳动成果，侵权必究！ 458

拉普拉斯矩阵不可逆！因为（1，1，1，1）在 A 与 AA 的零空间中，我们无法求解全部 4 个电势（potential）。有一个节点必须接地，令 x4=0 移除第 4 行与第 4 列，剩下一个 3×3 可逆矩阵。现在我们针对未知电势 x1，x2，x3 求解 ATAx=f，其中电流源 S 进入节点 1:

3 －1 －1

S

S/2

电压 ATAx=f

－1 3 －1 x2

得到

S/

－1

＃而石

－1 3 x3 0

S

y

－1

00

S/4

y2

－1 0

0 S/2 S/4

－1

电压 y=Ax

y3

0

0 S/4

0

У4

0 0

S/4 S/2

ys

0 －1 0

S/4

У6

0 0 －1

S

半数的电流直接在边 4 前进，这是 y4=S/2。从节点 2 到 3 没有电流，对称性指出 y3=0 并且现在得到证明。

承认错误。我记得电流从高电压流向低电压，这个产生 y=-Ax 中的负号。当边的电阻不再全部是 1 时，欧姆法则的正确形式应该是 Ry=-Ax。电导比电阻简洁：C=R1 = 对角矩阵。我们现在提出欧姆法则是 y=-CAx。

网络与 ATCA

在实际的网络中，沿着边的电流是两个数的乘积，一个是边的两个端点电势 x 之间的差，电压是 Ax 推动电流。另一个数是 c 是「电导」－- 量测流量通过的难易。在物理与工程中，c 由材料决定。对电流来说，金属的 c 很高，塑胶的 c 很低。对超级导体来说，c 接近无限大。在经济学，c 量测一个边的容量或成本。

整理一下，从关联矩阵 A 可以得知图形，告诉我们节点－边的连接。网络更深入，会指定每个边一个电导 c，这些数字 c1，..，cm 进入电导矩阵 C-— 对角矩阵。对于电阻网络，电导是 1/（电阻），除了基尔霍夫法则对应整体的电流系统之外，我们与欧姆法则对应每个电流。欧姆法则联结边 1 的电流 y1 与电压差 x2-x1:

欧姆法则：沿着边的电流 = 电导乘电压差

对于所有 m 个电流的欧姆法则是 y=-CAx，向量 Ax 给出电势差，然后左乘电导 C。结合欧姆法则与基尔霍夫电流法则 ATy=0，我们得到 ATCAx=0。

网址：linear.neocities.org 箱：876152660@qq.com 459

这个几乎是网络流动的中心方程式，唯一有问题的是右侧的零！网络需要外接的能量 — 一个电压源或是电流源 — 才能发生一些事情。

符号的注解我把电路理论的 Ax 改成－Ax，从高电势流向低电势，当 x1-x2 是正数时，有（正）电流从节点 1 到节点 2-Ax 的建立方式是 x2-x1。在物理学与电工程的负号，在力学工程与经济学中是正号。Ax 对比－Ax 一直是头痛的问题，但是不是无法避免的。

应用数学的注解每个新的应用有它自己的欧姆法则形式，对弹簧来说它是胡克法则，应力 y 是（弹力 C）乘（拉伸 Ax）。对于热传导来说，Ax 是温度梯度。对油流量来说它是一个压力梯度。对统计学的最小平方递归（第十二章）C1 是协方差矩阵。我的教科书：应用数学与计算科学与工程（Wellesley-cambridge Press）实际建立在 ATCA，这是矩阵以及微分方程式平衡的关键。应用数学比表面看起来还要有组织！新的问题中我学习了关注 ATCA。

问题集 10.1

问题 1-7 与 8-14 有关这些图形的关联矩阵。

2

边 1

边 2

2

3

4

5

2

边 3

3

3

4

1 写出三角形图形的 3×3 关联矩阵 A，第一行有－1 在列 1 以及 + 1 在列 2。什么向量（x1，x2，x3）在它的零空间中？你如何知道（1，0，0）不在它的行空间中？

2 写出三角形图形的 AT，求出零空间中的向量 y。y 的分量是边上的电流－环绕这个三角形的电流为何？

3 从第 3 个方程式消去 x1 与 x2 得到阶梯矩阵 U，什么树对应到 U 的两个非零行？

－x1+x2=b1

－x1+x3=b2

－x2+x3=b3

请尊重版权与译者的劳动成果，侵权必究！ 460

4 选一个向量（b1，b2，b3）使得 Ax=b 有解，然后另一个向量 b 得到无解。这些

b＇s 与（1，－1，1）的关系为何？

5 选择一个向量（y1，y2，y3）使得 ATy=f 有解，然后另一个向量 f 得到无解。这些 f＇s 与（1，1，1）的关系为何？方程式 ATy=f 是基尔霍夫＿_法则。

6 计算矩阵乘积得到 ATA。选择一个向量 f 使得 ATAx=f 有解，求出 x。把这些

电势 x 与电流 y=-Ax 以及电流源 f 放进三角图形中，电导是 1 因为 C=17 电导 C1=1 与 C2=C3=2，计算乘积 ATCA。的 f=（1，0-1），求出 ATCAx=f

的解。把电势 x 与电流 y=-CAx 放进三角图形中，此时电流源 f 从节点 3 出，

进入节点 1。

8 方形图形有两个回圈，写出对应的 5×4 关联矩阵 A。求出 Ax=0 的一个解以

及 ATy=0 的两个解。

9 找出 bs 的两个要求使得 5 个差 x2-x1，x3-x1，x3-X2，X4-x2，x4-x3 等于 b1，b2

b3，b4，b。你已经发现在图形中环统两个

的基尔霍夫法则。

10 简化 A 得到阶梯形式 U，三个非零行得到哪个图形的关联矩阵？在方形图形

中你发现一个树 — 找出其他 7 个树。

11 计算矩阵乘积得到 AA，从图形猜测它的单元为何：

（a）ATA 的对角线说明有多少＿进入美国节点。

（b）非对角线的－1 或 0 说明哪些节点配对是。

12 为什么每个叙述对于 ATA 都是正确的？答案是针对 ATA 不是 A。

（a）它的零空间包含（1，1，1，1），它的秩是 n-1。

（b）它是正半定不是正定。

（c）它的 4 个特征值是实数且他们的符号是。

13 电导 C1=C2=2 与 C3=C4=C5=3，计算矩阵乘积 ATCA。求出 ATCAx=f=（1，0，

0，-1）的解。把在节点与边的电势 x 与电流 y=-CAx 放进方形图形中。

14 矩阵 ATCA 不可逆，什么向量 x 在它的零空间中？为什么 ATCAx=f 有一个

解若且唯若 fi+2+3+f4=0?

15 一个 7 节点 7 边的连接图形有多少回圈？

16 对于 4 节点 6 边 3 回圈的图形加上一个新节点，如果你把它连接到一个旧节

点，欧拉公式变成（）-（）+（）=1。如果你把它连接到两个旧节点，

欧拉变成（）-（）+（）=1。

网址：linear.neocities.org 箱：876152660@qq.com 461

17 假设 A 是来自一个连接图形（但是未知）的 12×9 关联矩阵，

（a）A 有多少无关列？

（b）对于 f 什么样的条件使得 Ay=f 有解？

（c）AA 的对角线单元给出进入每个节点的边的个数，这些对角线单元的总和

为何？

18 为什么一个完整的 6 节点图形有 15 个边？一个连接 6 个点的树有几个边？注解化学计量矩阵（stoichiometric）是化学中相当重要的「广义」关联矩阵，它的单元显示每个化学片段（每个列）如何进入每个反应（每个行）。

请尊重版权与译者的劳动成果，侵权必究！ 462

10.2 工程中的矩阵

这个段落展示工程问题如何产生对称矩阵 K（通常 K 是正定），对称与正定的「线

性代数理由」是它的形式 K=ATA 与 K=ATCA。「物理理由」是 ⅓2uTKu 的叙述

代表能量 — 能量永远不是负数。矩阵 C，通常是对角线，包含正的物理常数，例

如电导或是刚度或是扩散率。

我们的最佳范例来自机械与土木与航空工程，K 是刚度矩阵，Kf 是对应外

界力量 f 的结构反应。段落 10.1 转至电工程－- 矩阵来自网络与电路，我会继续跟

上与化学工程有关的练习题！经济学与管理学与工程设计会在本章的后面来到（关

键是最佳化（optimization）。

工程有两个方式引导至线性代数，直接与间接：

直接方式物理问题只有有限个数的片段，联结他们的位置或速度的法则是

线性（移动不会太大或太快），利用矩阵方程式来表述法则。

间接方式物理系统是「连续」，不是个别的质量，质量密度与力量与速度

是 x 或 x，y 或 x，y，z 的函数。利用微分方程式来表述法则。要找到精确的解，

我们利用有限的差方程式或无限的元素方程式来近似。

两种方式都产生矩阵方程式与线性代数，我真正相信没有矩阵你是无法处理

现代的过程。

此处我们表述平衡方程式 Ku=f，加入运动，Md2u/dt2+Ku=f 变成动态，然

后我们利用来自 Kx=AMx 的特征值，或是有限差分（finite difference）。

微分方程式到矩阵方程式

微分方程式是连续的，我们的基础范例是－d2u/dt2=f（x）。矩阵方程式是离散的，

我们的基础范例是 Kou=f。利用第二导数到第二差的步骤，你在一个非常短的空

间会看到一个大图。从两个端点 x=0 与 x=1 的固定边界条件（fixed boundary

condition）开始：

固定固定边界值句题－-1，共中 = 0 与 = 0

（1）

这个微分方程式是线性，一个特定解是 up=-2x2（则 d2u/dx2=-1），我们可以

加上任意「零空间中」的函数。我们不是求解 Ax=0 的一个向量 x，而是求解

－dudx2=0 的一个函数 un（x）。（重点：右侧是零。）

零空间的解是 un（x）=C+Dx（对应一个二阶微分方程式的 2 维零空间），完整

解是 up+un:

网址：linear.neocities.org 箱：876152660@qq.com 463

完整解

u（）=-x2+C+ Dx

（2）

现在从两个边界条件求 C 与 D：令 x=0 然后 x=1，在 x=0，u（0）=0 强制

C=0，在 x=1，ul）-0-를+D=0，D=:

u（x）=-x2+x=（x-x2）求解了固定－固定边界值问题

（3）

差分取代微分

要得到矩阵而不是导数，我们有 3 个基础选择－前向或反向或中心差分，从第一

导数与第一差分开始：

【对应微分，取名「差分」】

.ك－ە－ە（ ي－ە=ە ＂-ە（ىي－ەي

在 x=0 与 x=1 之间，我们把区间分成 n+1 个相等片段，这些片段的宽度是△x

=1/（n+1），在这 n 个断点△x，2△x，. 的 u 值会是我们矩阵方程式 Ku=f 中的未知

数 u1 到 un:

需要计算的解：u=（u1，u2，.，un）≈（u（△x），u（2Δx），.，u（n△x）。零值 uo=un+1=0 来自边界值 u（0）=u（1）=0。

把前向差分与反向差分取代（）1 中的导

（4）

【原文粗体 1 部分写成－1 是错误】

这是我们的矩阵方程式，其中 n=3 与△x=1/4。这两个第一差分是彼此的转

置！方程式是 ATAu=（△x）2f。当我们计算 ATA，我们得到正定第二差分矩阵 K0:

2-1

Kou=（△x2f

得到

0-1

343

（5）

请尊重版权与译者的劳动成果，侵权必究！ 464

这个例子有一个很奇妙的事实，就是这些数字 u1，u2，u3 恰好就是正确值！他们与真实的解 u（x）=（x-x2）在这 3 个网格点 x=，2，3 的值一致。图 10.3 显示真实解（连续曲线）与近似解 u1，u2，u3（恰好位于曲线上），这个曲线是抛物线。

W2

（2））

u1 38

х=0 Δх 2Δ 3Δх 4Δx=1

图 10.3:-=1 的解与固定－固定边界 Kau=（Ax）2f 的解。

如何解释恰好落在 u（x）图形上的完美答案？在这矩阵方程式中，Ko=ATA 是一个「第二差分矩阵」，它给出了一的中心近似。我引入负号是因为第一导数是反对称，第二导数本身就是负数：

的「转置」是，则（）（）是正定

你在矩阵 A 与 AT 可以看到，（A = 前向差分）的转置是（AT=- 反向差分）。我不希望选择一个中心 u（x+△x）-u（x-△x），中心是第一差分的最佳，但是第二差分 ATA 会从 u（x+2△x）拉伸成为 u（x-2△x）：不好。

现在我们可以说明这个完美答案，确切在真实曲线 u（x）=2（x-x2）上。第二差分－1，2，－1 对于直线 y=x 与抛物线是真实的正确！

y=x =0

－（x+△x）+2x-（x-△x）=0（△x）2

yx2

－（x+△x）2+2x2-（x-△x）2=-2（△x）2

这个奇迹可以延续到 y=x3，正确的－d2y/dx2=-6 是从第二差分获得。但是对于 y=x4 我们回到了地球，第二差分不再确切适配－y」=-12x2。这些近似 u1，u2，u3 不会落在 u（x）的图形上。

网址：linear.neocities.org 箱：876152660@qq.com 465

固定端与自由端与变数系数 c（x）

要看到两个新的可能性，我会改变方程式只有一个边界条件：

（）- 共中 00-

（6）

端点 x=1 现在是自由，在这里没有支撑。「悬吊杆只在顶端固定」，自由端 x=1

不存在力。这个转成 du/dx=0 而不是固定条件 x=1 时，u=0。

另一个变化是系数 c（x）=1+x，棒子的刚度随着 x=0 到 x=1 变化，可能它

的宽度改变，或是材料改变。系数 1+x 带来差分方程式的新矩阵。

由于 u4 不再固定在 0，它变成新的未知数。反向差分 A 是 4×4，而且左乘 c（x）

=1+x 变成对角矩阵 C - 在网格点左乘 1+△x，..，1+4△x。下列是 AT，C 与 A:

~

［1-100］［1.25

1000

1.75

（7）

2.0］［00-1 1

矩阵 K=ATCA 会是对称且正定！对称是因为（ATCA）T=ATCATT=ATCA。正定是

因为它通过能量测试：A 有无关的列，所以当 x≠0 就有 Ax≠0。

当每个 x≠0 时就有 Ax≠0，能量 = xTATCAx=（Ax）TC（Ax）>0，

当你针对固定－自由组合去计算矩阵乘积 ATA 与 ATCA，观察 ATA 的最后角落的 1

是如何取代 2。第 4 个方程式有 u4-u3，一个第一（不是第二）差分来自自由边界条

件 du/dx=0。

注意在 ATCA 中，C1，C2，C3，C4 是如何来自方程式（7）的 c（x）=1+x，先前这些 c＇s

就是简单的 1，1，1，1，此处是固定－自由矩阵：

0

0

（8）

请尊重版权与译者的劳动成果，侵权必究！ 466

自由－自由边界条件

假设棒子的两端都是自由，现在 x=0 与 x=1 都有 du/dx=0，两端都没有把棒子固定！物理上来说它是不稳定的 — 没有外力之下可以移动。数学上来说所有的常数函数，比如 u=1，都满足这些自由条件。代数上来说，我们的矩阵 ATA 与 ATCA 是不可逆：

自由－自由范例

Ax = 0.5

向量（1，1，1）在两个零空间中，这个适配了连续问题中的 u（x）=1。自由－自由 ATAu=f 与 ATCAu=f 通常是无解。

在说明更多物理范例之前，我可以写下 6 个这样的矩阵吗？三对角 Ko 在本书出现很多次，现在我们来看它的应用。这些矩阵都是对称，前 4 个正交是正定：

固定－固定

包含弹簧常数

－a

atar

固定自由

包含弹簧常数

K 圆圈 =

自由－自由

周期性 u（0）=u（1）

为了简化，矩阵 K0，K1，K 奇异与 K 圆圈都有 C=I，表示所有的「弹簧常数」是 c1=1。我们引入 A0TC0A0 与 A1TC1A1 来展示弹簧常数如何进入矩阵（没有改变它的正定性质）。我们下一个目标是在其他工程问题中观察相同的刚度矩阵。

网址：linear.neocities.org 箱：876152660@qq.com 467

弹簧线与质量

图 10.4 展示一直线的弹簧连接 3 个质量 m1，m2，m3，固定－固定案例有 4 个弹簧，其中顶端与底部固定，这个得到 K0 与 A0TC0A0。固定－自由案例只有 3 个弹簧；最下方的质量自由悬挂，这个会得到 K1 与 A1TC1A1。自由－自由问题得到 K 奇异。我们想要质量移动与弹簧张力 y 的方程式：

u=（u1，u2，u3）= 质量的移动（往下为正）

y=（y1，y2，y3，y4）或（y1，y2，y3）= 弹簧的张力

固定端

uo=0

固定端

uo=0

C1

张力 y1

弹簧 c1

张力 y

mi

移动 ul

质量 m

移动 u1

C2

y2

弹簧 c2

张力 y2

m2

u2

质量 m2

移动 u2

C3

y3

弹簧 c3

张力 y3

m3

из

质量 m3

移动 u3

C4

y4

自由端

y4=0

固定端

u4=0

图 10.4：弹簧线与质量：固定－固定与固定－自由端

当一个质量往下移动，它的位移是正数（u>0）。对于弹簧来说，张力是正，压缩是负（y<0）。在张力时，弹簧拉伸，所以把质量往内拉，每个弹簧由自己的胡克法则 y=ce 控制：（拉伸力 y）=（弹簧常数 c）乘（拉伸距离 e）。

我们的工作是把这些单一弹簧方程式 y=ce 变成整个系统的向量方程式 Ku=f，力向量 f 来自引力，引力常数 g 会乘每个质量得到往下的力 f=（m1g，m2g，m3g）。

真正的问题在于找出刚度矩阵（固定固定与固定自由），用 3 个步驟建立最佳的 K，不是一个步骤。我们不把移动 u 直接与力 f 直接产生关联，我们连接下表的每个向量会更好：

u = 每个质量的移动 =（u1，..，un）

e = 每个弹簧的伸长 =（e1，..，em）

y = 每个质量的内力 =（y1，.，ym）

f = 每个质量的外力 =（fi，.，fm）

应用数学伟大的框架把 u 连接到 e 到 y 到 f，则 ACAu=f:

и

f

e= Au

A 是 m×n

Al

TAT

y= Ce

C 是 mxm

e

f=ATy

AT 是 n×m

请尊重版权与译者的劳动成果，侵权必究！ 468

我们会写下这两个例子的矩阵 A 与 C 与 AT，首先是两端固定然后是下端自由。

原谅这些矩阵的简洁性，这是他们的重要形式，特别是 A 与 AT 在一起的时候。

伸长度 e 是拉伸距离 — 弹簧被延伸多少，原始的拉伸是零－系统落在桌面上。

当它变成铅锤面竖直，引力开始作用。这些质量往下移动 u1，u2，u3 的距离，每个

弹簧被拉伸或压缩 ei=ui-ui-1，这是端点之间的位移差：

第一弹簧 el=u

（顶端固定所以 u0=0）

每个弹簧的拉伸第二弹簧 e2=u2-u1

第三弹簧 e3=u3-u2

第四弹簧 e4=-u3 （底部固定所以 u4=0）

如果两端移动相同的距离，弹簧就没有拉伸：uj=uj-1 以及 ej=0。这 4 个方

程式的矩阵是 4×3 的差分矩阵 A 以及 e=Au：1 0 0

拉伸矩阵

oNono

－11

e=Au 是

0

（伸长度）

0 －1 1 3

（9）

00 －1

下一个方程式 y=Ce 连接弹簧伸长度 e 与弹簧张力 y，这是对于每个个别弹

簧的胡克法则 y1=ciei，它是与弹簧材料相关的「本质法则」。软的弹簧有小的 c，

所以一般的力也会产生很大的伸长度 e。在弹簧没有被过度拉伸以及材料塑化之

前，胡克线性法则的精确度非常接近实际弹簧。

由于美国弹簧有自己的法则，y=Ce 中的矩阵是对角矩阵 C:

y1=C1

C1

胡克法则

y2=C22 是

C2

（10）

y=Ce

y3 =c3e3

SAAA

C3

y4=C44

C4 e4

结合 e=Au 与 y=Ce，弹簧力（张力）是 y=CAu。

最终来到平衡方程式，应用数学的最基础法则。来自弹簧的内力与质量上的

外力取得平衡，每个质量被上方的弹簧力 y 拉或推，在下方它感觉到弹簧力 y+1

加上引力 f，于是 y=y+1+fj 或 f=y-y+1:

力平衡

fi=y-y2

f=ATy

f2=y2-y3 是

f3=y3-y4

SAAA

（11）

这个矩阵是 AT！力平衡的方程式是 f=ATy，自然转置 e 到 u 矩阵的行与列，得

到 f 到 y 的矩阵。这是框架之美，AT 追随 A 出现，这 3 个方程式结合在一起就是

Ku=fo

网址：linear.neocities.org 箱：876152660@qq.com 469

三结合成 ATCAu=f 或是 Ku=f

K=ATCA 是刚度矩阵（力学）

K=ATCA 是电导矩阵（网络）

有限元素程序花费很大的功夫从成千上万的小片段来组合 K=ATCA，我们发现这 4 个弹簧的 K（固定－固定）是 AT 乘 CA:

G1 0

0

0

如果所有的弹簧都一样，C1=C2=C3=C4=1，则 C=I，刚度矩阵简化成 ATA，它变成特殊的－1，2，－1 矩阵 K0。

注意来自工程的 AA 与来自线性代数的 LU，来自 4 个弹簧的矩阵 A 是 4×3，来自消元法的三角矩阵是方形。刚度矩阵 K 是由 AA 组合而成，再拆散成为 LU。应用数学的一步，其他都是计算数学。每个 K 来自矩形矩阵然后分解成方形矩阵。我可以列出 K=ATCA 的一些性质吗？你已经知道大部分:

1.K 是三对角，因为质量 3 没有连接到 1。

2.K 是对称，因为 C 是对称且 AT 跟随 A。

3.K 是正定，因为 c1>0 且 A 有无关列。

4.K~1 是满（full）矩阵（不是稀疏），所有的单元都是正数。

性质 4 得到一个关于 w=K 的重要事实：若所有的力往下作用 > 0），则所有的移动往下（u1>0）。注意「正」与「正定」不相同，K~1 是正（K 不是），但是两者都是正定。

范例 1 假设所有的 c1=c 与 mj=m，求出移动 u 与张力 y。

所有的弹簧都一样而且质量都一样，但是所有的移动与伸长度与张力不会相同。K~1 包含 1/c 因为 ATCA 包含 c:

mg

3/2

移动

mg

mg

2

mg

3/2

中间质量的位移 u2 比 u1 与 u3 大，单位是正确的：力 mg 除以每单位长度 c 的力是长度 u，则

0

3/2

伸长度

1/2

－1/2

－3/2

请尊重版权与译者的劳动成果，侵权必究！ 470

警告：正常情况下你不可以写成 K-1=A-1C-1（AT）-1

这三个矩阵是 ACA 混合在一起，他们不能轻易的分开。一般来说，ATy=f 有很

多解，4 个方程式的 Au=e 只有 3 个未知数通常是无解，但是 ATCA 给出在框架

内的所有 3 个方程式正确的解。只有当 m=n，所有的矩阵是方形，我们才可以

从 y=（）到 e=C＇y 到 u=A＇e。我们现在会看到

固定端与自由端

移除第 4 个弹簧，所有的矩阵变成 3×3，模式没有改变！矩阵 A 失去了它的第 4

行以及（当然）AT 失去了它的第 4 列，新的刚度矩阵 K1 变成方形矩阵的乘积：

AT 失去的列与 A 失去的行乘以丢失的 c4，所以最快找出新 ATCA 的方法是令旧的

矩阵的 C4=0:

固定－自由

srca

（12）

范例 2 若 C1=C2=C3=1 与 C=I，这是－1，2，－1 三对角矩阵 K1。K1 的最后单元

是 1 而不是 2，这是因为底部的弹簧是自由。假设所有的 m=m:

固定自由

mg 356

这些移动比固定－固定的情况要来的大。u1 的数字 3 是因为全部 3 个质量都把第 1

个弹簧往下拉，下一个质量移动了 3 加上来自下方质量额外的 2，第 3 个质量下

掉更多（3+2+1=6）。弹簧伸长度 e=Au 显示这些数字 3，2，1:

【原文 free-free 是错误，应该是 fixed-fixed】

321

网址：linear.neocities.org 箱：876152660@qq.com 471

两个自由端：K 是奇异

两个自由端表示大麻烦，整个弹簧线都可以移动，A 是 2×3:

（13）

现在 Au=0 有一个非零解，没有弹簧拉伸质量也可以移动。整条线可以被 u=（1， 1，1）平移而且得到 e=（0，0）:

没有件

（14）

Au=0 当然产生 ACAu=0，则 ACA 只有正半定，因为没有 c1 与 c4。枢轴会是 C2 与 c3 而且没有第 3 个枢轴，秩是 2:

（15）

两个特征值是正数但是 x=（1，1，1）是对应 2=0 的一个特征向量，我们只能对特殊向量 f 才可以求解 ATCAu=f，这些力必须相加成 fi+f2+f3=0，或是整条弹簧线（两端自由）会像火箭一样发射。

弹簧圈

第 3 个弹簧会完成从质量 3 回到质量 1 的圆圈，这个不会使得 K 可逆－刚度矩阵 K 圆圈矩阵仍然是奇异：

（16）

枢轴只有 2 与 3/2，特征值是 3 与 3 与 0，行列式是零。当所有的质量一起移动时，零空间仍然包含 x=（1，1，1）。移动向量（1，1，1）在 A 圆圈的零空间中而且 K 圆圈 = ATCA。

让我整理一下这个段落？我希望这个例子会帮助你连接微积分与线性代数，利用差分方程式取代微分方程式。如果你的步阶△x 足够小，你会得到一个完整又满足的解。

方式是一（）- 共中 09000

把棒子分成长度△x 的 N 个片段，利用 Au 取代 du/dx 以及 ATy 取代－dy/dx，现在 A 与 AT 包含 1/△x，端点条件是 uo=0 与［uN=0 或 yN=0］。

请尊重版权与译者的劳动成果，侵权必究！ 472

3 个步骤－d/dx 与 c（x）与 d/dx 对应到 AT 与 C 与 A:

f=ATy 与 y=Ce 与 e=Au 得到 ATCAu=f

这是计算科学与工程的基础范例。

1. 利用微分方程式得到问题的模型

2. 把微分方程式离散化得到差分方程式

3. 了解并且求解差分方程式（以及边界条件！）

4. 说明得到的解答；视觉化；如果需要，重新设计。

除了试验与推导之外，数值仿真变成科学的第三分支。波音 777 的电脑设计要比风洞便宜太多了。

应用数学与计算科学与工程（卫斯理－康桥出版社）的两篇文章开发了深入的整体主题－观看课程内容 math.mit.edu/18085，附有视频演讲（这些演讲也在 ocw.mit.edu 以及 Youtube）。我希望这本书帮助你了解计算背后的框架。

问题集 10.2

1 证明 detA0TC0A0=C1C2C3+C1C3C4+C1C2C4+C2C3C4。也求出固定－自由范例中的

det AiTCia1o

2 求出固定－自由范例中的 A1TC1A1 的逆矩阵，利用右乘 A11C11（A1T）-1。

3 在自由－自由案例中方程式（15）的 ATCA 是奇异，把 3 个方程式 ATCAu=f 相加，

证明我们需要 fi+f2+f3=0。当力 f=（-1，0，1）自我平衡时，求 ATCAu=f 的

一个解，再求出所有的解。

4 自由－自由微分方程式的两个端点条件是 du/dx=0:

（），其中在两个点有－0

两侧积分证明力 f（x）必须自我平衡，f（x）dx=0，或者不存在解。完整解是

一个特定解加上任意常数，对应 u=（1，1，1）的常数在 ATCA 的零空间中。

5 在固定－自由问题中，矩阵 A 是方形可逆，我们分开求解 Ay=f 与 Au=e。

对于微分方程式做同样的事情：

求解 = f（x），其中 y（1）=0。若 f（x）=1，画出图形。

网址：linear.neocities.org 箱：876152660@qq.com 473

6 方程式（6）的 3×3 矩阵 K1=A1TC1A1 分成 3 个「元素矩阵」c1E1+C2E2+C3E3。

对应每个 c 写下这些片段。展示他们如何来自 A1TC1A1 的列乘行，这是有限元

素刚度矩阵如何实际组成的过程。

7 针对 5 个弹簧与 4 个质量以及两端固定，矩阵 A 与 C 与 K 为何？当 C=I 求

解 Ku=ones（4）。

8 比较问题 7 的解 u=（u1，u2，u3，u4）与连续问题－u＂=mg 的解，其中 u（0）=0 与

u＇（1）=0。抛物线 u（x）应该在 x=1/5，2/5，3/5，4/5 对应到 u - 会存在一个（△x）2

的因子作为补偿吗？

9 求解固定－自由问题－u＂=mg 的解，其中 u（0）=0 与 u＇（1）=0。当向量是范例 2

的 u=（3mg，5mg，6mg）时，在 x=1/3，2/3，3 / 比较 u（x）的值。

10 假设 c1=c2=c3=C4=1，m1=2 与 m2=m3=1，针对固定－固定弹簧线求解

ACAu=（2，1，1）。哪个质量移动最多（最大的）？

11（MATLAB）针对 100 个由 c=1 的弹簧连接的质量，求出位移 u（1），.，u（100）。

每个力是 f（i）=0.01，印出固定－固定与固定－自由时，u 的图形。注意 diag（ones（n，

1），d）是有 n 个 1 沿着对角 d 的矩阵。这个打印指令会画出向量 u 的图形：

plot（u， ＇+＇） xlabel（＇mass number＇）； ylabel（＇mass number＇）； print

12（MATLAB）化学工程有来自流体速度的第一导数 du/dx，以及来自扩散的

d2u/dx2。利用前向差分取代 du/dx，然后是中心差分，再然后是反向差分，其

中△x=1/8。画出 3 个数值解的图形，其中

+10=1，其中 u（0）-a（1）=0

这个对流－扩散方程式无所不在，它转换成针对数学财务中的期权价格

Black-Scholes 方程式。

问题 12 发展成在 MIT 中我的计算科学与工程 18.085 课程的第一个 MATLAB

作业。视频在 ocw.mit.edu。

请尊重版权与译者的劳动成果，侵权必究！ 474

10.3 马可夫矩阵，人口与经济

本段落有关正矩阵：每个 a>0，很快说明关键事实：最大的特征值是正数实数，它的特征向量也是如此。在经济学与生态学与人口动态学与随机游走（randomwalk）中，这些事实还有一段长路要走：

马可夫 2max=1

人口 max>1

消耗 λmax<1

2max 控制 A 的次方，我们先观察 2max=1。

马可夫矩阵

一再的使用矩阵 A 乘正数向量 uo:

马可夫矩阵

и1=Auo и2=Aи1=A²и0

在 k 步之后我们得到 A＊uo。向量 u1，u2，u3，. 会趋近一个「稳定状态」u。=（.6，.4）。最后的结果与开始的向量 uo 无关，对于每个 uo=（a，1-a）都会收敛至相同的 u=（.6，.4）。问题是为什么？

稳定状态方程式 Au=u 使得 u 成为对应特征值 1 的特征向量:

稳定状态 ［3］［］-［］＂.

左乘 A 不会改变 u，但是这个不能解释为什么那么多向量 u0 会得到 u。我们的例子可能有一个稳定状态，但是它不必然是吸引的：

不是马可夫 B-［2］

有非吸引的稳定状态 ³］-［

在这个情况下，初始向量 u0=（0，1）会得到 u1=（0，2）与 u2=（0，4），第二个分量一直加倍。用特征值的语言来说，B 有 λ=1 也有 1=2-- 这个产生不稳定。沿着不稳定特征向量的 u 的分量是乘 λ，而且 | 2|>1 代表爆炸。

本段落有关 A 的两个特殊性质，这些性质可以确保一个稳定的（stable）稳定状态，也定义了一个正数马可夫矩阵，以及上方的 A 是一个特定范例：

马可夫矩阵

1.A 的每个单元是正数：aj>0。

2.A 的每个列的总和是 1。

B 的列 2 的总和是 2 不是 1。当 A 是一个马可夫矩阵，马上得到两个事实：

因为 1:A 乘以 uo≥0 得到一个非负 u1=Auo≥0。

因为 2：如果 u0 的分量总和是 1，则 u1=Au0 的分量总和也是 1。

网址：linear.neocities.org 箱：876152660@qq.com 475

理由：当［1.1］u0=1，则 u0 的分量总和是 1，借由性质 2，对于 A 的每一列都是成立的，利用矩阵乘法［1.1］A=［1.1］:

Auo 的分量总和是 1

［1 .. 1］ A0 = ［1 .. 1］0= 1

相同的事实可以应用到 u2=Au1 与 u3=Au2。每个向量 A＊u0 都是非负而且分量的总和是 1，这些是「概率向量」。极限 u 也是一个概率向量－但是我们必须证明存在一个极限。我们会证明正数马可夫矩阵的 2max=1。

范例 1 在丹佛租车的比例开始是 1/50=.02，在丹佛之外是.98。每个月 80％的丹佛车停留在丹佛（20％离开），同时有 5％的外部车进入（95％停留在外），这表示用 A 乘分数（fraction）u0=（.02，.98）:

第一个月

4-［］得到 m1=4=4［］-［］

注意.065+.935=1，代表所有的汽车。每个步骤都是用 A 乘：

下个月 u2=Au1=（.09875，.9125），这是 A2uo。

所有的向量都是正数，这是因为 A 是正数，每个向量 k 的分量总和都是 1。第一分量从 0.02 成长，车子朝着丹佛移动。长期之下会发生什么？

这个段落与矩阵的次方有关，了解 A 是对角化的第一个也是最重要的应用，A 可以很复杂，对角矩阵 A 很简单，特征向量矩阵 X 连接他们：A 等于 XAX1。马可夫矩阵的新应用使用特征值（在 A 中）与特征向量（在 X 中），我们证明 u 是 A 的一个对应 2=1 的特征向量。

由于 A 的每个列的分量总和是 1，没有失去没有获得，我们是在移动车辆或人口，没有车辆或人口突然出现（或消失）。这些比例总和是 1 而且矩阵 A 让他们持续，问题是在 k 个时间周期后，他们是如何分布 — 引导我们到 A。

解 Auo 给定丹佛在 k 步之后的进与出比例，我们对角化 A 去了解 A，特征值是 λ=1 与 λ=.75（迹是 1.75）。

Ax=λx

起始向量 u0 组合 x1 与 x2，这个情况下的系数是 1 与.18:

特征向量的组合

［］-［］+1［］

现在用 A 乘得到 u1，特征向量是乘以 λ1=1 与 λ2=.75:

每个 x 乘以 λ

M1-1［］+（75）（18）］

请尊重版权与译者的劳动成果，侵权必究！ 476

每个月，另一个 λ=.75 乘向量 x2，特征向量 x1 保持不变：

k 步之后

M2=42M0=14［］+（75）（18）［］

这个方程式显示发生什么了，对应 λ=1 的特征向量 x1 是稳定状态，另一个特征向量 x2 会消失，这是因为 | 2|<1。我们走的步越多，我们越趋近 u=（.2，.8）。在极限时，2/10 的车辆在丹佛并且 8/10 在外部。这是马可夫链条（chain）的模式，纵使从 uo=（0，1）开始：

若 A 是一个正数马可夫矩阵（单元 a>0，每个列的总和是 1），则 λ1=1 比其他固有值都要大，特征向量 x1 是稳定状态：

uk=x1+c2（2）kx2+.+cn（n）kxn 永远会趋近 u00=x1

第一点是了解 λ=1 是 A 的一个特征值。理由：A-I 的每个列的分量总和是 1-1=0，A-I 的行的总和是个零行，这些行线性相关，所以 A-I 是奇异，它的行列式是零而且 λ=1 是一个特征值。

第二点是没有特征值可以有 | 2|>1，有这样的特征值，次方 A＊会长大。但是 A 也是一个马可夫矩阵！A 仍然有总和是 1 的正数单元 — 所以没有空间变大。很多关注在于另一个特征值有 | 2|=1 的可能性。

范例 24=［

没有稳定状态，因为 2=-1。

这个矩阵把丹佛内部的车辆全部送到外部，反之亦然。次方 A 在 A 与 I 之间交替，第二个特征向量 x2=（-1，1）在每一步都乘以 λ2=-1-- 但是没有变小：没有稳定状态。

假设 A 或 A 的任意次方的单元都是正数－- 不允许零，在「规则的」或「原始的」情况下，λ=1 比其他特征值要严格的大，次方 A 趋近秩 1 矩阵，这个矩阵的每个列有稳定状态。

范例 3（「每个人都移动」）从 3 个群体开始，在每一步，群体 1 的半数到群体 2，一半到群体 3；其他群体也分成两半移动。起始人口是 p1，p2，p3，一步之后是： 新人口

u1=Auo=

A 是马可夫矩阵，没有人出生或死亡。A 包含零的单元，这是范例 2 的麻烦。但是在两步之后，零从 A2 消失：

两步矩阵

и2= Au0 14 141214 141412 p

网址:linear.neocities.org 箱：876152660@qq.com 477

矩阵 A 的特征值是 1=1（因为 A 是马可夫）与 2=A3=-1/2。A=1 时，特征向量 x1=（1/3，1/3，1/3）会是稳定状态。当 3 个相等的人口分成两半移动，人口会再次相等。从 u0=（8，16，32）开始，马可夫链条趋近它的稳定状态：

8

16

22

20107

到了 u4 会把一个人分成两半，这个可不行。在每一步的总人口是 8+16+32=56，稳定状态是 56 乘（1/3，1/3，1/3）。你可以看到 3 个人口趋近，但是永远无法抵达，他们的极限是 56/3。

挑战问题 6.7.16 建立一个来自网站之间链接的马可夫矩阵，稳定状态会给出谷歌等级。谷歌利用追随链接的随机路径（随机浏览）找出 u，特征向量来自每个网站拜访的比例－快速计算稳定状态的方法。

第二特征值 2 的大小控制收到稳定状态的速度

佩龙－弗罗贝尼乌斯定理

有一个矩阵定理支配这个主题，当 a≥0 时应用佩龙定理（简写），没有要求每个列的总和是 1。我们证明最简洁的形式，当所有的 a>0：任意正数矩阵 A（不需要是正定！）。

针对 A>0 的佩龙定理

在 Ax=λmaxx 中的数字都是严格正数

证明关键概念是检视所有的数字 t，对于某些非负向量 x（除了 x=0 之外）使得 Ax≥tx。我们在 Ax≥tx 中允许不等式，这样才能有很多小的正数候选者 t。对于大的数字 tmax（已经获得），我们会证明等式成立：Ax=tmaxx。

否则，如果 Ax≥tmaxx 不是等式，左乘 A。因为 A 是正数会得到严格的不等式 A2x>1maxAx，因此正数向量 y=Ax 满足 Ay>tmaxy，且 tmax 增加。这个矛盾强迫等式 Ax=1maxx，而且我们得到一个特征值，它的特征向量 x 是正数，这是因为在等式的左侧，Ax 一定是正数。

为了了解没有特征值会比 max 大，假设 Az=λz，由于与可能与负数或复数有关，所以我们取绝对值：使用「三角不等式」有 | 2|z|=|Az|≤A|z|，这个 | z | 是一个非负向量，所以这个 | 2 | 是一个可能的候选者 t，因此 | 2 | 不可能超过 tmax— 这个必须是 2max。

请尊重版权与译者的劳动成果，侵权必究！ 478

人口成长

把人口分成 3 个年龄群体：年龄 < 20，年龄 20 到 39，年龄 40 到 59。在 T 年时，这些群体的数量是 n1，n2，n3，20 年后的人口数量会因为 3 个理由改变：出生，死亡与变老。

1. 生殖 n1=F1n1+F2n2+F3n3 给出新世代

2. 存活 n2=P1n1 以及 n3=P2n2 给出老世代

生育率是 F1，F2，F3（F2 最大），莱斯利（Leslie）矩阵 A 可能看起来像这样：

新

3

F F2F3 n

.041.1.01 n

n2

/

.980

n， 0P20 n，

0.92

这是人口数量最简单的投影，在每一步矩阵 A 都相同。在实际模型中，A 会随着时间改变（来自环境或是内部因素）。教授可能想要引入第 4 个群体，年龄≥60，但是我们不允许这样做。

矩阵 A≥0 但不是 A>0，因为 A3>0，佩龙定理仍然可以应用。最大的特征值是 2max≈1.06。你可以看到世代的移动，从中世代 n2=1 开始：

1.06

1.080.05.00

0.101.19.01

eig（A）=-1.01

A²= 0.041.08.01

A3= 0.060.05.00

－0.01

0.9000

0.040.99.01

一个快速的开始可以来自 u0=（0，1，0），中群体会生殖 1.1 然后存活.92。最新与最老的世代在 u1=（1.1，0，0.92）=A 的列 2，然后 u2=Au1=A2u0 是 A2 的第二列。早期的数字（暂时状态）与 u0 有很大关系，但是渐近（asymptotic）成长率 2max 对每一个初始值都相同。它的特征向量 x=（.63，.58，.51）显示这 3 个群体一起稳定成长。Caswell 的书：矩阵人口模型强调敏感度分析，这个模型永远都不精确。如果矩阵中的 F＇s 与 P＇s 变化 10％，max 会小于 1（表示绝种）吗？问题 19 会显示一个矩阵变化△A 产生特征值变化△A=y（△A）x，此处 x 与 yT 是 A 的右与左特征向量，其中 Ax=dx 与 ATy=λy。

经济学的线性代数：消耗矩阵

一篇有关经济学的线性代数的长文章在这里会格格不入，关于一个矩阵的短注解看起来比较合理。消费矩阵说明多少的输入产生一个单位的输出，这个在描述经济的生产面。

网址：linear.neocities.org 箱：876152660@qq.com 479

消耗矩阵我们有 n 个制造业例如化学品，食物与石油。要生产一个单位的化学品，需要 0.2 单位的化学品与 0.3 单位的食物与 0.4 单位的石油。这些数字进入消耗矩阵 A 的第一行：化学品输出

化学品输入

石油输出

石油输入

行 2 显示生产食物的输入 — 大量的化学品与食物以及少量石油，A 的行 3 显示精炼一单位石油需要消耗的输入。美国在 1958 年实际的消耗矩阵包含 83 个制造业，这个模型在 1990°s 年更大更精确。我们选择的消耗矩阵有一个便利的特征向量。现在问题来了：经济能够满足 y1，y2，y3 对应的化学品，食物与石油需求吗？要做到这样，输入 p1，2，p 有必要提高一些一因为部分的 p 在生产 y 时消耗掉了。输入 p 以及消耗 Ap，得到输出 p-Ap，这项净生产满足需求 y:

问题求出一个向量 p 使得 p-Ap=y 或是 p=（I-A）-y

很明显的线性代数的问题是 I-A 是否可逆？但是还有更多问题，需求输出向量 y 是非负，A 也是，在 p=（I-A）y 的生产水平也必须是非负。实际的问题是：

什么时候（I-A）1 是非负矩阵？

这是针对生产经济（I-A）1 的一个测试，一个能否满足需求的测试。若 A 比 I 小非常多，则 Ap 比 p 小非常多，存在很多输出。若 A 太大，则生产消耗太多而且需求 y 无法满足。

「小」或是「大」决定在 A 的最大特征值（是个正数）：

若 > 1 则（-A）- 有数单元

若 λ1=1 则（I-A）-1 不存在

若 A1<1 则（I-A）是我们想要的非负矩阵

重点在于最后一项，这项推理使用了一个（I-A）1 的优质公式，我们现在给出这个公式。数学里面最重要的无限级数是几何级数 1+x+x2+.，这个级数的总和是 1/（1-x），条件是 x 落在－1 与 1 之间。当 x=1，级数是 1+1+1+.=∞。当 | x|>1，x＂项不会趋近零，这个级数没有机会收敛。

关于（I-A）1 的优质公式就是矩阵的几何级数：

几何级数

（I-A）-1=I+A+A2+A3+..

请尊重版权与译者的劳动成果，侵权必究！ 480

如果你用 A 乘 S=I+A+A2+..，除了 I 以外你会得到相同的级数，因此 S-AS=I，如果级数收敛的话，级数的总和会等于 S=（I-A）1。如果 A 所有的特征值都有 | 2|<1，这个级数收敛。

在我们的案例 A≥0，级数的每一项都是非负，它的总和是（I-A）1≥0。

范列 49 有

.2.3.4

2527

513

这个经济是生产型，A 比 I 小，因为 λmax 是 0.9，要满足需求 y，从 p=（I-A）y 开始，则 Ap 是生产中的消耗，剩下 p-Ap，这就是（I-Ap=y，满足需求。

范例 5-2

这个消耗矩阵 A 太大，需求无法满足，因为生产消耗的比它制造的还要多。级数 I+A+A2+. 无法收敛到（I-A）~1，这是因为 2max>1。当（I-A）1 实际是负数时，级数是成长的。

相同的方式，1+2+4+. 实际上不是 1/（1-2）=-1，但也不是完全错误！问题集 10.3

问题 1-12 有关马可夫矩阵与它们的特征值及次方。

1 求出下列马可夫矩阵的特征值（总和是迹）：

对应 21=1 的稳定状态特征向量为何？

2 利用其他的特征向量，对角化问题 1 的马可夫矩阵成为 A=XAX1:

4-［ ］［＇.9］［］

当－X1 的极限为何？会趋近

3 求出下列马可夫矩阵的特征值与稳定状态特征向量：4141

4 对于每个 4×4 马可夫矩阵，AT 的哪个特征向量对应（已知）特征值 1=1?

网址:linear.neocities.org 箱：876152660@qq.com 481

5 每年会有 2％的年轻人变老以及 3％的年轻人死亡（没有出生），求出下列的稳定状态：

年轻人

.98.000 年轻人

老年人

=.02.970 老年人

死亡］k+1［.00.031 死亡」。

6 一个马可夫矩阵，x 的分量总和等于 Ax 分量的总和。若 Ax=Ax 且 λ≠1，证

明非稳定特征向量 x 的分量总和是 0。

7 求出矩阵 A 的特征值与稳定状态特征向量。说明为什么 A 趋近 A」：

挑战问题：哪个马可夫矩阵产生稳定状态（.6，.4）?

8 排列矩阵的稳定状态特征向量是（1/4，1/4，1/4，1/4），当 0=（0，0，0，1），不会趋

近到上述向量。u1，u2，u3，4 为何？P 的 4 个特征值为何？这些是 λ4=1 的解？

0100

排列矩阵 = 马可夫矩阵 P= 0010

0 0 0 1

1 0 0 0

9 证明一个马可夫矩阵的平方仍然是马可夫矩阵。

10 若 A 一个可大它的特征值是 1 与二，定状态特征向量 x1=

11 填空 A 变成一个马可夫矩阵并求出稳定状态特征向量。当 A 是一个对称马可夫矩阵，为什么 x1=（1，.，1）是它的稳定状态？

12 一个马可夫微分方程式是 du/dt=（A-I）u，而不是 du/dt=Au。A-I 的对角线

是负数，其他都是正数，每个列的总和是 0 不是 1。

针对 B=A-2 - 求出え与为什么 A 有 = 0

乘上 x1 与 x2 且 t→∞时，稳定状态为何？

请尊重版权与译者的劳动成果，侵权必究！ 482

问题 13-15 有关经济学的线性代数。

13 范例 4 消耗矩阵的每个行的总和是 0.9，为什么这样会使得特征值是 0.9? 特征向量为何？

14 使用 I-A 乘 I+A+A2+A3+. 得到 I，级数的总和是（I-A）1 4=［2］

求 A2 与 A3 并且利用这个模式求出级数的总和。

15 下列矩阵中，哪些可以使得 I+A+A2+A3+.. 得到一个非负矩阵（I-A）1? 则经济可以满足需求：

如果需求是 y=（2，6），向量 p=（I-A）y 为何？

16（再次马可夫）下列矩阵有零行列式，特征值为何？

.4.2.3

A=.2.4 .3

.4.4.4

从 u0=（1，0，0）与 uo=（100，0，0）开始，求出 Auo 的极限

17 若 A 是一个马可夫矩阵，为什么 I+A+A2+.. 的总和不是（I-A）1?

18 针对莱斯利矩阵证明 det（A-2D）=0 得到 F1λ2+F2P1λ+F3P1P2=λ3。右侧的 x3 在→时会变大，如果 F1+F2P1+F3PP2>1，左侧在 = 1 时会变大。在 2max>1 的情况下两侧会相等：成长。

19 特征向量的灵敏度：一个矩阵变化△A 产生特征值变化△A，这些变化△1，.，△An 落在（X△AX1）的对角线。挑战：从 AX=XA 开始，特征向量与特征值的变化是 ΔX 与 ΔA:

（A+△A）（X+△X）=（X+△X）（A+△A）变成 A（△X）+（△A）X=X（△A）+（△X）A 忽略小的项（△A）（△X）与（△X）（△A），用 X1 乘最后一个方程式，从里面的项，X1（A）X 的对角线部分给出△A 就是我们想要的。为什么外面的项 X＇A（AX）与 X1△XA 在对角线会抵消？

说明 X1A=ΛX1，然后 diag（AX1△X）=diag（X1ΔXΛ）。

20 假设 B>A>0 表示每个 b>aj>0，佩龙的讨论如何展示 λmax（B）>Amax（A）?

网址：linear.neocities.org 箱：876152660@qq.com 483

10.4 线性规划

线性规划（linear programming）是线性代数加上两个概念：不等式与极小化。开始点仍然是矩阵方程式 Ax=b，但是只有非负的解才可以接受，我们需要 x≥0（表示没有 x 的分量可以是负数）。矩阵是 n>m，未知数比方程式多，如果 Ax=b 有 x≥0 的解，可能会有很多解。线性规划筛选 x≥0 而且极小化下列成本的解：

成本是 C1x1+.+c，nx，致胜向量 x＊是

Ax=b 的非负解而且有最低的成本。

于是线性规划的问题从一个矩阵 A 与两个向量 b 与 c 开始：

i）A 有 n>m：例如 A=［112］（一个方程式，三个未知数）

ii）b 有 m 个分量对应 m 个方程式 Ax=b：例如 b=［4］

ⅲ）成本向量 c 有 n 个分量：例如 c=［538］

问题就是：在满足 Ax=b 且 x≥0 的条件下，极小化 c·x:

极小化 5x1+3x2+8x3 满足条件 x1+x2+2x3=4 且 x1，x2，x3≥0

我们直达主题，没有解释来自何处。线性规划实际上是数学到管理学的最重要应用，快速演算法以及极速代码的发展非常有竞争力。你会看到求出 x 比求解 Ax=b 要困很多，这是因为有額外的要求：x≥0 以及极小化成本 cx。在求解范例之后，我们会解释背景以及著名的「单纯形法（simplex method）」与「内点法（interior point method）」。

首先检视「限制」：Ax=b 且 x≥0，方程式 x1+x2+2x3=4 给出三维空间的一个平面，非负性质 x1≥0，x2≥0，x30 把平面切成一个三角形，解 x 必须落在图 10.5 的三角形 POR 里面。【原文 8.6 是错误，应该是 10.5】

在三角形里面，x 的分量都是正数。在 POR 的边缘，一个分量是零。在角点 P 与 Q 与 R，两个分量是零。最佳解 x 会是这些角点其中之一！我们现在说明为什么。

三角形包含所有满足 Ax=b 且 x≥0 的向量 x，这些 x 称为「可行（feasible）点」，而且这个三角形是「可行集合」。这些点允许成为极小化 c·x 的候选者，这最后一个步骤：

求出在三角形 PQR 中的 x 极小化成本 5x1+3x2+8x3

落在平面 5x1+3x2+8x3=0 的向量有零成本，这个平面与三角形没有交会，在满足 x 的要求下，我们无法得到到零成本。所以增加成本 C 直到平面 5x1+3x2+8x3=C 与三角形交会。当 C 增加，我们有平行的平面往三角形移动。

请尊重版权与译者的劳动成果，侵权必究！ 484

R=（0，0，2）

4 个家庭作业的问题

电脑 2 小时

Ax=b 是平面 x1+x2+2x3=4

三角形有 x1≥0，x2≥0，x3≥0

Q=（0，4，0）学生 4 小时

角点有两个零分量

成本 cTx=5x1+3x2+8x3

P=（4，0，0）博士 4 小时

图 10.5：三角形包含所有非奐解：Ax=b 且 x≥0。最低成本解 x＇是可行集合中的角点 P，Q，R 的其中之一。

第一个碰触三角形的平面 5x1+3x2+8x3=C 有极小成本 C，碰触的点就是解 x。碰触点必须是交点 P 或 Q 或 R 的其中之一，一个移动的平面不可能在碰触三角形的一个角点之前碰触到三角形的内部！所以检查在每个角点的成本 5x1+3x2 +8x3：P=（4，0，0）成本 20 Q=（0，4，0） 成本 12 R=（0，0，2）成本 16

胜利者是 Q，所以 x=（0，4，0）是这个线性规划问题的解。

如果成本向量 c 改变，平行平面会倾斜，如果是小的改变，Q 仍然是赢家。对于成本 c·x=5x1+4x2+7x3，最佳 x 移到 R=（0，0，2），极小成本是 7·2=14。注解 1 某些线性规划极大化收益而不是极小化成本，数学差不多一样。平行平面从比较大的 C 开始，而不是小的值。当 C 变小，他们朝着原点移动（而不是离开），第一个碰触点仍然是角点。

注解 2 需求 Ax=b 且 x0 可能无法满足，方程式 x1+x2+x3=-1 不可能有 x≥0 的解，可行集合是空集合。

注解 3 也可能发生可行集合是无界（unbounded）的情况，如果需求是 x1+x2-2x3=4，很大的正数向量（100，100，98）现在是一个候选者，更大的向量（1000，1000，998）也是。平面 Ax=b 不再切成三角形，两个角点 P 与 Q 仍然是 x 的候选者，但是 R 移到无限远处。

注解 4 一个无界的可行集合，极小成本可能是－∞（负数无限大）。假设成本是－x1 －x2+x3，则向量（100，100，98）使得成本是 C=-102，向量（1000，1000，998）使得成本是 C=-1002。我们现在是收到钱去引入 x1 与 x2，而不是付出成本，实际应用上这是不可能的事情。但是这是理论上的可能，A，b 与 c 可以产生非预期的三角形与成本。

网址：linear.neocities.org 箱：876152660@qq.com 485

原始与对偶问题

第一个问题适配范例中的 A，b 与 c，未知数 x1，x2，x3 代表一位博士的工作时数与

一位学生的工作时数与一台机器的工作时数，每小时的成本是 $5，$3 与 $8。（工

资这么低我感到抱歉。）小时的数字不可能是负数：x1≥0，x2≥0，x3≥0。博士与

学生每小时完成一个家庭作业问题，机器每小时解答两个问题。理论上他们可以

共同完成作业，总共有 4 个问题待解答：x1+x2+2x3=4。

问题是在极小成本 cx 下完成 4 个问题

如果全部三者都在工作，需要一小时完成：x1=x2=x3=1，成本是 5+3+8=16。但是理所当然的博士应该被学生的工作捣乱（学生工作很快但是成本低－问题变

成实际），当学生工作两小时机器工作一小时，成本是 6+8=14，而且解决全部

4 个问题。我们在三角形的 QR 边，这是因为博士没有在工作：x1=0。但是最佳

点是全部由学生解决（在 Q）或是全部由机器解决（在 R），这个例子中学生在 4 个小

时解决全部 4 个问题只要 $12-- 极小成本。

只有 Ax=b 的一个方程式，角点（0，4，0）只有一个非零分量。当 Ax=b 有 m

个方程式，角点就有 m 个非零分量，我们对着 m 个变数求解 Ax=b，其中 n-m

个自由变数设成零。但是不像第三章，我们不知道选择哪 m 个变数。

可能角点的个数是在 n 中选取 m 个分量的方式的个数，这个数字「n 选 m」

与博弈及概率极度相关。n=20 个未知数与 m=8 个方程式（还是小数字），「可行

集合」可以有 10！/8！/12！个角点，这个数字是（20）（19）..（13）=5，079，110，400。

为了极小成本检查 3 个角点还行，检查 50 亿个角点是不可行的方法。下面介

绍的单纯形法快速多了。

对偶问题（dual problem）在线性规划中问题都是成对出现，极小值问题与绝对值

问题－- 原始与它的「对偶（dual）」。原始问题是由一个矩阵 A 与两个向量 b 与 c

组成，对偶问题会转置 A 以及交换 b 与 c：极大化 b·y，下列是我们例子的对偶：

一个作弊提供者靠卖答案解答作业问题，一个问题收费 y 元，或一次性 4y 元

（注意 b=4 已经进入成本。）作弊者必颁比博士或是学生伙食机器便宜：y≤5 与

y≤3 与 2y≤8。（注意 c=（5，3，8）如何进入不等式限制），作弊者极大化收入 4y:

对偶问题

极大化 b·y 受限于 ATy≤c

当 y=3 出现极大值，收入是 4y=12。对偶问题的极大值（$12）等于原始问题

的极小值（$12）。极大值 = 极小值就是对偶。

【dual 翻译成「对偶」比「双重」来的好，因为它有对比的意思！】

请尊重版权与译者的劳动成果，侵权必究！ 486

如果其中之一的问题有一个最佳向量（x® 或 y），则另一个问题也有一样的情形。

极小化成本 c·x 等于极大化收入 b·y

本书从行图与列图开始，第一个「对偶定理」就是有关秩：无关行的个数等于无

关列的个数。那个定理，好像这个，对于小矩阵很容易，极小成本 = 极大输入

在教科书线性代数与应用中有证明。其中一行可以建立简单定理的一半：作弊者

的输入 bTy 不可能超过诚者的成本:

Ax=b， x 20， 4＇yse Bty =（A4x）y=x＇（4y） sx＇e

（1）

完整的对偶性定理说明当 by 达到极大值以及 xc 达到极小值时，他们是相等的：

b·y＊=c·x＊。检视（1）的最后一个步骤，有≤符号：

x≥0 与 s=c-ATy≥0 的点积得到 xTs≥0，这是 xTATy≤xTc。

等式需要 xs=0，所以对于每个 j，最佳解有

x2=0 或 s2=0

单纯形法

消元法是线性方程式的工作机器，单纯形法是线性不等式的工作机器。我们

不能像消元法一样给出那么多空间，但是概念会更清晰。单纯形法以较低成本从

一个角点到相邻的一个角点，最终（实际上是很快）到达极小成本的角点。

一个角点是一个向量 x≥0 满足 m 个方程式 Ax=b，其中最多有 m 个正数分量，

其余 n-m 个分量是零。（这些是自由变数，反向代入法给出这 m 个基础变数，所

有的变数必须是非负或是 x 是一个错误的角点。）对于相邻角点来说，x 的一个

零分量变成正数而且一个正数分量变成零。

单纯形法必须决定哪个分量借由变正「进入」，以及哪个分量借由边零「离

开」，交换的原则是缩小成本，这是单纯形法的一个步骤，朝向 x 前进。

以下是整体的计划，检视目前角点的每个零分量，如果它从 0 变成 1，其他

的非零数必须调整才能维持 Ax=b。利用反向代入法找出新的 x 然后计算在整体

成本 c·x 的变化，这项变化是新分量的「降低成本」r。进入变数是给出最负 r

的分量，这是对于一个新变数的单一单位的最多降低成本。

范例 1 假设目前的角点是 P=（4，0，0），这是博士负责全部的工作（成本 $20），如

果学生工作一小时，x=（3，1，0）的成本降低至 $18，减少的成本是 r=-2。

网址：linear.neocities.org 邮箱：876152660@qq.com 487

如果机器工作一小时，则 x=（2，0，1）的成本也是 $18，降低的成本也是 r=-2。这个情况下单纯形法可以选择学生或机器作为进入变数。

尽管这是个小例子，第一步也可能不会马上得到最佳 x，在这个方法知道要引入多少这样的变数之前，它就要选择进入变数。当进入变数从 0 变成 1，我们计算 r，但是一个单位可能太多或太少，这个方法选择选择离开变数（博士），它移动到图中的 Q 或 R。

引入进入变数越多，成本越低。当其中一个正数分量（调整可以维持 Ax=b）碰到零，程序必须停止。离开变数是第一个碰到零的正数 x1，当这个发生时，会发现一个相邻的角点，然后再出发（从新的角点）发现下个进入或离开变数。

当所有的降低成本都是正数，目前的角点就是最佳 x。在没有增加 c·x 的情况下，没有零分量可以变成正数，没有新的变数应该进入，问题得到解答（我们也可以证明 y® 也找到了）。

注解通常 x 在 an 步之内会抵达，其中 α 不是大数字。

范例 2 极小化成本 c·x=3x1+x2+9x3+x4，限制是 x≥0 与两个方程式 Ax=b:

x1+2x3+x4=4m=2 个方程式

x2+x3-x4=2n=4 个未知数

初始角点是 x=（4，2，0，0）的成本是 c·x=14，它有两个非零分量与 n-m=2 个零分量，零是 x3 与 x4。问题是 x3 或 x4 应该进入（变成非零）。尝试他们的一个单位：

若 x3=1 与 x4=0，则 x=（2，1，1，0）的成本是 16

若 x4=1 与 x3=0，则 x=（3，3，0，1）的成本是 13

与成本 14 做比较，x3 的降低成本是 r=2，正数但是无用。x4 的降低成本是 r=-1，负数且有用，进入变数是 x4。

x4 可以进入多少？一个单位的 x4 使得 x1 从 4 掉成 3，4 个单位会使得 x1 从 4 掉成 0（此时 x2 一路增加到 6），离开变数是 x1，新的角点是 x=（0，6，0，4），成本只有 c·x=10，这是最佳 x，但是要确认的话还要尝试另一个来自（0，6，0，4）的单纯形步骤。假设 x1 或 x3 尝试进入：

从角点（0，6，0，4）开始若 x1=1 与 x3=0，则 x=（1，5，0，3）的成本是 11

若 x3=1 与 x1=0，则 x=（0，3，1，2）的成本是 14

请尊重版权与译者的劳动成果，侵权必究！ 488

这些成本比 10 高，两者的 r 都是正数－不需要付出而离开，目前的角点（0，6，0，4）是最佳解 x。

这些计算可以流水线处理，每个单纯形步骤求解 3 个具有相同矩阵 B（这是 m×m 矩阵维持 A 的 m 个基本列）的线性系统，当一个列进入而一个老的列离开存在一个快速方法更新 B~1，那就是大多数代码组织的单纯形法。

在教科书「计算科学与工程」包含一个有注解的短代码（代码也在 math.mit.edu/cse）。最佳 y＊求解 m 个方程式 Ay=c，在 m 个 x 中不是零的分量，然后我们有最佳 xTs=0，这是对偶：不是 x=0 就是 s=c-ATy 中的「松散」有 s2=0。

当 x2=（0，4，0）是最佳角点 Q，作弊者的价格设定为 y=3。

内点法

单纯形法沿着可行集合的边移动，最终抵达最佳角点 x。内点法是在可行集合的内部移动（其中 x>0），这些方法希望更快的到达 x，他们做得很好。

一个留在内部的方法是在边界设立一个障碍，加入额外的成本，当任何的 x 碰到零时对数会爆炸。最佳向量有 x>0，数字 0 是个小参数，我们朝向零移动。

障碍问题极小化 cTx-θ（logx1+.+logxn），其中有 Ax=b

（2）

这个成本是非线性（代数线性规划在不等式已经是非线性），限制 x>0 已经不需要，这是因为 log xj 在 x1=0 会变成无限大。

这个障碍给出每个 θ 的近似问题，m 个限制 Ax=b 有拉格朗日乘数 y1，.，ym，这是处理限制的好方法。

来自拉格朗日的 yL（x，y，0）=cTx-0（∑logx2）-yT（Ax-b）

（3）

OL/Oy=0 带回 Ax=b，导数 OL/Oy=x；很有趣！

障碍问题的最佳 －-o 就是 xjsj=0

（4）

真正的问题有 x=0，障碍问题有 xs=，解 x（の落在到达 x（0 的中央路径，这些 n 个最佳方程式 x1s=θ 是非线性，我们利用牛顿法的迭代方法求解。

目前的 x，y，s 会满足 Ax=b，x≥0 以及 A①y+s=c，但不是 xjsj=θ。牛顿方法取一个步阶△x，△y，△s，忽略（x+△x）（s+△s）=θ 的第二阶项△x△s，x，y，s 的修正来自线性方程式：

网址:linear.neocities.org 箱：876152660@qq.com 489

AΔx = 0

牛顿步骤

ATAy+Δs=0

（5）

s；Ax；+x；As；=0-x；$；

牛顿迭代法对于每个 0 有二次收敛，然后 0 趋近 0。对偶间隔 xs 通常在 20 到 60 步之后会小于 108，在我的教科书「计算科学与工程」有详细的牛顿步骤，这个例子有 4 个作业。我没有要求学生把作业全部写完，但是 x 如何出现要熟悉。这个内点法通常作为商业软件，针对很多的线性与非线性最佳化问题。

问题集 10.4

1 在 xy 平面画出下列的区域：x+2y=6 与 x≥0 与 y≥0。可行集合的哪个点可

以极小化成本 c=x+3y? 哪个点得到极大值成本。这些点都是角点。

2 在 xy 平面画出下列的区域：x+2y≤6，2x+y≤6，x≥0，y≥0，它有 4 个角点。哪个点极小化成本 c=2x-y?

3 下列区域：x1+2x2-x3=4，x1，x2，x3 全部≥0 的角点为何？证明成本 x1+2x3

在这个可行集合可以是非常负的数。这是一个无界成本的例子：没有极小值。4 从 x=（0，0，2）开始，其中机器解答全部 4 个问题花了 $16，移动到 x=（0，1，）

求出由学生工作所降低的成本 r（每小时的节省）。求出对应博士的 x=（1，0，）

的 r，其中博士工作一小时。

5 从博士角点（4，0，0）开始范例 1，其中 c 变成（5，3，7），证明对应机器的 r 比学生的好，纵使学生的总成本较低。单纯形法有两个步骤，第一个对机器，然

后对学生求 x。

6 选择不同的成本向量 c，使得博士得到工作。改写对偶问题（作弊者有绝对值收入。）

7 一个 6 问题的作业，博士工作最快得到新的限制 2x1+x2+x3=6，则 x=（2，2，0）显示博士工作两小时与学生工作两小时。c=（5，3，8）时，这样的 x 能够极小化成本 cTx 吗？

8 这两个问题也是对偶。证明弱对偶，永远有 yTb≤cTx:

原始问题极小化 cTx，其中 Ax≥b 与 x≥0。

对偶问题极大化 yTb，其中 ATy≤c 与 y≥0。

请尊重版权与译者的劳动成果，侵权必究！ 490

10.5 傅里叶级数：函数的线性代数

这个段落从有限维度到无限维度，我想要说明在无限维度空间的线性代数。第一步：回头看。本书从向量与点积与线性组合开始，我们把这些基础概念转换到无限的情况 — 后面都追随这个。

有无限多分量的向量表示什么？有两种不同的答案，都很棒：

1. 向量是无限长：v=（v1，v2，v3，.），它可能是（1，⅓，4，..）。

2. 向量是一个函数 f（x），它可能是 ν=sinx。

两种方式我们都会使用，傅里叶级数的概念会联结他们。

在向量之后是点积，两个无限向量（v1，v2，v3，..）与（w1，w2，w3，.）的自然点积是一个无限级数：

点积

v·w=V1w1+v2w2

（1）

这个带来新的问题，这是 R」中向量从来没有遇到过的，这个无限级数的总和是一个有限数字吗？级数收敛吗？这是有限与无限第一个也是最大的差别。

当 v=w=（1，1，1，..，总和当然不收斂，这个情况下 y·w=1+1+1+.. 是无限大。由于 ν 等于 w，我们实际是在计算 ν·ν=|ν|2，长度的平方。向量（1，1，1，.）有无限的长度，我们不想要这个向量。因为我们在制定规则，我们没必要包含它，我们只允许具备有限长度的向量：

定义向量 v=（v1，v2，..）且函数 f（x）在我们无限维度的「希尔伯特空间」若且唯若 |ν| 与 |‖f^| 是有限：

‖ν|2=v·v=v12+v2+v32+.. 总和必须是一个有限数字

Ifl＇-（f，）-＂（«）dx

必须是一个有限积分

范例 1 向量 ν=（1，⅓，⅓，.）包含在希尔伯特空间，因为它的长度是 2/√3。我们有一个几何级数的总和是 4/3，ν 的长度是平方根：

长度平方

v.v=1+1/4+1/16+..=1/（1-1/4）=4/3

问题若 ν 与 w 有有限长度，他们的内积会有多大？

答案 v·w=v1w1+v2w2+. 的总和也是一个有限数字，我们可以安全的计算内积，苏瓦兹不等式仍然成立：

苏瓦兹不等式 1 v.w l sllvlll wll

（2）

v·w 与 |‖ν‖‖w | 的比值仍然是 θ（v 与 w 之间的角度）的余弦。纵使在无限维度空间，|cosθ| 也不会超过 1。

网址：linear.neocities.org 邮箱：876152660@qq.com 491

现在转移到函数，这些也是「向量」，函数 f（x），g（x），h（x），. 的空间，定义在 0≤x≤2π，必须比 R＂稍微大一点。f（x）与 g（x）的点积是什么？f（x）的长度是什么？

关键点在连续的情况：利用积分取代总和。不用 v 乘 w 的总和，点积是 f（x）乘 g（x）的积分。把括号内的「点」换成逗号，点积的词换成内积：

定义 f（x）与 g（x）的内积以及 f（x）的长度平方是

（f，g）=5f（x）g（x）dx

/=3 （f（x）y da

（3）

函数的定义区间［0，2π］可以改成不同的区间，例如［0，1］或（-∞，∞），我们选择 2π 是因为我们的第一个例子是 cosx 与 sin x。

范例 2f（x）=sinx 的长度来自于本身的内积：

（， f）= （sin x） ax=x， sinx

这是微积分中的一个标准积分－本身线性代数的一部分。把 sin2x 写成 ⅓－⅓cos2x，我们看出它在平均值 ⅓ 往上往下，平均值乘以区间长度 2π 得到答案 π。

更重要：sinx 与 cosx 在函数空间是正交:（f，g）=0

内是 u2

（4）

这个零没有意外，对于科学非常重要，正交性在两个函数 sinx 与 cosx 之上，正弦与余弦的无限列表，这个列表包含 cos 0x（这是 1）， sin x， cos x， sin 2x， cos 2x， sin 3x， cos 3x， ..

列表中的每个函数都与列表中的其他函数正交。

傅里叶级数

一个函数 f（x）的傅里叶级数是它的正弦与余弦的扩展：

f（x）= ao a cos x+ bi sin x+ a2 cos 2x+ b2 sin 2x+...

（5）

我们有一组正交基底！「函数空间」中的向量是这些正弦与余弦的组合。从 2π 到 4π 的区间，所有的函数重复回到 0 到 2 元，他们是周期函数，重复距离是 2π。

请尊重版权与译者的劳动成果，侵权必究！ 492 记住：列表是无限的，傅里叶级数是无限级数。我们避免 ν=（1，1，1，..）是因为它的长度是无限，现在我们避免像 ⅓+cosx+cos 2x+cos 3x 这样的函数。（注解：这是 π 乘上著名的「delta 函数」δ（x），它是在单一点上的无限「尖波（spike）」。在 x=0 它的高度是％+1+1+. 是无限大，其他在 0<x<2π 的所有点，级数的总和以某种平均方式得到零。）δ（x）的积分是零，但是 δ2（x）dx=∞，所以 delta 函数不允许进入希尔伯特空间。

【原文少了 dx】

计算一个典型总和 f（x）的长度：

（f， f）= （ao +a，cos x+ bsin x+ a2cos 2x +...dx

－a +a cos xtb＇sin x+a， cos 2x . x

llfll2=2zao2+（@2+b2+a22+....）

（6）

第一行到第二行的步骤使用了正交性，所有像乘积 cosxcos2x 的积分都会得到零。第二行包含剩下的项－每个正弦与余弦的平方的积分。第三行计算了这些积分。（12 的积分是 2π，其他的积分得到 π。）如果我们除以他们的长度，我们的函数变成正交单位：

√2cxsinx2x. 是我们的函数空间的一组基底

这些是单位向量，我们可以使用系数 A0，A1，B1，A2，.. 组合他们得到一个函数 F（x），则 2π 与 πs 就从长度公式提出。

函数长度 = 向量长度 | F|2=（F，F）=A02+A12+B12+A22+.

（7）

这里有一个重点，f（x）与 F（x）都适用。只有当系数向量有有限长度时，函数才有有限长度。傅里叶级数给了我们一个在函数与向量的希尔伯特空间之间完美的适配，数在 L2，它的傅里叶系数在 P2。

当希尔伯特空间包含 /（x）的傅里叶系数的向量 v=（ao，1，1，….，则函数空间包含 f（x），两者都有有限长度。

范例 3 假设 f（x）是个「方形波」，在 0≤x<π 时等于 1，在 π≤x<2π 时掉到－1，然后 + 1 与－1 一直重复。这个 f（x）是个类似正弦的奇函数，所有的余弦系数都是零。我们会求出它的傅里叶级数，只包含正弦：

方形波

）-4（sin sig sins.

（8）

这个函数的长度是√2π，这是因为在每一点（f（x）2 是（-1）2 或是（+1）2:

I|-3＂（f（«）dx=＂1dx=2

网址：linear.neocities.org 箱：876152660@qq.com 493

在 x=0 正弦是零而且傅里叶级数也是零，这是从－1 跳到 + 1 的一半。当 x=π/2 时傅里叶级数也很有趣，在这个点方形波等于 1，（8）中的正弦在 + 1 与－1 交替：

π 的公式

+

（9）

乘得到那个名数字法的公式 4+

傅里叶系数

我们如何求出乘上正弦与余弦的系数 a＇s 与 b＇s? 给定一个函数 f（x），我们想要知道它的傅里叶系数 ak 与 bk:

傅里叶级数 f（x）=a0+a1cosx+b1sinx+a2cos2x+.

这是求出 a1 的方法，两侧同乘 cosx，然后从 0 到 2n 积分。

关键是正交性！除了 cos2x 之外，右侧所有的积分都是零：

系数 a1

＂f（«）cos xdx=，＂a， cos² xdx=πa

（10）

除以 π 你得到 a1。要求出其他的 ak，用 coskx 乘傅里叶级数，从 0 到 2π 积分。利用正交性，所以只留下 akcos2kx 的积分，这个积分是 πak，除以 π：

a-1o f（r）cos kr dar

相似的

b- ）sin kr de

（11）

a0 是例外，这次我们乘 cosOx=1，1 的积分是 2π：

常数项

a=）= の的平均值

（12）

我使用这些公式去求方程式（8）的方形波的傅里叶系数，f（x）coskx 的积分是零，f（x）sin kx 的积分是 4/k，此时 k 是奇数。

比较 R＂中的线性代数

无限维度的希尔伯特空间很像 n 维空间 R＂，假设非零向量 v1，.，v 在 R＂中正交，我们想要把向量 b（而不是函数 f（x）写成这些 v＇s 的组合：

有限正交级数

b=CiV1+C2v2+...+CnVn

（13）

使用 v1T 同时乘两侧，利用正交性，所以 v1Tv2=0，只留下 c1 项：

系数 c1

v1Tb=c1v1Tv1+0+..+0 因此 C1=v1Tb/v1Tv1

（14）

分母 v1Tv1 是长度平方，好像方程式（11）的 π。分子 v1Tb 是好像∫f（x）cosxdx 的内积。当基底向量正交时，很容易求出系数。

请尊重版权与译者的劳动成果，侵权必究！ 494

我们只是在做一维的投影，找出沿着每个基底向量的分量。

当向量是单位正交时，这个公式会更好，我们在 Q 有单位向量，分母 kT 全部是 1，你知道 Ck=vkTb 的另一个形式：

c＇s 的方程式

C1V1+C2v2+.+Cnvn=b 或是

Qc=b 得到 c=QTb，一行一行的 Ck=qkTb。

傅里叶级数很像一个有无限多正交列的矩阵，这些列是基底函数 1，cos x， sin x，. 除以他们的长度之后我们有一个「无限正交矩阵」，它的逆矩阵是它的转置 QT。正交性让我们在积分时把一个级数的项简化成单一项。

问题集 10.5

1 假设 j≠k，针对三角恒等式 2cos jx cos kx=cos（j+k）x+cos（j-k）x 取积分，

证明 cos jx 与 cos kx 正交。当 j=k 时结果为何？

2 当积分从 x=-1 到 x=1 时，证明 1，x，x2 - 是正交。把 f（x）=2x2 写成这些正

交函数的组合。

3 求出一个与 ν=（1，⅓2，4，..）正交的向量 w=（w1，w2，w3，.）。计算它的长度 | w|。4 前 3 个勒让德多项式是 1，x，x2-，选择 c 使得第 4 个多项式 x3-cx 与前 3 个

多项式正交。积分都是从－1 到 1。

5 范例 3 的方形波 f（x）从 1 跳到－1，证明

ff（x）cosxdx=0 5f（x）sinxdx=4 ［f（x）sin2xdx=0

哪 3 个傅里叶系数来自这些积分？

6 方形波有 | f|2=2π，则（6）给出对于 n2 什么样的惊人总和？

7 画出方形波的图形。然后用手画出级数中两个正弦项的总和，或由机器画出

2，3 及 10 项的总和。著名的吉布斯现象是超调（overshoot）跳跃的震荡（这个不

会因为项数变多而消失）。

8 求出下列希尔伯特空间的向量长度

（）（）

网址：linear.neocities.org 箱：876152660@qq.com 495

（b）v=（1，a，a2，..）

（c） f（x）=1 + sin x

9 计算傅里叶系数 ak 与 bk，其中 f（x）定义在 0 到 2π：

（a）f（x）=1，0≤x≤π；f（x）=0，π<x<2π

（b）f（x）=x

10 当 f（x）有周期 2π，为什么从－π 到 π 的积分与 0 到 2π 的积分相等？如果 f（x）

是一个奇函数，f（-x）=f（x），证明 f（x）dx=0。奇函数只有正弦项，偶函

数只有余弦项。

11 使用三角恒等式求出 f（x）的傅里叶级数的两项：

（a）f（x）=cos2x（b）f（x）=cos（x+π/3）（c）f（x）=sin3x

12 函数 1，cos x， sin x， cos 2x， sin 2x，. 是希尔伯特空间的一组基底，把前 5 项函

数的导数写成相同的前 5 项函数的组合。这些函数的 5×5「微分矩阵」为何？ 13 求出中心在 x=0 的方形波脉冲 F（x）的傅里叶系数 ak 与 bk:F（x）=1/h，|x|≤h/2

以及 F（x）=0，h/2<|x|≤π。当 h→0，这个 F（x）趋近一个 delta 函数，求出

ak 与 kk 的极限。

计算科学与工程的段落 4.1 说明正弦级数，余弦级数，完全级数与复数级数

∑cker，也在 math.mit.edu/cse。

本书的段落 9.3 介绍离散傅里叶转换，这是向量的傅里叶级数，可以利用快

速傅里叶转换计算。这个快速的演算法迅速来自特殊的复数 z=ei=cos0+

isin 0，此时角度 0=2πk/n。

请尊重版权与译者的劳动成果，侵权必究！ 496

10.6 电脑图形

电脑图形处理图像，图像会搬迁，比例会调整，三维投影在二维，所有的重要运

算由矩阵完成 — 但是这些矩阵的形状会很惊人。

三维空间的转换由 4×4 矩阵完成，你可能会预期是 3×3，这项改变的理由是 4

种关键运算其中之一无法使用 3×3 的矩阵乘法完成。以下是 4 种运算：

平移

（原点移到另一点 Po=（xo，yo，zo）。

调整比例

（所有的方向都是 c 倍，或是不同的因子 C1，C2，C3。）

旋转

（环绕通过原点的轴，或是通过 Po 的轴。）

投影

（投影在通过原点的平面或是通过 Po 的平面。）

平移最简单－每个店都加上（xo，yo，zo），但是这个表示线性！没有 3×3 矩阵可以移

到原点，所以我们改变原点的坐标值到（0，0，0，1），这是为什么矩阵是 4×4 的原因。

点（x，y，z）的「齐次（homogeneous）坐标」是（x，y，z，1），我们现在展示如何工作。

1. 平移沿着向量 vo 移动整个 3 维空间，原点移动到（xo，yo，zo），这个向量 vo 加

到 R3 的每个点 v。使用齐次坐标，4×4 矩阵 T 把整个空间移动 vo:

1 0 0 0

平移矩阵

0 1 0 0

T= 0 0 1 0

xo yo z0 1

重要：电脑图形处理行向量，我们有行乘矩阵而不是矩阵乘列，你可以快速的检

查［00 0 1］T=［xo yo zo 1］。

要把（0，0，0）与（x，y，z）移动 vo，改变到齐次坐标（0，0，0，1）与（x，y，z，1）。乘 T，

一个行向量乘 T 得到一个行向量。每个 ν 移动到 ν+V:

［x y z 1］T=［x+xo y+yo z+zo 1］

这个输出说明任意 ν 会移到哪儿。（它到了 v+vo）。平移已经由一个矩阵完成，这

个在 R3 无法做到。

2. 重调比例要让一个图像适配一整页，我们改变它的宽度与高度，一台复印

机会重调一张图 90％的比例。在线性代数，我们乘 0.9 倍的单位矩阵，这个矩阵

通常是平面的 2×2 与立体的 3×3。在电脑图形，已经是齐次坐标的情况下，这个

矩阵是等比例放大：

.9

c 0 0 0

重调平面比例

重调立体比例 S= 0 c 0 0

S=

.9

00 c 0

1

0 0 0 1

网址：linear.neocities.org 箱：876152660@qq.com 497

重要：S 不是 cI，我们维持「1」在右下角，则［x，y，1］乘 S 在齐次坐标是正确的。原点仍然停留在正常位置，这是因为［001］S=［001］。

然后我们把那个 1 改成 c，结果会很奇怪，点（cx，cy，cz，c）与（x，y，z，1）相同，这个齐次坐标的特殊性质是乘 cI 不会移动点。R3 的原点有齐次坐标（0，0，0，1）以及对应每个非零 c 的（0，0，0，c），这是隐藏在「齐次」这个词背后的概念。

调整比例可以在不同方向有不同的比例，要把一个「全页」图片适配成半页，y 方向比例要调成 1/2。要建立边距，把 x 方向比例设成 3/4。图形矩阵是对角但不是 2×2，要调整平面需要 3×3，要调整空间需要 4×4:

34

Ci 0 0 0

0

调整矩阵 S=

与

C2 0 0

12

S= 0 0

0

1

C3

0 0 0

最后的矩阵调整 x，y，z 方向的比例是 c1，C2，C3，所有矩阵额外列留下额外的 1 在每个向量的末端。

综整：调整矩阵 S 与平移矩阵 T 有相同的大小，他们可以相乘。要先平移再调整，计算乘积 vTS，要先调整再平移，计算乘积 vST。他们不一样吗？是的。

R3 的点（x，y，z）有在 P3 的齐次坐标（x，y，z，1），这个「投影空间」与 R4 不同，它仍然是 3 维。要达成这样的事情，（cx，cy，cz，c）与（x，y，z，1）是相同的点，投影空间 P3 的这些点实际上是 R4 中通过原点的直线。

电脑图形使用「仿射（affine）」转换，线性加移动。一个仿射转换 T 是利用 4×4 矩阵在 P3 执行，其中的矩阵有一个特殊的第 4 列：

A11 a12 A13 0

T（1，0，0） 0

0

A= A21 a22 a23

T（0，1，0） 0

A31 A32 A33 0

T（0，0，1） 0

A41 A42 A43 1

T（0，0，0）

一般的 3×3 矩阵告诉我们 3 个输出，这个告诉我们 4 个。一般的输出来自输入（1，0，0）与（0，1，0）与（0，0，1），当这个转换是线性时，3 个输出会显示所有事情，当这个转换是仿射时，这个矩阵额外包含了来自（0，0，0）的输出，我们知道移动量。3. 旋转在 R2 与 R3 的旋转由正交矩阵 Q 完成，行列式是 + 1。（行列式－1 时，我们得到额外通过镜子的镜射。）当你使用齐次坐标时，就会引入额外的列！

cos θ － sinθ 0

平面转 Q 变成 R= sin θ cosθ 0

0

0 1

请尊重版权与译者的劳动成果，侵权必究！ 498

这个矩阵环绕原点旋转平面，我们该如何环绕点（4，5）旋转一个平面？这个答案带出了齐次坐标的美丽。把（4，5）平移到（0，0），旋转 0，然后把（0，0）平移回去（4，5）：我不会去计算乘积。这个点一次应用一个矩阵：ν 平移到 vT_，旋转到 vT_R，平移回去 vT_RT。因为每个点［xy1］是一个行向量，T_先作用，旋转的中心点（4，5）- 或是写成（4，5，1）- 首先移到（0，0，1），旋转没有改变它，然后 7 把它平移回去（4，5，1），这是它全部该做的。点（4，6，1）移到（0，1，1），旋转 0，再移回去。

在三维，每个旋转环绕一个轴，轴不移动－它是 λ=1 的特征向量直线。假设轴在 z 方向，Q 中的 1 要单独离开 z 轴，R 中额外的 1 要单独离开原点：

0

0

0

0

0 0 0

现在假设旋转是环绕单位向量 a=（a1，a2，a3），有了轴 a，适配进入 R 的旋转矩阵 Q 有 3 个部分：

Q=（c7+0-］（）

轴没有移动，这是因为 aQ=a。当 a=（0，0，1）是在 z 方向，这个 Q 变成前面的 Q - 对应环绕 z 轴的旋转。

线性转换 Q 永远进入 R 的左上方块，它的下方我们看到零，因为旋转让原点留在正确位置。当这些不是零，这个转换是仿射而且原点会移动。

4. 投影在线性代数课程中，大部分的平面通过原点。实际生活中，大部分都不会。通过原点的平面是向量空间，其他平面是仿射空间，有时候称为「平（flats）」。仿射空间来自平移一个向量空间。

我们想要把三维向量投影在平面，从通过原点的平面开始，平面的单位法向量是 n，（我们维持 n 是列向量。）平面上的向量满足 nTv=0。一般对于平面的投影矩阵是 I-nnT，要投影向量，用这个矩阵乘。向量 n 投影到零，在平面上的向量 ν 投影到自己：

（I －nn＇）n=n-n（n＇n）=0 （I-nn＇）v=v-n（n＇v）=v.

网址：linear.neocities.org 箱：876152660@qq.com 499

在齐次坐标中投影矩阵变成 4×4（但是原点没有移动）：

投影在平面 nTv=0 P= 0

00

现在投影到一个没有通过原点的平面 nT（v-vo）=0，平面上有一个点是 vo，这是仿射空间（或者平），它很像 Ax=b 当右侧不是零的解。一个特定解 vo 加到零空间－产生一个平。

投影到这个平有三个步骤，使用 T_把 vo 平移到原点，沿着 n 的方向投影，再沿着行向量 v0 平移回去：

投影到一个平

－［，］［］［

我情不自禁的注意到 T 与 T + 是可逆：平移与平移回去，他们很像第二章的基础矩阵。

这个练习会包含镜射矩阵，也称为「镜子矩阵」，这些是电脑图形需要的第 5 种形式。镜射会把每个点移动投影两倍的距离－镜射穿过平面来到另一侧，所以镜子矩阵需要把投影 I-nnT 改成 I-2nnT。

矩阵 P 给出「平行」投影，所有的点移动到与 n 平行，直到抵达平面。电脑图形的另一种选择是「透视」投影，因为它含有透视缩短效果，因此更为流行。有了透视，当物体靠近时看起来更大。投影直线朝着眼睛而来，而不是维持在与 n 平行 — 眼睛是投影的中心，这是二维照片的深度所在。

电脑图形的基本问题从一个镜头与一个观看位置开始，理想情况下，屏幕上的图像是观看者看到的景象。最简单的图像指定一个比特给每一个小图元素－称为像素（pixel），它是亮或暗，这个给出没有明暗的黑或白。你可能不同意，事实上我们对于红，绿，蓝三种颜色指定 0 与 28 之间的明暗度，这个表示每个像素有 8＊3=24 比特，乘上像素的数目，需要很大的记忆体！

根本上来说，光栅帧缓冲区指挥电子束，它想电视机一样扫描，品质控制在像素的数目以及每个像素的比特数目。在这个领域，标准的教科书是「电脑图形： 原理与实务」，作者 Hughes， Van Dam， Mcguire，Skylar， Feiner 与 Akeley（第三版，爱德森－卫斯理，2014）。Ronald Goldman 与 Tony DeRose 的注解是很棒的参考。

请尊重版权与译者的劳动成果，侵权必究！ 500

主要观念的复习

1. 电脑图形需要移动运算 T（v）=v+v0 以及线性运算 T（v）=Av。

2.R」中的移动可以利用阶数 n+1 的矩阵执行，使用齐次坐标。

3. 当所有矩阵有 0，0，0，1 在最后一列，［xyz1］的额外分量 1 会保持。问题集 10.6

1R3 的典型点是 xi+yj+zk，坐标向量 i，j，k 是（1，0，0），（0，1，0），（0，0，1），点的

坐标是（x，y，z）。

这个点在电脑图形中是 xi+yj+zk + 原点，它的齐次坐标是（__，＿_，＿_），＿__

对于这个相同点的其他坐标是（__，＿_，＿）。

2 线性转换 T 由已知的 T（i），T（j），T（k）决定，对于仿射转换，我们还需要 T（）。

输入点（x，y，z，1）转换到 x（i）+y）+zT（k）+

34×4 矩阵 T 对应沿着（1，4，3）的平移，矩阵 T1 对应沿着（0，2，5）的平移，计算乘

积 TT1，TT1 是沿着

的平移。

4 写出调整常数 c 的 4×4 比例矩阵 S，计算 ST 以及 TS，其中 T 是平移（1，4，3）。

要环绕中心点（1，4，3）放大照片，你会选择 vST 或 vTS?

5 什么样的调整矩阵 S（齐次坐标，所以是 3×3）可以把标准页 8.5×11 变成 1×1 平

方页？

6 什么样的 4×4 矩阵可以把一个立方体的一个角点移动到原点，然后所有的边

长都放大两倍？这个立方体的角点原来在（1，1，2）。

7 当方程式（1）的 3 个矩阵乘单位向量 a，证明他们给出（cos）a 与（1-cos）a 与

0。相加得到 aQ=a 而且旋转轴没有移动。

8 若 b 与 a 垂直，方程式（1）的 3 个矩阵乘 b 得到（cosθ）b 与 0 与一个垂直 b 的

向量，所以 Qb 与 b 有一个夹角 0，这是旋转。

9 投影在平面 x+y+z=0 的 3×3 投影矩阵 I-nnT 为何？在齐次坐标加上

0，0，0，1 作为 P 中的额外行与额外列。

网址：linear.neocities.org 箱：876152660@qq.com 501

10 使用相同的 4×4 矩阵 P，计算 TPT + 求出在平面 x+y+z=0 的投影矩阵。平移 T 把平面（选择一个）上的一个点移到（0，0，0，1），逆矩阵 T + 把它平移回去。11 把（3，3，3）投影在这些平面。使用问题 9 的 P 以及问题 10 的 TPT+。

12 如果你把一个方形投影到一个平面，你会得到数目形状？

13 如果你把一个立方体投影到一个平面，这个投影的轮廓为何？令投影平面与立方体的一个对角垂直。

14 穿过平面 nTv=0 的镜射的 3×3 镜子矩阵是 M=I-2nnT。求出点（3，3，3）对于平面 3x+3y+3z=0 的镜射点。

15 求出点（3，3，3）对于平面 x+y+z=1 的镜射点。采取 3 个使用 4×4 矩阵的步骤：T 负责平移使得平面通过原点，把平移点（3，3，3，1）T 对于那个平面做镜射，然后使用 T + 平移回去。

16 原点（0，0，0，1）到点（x，y，z，1）的向量是之间的差 ν=

，在齐次坐标，向

量的末端是

，所以我们加

到一个点，而不是加一个点到一个点。

17 如果你只乘每个点最后的坐标得到（x，y，z，c），你调整整个空间的比例是 ，

这是因为点（x，y，z，c）与（，，）相同

请尊重版权与译者的劳动成果，侵权必究！ 502

10.7 密码学的线性代数

1 密码学可以使用字母作为有限场：信息中的字母变成数字 0，1，2，.，p-1。

2 数字相加也相乘（模 p），除以 p 保留余数。

3 希尔密码利用机密矩阵 E（模 p）乘以信息方块。

4 解码时，利用逆矩阵 D（模 p）乘每个方块，不是很保密的密码。

密码学是有关信息的编码与解码，银行一直用这个处理金融信息。令人惊讶的是

现代演算法可以处理极端深入的数学，「椭圆曲线」扮演密码学的一部分，如同

安德鲁－威尔士做的有关费马最后定理耸动的证明。

本段落不会太深入！但是会是我们第一个有限场与有限向量空间的经验，R」

的场包含全部的实数，「模运算」的场只包含 p 个整数 0，1，.，p-1。在 R」存在

无限多的向量－现在只会在信息空间（message space）有长度 n 的 p＂个信息。字母

从 A 到 Z 是有限的（如同 p=26）。

本段落的代码很容易破解 — 他们对于实际的安全性太简单。电脑的能力要求

更复杂的密码学，这是因为电脑的强大很容易侦测到小的编码矩阵。但是一个矩

阵代码（希尔密码）允许我们看到线性代数的新工作方式。

我们所有编码与解码的计算都会是「模 p」，但是线性无关与基底与逆矩阵

与行列式的中心观念在改变中存活。我们会做「有限场的线性代数」，以下是模

p 的意义： 27≡2（模 5）意思是 27-2 可以整除 5

y≡x（模 p） 意思是 y-x 可以整除 p

y 除以 5 会有 5 个可能的余数 x=0，1，2，3，4，所有余数为 0 的数字 5，－5，10，－10，..

与零「全等（congruent）」（模 5）。数字 6，－4，11，－19，. 与 x=1 全等（模 5）。

我们使用全等这个词代表符号 =，我们称为「模运算」，每个整数 y 产生 x=0，

1，2，.，p-1 的数字之一。

如果 p 是一个素数（prime）就是最好的原理，p=26 个字母从 A 到 Z，我们很

不幸的没有从一个素数 ρ 开始，密码学可以处理这个问题。

网址：linear.neocities.org 箱：876152660@qq.com 503

模运算

线性代数是基于向量的线性组合，现在我们的向量（x1，.，xn）是整数字串，整数限定在 x=0，1，.，p-1。当我们以「模 p」处理时，所有的计算都会得到这些整数。这表示每个范围之外的整数 y 除以 p 得到余数 x:

y=qp+x y≡x（模 p） y 除以 p 得到余数 x

加法模 310≡1（模 3）与 16≡1（模 3）与 10+16≡1+1（模 3）

我可以 10+16，然后 26 除以 3 得到余数 2。

或是我直接余数相加 1+1 得到相同的答案 2。

加法模 211≡1（模 2）与 17=1（模 2）与 11+17=28=0（模 2）。

余数相加 1+1 但不是 2，最终的步骤是 2≡0（模 2）。

加法模 p 是完全合理，乘法模 p 也是一样，此处 p=3:

10≡1（模 3）乘 16≡1（模 3）得到 1 乘 1=1160≡1（模 3）

5≡2（模 3）乘 8=2（模 3）得到 2 乘 2=140≡1（模 3）

结论：我们可以安全的执行加法与乘法的模 p，所以我们可以取线性组合，这是线性代数的关键运算。但是可以除吗？

在实数场中，倒数是 1/y（除了 y=0 以外的任意数），这表示：我们找得到另外一个实数 z 使得 yz=1，可逆性是一个场的要求。可逆性的模 p 永远成立吗？对于任意 y=1，.，p-1，我们找得到数字 z=1，..，p-1 使得 yz≡1 模 p?

这些例子 31≡4（模 11）与 2~1≡6（模 11）与 51≡9（模 11）都是成功的。你可以求解 7z≡1（模 11）吗？倒数会是逆反矩阵的关键。

让我们展示当 p 不是一个素数时，逆反模 p 会存在一个问题，例子是 p=26 分解成 2 乘 13，则 y=2 不可能有倒数 z（模 26）。因为 2 与 26 都是偶数，不可能满足 2z≡1（模 26）的要求。

相似地当 p 是 25，5 没有倒数 z，我们不可能求解 5z≡1（模 25），数字 5z-1 不可能是 5 的倍数，所以它不可能是 25 的倍数。

每个 y（0<y<p）存在倒数若且唯若 p 是素数

倒数需要 y，2y，3y，.，py 在除以 p 时有不同的余数。

如果 my 与 ny 有相同的余数 x，则（m-n）y 可以被 p 整除。

素数 p 可以整除 m-n 或 y，不可能两者都可以。

所以 y，.，py 有不同的余数：其中之一的余数必须是 x=1。

请尊重版权与译者的劳动成果，侵权必究！ 504

恩尼格玛密码机与希尔密码

莱斯特希尔在 1929 年的数学月刊发表了它的密码（编码与解码系统），这个概念很

简单，但是在某些的地方它开启了密码学从语言到数学的变革。那个时代的代码

主要是字母混合与信息重排，二次世界大战德国海军使用恩格尼玛是一个巨大的

进步－使用的机器很像初始的计算机。英国人设立布莱切利园破解恩格尼玛，他

们雇佣拼图解答者与主修语言的人，运气好的他们碰巧得到艾伦图灵。

我不知道你有没有看过关于他的电影：模仿者游戏，很多都是虚构的（就好像

心灵捕手与美丽心灵），但是破解恩格尼玛代码的核心概念是正确的，利用在编码

以及传播的人性弱点。德国海军司令部公开发送他们的代码顺序－- 知道这个代码

太复杂无法破解（如果没有这些弱点的话）。破解代码需要英国的电子设备去撤销

德国的电子设备，也需要天才。

艾伦图灵当然是个天才 — 英格兰最杰出的数学家，他的一生超级悲惨于 1954

年去世。Andrew Hodges 写的传记非常棒，图灵在波兰被侵略的第二天来到布莱

切利园，这是温斯顿丘吉尔的信任使得他有快速又完整的支持。

恩格尼玛机器有齿轮及轮子，希尔密码只需要一个矩阵，这是我们现在要说

明的代码，使用线性代数。你会看到解码与矩阵的关系，所有的步骤使用模运算，

乘与逆模 p。

我会遵循 Salisbury 州立大学的 Spickler 教授的简洁说明，这些在网站看得到

facultyftp.salisbury.edu/despickler/personal/index.asp.

矩阵的模运算

对于 Ax（矩阵乘向量）来说，加法与减法与乘法都是我们全部需要的，要乘模 p，

我们可以像平常一样计算 A 中的整数乘 x 中的整数 — 用它的值模 p 后取代 Ax 的

每个单元。

关键问题：我们何时可以求解 Ax≡b（模 p）? 我们仍然有 4 个子空间 C（A），N（A），

C（A1），N（AT）? 他们仍然是配对正交？只要 A 有非零的行列式模 p，是否一定存在

逆矩阵模 p? 我很开心的说最后 3 个答案是「是的」。（但是逆反问题需要 p 是一

个素数）。

我们使用高斯消元法可以求出 A（模 p），如同段落 2.5 一样简化［AI］成为［I

A-1］，或者我们可以使用行列式与余因子矩阵 C 的公式 A-1=（detA）1CT。我会处

理 2×2 整数矩阵 A 的模 3:

纯属偶然的 A=A！计算 A 乘 A 模 3 确实得到单位矩阵：

网址:linear.neocities.org 箱：876152660@qq.com 505

³－［］［2］-［］-［］）

A 的行列式是 2，来自段落 5.3 的余因子公式同样得到 A1≡A:

［³¶－²［¦¯］-²［¦¯］-［²¦³）

定理 A-1 存在模 p 若且唯若（detA）~1 存在模 p

要求是：detA 与 p 没有公因子。

希尔密码的加密

原始的密码是用 A 到 Z 的字母，总数是 p=26。希尔选择一个 n×n 的加密矩阵 E 使得 detE 无法被 2 或 13 整除，则 detE 的数字有一个模 26 的倒数，矩阵 E 也有模 26 的逆矩阵。逆矩阵 E1≡D（模 26）会是解码信息的解密矩阵。

现在转换信息的每个字母变成 0 到 25 的数字，A=0 到 Z=25 的明显选择是可以接受的，这是因为矩阵会使得密码变强。

忽略空间并且把信息分成大小为 n 的方块 ν1，v2，..，然后用加密矩阵 E 去乘每个信息方块（模 p），编码信息是 Ev1，Ev2，.，然后你知道解码器会怎么做。

Spikler 的范例有 D=E-1= 2315 101916

detE=583≡11（模 26）

5812

4237 （模 26）

1134 17519

当然一个破译器并不知道 E 或 D，方块大小 n 通常也是未知，希尔心中的 n 不会太大，电脑可以快速的发现 E 与 D。

我不太确定希尔密码在使用很大的矩阵以及很大的素数 p 的情况下会太难破解，应用二次编码到已编码信息，使用不同的方块大小 n2 与大矩阵 E2 以及大素数 p。

有限场与有限向量空间

在代数中，一个场 F 是一个纯量的集合，这些纯量可以加，乘，倒数（除了 0 以外），熟悉的例子是实数 R 以及复数 C 以及有理数 Q（包含每个整数的比值 p/q）。从一个场你建立向量 ν=（f，.，fm），从向量的线性组合你建立向量空间，所以线性代数从一个场 F 开始。

我从一本从场开始的书教学 10 年，在去 R」的途中，我丢失了一大堆学生，这是一个信号 — 如果我们想要课程有用，就不能不适当的强调。

请尊重版权与译者的劳动成果，侵权必究！ 506

我相信正确的方法是先了解 R」以及它的子空间，就像你现在做的一样。然后你可以去检视其他场与向量空间，心中可以自然的存在一个疑问：当场不是 R 时，会有什么新奇事情？

这些页的内容是在询问有限场（finite field）的问题，可能性变得更加限制但是也有高度乐趣。初始点（不是终点）是有限场 F，它只包含数字 0，1，.，p-1 而且 p 是一个素数。我首先关注场 F2，它只有两个数字「0」与「1」，你可以想象 0 与 1 是「偶数」与「奇数」，因为偶数与奇数的加法与乘法的规则都是遵守的：偶 + 奇 = 奇，偶 × 奇 = 偶。

0 1

01

加法表 0

01

乘法表 0 00

10

01

这是加法与乘法「模 2」。

从场 F2 来看，我们可以建立比如 v=（0，0，1）与 w=（1，0，1）的向量，每个向量有 3 个分量，每个分量有 2 个选择：总共有 23=8 个不同向量在向量空间（F2）3 中。a）零维子空间只包含 0=（0，0，0）。

b）一维子空间包含 0 与类似 ν 的向量，注意 v+v=0！

c）二维子空间有一组类似与 w 的基底，以及 4 个向量 0，y，，+w

d）满三维子空间（F2）3 有 8 个向量。

什么是（F2）3 可能的基底？标准基底包含（1，0，0）与（0，1，0）与（0，0，1），这些向量是线性无关，他们生成（F2）3，他们系数 0 与 1 的 8 个组合填满整个（F2）3。

什么是乘这些向量的矩阵？这些矩阵会是 1×3 或 2×3 或 3×3，当他们是 3×3，我们会问他们是否可逆，他们的行列式只可能是 0（奇异矩阵）或 1（可逆矩阵）。判断下列矩阵是否可逆的乐趣，我就留给你们了。你怎么求出他们的逆矩阵？

在 F2 有 29 个可能的矩阵，我猜大部分都是奇异。

结束对于 F2 的讨论，我提出一个有 22=4 个成员的一个场。它不是来自乘法（模 4），因为 4 不是素数，2 乘 2 会得到 0（2 没有倒数）：不是一个场。但是我们可以从 F2 的 0 与 1 开始，再发明另外两个数 a 与 1+a— 假设他们遵守两个规则：（a+a=0）与（a×a=1+a），则 a 与 1+a 是倒数。不明显！

网址：linear.neocities.org 箱：876152660@qq.com 507

加

0 1 a 1 +a

乘

0 1

a l+a

0

a l+a

0

1

1 0 1+a a

1

0 1

1+a

a

a ノ

+a 0

a

0 a 1+a 1

1+a 1+a

0

1+a 0 1+a

超过 p=2 时，我们的场是 F，其中 p 是所有的素数，他们使用模 p 的加法与乘法，他们是代码的字母，他们在（F）」提供分量给向量 v=（fi，.，fm）。这些场 F 是最常使用的有限场。

其他唯一的有限场 p 个成员，上述的例子 0，1，a，1+a 有 22=4 个成员。我们把它留在这里然后安全的回到 R。

问题集 10.7

1 如果你乘 n 个数（偶或奇），何时会得到奇数的答案？以（模 2）的语言来说：如果你乘 0＇与 1＇s，何时答案是 1?

2 如果你加 n 个数（偶或奇），何时会得到奇数的总和？如果你加 0° 与 1＇s（模 2），何时答案是 1?

3（a）若 y1≡x1 与 y2=x2，为什么 y1+y2≡x1+x2（模 p）?

建议：y1=pq1+x1 与 y2=pq2+x2，现在 y1+y2。

（b）你能确认 x1+x2 小于 p? 不！给出一个例子，存在一个较小的 x 使得（y1+ y2）=x（模 p）?

4p=39 不是素数，找出一个 a 使得不存在倒数 z（模 39）。这表示 az≡1（模 39）无解。找出一个矩阵 A 不存在逆矩阵 Z（模 39），这表示 AZ≡I（模 39）无解。5 证明 y≡x（模 p）可以得到－y≡－x（模 p）。

6 找出一个有无关列的 R2 矩阵，但是在（模 5）下，矩阵有相关列。

72×2 矩阵由 0＇s 与 1＇s 组成，在（模 2）下，全部的可逆矩阵为何？

8 在模运算（模 11）下，A 的行空间仍然与零空间正交吗？在（模 11）下，这些子空间的基底仍然是基底吗？

9（希尔密码）把 THISWHOLEBOOKISINCODE 分成 3 个字母的方块。把每个字母用一个 1 到 26 的数字（正常顺序）取代，用一个 3×3 矩阵 L（对角线及对角线下方都是 1）乘每个方块，编码后的信息（数字表示）为何？你又如何解码？10 假设你知道原始信息（平面文字），假设你也看到编码后信息，你如何开始检测希尔密码的矩阵？对一个很长的信息，你期待成功吗？

请尊重版权与译者的劳动成果，侵权必究！ 508

第十一章

数值线性代数

1 数值线性代数的目的是速度与精确与稳定：n>103 或 106。

2 矩阵可以是满或稀疏或带状或结构：每个都有特殊演绎法。

3 消元法的精确度由条件数 | A|‖|‖A~| 决定。

4 格莱姆－施密特的计算通常使用豪斯霍德镜射 H=I-2uuT 来求 Q。

5 固有值使用 QR 迭代 A0=Q0R0→R0Q0=A1=Q1R1→→An。

6 平移 QR 更好：移到 Ak-CkI=RkQk，移回 Ak+1=RkQk+CkI。

7 若 ST 所有的固有值有 | 2|<1，则迭代 Sxk+1=b-Txk 可以解答（S+T）x=b。8 迭代法通常使用预条件子 P，把 Ax=b 变成 PAx=Pb，其中 PA≈I。

9 共轭梯度与 GMRES 是克雷洛夫方法；参考 Trefethen-Bau（以及其他书本）。11.1 实际的高斯消元法

数值线性代数是为了快速求解与精确求解的奋斗，我们需要效率但也要避免不稳定。高斯消元法中，主要的自由度（一直可得）是交换方程式。本段落说明为了速度何时交换行，以及为了精确何时交换行。

精确的关键是避免不必要的大数字，通常也是要求我们避免小数字！一个好计划是「部分枢轴」，在每个新列选择最大可用枢轴，我们会看到为什么这个枢轴策略会进入计算机程序当中。

其他的行交换是要节省消元步骤，实际上大部分的大型矩阵都是稀疏 — 几乎全部的单元都是零。

网址：linear.neocities.org 箱：876152660@qq.com 509

当方程式的顺序安排可以产生非零窄带（nonzero narrow band）时，消元法最快速。带状中的零在消元过程中被填满 — 这些零被摧毁而且不会节省电脑时间。

段落 11.2 有关不能避免的不稳定，它是内建在问题中，敏感度用条件数 （condition number）来量测。然后 11.3 描述如何运用迭代求解 Ax=b，我们不是直接求解，而是电脑求解一个较简单的问题很多次，每个答案 xk 得到新的猜测 xk+1。优质的迭代（共轭梯度法是超级棒），x 快速收敛到 x=A-1b。最快速的超级电脑

最新的超级计算记录是 IBM 与 Los Alamos 在 2008 年 5 月发表，路跑者测试是第一个达成每秒 105 浮点数运算：每秒 1 千万亿的计算。这个记录的衡量标准是一个大型浓密系统 Ax=b：利用线性代数测试电脑速度。

那台机器在 2013 年关闭！TOP500 计划为世界上 500 个最高能电脑系统评定等级，当我在 2015 年 10 月写下这一页时，前四是来自中国的 NUDT，美国的 CRAY 与 IBM，以及日本的富士通，他们全部使用 LINUX 基础的系统，所有的向量处理器都在 top500。

往前看，Summit 是被期待有第一名的实力，每秒 150-300 千万亿。奥巴马总统刚刚命令这项百万兆级系统的发展（1000 千万亿），直到现在都是遵循每 14 个月加倍的 Moore 定律。

LAPACK 软件是利用「部分枢轴」执行消元法，与本书最大的不同是使用大型子矩阵以及不使用单一数字。图形处理单元（GPU＇s）都是成功所必需，视频市场使得科学计算相对渺小，导致芯片惊人的加速发展。

在 IBM 的蓝色基因之前，一个关键课题是计算一个千万亿机器需要 4 核心处理器的个数：32，000 个。新的架构用电更少，但是混合设计有它的成本：一个代码需要 3 个个别编译与明确指令来移动所有的资料。请参阅 SIAM 的优秀文章 （siam.org，7 月，2008），以及网站 www.lanl.gov/roadrunner。

我们对于矩阵计算的想法反映在高度最佳化 BLAS（基本线性代数子程序），他们有层次 1，2，3:

层次 1 向量 au+ν 的组合：O（n）个工作

层次 2 矩阵－向量乘法 Au+v:O（n2）个工作

层次 3 矩阵－矩阵乘法 AB+C:O（n3）个工作

层次 1 是消元步骤（从行 i 减去 l 乘行 j），层次 2 可以一次消除一整列，一个高性能求解器在层次 3 的 BLAS 已经很足够（AB 有 2n3 的移动与 2n2 资料，好的工作比例。）

传送资料与提取储存限制了平行处理的速度，在主记忆体与浮点计算之间的高速快取必须全面使用！顶级速度需要针对消元法的方块矩阵法。

大变化现在来临，在芯片层次的平行处理。

请尊重版权与译者的劳动成果，侵权必究！ 510

舍去误差与部分枢轴

直到现在，任意枢轴（当然是非零）都可以接受，实际上小的枢轴是危险的，当不同大小的数字相加会引起大灾难。电脑用有效位数（digit，比如 3 位小数，很小的机器）保存一个固定数，10，000+1 的总和舍去变成 10，000，「1」完全丢失，看看问题的解如何变化：

.0001u+v=1

从系数矩阵开始

－u+v=0

4=［1｝

如果我们接受.0001 作为枢轴，消元法会把 10，000 乘行 1 加到行 2，舍去后留下

10，000v=10，000 而不是 10，001v=10，000

计算得到答案 ν=1 与真实 v=.9999 接近。但是之后的方向代入法把错误的 ν=1 放进 u 的方程式： .0001u+ 1=1 而不是 .0001u+.9999=1

第一个方程式得到 u=0，正确的答案（检视第二个方程式）是 u=1.000。因为丢失矩阵中的「1」，我们丢失了解。从 10，001 到 10，000 的小变化导致答案从 μ=1 到 u=0（100％错误！）。

如果我们交换行，纵使这部小电脑也能找正确答案到 3 位小数：

+=0-+v=0，=1

.0001u+v=1

v=1

y=1

原始的枢轴是.0001 与 10，000-- 差劲的比例，交换行之后，确切的枢轴是－1 与 1.0001 - 良好比例，计算的枢轴－1 与 1 跟确切值非常接近。小的枢轴带来数值的不稳定，补救的方法就是部分枢轴（partial pivoting）。这里是我们抵达并且搜寻列 k 作为最佳枢轴的策略：

选择行 k 或下方最大的数字，交换它的行与行 k

完全枢轴的策略也会寻找后面的列来找到最大枢轴，跟行一样，它也会交换列。这个代价是不合理的，所有的主流代码都是使用部分枢轴。用一个比例常数乘行或列是非常值得的，如果上述第一个方程式是 u+10，000v=10，000，我们不调整比例，则 1 看起来很像优质枢轴，使得我们可能会错失重要的行交换。

对于正定矩阵来说，不需要行交换，接受枢轴出现的方式是安全的。小枢轴会发生，但是矩阵不会因为行交换而改善。当它的条件数很高时，问题是在于矩阵而不是在于代码，这个情况下输出是无可避免的对于输入很敏感。

读者现在了解实际上电脑如何求解 Ax=b-- 使用部分枢轴的消元法，与原理描述比较－- 求 A1 然后计算 Ab-— 这很花时间。但是在电脑时间，消元法很快速。我相信消元法也是行空间与零空间代数的最佳途径。

网址：linear.neocities.org 箱：876152660@qq.com 511

运算计数与满矩阵

这是有关成本的实际问题，应用消元法需要多少次的个别运算才能求解 Ax=b? 这个决定在我们能够处理问题的大小。

首先观察 A，什么样的改变逐渐进入 U? 当我们从行 2 减去一个乘数乘行 1，我们做了 n 次运算。首先是除以枢轴，找出乘数 l，对沿着这一行的其他 n-1 个单元来说，这项运算是一个「乘－减」。方便起见，我们把它当成单一运算来计数。如果你认为用 1 去乘与从现存单元减去是两个运算，就把我们的计数乘 2。矩阵 A 是 n×n，这项运算计数应用到在第一行下方的其他全部 n-1 行，它需要 n 乘 n-1 次运算，或是 n2-n，用来产生第一枢轴下方的零。检查：除了第一行的 n 个单元，全部 n2 个单元都改变了。

当消元法降到 k 个方程式，行变短了，我们只需要 k2-k 次运算（而不是 n2-n）去清除枢轴下方的列，对于 1≤k≤n 是成立的。最后一个步骤不需要运算（12-1=0）；前向消元完成。得到 U 的全部计数是 k2-k 从 k 等于 1 到 n 的总和：

（12+.+n2）-（1+..+n）=n（n+1）（2n+1）n（n+1）

n3-

n

2

3

这些是前 n 个数与其平方总和的已知公式，代入 n=100 得到一百万减一百－- 然后除以 3（这个换成工作站的一秒钟）。我们忽略 n 与 n3 的比较，得到我们的主要结论：

对应前向消元（A 到 U，产生 L）的「乘 — 减计数」是 n3/3

这个表示 n3/3 次乘法与减法，加倍的 n，成本会变成 8 倍（因为 n 是立方）。100 个方程式很简单，1000 更贵，10000 个浓密矩阵接近不可能完成。我们需要更快的电脑或是一大堆零或是更新的概念。

在方程式的右侧，步骤走的更快，我们对单一数字运算，不是一整行，每个右侧需要确切的 n2 次运算。往下与往上我们是在求解两个三角形系统，前向的 Lc=b 与反向的 Ux=c。反向代入法中，最后的未知数只需要除以最后一个枢轴，在它上方的方程式需要两个运算－- 代入 xn 然后除以它的枢轴。第 k 步需要 k 次「乘－减」运算，全部的方向代入法需要

次运算

前向的部分很类似。n2 的总数确切等于计算 A-1b 的乘法次数！这个产生了高斯消元法胜过 A1b 的两大优势：

1 消元法需要 n3/3 次乘法与减法，相較之下 A-1 需要 n3。

2 若 A 是带状，L 与 U 也会是带状：相較之下 A-1 充满非零数。

请尊重版权与译者的劳动成果，侵权必究！ 512

带状矩阵

当 A 有「优质零」时，运算计数会改善，一个优质零是停留在 L 与 U 的零。最佳

零是在一行的开始，他们不需要消元步骤（乘数是零），所以我们也要找出在 L 的

相同优质零，对于三对角矩阵 A（以及图 11.1 的带状矩阵）:

三对角 Pa. I4

－1

双对角

乘

双对角

A=

LU

图 11.1：带状矩阵的 A=LU，A 的优质零在 L 与 U 还是零

这些零对于运算计数产生完全的改变，对于「半－带宽」w:

一个带状矩阵在 | i-j|>w 时，有 aj=0

于是 w=1 是对角矩阵，w=2 是三对角，w=n 是浓密。枢轴行的长度最多是 w，

在任意枢轴下方不会有超过 w-1 的非零数。消元法的每个步骤在 w（w-1）次运

算后完成，仍然维持带状结构。有 n 个列要去除，所以

带状矩阵执行消元法（A 到 L 与 U）需要小于 w2n 次运算

对于带状矩阵，计数正比于 n 而不是 n3，它也正比于 w2。一个满矩阵有 w=n 而

且我们回到 n3。针对确切的计数，记得带宽在右下角掉到小于 w（空间不够）:

＂（-）（-2-）

在 Ax=b 的右侧，从 b 求 x，成本大约是 2wn（与平常的 n2 对比）。重点：针对一

个带状矩阵的运算次数与 n 成正比，这是非常的快速。假设我们不计算 A-1，阶

数 10000 的三对角矩阵很便宜。反矩阵一个零都没有：

A=

我们实际上知道 A-1 还不如知道 L 与 U 来得好，用 A-1 去乘需要完整的 n2 个步骤，

求解 Lc=b 与 Ux=c 只需要 2wn。

网址：linear.neocities.org 箱：876152660@qq.com 513

带状结构实际上是常见的，当矩阵反映近邻的连接情形：a13=0 与 a14=0，因为 1 不是 3 与 4 的近邻。

我们以高斯－乔丹与格莱姆－施密特－豪斯霍尔德的计数作为结束：

A~1 的成本 n3 次乘法与减法。

QR 的成本 2n3/3 步。

在 AA-1=I 中，A-1 的第 j 列是 Ax=I 的第 j 列的解，左侧平常的成本 n3/3（这是一次的成本！L 与 U 没有重复。）对于 I 的第 j 列的特殊节省是来自它的前 j-1 个零，直到消元法抵达行 j 之前，右侧都不需要工作。前向成本是（n-j）2/2 而不是 n2/2。对 j 累加，前向消元的 n 个右侧总成本是 n3/6，如果我们实际想要用 A-1，最终对应 A-1 的总成本是 n3:

对 gn）仮向代

（1）

正交化（A 到 Q）：来自消元法的关键差异是每个乘数由一个点积决定，需要 n 个运算，其中消元法只是除以枢轴，然后有 n 个「乘 — 减」运算去移除来自列 k 沿着列 j<k 的投影（段落 4.4），组合成本是 2n，其中消元法是 n，因子 2 是正交的成本。当消元法把一个单元变成零时，我们是在把点积变成零。

警告要评价一个演绎法，只计数运算次数是不够的，在「失败计数」之上是稳定的研究（豪斯霍尔德获胜）以及资料流。

重新排序稀疏矩阵

对于常数宽度 w 的带状矩阵，行的排序是最佳。但是对于大部分实际计算的稀疏矩阵来说，带宽并不是常数而且在带状里面存在很多零，当消元法进行时，这些零会被填满 — 他们丢失了。我们需要重新计数方程式的个数来降低填满，因此可以加速消元法。

一般来说，我们希望把零移到较为前面的行与列，后面的行与列本身就比较短。「近似极小次数（approximate minimum degree）」演绎法在稀疏 MATLAB 是贪婪的 — 在没有计算全部结果的情况下选择要消去的行。我们在接近末端时可以得到近似的满矩阵，但是得到 LU 的总运算次数仍然非常小。要找到 L 与 U 中绝对极小的零是一个 NP - 难题，太昂贵了，amd 是一个可以接受的折中。

当方形格点的每个点连接到它的 4 个最近邻居时，填满是著名的，不可能把所有的格点编号使得邻居维持在一起！如果我们使用格子的行去编号，来到上述格点会是一个漫长的等待。

请尊重版权与译者的劳动成果，侵权必究！ 514

2

i=2

k=3

3

a32=0

a32=2

a32=0 之前

a32≠0 之后

我们只需要非零数的位置，而不是他们的确切值。思考非零数的图形：若 a≠0 则节点 i 与 j 相连，观察消元法如何产生非零（新的边），这是我们要避免的。指令 nnz（L）计算下三角 L 的非零数的个数，find（L）会列表，spy（L）显示他们。colamd 与 symamd 是较好的排序（排列 P）产生 AP 与 PTAP 的填满－选择下方有最少非零数的枢轴。

快速正交化

有 3 种方法得到重要的分解 A=QR，格莱姆－施密特求出 Q 中的正交单位向量，R 是上三角，这是因为格莱姆－施密特步骤的顺序。现在我们检视较好的方法（豪斯霍尔德与吉文斯），使用特殊简单 Q＇s 的乘积，我们知道这些 Q 是正交。

消元法得到 A=LU，正交化得到 A=QR，我们不想要三角 L，我们想要正交 Q。L 是来自消元法 E＇s 的乘积，有 1 在对角线且乘数 l 在下方，Q 会是正交矩阵的乘积。

有两个简单的正交矩阵可以取代 E＇s，镜射矩阵 I-2uuT 是以豪斯霍尔德命名，平面旋转矩阵是以吉文斯命名。把 xy 平面旋转 θ 的简单矩阵是 Q21:

在 1.2 平面的古文斯旋转－

如同使用 E21 一样的使用 Q21，产生在位置（2，1）的零，这个决定在 0。比尔哈格在「应用数值线性代数」给出例子：

这个零来自－.8（90）+.6（120），不需要找出 0，我们只需要 cosθ：

（2）

网址：linear.neocities.org 箱：876152660@qq.com 515

现在我们攻击（3，1）单元。旋转会在行 3 与列 1，数字 cos0 与 sin0 由 150 与 200 决定，而不是 90 与 120。

·

250-125250

0100325

再一步到 R，（3，2）单元要移除。现在 cos0 与 sin0 来自 75 与 100，旋转会在行 2 与列 3:

00］［250-125

250-125250

0100

00375

我们得到上三角 R，Q 是什么？把平面旋转 Q 移到另一侧求出 A=QR - 就好像你把消元矩阵 E 移到另一侧求得 A=LU 一般：

Q32031021A= R 就是 A=（Q21¯＇31¯＇Q32¯＇）R=OR

（3）

每个 Q 的逆矩阵是 QT（旋转－0），每个 E 的逆矩阵不是正交矩阵！LU 与 QR 相似，但是 L 与 Q 不相同。

豪斯霍尔德镜射比旋转来的快，因为每次清除对角线下方的一整列，观察 A 的第一列 a1 如何变成 R 的列 r1；

由 H1 镜射

|a1|

0

或

0

H1 =I- 2и1и

H1a1 =

=r1.（4）

0

0

长度没有改变，1 是在 a1-r1 的方向。我们有单位向量 1 中的 n-1 个单元得到 r 中的 n-1 个零。（旋转有一个角 θ 得到一个零。）当我们抵达列 k，我们在单位向量 uk 中有 n-k 个可用选择，这个产生 rk 的 n-k 个零。我们只需要储存 u＇s 与 r＇s 就可以知道最终的 Q 与 R:

H1 的逆矩阵是 H1（Hn-1.H1）A=R 就是 A=（H1..Hn-1）R=QR

（5）

这是 LAPACK 对于 19 世纪格莱姆－施密特的改善，Q 确切是正交。

段落 11.3 说明 A=QR 如何使用在其他大型线性代数的计算 — 固有值问题，因子 QR 反向得到 A1=RQ 也就是 Q1AQ。由于 A1 与 A 相似，固有值没有改变，A1 分解成 Q1R1，再反转顺序得到 A2。惊人的是在 A1，A2，A3，. 对角线下方的单元会越来越小，我们就可以鉴别固有值，这是针对 Ax=Ax 的「QR 方法」，数值线性代数的一大成功。请尊重版权与译者的劳动成果，侵权必究！ 516

问题集 11.1

1 分别使用与不使用行交换最大化枢轴，求出两个枢轴：

.0010

A=

1000

有行交换去极大化枢轴，为什么 L 没有单元大于 1? 求出 3×3 矩阵 A，其中 | a| ≤1 且 ||≤1 但是第三枢轴 = 4。

2 利用消元法计算希尔伯特矩阵 A 的确切逆矩阵，然后舍去三位小数之后的数，再次计算 A-1。

不良条件矩阵 A=hilb（3）= 11213 121314 131415

3 对于相同的 A 计算 b=Ax，其中 x=（1，1，1）与 x=（0，6，-3.6）。小的变化△b 导致大的变化 Δx。

4 求出 8×8 希尔博特矩阵 ay=1/（i+j-1）的固有值（使用电脑）。方程式 Ax=b 的 | b|=1，|x | 可以到多大？如果 b 的舍去误差小于 10~16，出现在 x 的误差会有多大？见段落 9.2。

5 针对带状矩阵（带宽 w）进行反向代入，说明求解 Ux=c 的乘法次数大约是 wn。6 如果你知道 L，U，Q，R，求解 LUx=b 或是求解 QRx=b 会比较快？

7 证明逆反一个 n×n 的上三角矩阵的乘法次数大约是 n3/6。对 I 的列使用反向代入，从 1＇s 往上。

8 在每一列选择最大可用的枢轴（部分枢轴），把每个 A 分解成 PA=LU:

101

9 把 1＇s 放在一个 4×4 三对角矩阵的三个中心对角线，求出 6 个零单元的余因子。这些单元是 A~1 的非零数。

10（C.Van Loan 建议）求出 LU 分解并且利用消元法求解，其中 ε=10-3，10-6， 10-9，10-12，10-15:

［］［］-［＇］

真实的 x 是（1，1），对于每个 ε 制作一个误差表。交换两个方程式再求解 — 误差几乎消失不见。

网址：linear.neocities.org 邮箱：876152660@qq.com 517

11（a）选择 sin 与 cos0 来三角化 A，并求 R:

吉文斯旋转

e. sne ose ［R

（b）选择 sin0 与 cos0 使得 QAQ-1 成为三角形，固有值为何？

12 用一个平面旋转 Q 乘 A，会改变 A 的哪些单元？当 QA 在右侧乘 Q1，会改变哪些单元？

13 计算 QA 需要多少次乘法与多少次加法？仔细安排整个旋转序列得到 2n3/3 次乘法与 2n3/3 加法 — 与使用镜射的 QR 相同，是 LU 的两倍。

挑战问题

14（转动机械手）机械手产生任意 3×3 旋转矩阵 A，他们来自环绕 x，y，z 轴的平面旋转，则 Q32Q31Q21A=R，其中 A 是正交，所以 R 是 I！三个机械手转动在 A=Q21-1Q31-1Q32-1.3 个角是「欧拉角」而且 detQ=1 避免镜射。从选择 cosθ 与 sinθ 开始，使得

15 创建 10×10 第二差分矩阵 K=toeplitz（［2 －1 zeros（1，8）］），利用 KK = K（randperm（10），randperm（10）随机排列行与列，利用［L，U］=lu（K）与［LL，UU］=lu（KK）的分解，然后利用 nnz（L）与 nnz（LL）计数非零数。这个情况下 L 是完美三对角，但不是 LL。

【负号与之 1 间不能有空格】

16 这个矩阵 K 的另一种排序是对于网点交替涂上红色与黑色，这个排列 P 把正常的 1 到 10 变成 1，3，5，7，9，2，4，6，8，10:

红黑排序 PKP=［］，求出矩阵 D。

很多有趣的试验都是可能的，如果你传送好的点子，他们可以在网站 math.mit/linearalgebra 上持续。我也推荐学习指令 B= sparse（A），在 find（B）之后，其中 find（B）会列出非零单元以及 lu（B）会使用稀疏格式的 L 与 U 分解 B。只有非零数会被计算，其中 ordinary（dense）MATLAB 也会计算所有的零。

17Jeff Stuart 创建一个学生活动聪明的展示不良条件：

误差是

x=2-10000（e-E）

e 与 E

y=1+10000（e-E）

当这些方程式用来展示几乎平行的长棍，一个小的震动会导致交点（x，y）的大跳跃，误差 e 与 E 放大 10000 倍。

请尊重版权与译者的劳动成果，侵权必究！ 518

11.2 范数与条件数

我们如何量测矩阵的大小？对向量来说，长度是 | x‖，对矩阵来说，范数是 | A‖。这个词「范数」有时候向量也用在向量，而不用长度，它一直使用在矩阵，而且有很多方式去量测 | A‖。我们检视所有的「矩阵范数」要求，然后选择一个。弗罗贝尼乌斯取所有的 | a|2 然后相加，它的范数 | A|F 是平方根，这个是把 A 当成一个有 n2 个分量的长向量：有时候很有帮助，但不是这里的选择。

我偏好从向量的范数开始，三角不等式说明 |‖x+y‖不会比 | x‖+‖y‖大，2x 或－2x 的长度加倍成为 2|x|。相同的规则可以应用在矩阵的范数：

A+B<A+BcAl=cAl

（1）

第二个对于矩阵范数的要求是新的，这是矩阵乘法。范数 | A | 控制从 x 到 Ax 的成长，以及 B 到 AB 的成长：

成长因子 |‖A‖

‖lxII‖II 与 I| AB | <|A | I| B |

（2）

这个得到定义 | A‖的一个自然方式，矩阵的范数：

矩阵的范数是最大的比值‖A|‖x‖： |A|=max

（3）

x≠0

‖Ax‖|x‖永远不大于 |‖A‖（它的绝对值），意思是 |‖Ax‖≤‖A‖‖x‖。

范例 1 若 A 是单位矩阵 I，比值是 | x|/|x‖，因此 | I|‖=1。若 A 是正交矩阵 Q，长度再次被维持：‖Qx‖=‖x‖，比值仍然得到 |‖Q‖=1。一个正交 Ω 很好计算：误差不会成长。

范例 2 角矩阵的范数是它的最大单元（使用绝对值）：

｝

的数 A3 有向位 x - 有 =

固有值是 3，对这个 A（不是全部的 A）来说，最大的固有值等于范数。

对于正定对称矩阵来说，范数是‖A‖=λmax（A）。

选择 x 是对应最大固有值的固有向量，则 |‖Ax‖/|x|‖等于 λmax，重点是没有其他的 x 可以使得这个比值更大。矩阵是 A=QAQT 而且正交矩阵 Q 与 QT 维持长度不变，所以极大化比值是 |‖Λx‖/‖x‖，范数是对角矩阵 Λ 的最大固有值。

网址：linear.neocities.org 箱：876152660@qq.com 519

对称矩阵假设 A 是对称但不是正定，A=QAQT 仍然成立，则范数是 |λ1|，|2|，..，|λn | 的最大值。我们取绝对值，这是因为范数只跟长度有关。对固有向量来说，|Ax| =‖|2x|‖=|2 | 乘 | x|，这个给出极大比值的 x 是对应极大值 | 2 | 的固有向量。

非对称矩阵假设 A 不是对称，固有值不可以量测它的实际大小，范数可能比任意固有值都来的大。一个非常不对称的例子有 = 2=0，但是它的范数不是零：

M>24 - 有范数 4-m-2

向量 x=（0，1）给出 Ax=（2，0），比值是 2/1，这是极大比值 | A|，纵使 x 不是固有向量。

是对称矩阵 ATA 有固有向量 x=（0，1），而不是非对称的 A 有这个固有向量。范数实际上是由 ATA 的最大固有值决定：

A（对称或不对称）的范数是 ma（A）的平方根：

（）

（3）

max（A）=0 的非对称例子有 max（ATA）=4:

对任意的 A 选择 x 是对应 ATA 最大固有值 max 的固有向量，方程式（4）的比值是 xTATAx=xT（Amax）x 除以 xTx，这个是 Amax。

没有 x 可以给出更大的比值，对称矩阵 ATA 有固有值 1，.，n 以及正交单位固有向量 q1，..，qn，每个 x 是这些向量的组合。尝试在比值中的这个组合，不要忘记 qi①qj=0:

最大比值 λmax 是当所有的 c＇s 是零，除了乘 λmax 的那个 c。

注解 1 方程式（4）的比值是对称矩阵 ATA 的莱利商（Rayleigh quotient），它的极大值是最大固有值 λmax（ATA），极小值比值是 λmin（ATA）。如果你把任意 x 代入莱利商 xTATAx/xTx，你会确保得到一个介于 λmin（ATA）与 2max（ATA）之间的数。

请尊重版权与译者的劳动成果，侵权必究！ 520

注解 2‖A‖等于 A 的最大奇异值 Omax，这些奇异值 1，.，，是 ATA 的正数固有值的平方根，当然会有ōmax=（λmax）12。由于 A=UΣVT 中的 U 与 V 是正交，‖A‖等于 omax。

A 的条件数

段落 9.1 展示了舍去误差可以很严重，有些系统很敏感，有些不敏感，对于误差的敏感度可以用条件数（condition number）来量测。这是本书特意提出误差的第一章，我们希望估测他们改变 ⅹ 多少。

原始方程式是 Ax=b，假设因为舍去与量测误差造成右侧变成 b+△b，解会变成 x+△x，我们的目的是估测来自方程式的变化△b 造成的变化△x。两式相减给出误差方程式 A（△x）=△b:

从 A（x+△x）=b+△b 减去 Ax=b 得到

A（Δx）= Δb

（5）

误差△x=A-1△b，当 A-1 很大（A 近乎是奇异）误差就很大。当△b 指向错误的方向时 — 被 A-1 放大最多的方向，误差△x 会特别大。最差的误差是 |△x|=|‖A~1|‖‖△b|‖。

误差界限 | A | 有一个很严重的缺点，我们让 A 乘 1000，A-1 就会除以 1000，矩阵看起来是 1000 倍的好，但是单纯的调整比例并没有改变问题的本质。△x 的确会除以 1000，但是确切的解 x=A-1b 也会除以 1000，相对误差 |△x|‖/‖x|‖仍然没有改变，跟 b 的相对误差比较的应该是 x 的相对误差。

比较相对误差现在产生「条件数」c=‖A|‖‖A~1|‖，A 乘以 1000 不会改变这个数，因为 A1 会除以 1000，条件数 c 维持不变，它可以量测 Ax=b 的敏感度。

解的误差小于 c=|‖A|‖|‖A-1‖乘问题的误差：

条件数 c

（6）

如果问题误差是△A（A 的误差而不是 b 的误差），仍然是 c 控制△x:

A 的误差 ΔA

（7）

网址：linear.neocities.org 箱：876152660@qq.com 521

证明原始方程式是 b=Ax，误差方程式（5）是△x=A-1△b，应用矩阵范数的关键性质 | Ax|≤|A|‖|x|：lbllsIlAll llkell IAxll <A-lIAbll

两式的左侧相乘得到 |‖b|‖|‖△x|，右侧相乘得到 c|x|‖|‖△b|‖，两侧同时除以‖b‖|x|，左侧现在是相对误差 |Δx|/|x|，右侧现在是方程式（6）的上界限。

当误差是在矩阵，相同的条件数 c=‖A‖‖A~1|‖也会出现，在误差方程式中我们有△A 而不是△b:

从（A+△A）（x+△x）=b 减去 Ax=b 得到 A（△x）=-（△A4（x+△x）

s 使用 A-1 乘最后一个方程式，然后取范数得到方程式（7）:

‖l｜SIAx+Ax｜或是

结论误差有两个进入方式，他们从误差△A 或△b 开始 — 一个错误的矩阵或一个错误的 b。问题的错误被放大（很多或是一些）进入解的误差 Δx，这个与自己相关的误差是有界的，界限是条件数 c。

误差△b 与电脑的舍去以及 b 的原始量测有关，误差△A 也与消元法的步骤有关。小枢轴倾向于制造 L 与 U 的大误差，L+△L 乘 U+△U 等于 A+△A，当△A 或条件数很大时，误差△x 将是无法接受。

范例 3 当 A 是对称，c=|A|‖|A-1 | 来自固有值：

4-2 有范数 6.A1-［

有范数

这个 A 是对称正定，它的范数是 λmax=6，A-1 的范数是 1/λmin=。计算两个范数的乘积得到条件数 | A|‖|A-1|=λmax/λmin:

正定 A 的条件数 c=max/1min=6/2=3

范例 4 维持相同的 A，固有值是 6 与 2。要使得 x 小，沿着第一固有向量（1，0）选择 b。要使得△x 大，沿着第二固有向量（0，1）选择△b。x=b/6，△x=△b/2，比值 ‖△x|‖/|‖x | 确切是 c=3 乘比值 |Δb|‖/‖b|‖。

这个展示了条件数 | A|‖|‖A~1|‖允许的最差误差实际上是会发生的，这里有一个经验法则，高斯消元法实验验证：电脑会损失 logc 位数的舍去误差。

请尊重版权与译者的劳动成果，侵权必究！ 522

问题集 11.2

1 求出下列正定矩阵的范数 | A|‖=λmax 与条件数 c=λmax/λmin:

2 从（A+A）的平方根求出范数与条件数与 AA),A 没有正定，我们找 AA!

[¯][][¦¦

3 从 ||A 与 ||B | 的定义（3），说明这两个不等式:

|ABx|≤|A||Bx|≤|A||B||x|

从 | ABx | 到 | x|，推导 | AB|≤‖A|‖|‖B|，这是使用矩阵范数的关键，A」的范数不

会大于 | A|」。

4 使用 | AA~|‖≤|A|‖|‖A~1 | 证明条件数最小是 1.

5 为什么 I 是唯一具有 λmax=λmin=1 的对称正定矩阵？其他具有 | A|‖=1 与 | A-‖

=1 的矩阵必须有 ATA=I。这些是

矩阵：完美条件。

6 正交矩阵有范数 |‖Q|‖=1。若 A=QR 证明 | A|‖≤‖R|‖同时 |‖R|‖≤|‖A|‖，则‖A‖=‖Q‖

|R|。找出一个例子 A=LU，其中‖|A|‖<|‖L|‖‖U|。

7（a）哪个著名的不等式给出对于任意 x,|(A+B）x|≤|‖Ax|+|‖Bx|‖？

(b）为什么矩阵范数的定义（3）得到 | A+B‖≤‖A‖+‖B|‖？

8 证明若 λ 是 A 的任意固有值，则 | 2|≤|A|，从 Ax=x 开始。

9「光谱（spectral）半径」p（A)=|2max | 是固有值的最大绝对值，展示一个 2×2 矩

阵使得 p（A+B)≤p（A)+p（B）以及 p（AB)≤p（A）p（B）都是错误，光谱半径不能

作为一个范数。

10（a）说明为什么 A 与 A-1 有相同的条件数。

(b）说明为什么 A 与 AT 有相同的范数，基于 A（ATA）与 A（AAT）。

12 为什么 A 的行列式不能很好的作为范数？为什么不能很好的作为条件数？

网址：linear.neocities.org 箱：876152660@qq.com 523

13 给定下列矩阵计算 b-Ay 与 b-Az:

·.，·

y 与 z 哪个比较接近 Ax=b 的解？两个方式回答问题：比较残余量 b-Ay 与 b

－Az，然后比较 y 与 z 与真实的 x=（1，-1）。两个答案都是正确的，有时候我

们希望小的残余量，有时候希望小的 Δx。

14（a）计算问题 13 的 A 的行列式，计算 A-1。

（b）可能的话计算 | A | 与 | A-1|，证明 c>106。

问题 15-19 有关与平常 | x|=√x·x 不同的向量范数。

15x=（x1，.，xn）的「范数」以及「l° 范数」是

1…I-s

i 算 R 的向量的 xcll kello:

x=（1， 1，1， 1， 1） x=（.1，.7，.3，.4，.5）

16 明 l［＇|，M 不等式明］/I 不

会大于√n。哪个向量（x1，.，xn）使得比值大于√n?

17 所有的向量范数必须满足三角不等式，证明

llxc yllo lxllo+ llvllo+yll xcll1+llvlli

18 向量范数也必须满足 | cx|=|c|x|，除了 x=0 时范数必须是正数。下列哪些

是 R2 向量（x1，x2）的范数？

llella xi+ 2x2l xcllB min（x1， x2）

I|Is||+시［|I|=I（A 有）

挑战问题

19 证明 xTy≤|x|1||。，借由选择分量 y1=±1 使得 xTy 尽可能的大。

20-1，2，-1 差分矩阵 K 的固有值是 1=2-2cos（jπ/（n+1），当 n 增加时，估测 2min

与 λmax 与 c=cond（K）=λmax/λmin:c≈Cn2，其中常数 C 为何？

当 n=10，100，1000 时，测试估测值 eig（K）与 cond（K）。

请尊重版权与译者的劳动成果，侵权必究！ 524

11.3 迭代法与预条件子

直到现在，我们都是直接求解 Ax=b，我们接受自来的 A，我们使用消元法与行交换处理它。我们现在要检视迭代（iterative）法，这个方法把比较简单的矩阵 S 取代 A，差分 T=S-A 移到方程式的右侧。利用 S 取代 A，问题变得容易求解。但是要有代价－- 简单的系统要重复求解。

迭代方法很容易发现，只要把 A（仔细地）分成 S-T。

改写 Ax=b

Sx=Tx+b

（1）

新奇的地方在于迭代求解（1），每个猜测的 xk 得到下一个 xk+1:

单纯迭代

Sxk+1= Txk+b

（2）

从任意 x0 开始，求解 Sx1=Tx0+b，继续 Sx2=Tx1+b，100 次迭代很正常－通常要更多。当（或是如果）x+1 足够接近 x 时一或是残余量 r=b-Ax 接近零，停止迭代程序。我们希望消元法更快得到接近的真实解，当 xk 收敛，他们的极限 x 确切是方程式（1）的解：Sxo=x+b 表示 Ax=b。

分割 A=S-T 的两个目的是加速每个步骤以及快速收敛。每个步骤的速度与 S 有关而且收敛速度与 ST 有关：

1 方程式（2）应该很容易求解 x+1，「预条件子（preconditioner）」S 应该是 A

的对角或是三角部分。一个快速方法是 S=LoUo，其中这些因子与确切的 A=LU 相比多了很多零。这是「不完全 LU」。

2 差 x-xk（这是误差 ek）应该快速到零，从方程式（1）减去方程式（2）消去 b，剩下误差 ek 的方程式：

误差方程式

Sek+1=Tek 意思是 ek+1= S-ITek

（3）

在每一步 ST 乘上误差，若 ST 够小，它的次方很快到零，但是什么是够小？极端的分割是 S=A 与 T=0，第一步的迭代就是原始的 Ax=b，收敛是完美的而且 ST 是零。但是这一步的成本是我们想要避免的，S 的选择是在每一步的速度（简单的 S）与快速收敛（S 接近 A）之间的战斗。这里是一些 S 的选择法：

JS=A 的对角部分（这个迭代称为雅克比方法）

GSS=A 的包含对角的下三角（高斯－赛德尔方法）

ILUS = 近似 L 乘近似 U（不完全 LU 方法）

网址：linear.neocities.org 邮箱：876152660@qq.com 525

我们第一个问题是纯粹的线性代数：什么时候 xs 收敛到 x? 答案会揭露数字 | 2|max 控制着收敛，在雅克比与高斯－赛德尔的例子中，我们会计算「光谱半径」|2|max，它是迭代矩阵 B=S1T 的最大固有值。

光谱半径 p（B）控制收敛

方程式（3）是 ek+1=S-1Tek，每一个迭代步骤都用相同的矩阵 B=S-1T 乘上误差，在 k 步之后误差 ek=B＊eo，如果 B=S-1T 的次方趋近零，则误差趋近零。看看 B 的固有值－特别是最大固有值 — 如何控制矩阵次方 B＊是美丽的。

次方 B＊趋近零若且唯若 B 的每个固有值都有 | 2|<1。

B 的光谱半径控制收敛速率： p= max |A（B）

收敛的测试是 | 2|max<1，实数固有值必须在－1 与 1 之间，复数固有值 λ=a+ib 必须有 | 2|2=a2+b2<1。光谱半径「p（读成 ro）」从零到 B=S1T 的固有值的最大距离，这是 p=|2|max。

要了解为什么 | 2|max<1 是必要条件，假设初始误差 eo 刚好是 B 的一个固有向量，一步之后误差是 Beo=λe0，k 步之后是 Bkeo=2keo。如果我们从固有向量开始，我们维持在这个固有向量 — 当 | 2|<1 时，因子 2 才会到零，这个条件适用每一个固有向量。

要了解为什么 | 2|max<1 是误差趋近零的充分条件，假设 eo 是固有向量的组合：

e0=c1x1+..+cnxn 得到 ek=c1（λ1）kx1+.+cn（λn）kxn

（4）

这是固有向量的特点！当我们用 B 去乘，相当于用 λ 去乘每个固有向量 x1。如果所有的 |λ|<1，则方程式（4）确保 ek 走到零。

范例 1B = 有 = 1.1B=1 有 = 6。

B2 是 1.1 乘 B，B3 是（1.1）2 乘 B，B 的次方会爆炸。B＇的次方刚好相反，矩阵（B＇）在对角线有（.6）＊与（.5）＊，非对角线的单元也跟 p＊=（.6）＊有关，这些设定收敛速度。注解当固有向量不足，方程式（4）就不正确。当我们丢失固有向量回到乔丹形式而且 B 不能对角化：

乔丹形式 JB=MJM1 与 B=MJM1

（5）

段落 8.3 显示 J 与 J＊由一个重复固有值的「方块」组成：

J 的 2×2 方块的次方是

请尊重版权与译者的劳动成果，侵权必究！ 526

如果 | 2|<1 则这些次方趋近零，来自双重固有值的额外因子 k 被衰减因子 2~1 压制，这个适用每一个方块：

是否可对角化:

收斂 B→0 而且它的速度依赖 = 1max<1

雅克比对比高斯－赛德尔

我们现在分割 A 来求解一个特定的 2×2 问题，注意数字 | 2|max。

Ax=b

2u-v=4 的解是

－u+2v=-2

20

（6）

第一个分割是雅克比方法，维持 A 的对角线（这是 S）在左侧，把 A 的非对角线部分移到右侧（这是 T），开始迭代：

雅克比方法

Sxk+1=TXk+b

2uk+1=Vk+4

2vk+1=uk-2

从 uo=vo=0 开始，第一步得到 u1=2 与 v1=-1，继续下去：

［］［］［］［-1］［＇³］ ［-л趋近 20

这个显示了收敛。在第 1，3，5 步，第二分量是－1，－1/4，－1/16，每两步下降 4 倍。误差方程式是 Sek+1=Tek ：

误差方程式

［-H-｝］

（7）

最后的矩阵 S~`T 有固有值％与－％，所以他的光谱半径是 p（B）=％:

B-817-｛- 且

：85-89

在这个特殊例子的两个步骤确实得到误差乘％。重要的信息是：当 A 的主对角线比非对角线部分来的大，雅克比方法可以很好的工作。对角线部分是 S，剩下的是－T，我们希望对角线部分支配。

固有值 A=％是不平常的小，迭代 10 次降低误差 210=1024。更典型更昂贵的是 | 2|max=.99 或.999。

高斯－赛德尔方法把 A 的整个下三角部分留给 S:

高斯－赛德尔

2uk+1

=Vk+4 或是

（8）

－uk+1+2vk+1=-2

注意变化。来自第一个方程式的新 uk+1 马上用在第二个方程式，如果是雅克比，我们保存旧的 uk 直到整个步骤完成。现在是高斯－赛德尔，新的值立刻加入而且旧的 uk 被摧毁，这个减少一半的储存，它也会加速迭代（通常），而且它的成本不会比雅克比方法来的高。

网址：linear.neocities.org 箱：876152660@qq.com 527

从另一个初始值 uo=0 与 vo=-1 开始测试：

％趋近 20

在第一分量的误差是 2，1/2，1/8，1/32，在第二分量的误差是－1，－1/4，－1/16，－1/32，我们一个步骤就除以 4，而不是两个步骤，高斯－赛德尔是雅克比的两倍快。当 A 是正定三对角，我们有 pGs=（p）2:

5 - 月 7-| 酿 57-|

高斯－赛德尔的固有值是 0 与％，比较雅克比的 ⅓ 与－％。

往前推进一下，我们可以描述连续超松弛（overrelaxation）方法（SOR）。这个新概念引入一个参数 ω（omega）进入迭代，选择数字 ω 使得 S-1T 的光谱半径尽可能小。

改写 Ax=b 成为 ωAx=ωb，SOR 中的矩阵 S 有原始 A 的对角线，但是对角线下方我们使用 ωA，在右侧的 T 是 S-ωA:

SOR

（9）

这个看起来更复杂，但是电脑跑起来一如既往的快。SOR 很像高斯－赛德尔，有一个可以调整的数字の，最佳の得到快速的迭代。

我会把阶数 n 的最有价值测试矩阵记录在案，它是我们的最爱－1，2，－1 的三对角矩阵 K。对角线是 2I，下方与上方是－1＇s，我们的例子有 n=2，得到 cosπ/3=⅓，这是上述的雅克比固有值。特别注意这个 | 2|max 是高斯－赛德尔的平方：

－1，2，-1 阶数 n 的矩阵 K 的分割得到这些 B 的固有值：

雅克比（S=0，2，0 矩阵）:

ST 有 | m=cOs

高斯－赛德尔（S=-1，2，0 矩阵）:

SOR（具有最佳の）:

让我说明清楚：你不应该针对－1，2，－1 矩阵使用任何迭代法！三对角矩阵使用消元法已经非常快速（确切的 LU）。迭代法是针对大型的稀疏矩阵，其中矩阵有远离中心对角线的零，这些零在确切的 L 与 U 制造了更多的非零，这项「填满」就是为什么消元法昂贵的原因。

请尊重版权与译者的劳动成果，侵权必究！ 528

我们多提一个分割，「不完全 LU」的概念是把 L 与 U 中小的非零行恢复到

零，这样留下的三角矩阵 Lo 与 Uo 再次是稀疏矩阵。这个分割有 S=LoUo 在左侧。

每个步骤很快速：

不完全 LU

LoU0xk+1=（L0U0-A）xk+b

在右侧我们执行稀疏的矩阵－向量乘法，不用 L0 乘 U0，这些是矩阵。用 U0 乘 xk，

再用 Lo 乘那个向量，在左侧我们执行前向与反向代入法。如果 LoUo 接近 A，则 | A|max

很小，几个步骤过后会得到接近的答案。

多格点与共轭梯度

我不能留下雅克比与高斯－赛德尔是优秀方法的印象，通常误差的「低频率」部分

衰减非常慢，需要很多次迭代。这里是两个得到重大改善的重要概念，多格点

（Multigrid）可以在 O（n）步内解决阶数 n 的问题，具有一个优秀的预条件子，共轭

梯度（conjugate gradient）变成数值线性代数中最流行也最有效的演绎法之一。多格点求解小问题使用粗格点，每次迭代便宜又快速，然后在粗格点值之间

内插，得到全幅大小问题的快速开头。多格点可能走 4 阶层的下与回。

共轭梯度如同 xk+1=xk-Axk+b 的正常迭代，会在每个阶段牵涉到用 A 乘，如

果 A 是稀疏，这就不贵：Axk 是我们想要做的，它多加了一个基底向量至「克雷

洛夫空间」，这个空间包含我们的近似值。但是 xk+1 不是 x0，Axo，.，Ax0 的最佳

组合，正常的迭代有效但是离最佳还很远。

共轭梯度在每个步骤选择最佳组合 xk，额外的成本（超出一个 A 的乘法）不多，

我们会给出 CG 迭代，强调这个方法是为了对称正定矩阵而创建。当 A 不是对称，

一个好选择是 GMRES，当 A=AT 不是正定时，有 MINRES。环绕制造每个连续

xk 的最佳选择的概念，已经建立了一个高能迭代方法的世界。

我的教科书「计算科学与工程」详细描述了多格点与 CG，在数值线性代数的

书本中，Trefethen-Bau 的书值得流行（其他也很棒），Golub-Van 是一个提高。

问题集重建了从 xk-1 到 xk 的每个共轭梯度循环的 5 个步骤，我们计算新的近

似 xk，新的残余量 rk=b-Axk，与新的搜寻方向 dk 寻找下个 xk+1。

我写下这些针对原始矩阵 A 的步骤，但是预条件子 S 可以使得收敛更快。我

们的原始方程式是 Ax=b，预条件方程式是 SlAx=S-1b，代码的小变化得出预条

件共轭梯度法 — 求解正定系统领先的迭代法。

网址：linear.neocities.org 箱：876152660@qq.com 529

最大的竞争者是直接消元法，把方程式重新排序取得 A 中的零的最大优势，要超过高斯还是不容易的。

固有值的迭代法

我们从 Ax=b 回到 Ax=λx，迭代法是线性方程式的一种选择，他们是固有值问题的必需品。一个 n×n 矩阵的固有值是一个 n 次多项式的根，A-I 的行列式从（-2）＂开始，本书不能留下固有值只能这样计算的印象！从 det（A-2）=0 开始处理是一个很差劲的方法－— 除了 n 很小。

当 n>4 就没有公式求解 det（A-）=0，更糟糕的是 λ＇s 可能非常不稳定与敏感。从 A 本身开始处理会更好，逐渐的变成对角或是三角。（则固有值出现在对角线。）LAPACK 函数库有很好的电脑代码 — 个别的副程序在 www.netlib.org/lapack 是免费的，这些函数库组合了较早的 LINPACK 与 EISPACK，具有很多改善（在层次 3BLAS 使用矩阵－矩阵运算），它是一个在高性能电脑上针对线性代数的 Fortran77 程序的集合。对于你的或我的电脑，我们需要的是高品质矩阵包装。对于具有平行处理的超级电脑，要用到 ScaLAPACK 与方块消元法。

我们会简单讨论针对计算固有值的次方（power）法与 QR 法（LAPACK 选择的），给出详细代码就没有意义了。

1 次方法与逆次方法。从任意向量 u0 开始，用 A 乘得到 1，再次用 A 乘得到 u2。如果 u0 是固有向量的组合，会有 A 乘每个固有向量等效于 λ 乘 x1，k 个步骤之后我们有（）＊:

uk=Auo=c1（1）x1+..+cn（n）xn

（10）

当次方法继续时，最大的固有值开始支配，向量指向支配固有向量 x1。从马可夫矩阵我们看到这个：

4=9 有 2=1，对应固有向量

从 uo 开始，每个步骤用 A 乘：

收敛速度与第二大固有值 2 对最大固有值 1 的比值有关，我们不希望 λ1 太小，我们希望ん 2 / 很小。这里 2=0.6 与 1=1，则次方法就太慢了。

存在一个找出最小固有值的方法吗？－这是应用上最重要的。是的，使用逆次方法：用 A1 乘 u0 而不用 A。我们从来都不想计算 A-1，我们实际是求解 Au1=uo。借由节省的 LU 因子，下个步骤 Au2=u1 很快速，步骤 k 会有 Auk=uk-1:

请尊重版权与译者的劳动成果，侵权必究！ 530 逆次方法

n-4-++

（10）

现在最小的固有值 min 在掌握之中，当它很小时，因子 1/2min＊就很大。为了高速度，我们借由平移矩阵到 A-λ＊I 使得 λmin 更小。

这项平移不会改变固有向量，（2＊可能来自 A 的对角线，如果来自莱利商 xTAx/xTx 会更好。）如果 λ＊接近 λmin，则（A-λ＊I）-1 会有非常大的固有值（λmin-λ＊）－1。每个平移逆反次方步骤使用大的数乘固有向量，使得固有向量很快就会支配。2QR 法这是一个数值线性代数的重要成就，六十年前，固有值计算很慢而且不精确，我们甚至不知道求解 det（A-2）=0 是糟糕的方法。雅克比较早曾经建议 A 应该逐渐变成三角形－- 然后固有值自动出现在对角线，他使用 2×2 旋转产生非对角线的零。（不幸的是较早的零又变成非零，但是雅克比方法使得平行电脑恢复一部分流行。）QR 方法目前是固有值计算的领导者。

基本的步骤是分解 A 成为 OR，其中 A 的固有值是我们想要的。回忆格莱姆－施密特（段落 4.4），Q 有正交单位列与 R 是三角形。固有值的关键概念是：反转 Q 与 R。新的矩阵（相同 A＇s）是 A1=RQ，因为 A=QR 与 A1=Q-1AQ 相似，所以 RQ 的固有值没有改变：

A1=RQ 有相同的 QRx=2x 得到 RQ（Q-1x）=（Q-1x）

（12）

继续这个程序。把新矩阵 A1 分解成 Q1R1，然后反转因子变成 R1Q1，这是相似矩阵 A2 而且再次没有改变固有值。惊人的是这些固有值开始出现在对角线，很快的 A4 的最后单元得到一个精确的固有值。这个情况下，我们移除最后一行与最后一列得到一个较小的矩阵，然后继续寻找下一个固有值。

两个额外的概念使得这个方法成功，一个是在分解成 QR 之前，把矩阵平移 I 的倍数，然后 RQ 再平移回去得到 Ak+1:

把 Ak-CkI 分解成 QkRk，下一个矩阵是 Ak+1=RkQk+CkI

Ak+1 与 Ak 有相同的固有值，而且与原始的 A0=A 有相同的固有值。一个优质的平移是选择 c 靠近一个（未知的）固有值，这个更精确的固有值出现在 Ak+1 对角线 — 这个告诉我们下一个到 Ak+2 的步骤应该选择的较好 C。

第二个概念是在 QR 方法开始之前先获得非对角线的零，一个消元步骤 E 会做这样的事情，或是一个吉文斯旋转，但是不要忘了 E1（否则会改变）:

231

153

1

相同的 2＇s

我们必须在次对角线留下非零数 1 与 4，更多的 E＇s 可以移除他们，但是 E1 会再次填满，这是一个海森堡矩阵（一个非零的）次对角线。

网址：linear.neocities.org 箱：876152660@qq.com 531

在 QR 方法过程中，左下角的的零仍然维持是零。每个 QR 分解的运算次数从 O（n3） 降到 O（n2）。

Golub 与 Van Logan 给出一个在海森堡矩阵的 QR 一步平移的范例，这个平移是 7I，把 A 的所有对角线单元提出 7（然后平移回去 A1）:

－.54

1.690.835

00.000027.012

把 A-7I 分解成 QR 产生 A1=RQ+7I。注意这个非常小的数 0.00002，对角单元 7.012 几乎是 A1 的确切固有值，所以也是 A 的固有值。另一个在 A1 的平移 7.012I 的 QR 步骤会给出极佳的精确度。

对于大型稀疏矩阵的固有值，我会参考 ARPACK。问题 25-27 描述基底正交化的 Arnoldi 迭代法－— 当 A 是对称时每个步骤只有 3 项，矩阵变成三对角：计算固有值的奇妙开始。

问题集 11.3

问题 1-12 有关 Ax=b 的迭代法。

1 把 Ax=b 变成 x=（I-A）x+b，这样分割对应的 S 与 T 为何？什么样的矩阵 S-1T 控制 xk+1=（I-A）xk+b 的收敛？

2 若 λ 是 A 的一个固有值，则＿_是 B=I-A 的固有值。若 A 的实数固有值介于

与

之间，B 的实数固有值有绝对值小于 1。

3 说明为什么 =+b 达代对于 A 无法

4 为什么 B＊的范数不会大于 | B|＊? 则 | B|<1 确保次方 B＊趋近零（收敛）。由于 | 2|max 小于 | B|，所以前述的事实毫无惊讶。

5 若 A 是奇异，则所有的分割 A=S-T 必定失败。由 Ax=0 证明 STx=x，所以矩阵 B=S-1T 有 λ=1，因此迭代失败。

6 把 2＇s 换成 3＇s，求出雅克比方法对应的 ST 的固有值：

Sx+1=xx+b 是［］x1=［］x+b

7 针对问题 6，求出高斯－赛德尔方法对应的 ST 的固有值：

高斯－赛德尔对应的 | 2|max 等于雅克比对应的 ||max?

请尊重版权与译者的劳动成果，侵权必究！ 532

8 对于任 2 证明对应高斯德尔的等于 a 对应雅

克比的 | 2|max 等于 | bc/ad|12。我们需要 ad≠0 使得矩阵 S 可逆。

9 写出高斯－赛德尔的一个电脑代码（MATLAB 或其他），你可以从 A 定义 S 与 T，或是直接从单元 a 设定迭代回圈。针对阶数 10，20，50 的－1，2，－1 矩阵 A 进行测试，其中 b=（1，0，.，0）。

10 在分量 i 的高斯－赛德尔迭代使用较早的 xnew 的部分：

高斯－赛德尔

e －d +1 （6-aew － aoa）

如果每个 xnew=xold，然后证明解 x 是正确的？对应雅克比方法时，公式要如何修改？对于 soR，在括号外插入の。

11 方程式（10）除以 1，说明为什么 | 2/1 | 控制次方法的收敛速度。创建一个矩阵 A 使得这个方法不能收敛。

12 马可夫矩阵 A = 有 = 1 与 0.6，次方法 = A4o 收到，求出 A

的固有值。逆次方法 u=A＊uo 收敛到什么数字（在你乘 0.6＊之后）？

13 对角线－1，2，－1 的阶数 n-1 的三对角矩阵有固有值 λ=2-2cos（jπ/n），为什么最小的固有值近似于（/n）2? 逆次方法收飲的速度是 / 2≈1/4。

14 对于 A［- 应用次方法三次、其中初始值是次方法收敛到什么样的固有向量？

15 对于 A=-1，2，-1 矩阵，应用逆次方法 uk+1=A-1uk 三次，初始值与前述相同，这些 uk＇s 趋近什么样的固有向量？

16 求取固有值的 QR 方法中，当 A 平移使得 A22=0，证明 2，1 单元从 A=QR 中的 sinθ 掉落成 RQ 中的－sin3 0。（计算 R 与 RQ。）这项「立方收敛」使得这个方法成功：

17 如果 A 是正交矩阵，它的 QR 分解有 Q=__与 R=__，因此 QR=__

当 QR 方法无法使用时，这些是稀有的例子。

18 平移 QR 法把 A-cI 分解成 QR，证明下一个矩阵 A1=RQ+cI 等于 Q-1AQ，因此 A1 与 A 有

的固有值（但是 A1 接近三角形。）

网址：linear.neocities.org 箱：876152660@qq.com 533

19 当 A=AT，「Lanczos 方法」求出 a＇s 与 b＇s 与正交单位 q＇s 使得 Aqj=b-1q-1+

a9+b9+1（其中 q0=0），用 q 乘前述方程式求出的公式。这个方程式昱

示 AQ=QT，其中 T 是一个三对角矩阵。

20 问题 19 的方程式来自下列的回圈，其中 bo=1 与 ro = 任意 q1:

q+1=r11b；j=j+1；a1=q，TAq1:r=Aq1-b-1q-1-a，q；b，=|r，|

写出一个代码并在－1，2，－1 矩阵 A 测试，QTQ 应该是 I。

21 假设 A 在 QR 方法中是三对角且对称，从 A1=Q1AQ 证明 A1 对称。写出 A1=

RAR1，证明 A1 也是三对角。（如果证明 A1 的下半部是三对角，依据对称性质，

则上半部分也是三对角。）对称三对角矩阵是 QR 方法的最佳开始方式。

问题 22-25 提出两个基础迭代，每个步骤包含 Aq 或 Ad。

大型矩阵的关键点在于矩阵－向量乘法比矩阵－矩阵乘法快很多。需要的创建从向量 b 开始，重复乘法得到 Ab，A2，. 但是这些向量不是正交。「Arnoldi 迭代」针对格莱姆－施密特概念建立的空间，创建一组正交单位基底 q1，q2，.：针对前面的 q1，..，qn-1，正交化每个新的 Aqn，由 b，Ab，.，An-1b 生成的「Krylov 空间」具有更好的基底 q1，.，qn。

这里的伪代码是数值线性代数中两个最重要的演绎法，Arnoldi 给出优质基底，CG 给出 x=A-1b 的优质近似。

Arnoldi 迭代法

针对正定 A 的共轭梯度迭代

q1=b/lbll

xo=0， ro=b， do= ro

for n = 1 to N － 1 forn =1 to N

v=Agn

an=（r-irn-1）/（dn-1Adn-1）步阶长度 xn-1 到 xn

forj=1 to n

an=n-1+andn-1

近似解

hjn=qv

Tn=rn-1-anAdn-1

新的残余量 b-Axn

v=v-hjnqj

Bn=（rrn）/（r-1rn-1）

改善步阶

hn+1，n= llull

dn = rn +ßndn-1

下个搜寻方向

9n+1= v/hn+1，n％注意：只有一个矩阵－向量乘法 Aq 与 Ad

对于共轭梯度，残余量 rn 是正交，搜寻方向是「A - 正交」：所有的 dAdk=0。这个迭代法利用极小化误差 eTAe 求解 Ax=b，其中极小化是针对 b，Ab，.，A＂1b 生成的「Krylov 空间」中的所有向量。这是奇妙的演绎法。

22 对于对角矩阵 A=diag（［1234］）与向量 b=（1，1，1，1），走完一个 Arnoldi

步驟，求出正交单位向量 g1 与 q2

请尊重版权与译者的劳动成果，侵权必究！ 534

23 Arnoldi 的方法是找出 Q 使得 AQ=QH（一列一列的处理）:

－［

H 是一个「海森堡矩阵」，其中有一个非零的次对角线。当 A 是对称，存在一个重要的事实：海森堡矩阵 H=Q1AQ=QTAQ 是一个对称矩阵，因此它是三对角矩阵。说明上述这句话。

24 三对角 H（当 A 是对称）给出 Lanczos 迭代：

只有三个项 9=（ag-h，9，-，91）

从 H=Q-1AQ，为什么 H 的固有值与 A 的固有值相同？对于大型矩阵，「Lanczos 方法」借由停在较小的三对角矩阵 H 来计算带头固有值，书中的 QR 方法应用在计算 Hk 的固有值。

25 应用共轭梯度（CG）方法求解 Ax=b=ones（100，1），其中 A 是－1，2，－1 的第二差分矩阵 A=toeplitz（［2-1 zeros（1，98）］）。沿着确切解 x＊，从 CG 画出 x10 到 x20。（它的 100 个分量是 x1=（ih-i2h2）/2，其中 h=1/101。「plot（i，x（i）」应该是一个抛物线。）【原文－1 之间空格是错误】

26 对于非对称矩阵，光谱半径 p=max|2 | 不是一个范数。但是在大的 n 时，‖A＂| 会像 p＂一样的成长或衰减。针对 A=［11；01.1］，使用指令 norm 比较前述的数字。

An→0 若且唯若 p<1。当 A=S-T，这是收的关键。

网址：linear.neocities.org 箱：876152660@qq.com 535

第十二章

概率与统计的线性代数

12.1 平均值，方差与概率

我们从本章 3 个基本词语开始：平均值，方差与概率，在我开始写任何公式之前

那，先做个粗略的意义说明：

平均值是平均数值或是期望数值。

方差♂2 量测与平均值 m 的距离的平方。

n 个不同事件的概率是正数 p1，.，pn，他们的总和是 1。

当然，平均值很容易了解，我们从它开始。但是马上我们有两个不同的情况需要

你保持清楚，一方面我们可以从完整的试验得到结果（样本值），另一方面我们可

以从未来的试验得到期望的结果（期望值）。让我给出一些例子：

样本值

5 个随机大一新生的年龄 18，17，18，19，17

样本平均值（18+17+18+19+17）/5=17.8

概率

大一新生班级的年龄是 17（20％），18（50％），19（30％）一个随机大一新生有期望年龄 E［x］是（.2）17+（.5）18+（.3）19=18.1 两个数字 17.8 与 18.1 都是正确的平均。样本平均值从来自一个完整试验的 N 个

样本 x1，..，xN 开始，他们的平均值是 N 个观察样本的平均：

样本平均值 m=1=（x1+x2+.+x）

（1）

请尊重版权与译者的劳动成果，侵权必究！ 536

x 的期望值从年龄 x1，.，xn 的概率 p1，.，pn 开始：

期望值 m=E［x］=p1x1+p2x2+.+pnxn

（2）

这是 p·x。注意 m=E［x］告诉我们期望什么，m=μ 告诉我们得到什么。

借由取得很多样本（很大的 N），样本的结果会与概率接近，「大数法则」说明当样本大小 N 增加，样本的平均值会收敛到它的期望值 E［x］，这个概率是 1。一个公平的铜板有概率 po=％的尾与 p1=％的头，则 E［x］=（％）0+（％）1。在 N 次铜板的投掷出现头的比例是样本平均值，期望会趋近 E［x］=％。

这个并不是说如果我们看到的尾比头多，下个样本会倾向出现头，机会仍然是 50-50。前 100 或 1000 次投掷确实会影响样本平均值，但是 1000 次投掷不会影响它的极限－— 因为你要除以 N→∞。

方差（环绕平均值）

方差 σ2 量测与期望平均值 E［x］的期望距离（平方），样本方差 S2 量测与样本平均值的实际距离（平方），平方根是标准差 σ 或 S。一次考试之后，我邮寄 μ 与 S 到班级，我不知道期望平均值与方差，因为我不知道每个分数的概率 p1 到 p100。（教学 50 年，我仍然不知道期望什么。）

偏差永远是与平均值的偏差 — 样本或期望，我们在检视环绕平均值 x=m「分布」的大小，从 N 个样本开始。

样本方差

8=1x + ー

（3）

样本年龄 x=18，17，18，19，17 有平均值 m=17.8，样本有方差 0.7:

当我们计算平方时，负号消失。请注意！统计学家除以 N-1=4（不是 N=5）使得 S2 是 σ2 的一个「无偏差（unbiased）」估测。一个自由度已经用在样本平均值。

一个重要的等式来自分割（x-m）2=x2-2mx+m2:

（x1-m）2 的总和 =（x2 的总和）-2m（x1 的总和）+（m2 的总和）

=（x2 的总和）-2m（Nm）+Nm2

（x1-m）2 的总和 =（x2 的总和）-Nm2

（4）

这是借由 x12+.+xN2 的总和求取（x1-m）2+.+（xN-m）2 的等效方式。

【原文排版错误】

网址：linear.neocities.org 箱：876152660@qq.com 537

现在从概率 p（不会是负数！）而不是从样本开始，我们求出期望值而不是样本值。方差 σ2 是统计学的重要数字。

方差

σ²=E［（x-m）²］=pι（xι－m）²+ .+p＂（x^-m）²］

（5）

我们把与期望值 m=E（x）的距离平方，我们没有样本，只有期望，我们知道概率但是我们不知道试验结果。

范例 1 求出大一新生年龄的方差 2。

解年龄 x1=17，18，19 的概率是 p1=0.2，0.5 与 0.3，期望值是 m=∑p1x1=18.1，方差使用这些样本概率：

σ2=（0.2）（17-18.1）2+（0.5）（18-18.1）2+（0.3）（19-18.1）2

=（0.2）（1.21）+（0.5）（0.01）+（0.3）（0.81）=0.49.

标准方差是平方根 σ=0.7。

这是量测 17，18，19 环绕 E［x］的分布情况，加权是概率.2，.5，.3。连续概率分布

直到现在我们才允许 n 个可能的结果 x1，.，xn。对于年龄 17，18，19，我们只有 n=3。如果我们用天量测而不是用年，会有 1000 个可能的结果（太多了），最好是允许介于 17 到 20 之间的每个数 — 一个可能年龄的连续。对应年龄 x1，x2，x3 的概率 P1，P2，p3 必须移到一个概率分布（probability distribution）p（x），对应一整个 17≤x≤20 的连续范围。

说明概率分布的最佳方法是给你两个例子，他们是均匀分布（uniform）与正态分布（normal）。第一个（均匀）很简单，正态分布最重要。

均匀分布假设年龄在 17.0 到 20.0 之间均匀分布，两个数字之间的年龄发生的机会相等，当然任何一个确切的年龄完全没有机会。当你要命中确切数字 17.1 或 17+√2 的概率将是零。你真实能够提供（假设我们的均匀分布）的是一个随机大一新生的年龄小于 x 的机会 F（x）:

年龄小于 x=17 的机会是 F（17）=0

x≤17 不会发生

年龄小于 x=20 的机会是 F（20）=1

x≤20 一定发生

年龄小于 x 的机会是 F（x）=（x-17）

F 的值从 0 到 1

公式 F（x）=（x-17）在 x=17 时 F=0，表示 x≤17 不会发生。在 x=20 时给出 F=1，表示 x≤20 一定发生。针对均匀模型，介于 17 与 20 的累积（cumulative）分布 F（x）的图形是线性增加。

请尊重版权与译者的劳动成果，侵权必究！ 538

让我画出 F（x）与它的导数 p（x）=「概率密度（probability density）函数」的图形。

累积 F（x）= 样本

「pdf」p（x）= 样本

小于 x 的概率

接近 x 的概率

F（x）=（x-17）

p（x）=dF（x）/dx

F=1

p=3

1

+ 1

17

20

17

20

图 12.1:F（x）是累积分布而且它的导数 p（x）=dF（x）/dx 是概率密度函数（pdf）。对于均匀分布，p（x）在 17 到 20 之间是常数，p（x）图形下的总面积是总概率 F=1。

你可以说 p（x）dx 是一个样本落在 x 与 x+dx 之间的概率，这是「无限小的真实」：p（x）dx=F（x+dx）-F（x），这里是整个事实：

F=p 的秋分 aSxb 的概率 = I＂p（）=F（）-F（）

（6）

F（b）是 x≤b 的概率，我减去 F（a）维持 x≥a，留下了 a≤x≤b。

p（x）的平均值与方差

一个概率分布的平均值 m 与方差 σ2 为何？前面我们累加 pxi 得到平均值（期望值），连续分布的情况下，我们积分 xp（x）:

平均值 m-EA-=85

对于均匀分布来说，平均值 m 在 17 与 20 的中间，在中间点 m=18.5 以下的随机值 x 的概率是 F（m）=1/2。

在 MATLAB 中，x=rand（1）会在 0 与 1 之间均匀选择一个随机数字，期望平均值是 m=1/2。从 0 到 x 的区间有概率 F（x）=x，在平均值 m 以下的区间永远有概率 F（m）=1/2。

方差是与平均值距离的平方的平均值，如果有 N 个结果，σ2 是 p（x1-m）2 的总和。对于连续的随机变数 x，总和变成积分：

方差 σ2=E［（x-m）2］=∫p（x）（x-m）2dx

（7）

网址：linear.neocities.org 箱：876152660@qq.com 539

当年龄在 17≤x≤20 之间均匀分布，积分可以平移到 0≤x≤3:

o2=f（x-18.5）2dx=f（x-1.5）2dx=（x-1.5）|=（1.5）2 = 这是典型的例子，这里是对于均匀 p（x）的完整轮廓，0 到 a。

对于 0≤x≤a 的均匀分布，密度 p（x）=1/a 累积分布 F（x）=x/a

平均值 m=a/2 中间值

方差。2=

（8）

平均值是 a 的倍数，方差是 a2 的倍数。a=3 时，σ2=9/12=3/4。对于一个介于

0 到 1（平均值是 1/2）的随机数，方差是 σ2=1/12。

正态分布：钟形曲线

正态分布也称为高斯分布，它是所有概率密度函数 p（x）中最重要的函数，它的超

级重要性的理由来自重复一个实验以及实验的平均结果。实验有他们自己的分布

（例如头与尾），平均值会趋近正态分布。

中央极限定理（central limit theorem）（非正式）任意概率分布在 N→∞时，它的 N 个样本的平均值会趋近正态分布。

从「标准正态分布」开始，它是对称于 x=0，所以它的平均值是 m=0，它被选

成一个标准方差 σ2=1，称为 N（0，1）。

标准正态分布

p（x）=e-x212

（9）

p（x）的图形是图 12.2 的钟形曲线，标准事实是：

总概率 = 1

平均值 E［x］=0

m-xerak-0

方差 E［x2］=1

o2=（x-0）2e-x22dx=1

请尊重版权与译者的劳动成果，侵权必究！ 540

零平均值很简单，因为对一个奇函数积分，把 x 换成－x 显示「积分 =- 积分」，所以积分必须是 m=0。

另外两个积分应用问题 12 的概念得到 1，图 12.2 显示正态分布 N（0，o）的 p（x）的图形，以及累积分布 F（x）=p（x）的积分的图形。从 p（x）的对称性，你看到平均值 = 零，从 F（x）你看到针对民意调查非常重要的实际近似：

随机样本落在－σ 与 σ 之间的概率是 F（o）-F（-o）≈2/3。

这是因为［°p（x）dx=［°p（x）dx-p（x）dx=F（o）-F（-o）

近似的，随机 x 落在－2σ 与 2σ（离开平均值的距离小于两个标准差）之间的概率是 F（2σ）-F（-2σ）≈0.95。如果你有一个实验结果距离平均值比 2oσ 还远，它几乎可以确定不是偶然发生：机会 = 0.05。药物测试要寻找更严格的确认，比如概率 0.001。寻找希格斯玻色子（Higgs boson）时使用远离偶然的 5σ 标准差的超严格测试。

.98

.84

p（x）

Pie-joudo da

F（O）-

.16

.02

－

－2σ －σ

0

σ

2σ

－2σ

－σ

0

σ

2σ

图 12.2：标准正态分布 p（x）有平均值 m=0 与 σ=1。

有任意平均值 m 与标准差 σ 的正态分布，是来自平移与拉伸标准的 N（0，1）。x 平移到 x-m，拉伸 x-m 成为（x-m）/σ。

高斯密度 p（x）

正态分布 N（m，σ）

（10）

p（x）的积分是 F（x）- 随机样本小于 x 的概率，微分 p（x）dx=F（x+dx）-F（x）是一个随机样本落在 x 与 x+dx 之间的概率。没有简单的公式可以积分 e-x2/2，所以累积分布 F（x）需要仔细计算与列表。

网址：linear.neocities.org 箱：876152660@qq.com 541

N 次投掷铜板与 N→∞

范例 2 假设 x 是 1 或－1，概率是相等的 p1=p-1=1/2。

平均值是 m=2（1）+％（-1）=0，方差是 σ2=％（1）2+2（-1）2=1。关键问题是平均值 AN=（x1+..+xN）/N，无关的 x1 是 ±1，而且我们除以他们的总和 N，AN 的期望平均值仍然是零。大数法则说明这个样本平均值趋近零的概率是 1，AN 趋近零会有多快？它的方差 σ2 为何？

＊-

范例 3 改变输出，从 1 或－1 改成 x=1 或 x=0，维持 p1=p0=1/2。

新的平均值是 m=1/2，这是 0 与 1 的中间值。方差移到 σ2=1/4:

m=％（1）+（0）=1/2 与 σ2=（1-）2+（0-％）2=1/4

平均 AN 现在有平均值 1/2 与方差 2++4N24N=ON2

（12）

这个 o 是范例 2 的 σN 的一半，这个必须是正确的，因为新的值域是 0 到 1，这是－1 到 1 的一半。范例 2-3 展示一个线性法则。

新 0-1 变数 x 新是 ⅓x 旧 +⅓，所以平均值 m 增加到 1/2 以及方差变成（1/2）2 倍。一个平移改变 m 与调整比例改变 σ2。

线性 x 新 = ax 旧 + b 有 m 新 = am 旧 + b 与 σ2 新 = a2σ2 旧

（13）

这里是来自 3 个测试的结果：N 次试验的随机 0 或 1 的平均。

［从 N=100 有 48 个 1＇s］［从 N=10000 有 5035 个 1＇s］［从 N=40000 有 19967 个 1＇s］ 标准化 X=（x-m）/σ=（AN-⅓）/2√是［-.40］［.70］［-.33］

中央极限定理说明很多次投掷铜板会趋近一个正态分布，让我们开始观察这是如何发生：二项式趋近正态。

每次投掷出现头的概率是 1/2。N=3 次投掷出现三次头的概率是（1/2）3=1/8。出现两次头一次尾的概率是 3/8，这是来自 3 个序列 HHT 与 HTH 与 THH。数字 1/8 与 3/8 是（+=+++=1 的片段。3 次投掷出现头的平均数是 1.5。

wxex2cx0은1

请尊重版权与译者的劳动成果，侵权必究！ 542

投掷 N 次，范例 3（或常识）得到平均值 m=∑x1p1=N/2 次头。

方差 σ2 是基于离开平均值 N/2 的距离平方，N=3 时方差是 σ2=3/4（就是 N/4）。要求得 σ2，我们累加（x1-m）2p1，其中 m=1.5:

对于任意的 N，方差 σN2=N/4，则 σN=N/2。

图 12.3 显示在 N=4 次投掷中，出现人头次数 0，1，2，3 的概率是如何接近一个钟形高斯。这个高斯的中心是平均值 N/2=2，要变成标准高斯（平均值 0 与方差 1），我们平移然后拉伸图形。如果 x 是 N 次投掷出现人头的次数－N 个 0-1 结果的平均值－- 则 x 平移到它的平均值 m=N/2 然后利用 σ=√N/2 调整比例，产生标准的 X:

平移与调整比例

x=:-）3

（N=4 有 X=x-2）

减去 m 是「中心化」或「消除趁势」，X 的平均值是零

除以是「正态化」或「标准化」，X 的方差是 1

PN/2~/2/πN

p（x） = 1

均匀

二项式

趋近高斯

N 次投掷

M 次人头

面积 = 1

1 1

16 2N

12

0

12

M=0

N/2

N

图 12.3:4 次投掷出现人头次数的概率 p=（1，4，6，4，1）/16，这些 p；趋近一个高斯分布，其中 σ2=N/4，中心点在 m=N/2。对于 X，中央极限定理给出收敛到正态分布 N（0，1）。

看到中央极限定理在中心点 X=0 给出正确答案是开心的，在这个点的因子 e-x2/2 等于 1。我们知道 N 次投掷铜板的方差是 σ2=N/4，钟形曲线的中心有高度 11√2πσ2=√21Nπ。

投掷铜板分布 po 到 pn（二项式分布）的中心点高度为何？当 N=4，人头次数 0，1，2，3，4 的概率来自（+）

中心概率 6/16

+）-

网址：linear.neocities.org 箱：876152660@qq.com 543

问题 8 的二项式定理告诉我们对于任意偶数 N 的中心概率：

中心概率（N/2 次人头，N/2 次尾）是

（N/2）（N/2）

N=4，这些阶层得到 4！/2！2！=24/4=6。针对大的 N，Stirling 的公式√2πN（N/e）M 是一个接近 N！的近似值，使用 Stirling 公式取代 N！与两次的（N/2）！:

【原文少了两个＇！＇】

投掷铜板中心概率的极限

（14）

最后一个步聚我们针对铜板投题使用了方 N4 结果配高

的中心值（上述）。中央极限定理成立：当 N→∞，「二项式分布」趋近正态分布。

蒙特卡罗估测法

科学计算必须处理资料中的误差，金融计算要处理不确定的数字与不必然的预测，所有的应用数学必须移到接受输入的不确定与估测输出的方差。

如何估测方差？通常概率分布 p（x）是未知，我们能做的就是尝试不同的输入 b 与计算输出 x 然后取平均。这是蒙特卡罗法的最简单形式（以位于 Reviera 的赌场命名，在那儿我看过一次由于赌注是否及时落地引起的争斗。）蒙特卡罗法利用样本平均（x1+.+xn）/N 取得期望值 E［x］的近似值。

请了解每个 xk 都是很花成本去计算的，我们不只是投掷铜板，每个样本来自一个资料 bk 的集合。蒙特卡罗法随机选择资料 bk，它计算输出 xk，然后取这些 x＇s 的平均值。E［x］要有不错的精确度通常需要很多样本 b 以及巨大的计算成本。利用（x1+.+xn）/N 取得 E［x］近似值的误差的阶数通常是 1/√N，当 N 增加会有缓慢的改善。这个 1/√N 估测出现在方程式（11）的投掷铜板中，对 N 个无关样本 xk 取平均， 方差 σ2 降为方差 σ2/N。

「类似－蒙特卡罗」有时候可以把方差降低到 σ2/N2：一个巨大的不同！非常仔细的选抒输入 b 一不只是随机。这个 QMC 方法在期刊 Acta Numerica2013 申阅，更新的概念「多阶层蒙特卡罗」在 Acta Numerica 2015 由 Michale Giles 发表，这里是如何工作的原理：

2 阶层蒙特卡罗

请尊重版权与译者的劳动成果，侵权必究！ 544

这个概念是 x-y 比原始的 x 有一个较小的方差 σ°，因此在相同的 E［x］的精确

度下 N 会比 N 小。我们做 N 次便宜的仿真求出 y＇s，每次的成本是 C，我们只做

N＊次与 x＇s 有关的昂贵仿真，每次的成本是 C，全部的计算成本是 NC+N＊C＊。微积分针对固定总成本取整体方差的极小值，最佳比值 N/N 是√C/Cσ/σ。

三阶层蒙特卡罗会仿真 x，y 与 z:

Giles 最佳化 N，N＊，N＊，.. 维持 E［x］≤固定的 Eo，而且有提供 MATLAB 代码。

复习：平均值与方差的三个公式

对于 m 与 2 的公式所有概率与统计的起点，有三种不同的方式：样本值 X，期望

值（离散 pi）与期望值的值域（连续 p（x），这里是平均值与方差：。

样本 X1 到 XN

m= X1+…+XNS2_（X1-m）2+…+（XN-m）2

N

N-1

概率 p 的

n 个可能输出

m=

2=p:（x-m）2

概率密度

的输出值域

m =fxp（x）dx σ²=f（x-m）²p（x）dx

一个自然的问题：为什么第一行没有概率 p? 这些公式如何相通？答案：我们期

望一个样本的函数 p1 是 X=xi，如果真实成立，X=xi 重复 piN 次，则行 1 与行 2

得到相同的 m。

当我们处理样本时，我们不知道 p1，我们只能记录每个输出 X 来临的次数，

我们得到的是经验值而不是期望平均值。

问题集 12.1

1 加 7 到每个输出 x，平均值与方差发生什么？新的样本平均值，期望平均值与新的方差为何？

2 我们知道：1/3 的整数可以被 3 整除，1/7 的整数可以被 7 整除。可以被 3 或被 7 或同时整除的比例是多少？

3 假设你用相同的概率 1/1000 从 1 到 1000 取得样本，样本的最后位数是 0，.，9 的概率 p 到 p 为何？最后一位数的期望平均值为何？方差 2 为何？

4 再次从 1 到 1000 取样，但是这次观察样本平方的末位数，这个平方的末端可能是 x=0，1，4，5，6 或 9，这些概率 po，p1，p4，p5，p6，p9 为何？数字 x 的（期望）平均值 m 与方差 σ2 为何？

网址:linear.neocities.org 箱：876152660@qq.com 545

5（有一些困难）再次使用相同的概率从 1 到 1000 取样，令 x 是第一位数（如果数字是 15，x=1）。这些 x=1，..，9 的概率 p1 到 p9（总和是 1）为何？x 的平均值与方差为何？

6 假设问题 5 你有 N=4 个样本 157，312，696，602，这些数字的平方的第一位数 x1 到 x4 为何？样本平均值 μ 为何？样本方差 S2 为何？记得除以 N-1=3，而不是 N=4。

7 方程式（4）给出 S2 的第二等效形式（使用样本的方差）：

8 = 的总利的总利－m）

验证期望方差 σ2 的适配等式（使用 m=∑px1:

2=p1（x1-m）2 的总和 =（p1x2 的总和）-m2

8 来自人口的全部 24 个样本产生相同的年龄 x=20，则样本平均值 μ 与样本方差 S2 为何？如果 x=20 或 21，分别有 12 次，答案为何？

9 如同 541 页的电脑实验：找出一百万次随机 0-1 样本的平均值 A1000000！求出 x=（An-）2。

0 在次投板得到次人头的率是二项式数字 b）除以 2 的总和是（1+1）N=2N，所以概率 p；的总和是 1。

N=4 得到 b=2b=（6）.=（2）B=16（1，46.41）

注意 b1=b。问题：确认平均值 m=Opo.+p=N2。

11 任意函数 f（x）的期望值是 E［f］=∑p1f（x1）或∫p（x）f（x）dx（离散概率或连续概率）。假设平均值是 E［x］=m 以及方差是 E［（x-m）2］=σ2，求 E［x2］。

12 证明标准正态分布 p（x）的总概率是如同要求的 p（x）dx=1，一个著名的把戏是 fp（x）dx 乘 p（y）dy，然后计算对于全部 x 与 y（-0 到∞）的积分。这个把戏是把 dxdy 换成 rdrd0（极坐标的 x2+y2=r2），说明下列的每个步骤：

请尊重版权与译者的劳动成果，侵权必究！ 546

12.2 协方差矩阵与联合概率

当我们一次进行 M 个不同试验时，线性代数进入。我们可以量测年龄与身高与重量（N 个人，每人 M=3 个量测值），每个试验有自己的平均值，所以我们有一个向量 m=（m1，m2，m3）包含这 M 个平均值。这些可以是年龄与身高与重量样本平均值，或是 m1，m2，m3 可以是基于已知概率的年龄与身高与重量的期望平均值。

当我们关注方差时就会引入矩阵，每个试验有一个样本方差 S2 或一个基于离开平均值距离平方的期望 σ2=E［（xi-mi）2］，这 m 个数字 m2，.，o2 会落在矩阵的对角线。目前为止我们还没有联结这 M 个平行试验的关系，他们量测 M 个不同的随机变数，但是试验没有必要是无关！

如果我们量测小孩子的年龄与身高与重量（a，h，w），这些结果会有强烈的相关性，大一点的小孩通常比较高比较重。假设这些平均值 ma，mn，mw 已知，则 σa2，h2，2 是年龄与身高与重量的个别方差，新的数字是好像 σah 的协方差（covariance），这是年龄乘身高。

协方差 =σah=E［（年龄－平均年龄）（身高－平均身高）］

（1）

这个定义需要仔细观察，要计算 σah，知道每个年龄的概率与每个身高的概率是不够的，我们必须知道每个配对（年龄与身高）的联合（joint）概率，这是因为年龄与身高相关。

Pah= 一个随机小孩有年龄 = a 与身高 = h 的概率：同时拥有。

p = 试验 1 得到 xi 与试验 2 得到 y 的概率。

假设试验 1（年龄）的平均值是 m1，试验 2（身高）的平均值是 m2，（1）中试验 1 与 2 之间的协方差关注年龄 x1 与身高 y 的所有配对：

协方差

12=∑∑p（x1-m1）（y1-m2）

（2）

全部 i，

要捕捉「联合概率 p 的概念」我们从两个小例子开始。

范例 1 分开投掷两个铜板，1 代表人头，0 代表尾，结果可以是（1，1）或（1，0）或（0，1）或（0，0），这 4 个结果的概率都是 p11=p10=p01=p00=1/4。无关试验有

（i，j）的概率 =（i 的概率）（j 的概率）

范例 2 把铜板粘在一起，面朝同一个反向。可能性只有（1，1）与（0，0），这些有概率 1/2 与 1/2。概率 p10 与 po1 是零，（1，0）或（0，1）不会发生，这是因为铜板粘在一起：同时人头或同时尾。

试验 1 与 2 的概率矩阵

网址：linear.neocities.org 邮箱：876152660@qq.com 547

让我在 P 停留久一点，来展示它在良好的矩阵表示法中。矩阵显示每个配对（xi，y）的概率－从（x1，y1）=（头，头）与（x1，y2）=（头，尾）开始，注意行的总和 p1 与列的总和 P 以及全部总和 = 1.。

概率矩阵 P=［］p+=p2 铜板

（第二个铜板）列的总和 P1P24 个单元总和是 1

这些数字 p1，p2 与 P1，P2 称为矩阵 P 的边际（marginal）:

p1=P11+p12 = 来自铜板 1 的人头机会（铜板 2 可以是头或尾）

P1=p11+p21 = 来自铜板 2 的人头机会（铜板 1 可以是头或尾）

范例 1 展示无关变数，每个概率 py=pi 乘 p（本例中 1/2 乘 1/2 得到 p=1/4），这个情况下协方差 σ12 会是零，来自第一个铜板的头或尾无法给出第二个铜板的信息。无关试验的零协方差 c12v=［］对角协方差矩阵

无关试验有 σ12=0，这是因为方程式（2）的每个 p=（pi）乘（pj）。

012-（n）（）（x2-m）（-2）-［E（）（x2-m）］［（）（-me2）］-（00 粘在一起的铜板展示完美的关联，一个出现头表示另一个也是，协方差 σ12 从 0 变成 σ1σ2=1/4— 这是 σ12 的最大可能值：

平均值 = 02=（1-）（1-）+0+0+（0-）（0-）-

来自铜板 1 的头或尾得到来自铜板 2 的头或尾的完整信息：

粘合铜板得到最大可能的协方差

奇异协方差矩阵：行列式 = 0

=］

永远有 σ120220122，于是 σ12 介于－σ102 与 0102 之间，协方差矩阵 V 是正定（或是粘合铜板的奇异情况下，V 是正半定。）这是关于 M 个试验的 M×M 协方差矩阵的重要事实。

注意来自 N 次试验的样本协方差矩阵 S 当然是正半定，每个新样本 X=（年龄，身高，重量）贡献出样本平均值 X 与 S，每个项（X-X）（X-X）T 是正半定，然后我们相加得到 S:

x-X＇tXx s-（xi-Xi-ttxx-x-）＇）

请尊重版权与译者的劳动成果，侵权必究！ 548

回到试验 1 与 2（两个铜板）之间的期望方差 σ12:

σ12=［（输出 1 - 平均 1）乘（输出 2 - 平均 2）］的期望值

=∑∑Pg（x1-m1）y1-m2）

（4）

全部 i，j

p≥0 是看到试验 1 出现 xi 与试验 2 出现 y 的概率。某些输出配对必须出现，

因此 N2 个概率 p 的总和是 1。

总概率（所有的配对）是 1

∑∑p=1

（5）

这里我们需要另一个事实。在试验 1 固定一个特定输出 x1，允许所有的输出

y 出现在试验 2，把出现（xi，y1），（xi，y2），.，（xi，yn）的概率相加：

P 的行总和 pi

p = 试验 1 出现 x1 的概率 p

（6）

某些 y 必须出现在试验 2！不论两个铜板是完全分开或是粘合一起，我们仍然得

到铜板 1 是人头的概率 pH=pHH+pHT 是 1/2:

（分开）pHH+pHT=1/4+1/4=1/2

（粘合）pHH+pHT=1/2+0=1/2

基础的推理允许我们写出一个矩阵公式，这个公式在试验 1 与试验 2 的个别方差

12 与 22 之外，引入伴随的协方差 2。把每个配对（i，j）的矩阵 Vg 相加，我们得到

整体的协方差矩阵 V:

协方差矩阵

在非对角线，这是对应协方差 m2 的方程式（2）。在对角线，我们得到正常的方

差 12 与 22，我会仔细的展示我们如何使用方程式（6）得到 V1u=12。允许所有的 j

得到试验 1 出现 x1 的概率 p；:

V1=∑∑pg（x1-m1）2=∑（x1 的概率）（x1-m1）2=a12

（8）

全部 i，j

全部 i

请观察两次，这是利用一个公式（7）产生整个协方差矩阵的关键。这个公式的美妙

之处在于它结合 2×2 矩阵 V，并且（7）中对应每个输出 i，j 配对的矩阵 V 是正半定：

V 有对角线单元 p（x3-m1）2≥0 与 p（y1-m2｝2≥0 以及 det（V）=0

这个矩阵巧有秩 1，方程式（7）计算 p 乗列 U 乘行 U:

网址：linear.neocities.org 箱：876152660@qq.com 549

［xi-m y-ma］

（9）

每个矩阵 UUT 是正半定，所以整个矩阵 V（利用加权 p≥0 结合这些矩阵 UUT）最少是正半定 —V 可能是正定。

除非试验是相关，否则协方差矩阵 V 是正定。

现在我们从两个变数 x 与 y 来到 M 个变数，比如年龄－身高－重量，来自每个试验的输出是一个有 M 个分量的向量 X，（每个小孩有一个 3 个分量的年龄－身高－重量的向量。）协方差矩阵 V 现在是 MxM，V 是来自输出向量 X 与它们的平均值 ⅹ= E［X］:

协方差矩阵

V=E［（X- X）（X- X）］

（10）

记得 XXT 与 XXT=（列）（行）是 M×M 矩阵。

M=1（一个变数），你看到 ⅹ 是平均值 m 与 V 是 σ2（段落 12.1）。M=2（两个铜板），你看到 ⅹ 是平均值（m1，m2）与 V 适配方程式（10），期望值 E 永远是输出乘概率的总合。对年龄－身高－重量来说，输出可以是 X=（5 岁，31 时，48 磅）并且它的概率是 p5，31，48。

现在是一个新概念，取任意的线性组合 cTX=c1X1+..+cMXM，当 c=（6，2，5），这个就是 cTX=6（年龄）+2（身高）+5（重量）。基于线性我们知道它的期望值是 E［¢TX］=¢E［X］=cTX.

E［cTX］=cTE［X］=6（年龄期望值）+2（身高期望值）+5（重量期望值），不止如此，我们也知道 cX 的方差♂2:

cX 的方差 = E［（cX-cx）（cX-cX）円

=cTE［（X-X）（X-X）T］c=cTVc

（11）

现在是关键点：cTX 的方差不可能是负数，所以 cTVc≥0，依据能量测试 cTVc≥0，所以协方差矩阵 V 是正半定。

协方差矩阵 V 开启概率与线性代数的联结：V 等于 QAQT，其中固有值≥0 而且有正交单位向量 q1 到 qM。

对角化协方差矩阵的意义是求出 M 个无关试验作为原始 M 个试验的组合。

请尊重版权与译者的劳动成果，侵权必究！ 550

告白我不是很喜欢基于 cTVc≥0 的证明，期望值符号 E 葬送了联合概率的关键概念。请允许我直接证明 V 是正半定（至少是针对年龄－身高－重量的例子），这个证明就是 V 是每个（年龄－身高－重量）组合的联合概率 pahw，乘上正半定矩阵 UUT，这里的 U 是 X-X:

年龄

平均年龄

V= ∑ Pah UUT

U = 身高 －平均身高

（12）

all a，h，w

重量

平均重量

这个确切如同方程式（7）中 2×2 铜板投掷矩阵 V，现在 M=3。

期望值符号 E 的值也允许 pdf^s（例如对应连续随机变数 x 与 y 与 z 的概率密度函数 p（x，y，z）。）如果我们允许年龄与身高与重量是所有的数字，而不是年龄 i=0，1，2，3..，则我们需要 p（x，y，z）而不是 pk，本书本段落的总和都要改成积分，但是我们仍然有 V=E［UUT］:

协方差矩阵

（13）

永远有∫=1。范例 1-2 强调了 P 如何给出对角 V 或奇异

无关变数 x，y，z

p（x，y，z）=p1（x）p2（y）p3（z）

相关变数 x，y，z

p（x，y，z）=0，除了 cx+dy+ez=0 之外

z=x+y 的平均值与方差

从样本平均值开始，我们有 x 的 N 个样本，他们的平均值（average）是 mx。我们也有 y 的 N 个样本，他们的平均值是 my。z=x+y 的样本平均值很明显是 m2=mx+ my:

总和的平均 = 平均的总和

（x1+）=4+（14）

很开心看到这么简单的事情。

乘 σ2（段落 12.1）。M=2（两个铜板），z=x+y 的期望平均值看起来不简单，但是它必须如同 E［z］=E［x］+E［y］的形式出现，有一个方法可以看出来。

他们的配对（xi，y）的联合概率是 p，它的值与试验是否无关产生关联，这是我们不知道的。

网址：linear.neocities.org 箱：876152660@qq.com 551

但是总和 z=x+y 的平均值，与 x 及 y 是否无关或是相关并没有关联，期望值仍

然是相加： E［x+y］-ZZp（x4+y1）=Epx1+EZpy1

（15）

所有的总和从 1 到 N，我们可以采用任意顺序相加。在右侧的第一项，沿着概率

矩阵 P 的行 ⅰ 累加 p 得到 pi，这个双重累加得到 E［x］:

EEPx1=E（pn+…+P）x1=EP1x1=E［x］

对于最后一项，沿着矩阵的列 j 累加 p 得到 y 的概率 P。这些配对（x1，y）与（x2，y）

与。与（xN，yj）是全部的 yj:

Pay， －（e， +.Ps）y －ZPy，-El

现在方程式（15）说明了 E［z］=E［x］+E［y］。

z=x+y 的方差又是如何？联合概率 p 与协方差 σy 会参与其中，让我把 x+y

的方差分成 3 个简单的片段：

2=∑∑pij（xi+yj-mx-my）2

=∑∑pij（xi-mx）2+∑∑pij（yj-my）2+2∑∑pij（xi-mx）（yj-my）第一个片段是 σx2，第二个片段是 σ22，第三个片段是 2σxy。

z=x+y 的方差是 σ22=σx2+σ22+2σxy

（16）

Z=AX 的协方差矩阵

有一个好方法可以看出 z=x+y 的 σ22，想象（x，y）是一个向量 X，再想象 1×2 矩

阵 A=［1 1］乘向量 X，则 AX 是 z=x+y。方程式（16）的方差 σ22 写成矩阵表示

法得到：

（17）

你可以看到（17）的 σ2=AVAT 与（16）的 σx2+σ32+2σxy 是一致。

现在是重点，向量 X 有来自 M 个（不只是 2）试验的 M 个分量，这些试验会有

一个 MxM 的协方差矩阵 Vx。矩阵 A 可能是 KxM，则 AX 是一个具有 M 个输出

的 K 个组合的向量（不是 2 个输出的 1 一个组合 x+y）。

向量 Z=AX 有长度 K，它的协方差矩阵是 K×K 的 Vz，则协方差矩阵的伟大

规则－方程式（17）只是一个 1×2 的例子－是这个美丽公式：AX 的协方差矩阵是

A（X 的协方差矩阵）AT:

Z=AX 的协方差矩阵是

Vz=AVxAT

（18）

对我来说，这个简洁公式展示了矩阵乘法的美丽，我不会去证明这个公式，只是

赞赏它。它在应用中经常使用－- 段落 12.3 会介绍。

请尊重版权与译者的劳动成果，侵权必究！ 552

相关因子 p

相关因子与协方差有很大的关联，他们都是量测无关性或相关性。从调整比例或是「标准化」随机变数 x 与 y 开始，新 X=x/ox 与 Y=y/oy 有 ox2=y2=1。这就好像把一个向量 ν 除以它的长度得到长度 1 的单位向量 /| 一样。

x 与 y 的相关因子是 X 与 Y 的协方差，如果原始 x 与 y 的协方差是 σ，调整比例至 X 与 Y 后会除以 x 与 y:

相关因子 Py==x 与 y 的协方差永远有－1≤py≤1

0100x0

零协方差得到零相关，无关随机变数产生 pxy=0。

我们知道永远有 σ2≤σ2σ2（协方差矩阵 V 至少是正半定），则 p2≤1。接近 p=+1 的相关因子在相同的方向有强烈的相关性：通常结果都是一样。负的相关因子表示当 x 大于平均值时，y 倾向小于平均值：结果在相反的方向。

范例 3 当假设 y 刚好是－x，投掷铜板的输出是 x=0 或 1，相同的投掷有输出 y=0 或－1。一个公正铜板的平均值 mx 是 1/2 与 my 是－1/2。协方差是ōy=-xō，这个协方差除以 x 得到 py=-1。这个情况下相关矩阵（correlation matrix）R 有零的行列式（奇异且半定）：【原文写成 correlation 是错误】

相关矩阵 R=

当 y=xR=|

R 永远有 1＇s 在对角线，这是因为我们正态化成为 ox=oy=1。R 对应 x 与 y 的相关矩阵，也是对应 X=x/σx 与 Y=y/σ 的协方差矩阵。

数字 ρy 也称为皮尔森（Pearson）系数。

范例 4 假设随机变数 x，y，z 是无关，矩阵 R 为何？

答案 R 是一个单位矩阵，全部 3 个相关因子 pxx，yy，ρ= 基于定义都是 1。原文无关，所以 3 个交叉相关因子 p，P，Py2 都是零。

当我们重调每个行与列的比例，相关矩阵 R 来自协方差矩阵 V。把每个行 i 与列 i 除以第 i 个标准方差 σ。

（a）R=DVD，其中对角矩阵 D=diag（1/，..，1/om）。

（b）若协方差 V 是正定，相关矩阵 R=DVD 也是正定。

网址：linear.neocities.org 箱：876152660@qq.com 553

已解范例

12.2A 假设 x 与 y 是无关的随机变数，其中平均值是 0 与方差是 1，对应 X=（x，y）的协方差矩阵 Vx 是 2×2 单位矩阵。具有 3 分量的向量 Z=（x，y，ax+by）的平均值 mz 与协方差矩阵 Vz 为何？

解 Z 经由 A 与 X 产生关联

向量 mx 包含 X 的 M 个分量的平均值，向量 mz 包含 Z=AX 的 K 个分量的平均值，连接 X 与 Z 的两个平均值的矩阵必须是线性：mz=Amx。ax+by 的平均值是 amx +bmyo

Z 的协方差矩阵是 Vz=AAT，当 Vx 是 2×2 单位矩阵时：

2-（区－（x + 的协方差）-］］

说明：x 与 y 是无关所以 y=0，则 x 与 ax+by 的协方差是 a，y 与 ax+by 的协方差是 b，这些刚好来自 ax+by 的两个无关部分。最终，方程式（18）给出 ax+by 的方差： 使用 Vz=AVxAT

oar+by =oax +oby+20ar，by =a2+b2+0

3×3 矩阵 Vz 是奇异，它的行列式是 a2+b2-a2-b2=0。第 3 个分量 z=ax+by 完全与 x 及 y 相关，Vz 的秩只有 2。

GPS 范例来自 GPS 卫星的信号包含它的出发时间，接收器的时钟给出到达时间，接收器把传播时间乘上光速，就知道与卫星的距离。来自 4 个或以上的卫星定位接收器的位置（使用最小平方！）

一个问题：光的速度在电离层（ionosphere）会改变，但是对于附近的接收器来说，所需的修正几乎都一样。如果一个接收器在已知位置，我们可以从那个位置取差分，差分 GPS 降低误差的方差：

差分矩阵 A=［1-1］

协方差矩阵 Vz=AVxAT

V2=11-1］［］［1］-02-2012+02

光速中的误差消失了，达成「厘米定位」的精确度。（关键概念在 320 页，全球定位系统演绎法，Borre，Strang）GPS 的世界就是时间，空间与惊人的精确度。

请尊重版权与译者的劳动成果，侵权必究！ 554

问题集 12.2

1（a）当投掷铜板的概率是 p 与 1-p，计算方差 o2。（尾 = 0，头 = 1）。

（b）N 个无关铜板的投掷（0 或 1）的总和是 N 次试验后出现人头的次数，规则

总和的方差规则（16-17-18）给出 σ2=___。

2 试验 3 的结果 x1 到 xn 之间的协方差 O 为何？试验 5 的结果 y1 到 yn 之间的协方差为何？你的公式看起来像方程式（2）的 2，则协方差矩阵 V 的（3，5）与（5，3）单元是 = 03

3M=3 个试验，协方差矩阵 V 是 3×3，存在一个输出是 xi 与 yj 与 zk 的概率 pjk，

写出一个如同方程式（7）的矩阵 Ⅴ 的公式。【原文多了 variance】

4M=3 个无关试验，平均值分别是 m1，m2，m3，方差分别是 2，022，032，求出

协方差矩阵 V?

问题 5-9 有关已知 X=x1 得到 Y=yj 的条件概率（conditional probability）。表示法 Prob（Y=y|X=x1）= 给定 X=x1，结果是 y 的概率。

范例 1 铜板 1 与铜板 2 粘合，则 Prob（Y = 人头，当 X = 人头）是 1。

范例 2 无关的铜板投掷：X 的信息与 Y 无关，知道 X 没有用处。

则 Prob（Y = 人头 | X = 人头）与 Prob（Y = 人头）相等。

5 说明条件概率的加法规则：

Prob（Y=y）= 针对所有输出 x2 的 Prob（Y=y|X=x；）的累加。

6n×n 矩阵 P 包含联合概率 py=Prob（X=x1 且 Y=yj）。说明为什么

条件概率 Prob（Y=y|X=xi）等于＿_P___P。

Pil+...+pin Pi

7 下列的联合概率矩阵有 Prob（x1，y2）=0.3，求出 Prob（y2|x1）与 Prob（x1）。

单元 p 的总和是 1

某些 i 与 j 必须发生

8 说明条件概率的乘积规则：

py=Prob（X=x1 且 Y=y1）等于 Prob（Y=y1|X=xi）乘 Prob（X=x1）。

9 从问题 8 的乘积规则，推导 p 的贝叶斯（Bayes）定理：

Prob（Y=y 且 X=x1）=Prob（X=xi|Y=y5）Prob（Y=y3）

Prob（X=xi）

「贝叶斯学派」使用先前的信息，「频率学派」只使用取样信息。

网址：linear.neocities.org 箱：876152660@qq.com 555

12.3 多元高斯与加权最小平方

正态概率密度 p（x）（高斯）只跟两个数有关：

平均值 m 与方差 σ2

（1）

p（x）的图形是个中心在 x=m 的钟形曲线，连续变数 x 可以在－∞与∞之间的任意位置。如果概率接近 2/3，随机 x 会落在 m-σ 与 m+σ 之间（离开平均值 m 的距离小于一个标准差）。

（2）

这个积分有一个从 x 到 X=（x-m）/σ 的变数变换，把指数简化成－X2/2 以及把积分的极限简化成－1 到 1。就连来自 p 的 σ 也在积分外面消失，这是因为 dX=dx/σ。每个高斯变成标准高斯 p（X），其中平均值 m=0 与方差 σ2=1，就称为 p（x）:

标准正态分布 X1）有

（3）

对 p（x）从－∞到 x 积分得到累积分布 F（x）：随机样本小于 x 的概率，这个项概率在 x=0（平均值）时 F=1/2。

二维高斯

现在我们有 M=2 个高斯随机变数 x 与 y，分别有平均值 m1 与 m2，以及方差 o12 与 σ2。如果他们是无关，他们的概率密度 p（x，y）就是 p1（x）乘 p2（y）。当变数是无关时，概率直接相乘：

无关 x 与 yp（x，）=2（-my120e（-m）y120

（4）

x 与 y 的协方差会是 σ12=0，协方差矩阵 V 是对角矩阵，方差 12 与 22 永远在 V 的主对角线。p（x，y）的指数就是 x - 指数与 y - 指数的总和，很好的注意到这两个指数可以结合成为－（x-m）V-1（x-m），其中 V-1 在中间：

（x-m）（v-m3）=（x-my-m2］［［y-m］

（5）

请尊重版权与译者的劳动成果，侵权必究！ 556

非－无关的 x 与 y

我们准备好抛弃无关性质，当 V 不再是对角矩阵时，具有 V~1 的指数（5）仍然是正确。现在的高斯与向量 m 及矩阵 V 有关。

当 M=2，第一个变数 x 会给出第二个变数 y 的部分信息（反之亦然），也许 y 的某个部分由 x 决定，其他部分是真实无关。正是 MxM 协方差矩阵 V 负责 M 个变数 x=x1，..，xM 之间的相关性，它的逆矩阵 V1 进入 p（x）:

多元高斯

概率分布

p（x）=

e-（x-m）V-1（x-m）/2

（2π）detV

（6）

向量 x=（x1，.，xm）与 m=（m1，.，mm）包含随机变数与他们的平均值，引进 2π 的平方根的 M 次方与 V 的行列式是为了使得总概率等于 1。让我使用线性代数验证，我使用对称矩阵 V=OAO 的固有值入与正交单位固有向量 q，所以 1=QA-1Q:

X=x-m（x-m）TV-1（x-m）=XTQA-1QTX=YTA-1Y

很棒！组合 Y=QTX=QT（x-m）是统计无关（statistical independent），他们的协方差矩阵 Λ 是对角矩阵。

利用 V 的固有向量矩阵 Q 进行对角化的步骤与把随机变数「解除关联」是相同的，对于新的变数 Xi1，..，X 的协方差是零。这是线性代数协助微积分计算多维积分的重点。

【原文 m 是错误】

当我们执行中心化把变数 x 减去 m 得到 X，然后旋转变数得到 Y=QX，此时 p（x）的积分并没有改变，矩阵 A 是对角矩阵！所以我们把积分分割成 M 个分别已知的一维积分：

f-rra-ypar-（k a）（raw sow

=（2x1）..（2M）=（2）detV.

（7）

V 的行列式（也是∧的行列式）是固有值（1）（的乘秋则（7）给出应该除以的正确数字使得方程式（6）的 p（x1，..，xM）有预期的积分 = 1。

p（x）的平均值与方差也是 M 维的积分。利用 V 的固有向量进行对角化的相同概念，以及引进 Y=QTX 可以求出这些积分：

平均值的向量 m

|.xp（«）dt= （mı，m2，.） =m

（8）

协方差矩阵 V

－x-m-m『=V

. （9

结论：对应概率密度函数 p（x）的方程式（6）拥有完美想要的全部性质。

网址：linear.neocities.org 箱：876152660@qq.com 557

加权最小平方

在第四章，最小平方从无解的系统 Ax=b 开始，我们选择来极小化误差 | b-Ax|2，

这个引导我们得到最小平方方程式 AAx=Ab。最佳 A 是 b 在 A 的列空间的投

影，但是这个距离平方 E=|b-Ax|2 是我们想要极小化的正确误差量测吗？

如果 b 中的量测误差是无关的随机变数，其中平均值 m=0 与方差 o2=1 以及

是一个正态分布，此时高斯会说好的：使用最小平方。如果误差不是无关或是他

们的方差不相等，高斯会说不行：使用加权最小平方，本段落会展示误差的优质

量测是 E=（b-Ax）TV-1（b-Ax），针对最佳 x 的方程式使用协方差矩阵 V:

加权最小平方

ATV＇A=ATV¹b

（10）

最重要的范例是 b 有 m 个无关的误差，这些误差有方差 2，.，om2。依据无关

性质，V 是对角矩阵，优质加权 1/o2，.，1/cm2 来自 V1，我们的目标是加权 b 的

误差使得方差 = 1:

加权 b 的无关误差的最小平方

极小化 E=b-Ax）2

（11）

借由加权这些误差，我们是在「白色化」杂讯。「白色杂讯」是一个无关误差的

快速描述，其中的误差是基于零平均值与 σ2=1 的标准高斯 N（0，1）。

让我写下求出最佳过程中抵达方程式（10）与（11）的步骤：

从 Ax=b 开始（m 个方程式，n 个未知数，m>n，无解）。

每个右侧 b1 有零平均值与方差 σ2，b1 是无关。

第 i 个方程式除以 σ，每个 b；/σ；有方差 = 1。

上述的除法把 Ax=b 变成 V-12Ax=V-12b，其中 V-12=diag（1/m，..，1/0m）。这些加权方程式的正常最小平方有 A→V-V2A 与 b→V-1V2b。

（P1A）（A）x=（P1A）JFb 是

ATV-IAX =ATV-1b

（12）

因为 V-1 的 1/02，更多可靠的方程式（较小的 o）得到较重的加权，这是加权最小平

方的重点。

这些对角加权（未耦合方程式）是最频繁也是最简单的，他们应用到 b 的无关

误差。当这些量测不是无关，V 不再是对角－但是（12）仍然是正确的加权方程式。

实际上，找出所有的协方差是很困难的工作，对角化 V 比较简单。

请尊重版权与译者的劳动成果，侵权必究！ 558

估测的方差

还有一个重点：通常重要的方程式不是对应量测值 b 的一个特定集合的最佳，这只是一个样本！真实的目的是要知道整个试验的可靠性，这个由估测的方差来量测（作为可靠度）。首先，b 的零平均值给出 x 的零平均值，然后联结输入 b 的方差 V 与输出 x 的方差 W 的公式变得如此美丽：

对应 x 的方差－协方差矩阵 W

EI（x-x）（x-x）=（4A）1

（13）

最小可能的方差来自最佳可能的加权，就是 V1。

这个关键公式是段落 12.2 的完美应用，如果 b 有协方差矩阵 V，则 x=Lb 有协方差矩阵 LVLT。前面的方程式（12）告诉我们 L 是（ATV-1A）-1ATV-1，现在代入 LVLT 可以看到方程式（13）出现了：

LVLT=（ATV-1A）-1ATV-1V V-1A（ATV-1A）-1=（ATV-1A）-1

这是输出的协方差矩阵 W，我们的最佳估测。范例的时间到了。

范例 1 假设医生量测你的心率 x 三次（m=3，n=1）:

x=b

0 0

x=b3

方差是 2=1/9 与の 2=14 与 02=1。当量测值 b 比 b2 与 b 不可靠，你越来越緊张。这 3 个量测值都包含某些信息，所以他们都进入最佳（估测）：

3x=3b

V-12Ax=V-12b 是 2x=2b2 得到 ATV-1Ax=ATV-1b

1x=1b3

=2 + 是 b 的加平均

网址：linear.neocities.org 箱：876152660@qq.com 559

方差 σ 最小，所以最多的加权放在 b1。x 的方差有美丽的公式

W=（ATV1A）-1= 1/14:

x 的方差

＇）

高斯的蓝色定理（网站有证明）说明我们的 x=Lb 是 Ax=b 的解的最佳线性无偏见估测，任何其他无偏见选择 x＊=Lb 的方差都会比的方差来的大。所有的无偏见选择都有 L＊A=I，所以一个确切的 Ax=b 会产生正确的答案 x=L＊b=L＊Ax。

注解：我必须加上刚开始不要极小化误差平方的理由。第一个理由：这个通常有很多小的分量，小数的平方非常小，当我们极小化时他们出现了。理解稀疏矩阵比较容易－— 只有一些非零数。统计学家通常偏好极小化非平方误差：|（b-Ax）| 的总和，这个误差量测是 L1 不是 L2。因为绝对值，的方程式变成非线性（实际是片段线性。）

快速的新演绎法非常快速的计算稀疏 x，未来可能属于 L1。卡尔曼滤波器

「卡尔曼滤波器」是动态最小平方的最伟大演绎法，动态这个词表示持续有新的量测值 b 进来，所以最佳估测持纹改变（基于所有的 b0，…b）. 不止如此，矩阵 A 也在改变，所以 x2 会是我们的最新解 xk 的最佳最小平方估测，其中 xk 是直到时间 2 的历史最新解，这项历史包含观察方程式与更新方程式（状态方程式）：

A0x0=b0 x1=F0x0 A1x1=b1 x2=F1x1 A2x2=b2

（14）

卡尔曼的概念是一次引进一个方程式，每个方程式存在误差。基于每个新方程式，我们对目前的 xk 更新成最佳估测 k。但是历史不能忘记！新的估测 k 使用了过去所有的观察 b0 到 bk1 以及所有的状态方程式 xnew= Fold xold，这是一个大型与成长的问题。

更重要的一点，每个最小平方方程式使用对应每个 bk 的误差的协方差矩阵 V 进行加权，甚至存在一个对应更新方程式 xk+1=Fkxk 的误差的协方差矩阵 Ck，则最佳 x2 会与 b0，b1，b2 与 o，1，V2 与 C，C2 有关。写出的优质方法是写成前面的 xk-1 的更新。

让我聚焦在一个没有矩阵 Fk 与协方差 Ck 的简化问题，我们每一步都在估测相同的真实 x。我们如何从 xo 得到 x1?

旧的 Aoxo=bo 得到加权方程式 AoTVo-1A0xo=AoTVo-1bo

（15）

新的 ［

请尊重版权与译者的劳动成果，侵权必究！ 560

（16）

是的，我们求解了新问题也忘记了旧问题。但是旧的解 0 需要处理以便在 1 中

使用，我们寻找的就是 0 的更新：

卡尔曼更新从到 1

1=o+K1（b1-A10）

（17）

这项更新修正是旧状态是 xo 与新量测 b 之间的不透配 b1-A1o 用卡尔曼

增益矩阵 K1 去乘。K1 的公式来自比较（15）的解 x0 与（16）的解 1，我们基于新资

料 b 把 o 更新到 1，我们也把协方差矩阵 W 更新到 W。记得来自方程式（13）

有 Wo=（AoTV0-1A0）-1。更新它的逆矩阵到 W1-1:

x1 误差的协方差 W1

W11=Wo-1+A1+V1-A1

（18）

卡尔曼增益矩阵 K1

K， =W，4TV，¯＇

（19）

这是卡尔曼滤波器的中心，注意 W 的重要性，这些矩阵量测整个程序的可靠度，

其中向量基于特定的量测值 b 到 b 来估测目前的状态。

当状态 k 也在变化（基于矩阵 FA），整章与整本书都在说明动态卡尔曼滤波器。

在使用新资料 b 修正之后，利用 F 可以预测 xk，最好停止这里。

本页是有关迭代最小平方：加入新资料 bk 与更新及 Wk：基于所有资料的最

佳当前估测，以及它的协方差矩阵。

问题集 12.3

1 相同变数 x 的两个量测得到 x=b1 与 x=b2，假设平均值是零与方差是 2 与 σ22，

误差是无关：V 是对角且对角单元是 12 与 22。写出如同 Ax=b 的两个方程式

（4 是 2x1）。如同课本范例 1，基于 b1 与 b2，求出最佳估测 x h/a2+bla2

2（a）问题 1 中，假设第二个量测值 b 变成超级精确而且它的方差の→0，当

2 抵达零时，最佳估测 x 为何？

（b）相反的情况是の→而且没有 b 的信息现在基于 b1 与 b 的最佳估测

为何？

网址:linear.neocities.org 箱：876152660@qq.com 561

3 若 x 与 y 无关，概率分别是 p1（x）与 p2（y），则 p（x，y）=p1（x）p2（y）。借由分离双

重积分成为单一积分（-∞到∞），证明

ffp（x，y）dxdy=1 与 ff（x+y）p（x，y）dx dy=m1+m2

4 继续问题 3，对于无关的 x 与 y 证明 p（x，y）=p1（x）p2（y）有

（x-m｝ p（x， y）dr dy =o? （x-m）（v-m2）p（x， y）dr dy=0

所以 2×2 协方差矩阵 V 是对角而且对角单元是

5 证明 2×2 协方差矩阵 V 的逆矩阵是

相关因子是 =

这个产生双变数高斯的指数 －（x-m）TV-1（x-m）。

6 假设是 bb 的平均值，新量测值 b 抵达，我们想要新的平均值 k10

卡尔曼更新方程式（17）是

新平均

验证 1 是 b1，… 的正确平均值。

7 也验证更新方程式（18），其中平均值的方差是 Wk+1=2/（k+1），我们假设

Wk=2/（k）而且 b1 有方差 V=2。

8（稳定模型）问题 6-7 是静态最小平方，所有的样本平均值是 k 是相同 x 的

估测值。要使得卡尔曼滤波器变成动态，也包含一个状态方程式 k+1=Fxk，

其中本身的误差方差是 s2。动态最小平方问题在 k 最佳时允许 x 移动：

其中方差是

当 F=1，这 3 个方程式的两侧同时除以 σ，s，σ，利用最小平方求出 0 与 1，

使得新进的 b 有更多加权。卡尔曼波器在全球定位演纤法中发表（Bore 与 Strang，卫斯理－康桥出版社）。

请尊重版权与译者的劳动成果，侵权必究！ 562

来自 A 的改变导致的 Aˉ` 的改变

最后一页把本书的开头（逆矩阵与秩 1 矩阵）与本书的结尾（动态最小平方与滤波器）做个联结，从基本公式开始：

M=I-uvT 的逆矩阵是 M-1=I+uvT

1-v＇

快速证明是 MM-1=I-uvT+（1-uvT）v=I-uvT+uv=I。

如果 vTu=1 则 M 不可逆（Mu=0）。这里 vT=uT=［111］:

范例 M=1-

的逆矩阵是 M1=I+

但是我们不是一直从单位矩阵开始，很多应用需要逆反 M=A-uvT。在我们求解 Ax=b 之后，我们期望一个秩 1 的改变得到 My=b。前述的除以 1-vTu 会变成除以 c=1-vTA-1u=1-vTz:

步骤 1 求解 Az=u 然后计算 1-vTz。

步骤 2 若 c≠0 则 M-＇b 是 y=x+

假设 A 很容易处理，A 可能已经应用消元法变成 LU，则这个 Sherman-Woodbury-Morrison 公式是求解 My=b 是最快速方法。这里有三个问题来结束本书！

9 当 A=I 与 uT=vT=［123］与 bT=［214］，使用步骤 1-2 求 y。

10「更新公式的步原 2 宣称的 xb 简化成为

uvx（1-c-vz）=0。由于 c=1-vz，前式成立。

11 当 A 有一个新行 vT，最小平方方程式的 ATA 变成 M:

M=［A+v］］=A+A+w=A+A 中的秩 1 变化。

为什么这个乘法是正确？更新的来自步骤 1 与 2。这里有 M1 的 4 个公式作为参考，前两个是当变化是 uvT 时，在上方已经给出。公式 3 与 4 超越秩 1，允许矩阵 U，V，W。

1 M=I-uvT

M-1=I+uvT/（1-vTu）（秩 1 变化）

2 M=A-uvT

M-1=A-¹+A-¹иvTA-¹/（1-vTA-＇и）

3 M=I-UV

M-1=In+U（Im －VU）-IV

4 M=A-UW-1V

M-¹=A-¹+A-¹U（W-VA-¹U）-¹VA-¹ 公式 4 是工程中的「矩阵逆反辅助定理」，直到现在才看到！卡尔曼滤波器在求解方块三对角系统时，每个步骤都用到公式 4。

网址：linear.neocities.org 箱：876152660@qq.com 563

矩阵分解

1.A=LU=（1＇s 在对角线的下三角 L）（枢轴在对角线的上三角 U の

要求：高斯消元法从方形 A 简化到 U 没有行交换。

2.A=LDU=（1＇s 在对角线的下三角 L）（枢轴矩阵 D 是对角）（1＇s 在对角线的上三角 U）

要求：没有行交换，提出 D 中的枢轴留在 U 的对角线。若 A 对称则 U 是 LT 以及 A=LDLT。

3.PA=LU（排列矩阵 P 是为了避免枢轴位置的零）

要求：A 可逆，则 P，L，U 可逆，P 事先做完 A 的所有行交换，允许正常的 LU。交替：A1=L1P1U1。

4.EA=R（m×m 可逆 E）（任意 m×n 矩阵 A）=rref（A）。

要求：无！简化行阶梯形式 R 有 r 个枢轴行与 r 个枢轴列，包含单位矩阵。E 的最后 m-r 个行是 A 的左零空间的一组基底；他们乘 A 得到 R 中的 m-r 个零行。E-1 的前 r 个列是 A 的列空间的一组基底。

5.S=CCT=（下三角）（上三角），其中√D 在两个对角线。

要求：S 是对称正定（D 全部的 n 个枢轴都是正数），乔列斯基 C=chol（S）有 CT=L√D，所以 S=CTC=LDLT。

6.A=QR=（Q 有正交单位列）（上三角 R）

要求：A 有无关列，这些列在 Q 利用格莱姆－施密特或豪斯霍德程序正交单位化。若 A 是方形则 Q-1=QT。

7.A=XAX1=（X 有固有向量）（A 有固有值）（X-1 有左固有向量）

要求：A 必须有 n 个无关固有向量。

8.S=QAQT=（正交矩阵 Q）（实数固有值矩阵 A）（QT 是 Q-1）

要求：S 是实数与对称：ST=S，这是光谱定理。

请尊重版权与译者的劳动成果，侵权必究！ 564

9.A=BJB-1=（B 有广义固有向量）（J 有乔丹方块）（B-1）

要求：A 是任意方形矩阵，这个乔丹形式有对应 A 的每个固有值的方块，每

个方块只有一个固有值。

10.A=UΣVT=（正交 U 是 mxm）（m×n 奇异值矩阵，，.，o，在对角线）（正交 V

是 n×n）

要求：无。这个奇异值分解（SVD）有 AAT 的固有向量在 U 以及 ATA 的固有向

量在 V；σ1= Va， ATA）=va， AAT）这些奇异值是 σ1≥σ2≥.≥σ，>0，使

用列－行乘法：

A= UΣ V= σιuιν1T +. + σrurν，T

若 S 是对称正定，则 U=V=Q 与∑=A 以及 S=QAQT。

11.A+=UΣ+VT=（正交 n×n）（n×mΣ 的伪逆，1/c，..，1/o，在对角线）（正交 m×m）

要求：无。伪逆 A + 有 A+A = 对 A 的行空间的投影，以及 AA+= 对 A 的列空间

的投影。若 A 可逆则 A+=A+1。Ax=b 的最短最小平方解是 x+=A+b，这是 ATAx+

=ATb 的解。

12.A=QS=（正交矩阵 Q）（对称正定矩阵 S）

要求：A 可逆。这个极分解有 S2=ATA，若 A 是奇异则因子 S 是半定，逆反

极分解 A=KQ 有 K2=AAT，两者都有来自 SVD 的 Q=UVT。

13.A=UΛU1=（幺正 U）（固有值矩阵 A）（U1 就是 UH=UT）

要求：A 是正态：AHA=AAH，它的正交单位（可能是复数）固有向量是 U 的列。

除非 S=SH，λ 是复数：厄米矩阵。

14.A=QTQ-1=（幺正 Q）（三角 T，＇s 在对角线）（Q-1=QH）

要求：任意方形 A 的舒尔三角化，存在矩阵 Q 有正交单位列使得 Q-1AQ 变

成三角形：段落 6.4。

15.Fa-［B］［F］［］= 送代 FT 的一步

要求：Fn = 傅里叶矩阵有单元 w＊其中 wn=1:FF=nI。D 有 1，w，.，wn/2-1

在对角线。n=2＇时，快速傅里叶转换会计算 Fnx，只需要来自 D＇s 的 l 阶段

的 nl/2=（nlog2n）/2 次乘法。

网址：linear.neocities.org 箱：876152660@qq.com 565

线性代数的六个伟大定理

维度定理对应一个向量空间的所有基底都有相同的向量个数。

计数定理列空间的维度 + 零空间的维度 = 列的个数。

秩定理

列空间的维度 = 行空间的维度，这是秩。

基础定理 A 的行空间与零空间是 R＂中的正交互补。

SVD

存在正交单位基底（v＇s 与 u＇s 对应行与列空间）使得 Avi=ui。

光谱定理若 A=A，存在正交单位 qs 使得 Aq=g 与 A=QAQ。概括线性代数（矩阵 A 是 n×n）

非奇异

奇异

A 是可逆

A 不可逆

列是无关

列是相关

行是无关

行是相关

行列式不是零

行列式是零

Ax=0 有一个解 x=0

Ax=0 有无限多解

Ax=b 有一个解 x=A-1b

Ax=b 无解或无限多解

A 有 n 个（非零）枢轴

A 有 r< n 个枢轴

A 有满秩 r=n

A 的秩 r< n

简化行阶梯形式是 R=I

R 最少有一个零行

列空间是全部的 R＂

列空间的维度 r< n

行空间是全部的 R＂

行空间的维度 r< n

所有的固有值都是非零

零是 A 的一个固有值

ATA 是对称正定

ATA 只有半定

A 有 n 个（正数）奇异值

A 有 r< n 个奇异值

请尊重版权与译者的劳动成果，侵权必究！

