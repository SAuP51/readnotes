# 
> 2018000模板




07 过度拟合 不要想太多


当查尔斯·达尔文试图决定是否应该向他的表妹艾玛·韦奇伍德求婚时，他拿出一支铅笔和一纸张，并衡量了每一个可能的后果。关于结婚的好处，他列举了孩子、陪伴和“音乐与女性聊天的魅力”等因素。相反，关于婚姻中的不利因素，他列举了“可怕的时间损失”、没有自由去他想要去的地方、亲戚的负担、孩子带来的花费和焦虑、担心“也许我的妻子不喜欢伦敦”，以及花在买书上的钱变得更少等。衡量这一系列因素使取得胜利的渠道变得十分狭窄，最后，达尔文潦草地用拉丁文写道：“结婚——结婚——结婚，这被证明了。”达尔文自己用英文重述了这一数学结论：“这证明结婚是必要的。”

在达尔文所处的时代，优劣对比已经被推崇，而这在一个世纪前已被本杰明·富兰克林认可。为了克服“令我们困惑的不确定性”，富兰克林写道：

我的方式是在一张纸的中间画一条线，将其一分为二，一半写上优势，另一半写劣势。然后在几天的考虑之中，我用不同的方式考虑不同动机的短期提示，考虑在不同的时间该措施可能带来的利弊。当我把它们聚集在一个视图时，我努力评估它们各自的权重。我会找到两项看起来能抵消的因素，然后把它们都划掉：如果我找到一个优势因素的权重相当于两个劣势因素，我就划掉三个。如果我判断两个正面理由相当于三个负面理由，我会划掉五个。这样，我就找到了平衡所在，如果经过一两天的考虑，任何一方都不会有任何重要的新理由出现，我便可以相应地做出决定。

富兰克林甚至认为这是一个计算公式，并说：“我从这种方程式（所谓的道德或保守的代数）中发现了很大的优势。

当我们在考虑思考过程时，很容易认为想到更多自然会更好：你列出的利弊越多，越能做出更好的决定。关于股票的价格走向，你能辨别的相关因素越多，能做出的预测更准确；你花在工作上的时间越多，能写出的报告越好。这肯定是富兰克林法则存在的前提。在这个意义上，达尔文对结婚与否的“代数”分析，尽管有些古怪，但似乎也是一种非常合理甚至是值得称赞的方法。

然而，如果富兰克林或达尔文已经进入机器学习研究的时代，也就是教会计算机如何根据经验做出良好判断的科学，他们会看到道德代数的基础被不断动摇。想一想思考的力度和考虑的因素这些问题，就是统计人员和机器学习研究人员所称的“过度拟合”这个棘手的问题的核心。处理这个问题可以揭示出，刻意地较少思考也是一种智慧。意识到过度拟合的问题可以改变我们投资、就餐、健身，甚至祭祀的方法。





反对复杂性案例


《飞燕金枪》

任何你能做的，我都可以做得更好。我做任何事都可以比你做得好。

每一个决定都是一种预测：你还没有尝试过的东西你会有多喜欢；某个方向，以及不常走的路（或者更多）是否能走得通。每一个预测，都涉及两方面不同的重要内容：你知道的和你不知道的。也就是说，它试图制定一种理论，来解释你以往的经验，并提供一些对未来的猜想。一个好的理论，当然两方面都会照顾周全。但事实上，如果每一次预测都要顾全双方，那么就会产生一些难以避免的矛盾关系。




结婚不同时长的生活满意度


作为这种矛盾关系的一个例证，让我们来看一个可能与达尔文有关的数据集，上图是最近在德国进行的一项研究：前10年的婚姻生活中，人们对生活的满意度。图表上的每一个点都取自研究本身，我们的工作是找出符合这些点并延伸到未来的一条线的公式，使我们能够跨越这十年的标记预测未来。

这个可能的公式将只使用一个单一因素来预测生活满意度——自结婚以来的时间。这将在图表上创建一条直线。另一种可能性是使用两个因素，时间和时间的平方，产生的线将是一个U形抛物线，这可以分析出一个潜在的更复杂的时间和幸福之间的关系。如果我们扩大公式，让其包含更多的因素（时间的立方等），这条线将会有更多的拐点，越来越多的“弯曲”和波动。当我们进入九因素公式时，我们就可以分析出非常复杂的关系。

从数学上讲，我们的双因素模型包含了所有进入单因子模型的信息，并且还有另一个因素可以使用。同样，九因素模型可以利用双因素模型中的所有信息，还包括潜在内容。根据这种逻辑，九因素模型似乎总是能给我们带来最好的预测结果。




使用不同数量因素的模型对生活满意度的预测


但事实证明，并非如此简单。

这些模型应用到前期数据上的结果如上图所示。不出所料，单因素模型错过了很多更精确的数据点，虽然它也能分析出蜜月后开始衰落的基本趋势。然而，它的直线预测法预测这种下降将永远持续下去，最终导致无限的痛苦。这个轨迹听起来好像不太正确。双因素模型更接近拟合的调查数据，其弯曲的形状就是不同的长期预测，表明在初始下降之后，随着时间的推移，生活满意度会慢慢达到一种稳定水平。最后，九因子模型通过了图表上的每一个点，它本质上就是一个完美并适合所有研究数据的模型。

从这个意义上说，九因素公式似乎是我们最好的模型。但如果你看看对没有被研究到的年限的预测，你会知道它是多么有用：它预测到了婚前的恐惧，结婚后几个月的欢欣愉悦，之后仿佛坐过山车一样的颠簸，以及十年后的急转直下。相比而言，由双因素模型预测的结果与心理学家和经济学家关于婚姻和幸福所预测的最一致。（顺便说一下，他们认为，这只反映出他们对生活的满意度回归了正常的基线水平，而不是对婚姻本身有任何不悦。）

其中的启示是这样的：的确，若模型中包含更多的因素，从定义上来说，会更拟合我们已经现有的数据。但更好地拟合现有数据并不一定意味着会得出更好的预测结果。




单因素模型




双因素模型




九因素模型


注：加入少量的随机数据“噪声”（模拟重新由一组新的参与者参加的调查得出的结果）在九因素模型中会产生巨大的起伏，而单、双因素模型相比会更加稳定，与他们的预测也更一致。

诚然，像单因素公式的直线这样过于简单的模型，可能无法分析出数据中的基本模式。如果真相看起来像一条曲线，就没有任何一条直线能正确表达。另一方面，像这里的九因素模型这样过于复杂的模型，就会对我们碰巧观察到的数据点过于敏感。正是因为它是如此精细地调整以适应特定的数据集，所以它所产生的解决方案高度可变。如果研究的对象发生变化，同一基本模式也会发生细微变化，那么单、双因素模式会或多或少地保持稳定状态，但九因素模型将从研究中的一个例子剧烈回旋到另一个。这就是统计学家所称的过度拟合。

因此，机器学习的最深刻的真理之一就是，事实上，并非使用一个更复杂的模型就会更好，它需要考虑更多的因素。这个问题不仅仅是额外的因素可能会提供递减的回报，比一个简单的模型效果更好，还不足以证明增加的复杂性。相反，他们可能会使我们的预测效果急剧恶化。





数据崇拜


如果我们现有的丰富数据是一个完全有代表性的样本，完全没有错误，并完全代表我们正试图评估的对象的话，那么使用最复杂的模型确实是最好的方法。但如果我们试图找到完全适合我们的模型数据时，只要有一个因素不符合以上条件，我们就不能将模型完美地拟合于数据之上，就会有过度拟合的风险。

换句话说，当我们处理经常遇到的数据噪声或估算不准时，过度拟合就会随时构成危险。例如在数据收集或被报道过程中可能出现错误。有时被调查的现象，如人类的幸福，是很难进行定义的，更不用说测量了。由于其灵活性，我们可用的最复杂的模型可适用于数据中出现的任何模式，但这意味着即使这些模式在噪声的掩护下仅仅是魔怪和幻影，他们也必须这么做。

纵观历史，宗教教义都警告他们的追随者要反对偶像崇拜，例如崇拜雕像、绘画、文物和其他有形的文物，以及代替那些有形之物所代表的无形的神。例如第一条诫命就是警告不许膜拜“任何偶像或任何类似的在天堂存在的东西”。在《列王纪》中，一条奉上帝之令出现的青铜蛇成为人们崇拜和敬香的对象，而不是上帝本身。（上帝有些不高兴。）从根本上说，过度拟合就是对数据的一种偶像崇拜，产生的原因是将重心放在我们能够测量的数据而不是真正重要的问题上。

我们所拥有的数据和我们想要的预测之间的差距几乎无处不在。当做出重大决定时，我们只能通过考虑现在对我们重要的因素来猜测什么会让我们稍后更愉悦。（正如哈佛大学的丹尼尔·吉尔伯特所说，未来的我们往往会“支付大价钱来去除自己曾经花了大价钱文在身上的文身”）。当我们做财务预测时，我们只能看过去的股票价格，而不是未来的价格。即使在日常的小事中，这种模式仍然存在：写电子邮件时，我们会自己通读一遍，以预测收件人读到的效果。因此，在公共调查中，我们自己生活中的数据也总是嘈杂纷乱的，充其量是我们真正关心的一种间接测定的方法。

因此，考虑越来越多的因素和在模型分析上花费的更多努力，会导致我们进入将错误的事物最优化的误区。正如上文提到的，向青铜蛇而不是其身后蕴含的更大力量祈祷。





过度拟合无处不在


一旦你了解了过度拟合，你就会发现它随处可见。

例如，过度拟合解释了我们具有讽刺意味的味觉。如果按照进化论来说，味蕾的整个功能都是为了防止我们吃坏掉的东西，那么为什么我们最喜欢吃的食物都被认为是对我们的健康有害的呢？

答案是，味觉是我们身体的健康指标。脂肪、糖和盐是重要的营养物质，在长达几十万年的时间里，食用含有这些物质的食物是持续性饮食的一个合理方法。

但当我们能够改善所食用的食物时，这种关系就被打破了。我们现在可以把脂肪和糖添加到食物中去，但这些食物的量已经超出我们身体可承受的健康范围，但是我们还是只喜欢吃那些食物，而不是吃蔬菜、谷物和肉类这些构成人类正常饮食习惯的食物。换句话说，我们可以过度拟合食物的味道。我们越能熟练地操纵食物（我们的生活方式和祖先的生活方式就越不一样），只有一种度量之下的味道就越不完美。人类因此变成诅咒，使我们能够拥有我们想要的东西成为一种危险，即使这些可能并不是我们真正想要的正确的东西。

注意：当你去健身房减掉由于吃糖带来的多余的体重时，你也可能会对健身过度拟合。明显的身体健康的表征，例如低脂肪和高肌肉量，很容易测量，它们也可以降低心脏病和其他疾病的风险。但它们也是一种不完善的间接测定方法。对表征过度拟合——采用极端的饮食来降低身体脂肪以及服用类固醇来增强肌肉，也许会让你的身体状况看起来非常好，但只是看起来而已。

过度拟合也表现在运动中。例如，汤姆是一名击剑运动员，从少年时代就一直断断续续地练击剑。击剑运动最初的目标是教人们如何在一场决斗中捍卫自己，故出自“防御”一词。现代击剑用的武器是类似于被用于训练在这种场景中使用的东西。（佩剑尤为如此，不到50年前，佩剑仍然被用在正式的决斗中。）但引进电子计分设备——装在剑顶端的一个按钮，一有碰击便会记录下来，这改变了这项运动的性质，在真正决斗中没什么作用的技术已经成为击剑比赛中的关键技能。现代击剑运动员使用柔性叶片，使他们可以向对手身上的按钮“甩尾”，只要触碰的力量足够就可以被记录下来并得分。结果，他们看起来更像是在甩一个金属鞭子，而不是用剑切或插。它本是一种令人兴奋的运动，但运动员因为奇怪的计分工具而对策略过度拟合，因此灌输真实的剑术技能就变得不那么重要了。

但是，也许没有哪个领域中存在的过度拟合是和商业世界一样显著的。史蒂夫·乔布斯说：“激励结构是有效的，所以你对激励别人做的事必须非常小心，因为不同的激励结构产生的不同后果是你所不能预料的。”萨姆·阿尔特曼是创业孵化器Y联合机构的总裁，他也认同乔布斯的警告：“公司将按照首席执行官所做的任何估量决策发展。”

事实上，要想出一些具有某种有悖常理的激励手段或衡量方式十分困难。20世纪50年代，康奈尔大学管理学教授V.F.里奇韦编录了一系列例如“主机性能测量的不良后果”等研究。就业安置公司的工作人员对他们所进行的访谈的数量进行评估，这促使他们要尽可能快地开会，少花时间在开会上实际是帮助他们的客户尽快找到工作。在一个联邦执法机构，每月发放绩效工资的调查人员被发现他们在月底会挑选较容易的案件，而不是最紧迫的案件进行调查。在一家工厂，过度专注于生产指标会导致主管忽视维护和修理，这会带来灾难隐患。这样的问题不能简单地被认为是实现管理目标的失败。相反，是另一方面：对本就错误的事物进行无情和聪明的优化。

21世纪进入实时分析的转变只会使指标的危险更加激烈。谷歌的数字营销师阿维纳什·考希克曾警告说，试图让网站用户看到更多广告，这就会很自然地发展成将网站塞满广告：“当你按每千次展示费用的基础来支付，激励机制就是试图在每一页尽可能多地塞入广告，（同时）确保访问者看到了网站上最可能的页面……激励机制会将焦点从重要的实体上移除，例如你的客户，并将其放置在次要的实体上，例如你的广告商。”网站可能在短期内获得更多的钱，但塞满广告的文章，缓慢加载的多页幻灯片，以及耸人听闻的标题从长久来说会失去读者。考希克的结论是：“真正的朋友是不会让朋友去测量页面浏览量的，永远都不会。”

在某些情况下，模型和现实世界之间的区别就是生死问题。在军事领域和执法部门，例如重复的机械训练被认为是灌输火线技能的一个关键手段。我们的目标是演练某些运动和战术要点，使它们成为完全自动的技能。但当过度拟合在此出现时，一切就可能是灾难性的。比如，曾发生这样一个故事，警察发现自己在枪战中竟会花时间将弹壳收在口袋里——这是在射击场上培养起来的良好习惯。作为美国前陆军游骑兵和西点军校心理学教授戴夫·格罗斯曼曾写道：“在许多真实枪战中，当硝烟散去，军官们会震惊地发现自己的口袋里有许多空弹壳，但他们自己完全不记得是如何放到那里的。在一些场合，殉职的警察被发现手中还握着空弹壳，他们死在执行一个渗入他们身体里的行政程序的过程中。”同样，美国联邦调查局被迫改变其训练，因为他们发现有些特工在开完两枪之后会本能地将武器收入枪套中（这是训练的标准程序），无论他们是否击中目标，也无论威胁是否仍然存在。这样的错误在执法和军事领域被称为“训练的伤疤”，这反映了一个事实——人们可能会对自己的准备过程过度拟合。在一个特别戏剧性的案件中，一名军官本能地将枪从攻击者手中抢走，然后又本能地将枪交还给他——就像他在训练中一次又一次地与他的训练者所做的那样。





检测过度拟合：交叉验证


因为过度拟合最初作为一种理论是完全符合现有数据的，所以它似乎很难被发现。我们如何能区别一个真正的好模式和一个过度拟合的模式呢？在教学领域，我们如何区分一个擅长所有科目的班级，和一个仅能“通过考试”的班级？在商业世界中，我们怎么能区别一个真正的明星员工和一个过度拟合公司关键绩效指标或老板看法的员工？

区分这些情况确实具有挑战性，但并非不可能。机器学习的研究已经得出了一些具体的策略以检测过度拟合，而最重要的问题之一就是所谓的交叉验证。

简单地说，交叉验证意味着不仅要评估模型是否适合给出的数据，还要看它是如何概括没有见过的数据。矛盾的是，这可能要使用更少的数据。在婚姻的例子中，我们可能会在随机的两个点位上“退缩”，使我们的模型适合其他8个点位。然后，我们将采用这两个测试点，并用它们来衡量各种功能是如何概括出他们已经给出的这8个“训练”点位之外的内容。这两个点就像是煤矿中的金丝雀：如果一个复杂的模型重合了那8个点位但又和那两个试验点差距很大，这很可能是过度拟合在产生作用。

除了保留一些可用的数据点，也可以考虑测试完全来自其他评价形式的数据模型。正如我们已经看到的，代理指标的使用——可作为营养的代替，或很多情况下作为研究者勤奋的代表加以解决，可能导致过度拟合的情况发生。在这种情况下，我们需要交叉验证我们正在使用的主要性能措施，而不是其他可能的措施。

例如，在学校里，标准化考试提供了许多好处，包含一种明显的规模经济：学生可以被大批量地、迅速地进行分级。然而，除了这些测试，学校还可以使用不同的评价方法，例如写一篇文章或参加口头考试，以此随机评估一小部分学生，例如一个班中的一名学生，或100个学生中的一个。（因为只有少数学生会以这种方式进行测试，用这种二级评价方法，规模就不是一个大问题。）标准化测试会提供即时的反馈，例如你可以让学生每星期参加一个简短的计算机考试，并用图表实时分析学生的进步。此时，二级数据点就可以被用来进行交叉验证，以确保学生真正获得知识。事实上，标准化测试的目的也是测量这个，而不是让学生简单的考得更好。如果一个学校的标准化考试成绩上升，而其“非标准化”方面的表现却在向相反的方向移动，管理人员便会意识到一个明确的警告——“应试教育”已经出现，学生的技能开始对考试本身这个机制出现过度拟合。

交叉验证也给执法和军事人员提供了一个建议，希望他们能获得良好的反应能力，而不是养成从训练过程本身被强行注入的习惯。正如写文章和口语考试可以交叉验证标准化测试，偶尔不熟悉的“交叉培训”评估，便可以用来测试反应时间和射击精度是否能适应不熟悉的任务。如果不能，那么这便是一个强烈的信号，表示应该改变原有的训练方案。虽然没有什么能够确保实战万无一失，但这样的演习至少应事先警告“训练疤痕”很可能已经形成。





如何应对过度拟合：惩罚复杂性


无名氏

如果你不能简单地解释一个问题，那你就没有完全理解它。

我们已经看过一些过度拟合出现的方式，及其检测和测量的方法。但是我们能做些什么来缓解这个问题呢？

从统计的观点来看，过度拟合是我们对看到的实际数据太过敏感的体现。那么，解决方案也是直截了当的：我们必须平衡我们的愿望，找到我们应该使用的对抗复杂性的模型进行分析。

在几个相互竞争的模型中选择一种方法就是奥卡姆的剃刀原理，它表明，所有的事情都是平等的，最简单的假设可能就是最正确的那个。当然，事情很少是完全平等的，所以在数学背景下，如何应用像奥卡姆剃刀这样的原理并不是清楚明了的。面对这一挑战，在20世纪60年代，苏联数学家安德烈·季霍诺夫给出了一种答案：引入一个额外项来计算惩罚更复杂的解决方案。如果我们引入复杂性惩罚，那么更复杂的模型需要做的不仅是做得更好，更重要的是解释数据以证明其更大复杂性的合理性。计算机科学家将这个原则——使用约束来惩罚模型的复杂性，称为正则化。

那么这些复杂性惩罚是什么样的呢？在1996年，由生物统计学家罗伯特·蒂什拉尼发现的一种算法，被称为套索算法，这被用作对模型中各因素总和的惩罚。[1]通过将这种下行压力放到因素的总权重上，套索算法将驱使它们降为零。只有对结果有很大影响的因素才能保留在方程中，因此有可能将一个过度拟合的九因素模型转化为一个简单的、更强大的、只有最关键因素的公式。

像套索算法这样的技巧在目前的机器学习时代无处不在，但同一类原则——复杂度惩罚原则同样也出现在自然界中。由于受到时间、记忆、精力和注意力的限制，活的生物体几乎可以自动地朝着简单化方向发展。例如，新陈代谢的负担对生物体的复杂性起到了刹车作用，对过度精细的机体运行引入了热量惩罚机制。一个人的大脑每日消耗的总热量是摄入量的1/5，这证明了进化的优势，我们的智力为我们提供了大脑贡献的、肯定不止消耗量那么多的燃料。另一方面，我们也可以推断，从进化论的角度来说，一个更复杂的大脑可能无法提供足够的报酬。我们的聪明程度符合我们的需要，而不是任意的更高程度。

同样的过程也被认为在神经水平上发挥作用。在计算机科学中，基于大脑的软件模型被称为“人工神经网络”，它可以学习大脑任意复杂的功能，甚至比我们之前的九因素模型更灵活，但正因为它非常灵活，所以也更容易过度拟合。实际上，生物神经网络在回避这个问题，因为它们需要用它们的表现来换取维持运行的成本。神经科学家建议，大脑应在任何给定的时刻尽量减少神经元的数量，像套索算法那样执行同类的复杂性下行压力。

然而语言又是另一种自然的套索：复杂性受到更长时间的说话和对听众注意力时限的惩罚。商业计划被压缩到电梯营销，生活忠告只有在足够简洁易懂的情况下才能成为谚语般的智慧之语。需要记住的东西都必须经过固有的记忆套索。

[1]这相当于数学上的变量系数绝对值之和。





启发法


经济学家哈里·马科维茨凭借拓展了现代投资组合理论而获得1990年的诺贝尔经济学奖。他开创性的“均值-方差投资组合优化”理论告诉投资者如何在不同的资金和资产之间进行最优分配，在同一风险程度下收益达到最大化。所以当轮到马科维茨投资自己的退休储蓄时，他似乎应该是最胜任此项工作的人。他决定怎么做呢？

我应该计算资产阶级的历史协方差，并得出有效前沿。相反，我想象如果股市大涨，但我却没有入市（或如果它大跌，我却都投资在此）那我一定很悲伤。我的意图是尽量减少我未来的遗憾。所以我在债券和股票上的投资是一半对一半。

他为什么要这样做呢？诺贝尔奖得主的故事和他的投资策略可以作为人类非理性的一个例子：面对现实生活的复杂性，他放弃了理性的模型，转而遵循一个简单的启发法则。但正是由于现实生活的复杂性，一个简单的启发法实际上可能是理性的解决方案。

当涉及投资组合管理时，事实证明，除非你对市场信息非常有信心，你便可以忽略这些信息。应用马科维茨最优资产配置方案要求能对不同投资的统计资产做出良好的估计。在这些估计中，一旦犯错误，便可能会导致完全不同的资产分配，就可能增加风险。相比之下，你的钱均匀地分散在股票和债券上，你就不会受到可观察到的所有数据的影响。这种策略甚至不尝试拟合自己的投资类型的历史业绩，因此不会出现过度拟合的状况。

当然，仅仅使用一半对一半的分配方法并不一定是复杂性的最佳选择，但这里就有一些东西可以谈谈。如果你碰巧知道一组投资的期望均值和期望方差，那么使用均值-方差组合优化的最优算法就是其中一个最佳原因。但当正确估计的可能性很低，同时模型过于重视那些不值得信任的量时，那么警报应该在决策过程中响起：应该进行正则了。

受到例如马科维茨的退休储蓄的启发，心理学家格尔德·吉仁泽和亨利·布莱顿认为，人们在现实世界中使用的决策捷径在许多情况下，正是这种能做很好的决定的思维。“与广泛持有的处理得越少，准确度就越低的观点不同，”他们写道，“启发式的研究表明，更少的信息、计算和时间，其实是可以提高准确度的。”支持启发式思想的人更喜欢简单的答案，用更少的因素，或更少的计算，这正展现出“少即是多”的效果。

然而，对模型的终极复杂性进行处罚并不是减轻过度拟合的唯一途径。你还可以通过控制输入数据的适应速度来推动模型走向简单化。这使过度拟合可以照亮我们的历史——无论是作为一个社会，还是作为一个物种。





人类进化中的过度拟合


《疾病与新食物摄入前的关联》

一只活着的老鼠所吃过的每一样食物，都一定没有杀死它。

20世纪90年代中期到2013年，美国的豆奶销量翻了两番多。但截至2013年年底，根据新闻报道，它的畅销似乎已经是过去时了，豆奶的销量远落后于杏仁奶的销量。食品和饮料研究员拉里·芬克尔在《彭博商业周刊》上这样说道：“坚果现在很流行，大豆听起来更像是老式的保健食品。”以推广豆浆而闻名的丝滑公司（正如其名字所暗示的），在2013年年末报告说，仅在上个季度，杏仁奶的产品销量就增长了超过50%。同时，其他饮料，例如椰子汁的领先品牌维塔可可，2014年度所报告的销售额就比2011年翻了一番——自2004年以来增加了惊人的300倍。正如《纽约时报》所说：“椰子汁似乎在我们模糊又熟悉的领域，已经从无形发展到不可避免的存在了，中间没有一丝停顿。”同时，在2013年，羽衣甘蓝的销量就增长了40%。2012年羽衣甘蓝最大的采购商是必胜客，他们把它放在沙拉上作为装饰。

人类生活的一些最基本的领域，比如我们应该把什么吃进我们的身体里，似乎很奇怪地都被那些昙花一现的潮流主宰着。使这些潮流席卷世界的部分原因是我们的文化能迅速做出改变。现在，信息比以往任何时候都更快地渗透到社会中，而全球供应链使消费者能够迅速改变他们的购买习惯（市场营销也鼓励他们这样做）。如果有特别的研究正好表明某些东西对健康有益，例如八角，它便会在一周内充斥整个博客，下一周就开始登上电视节目，并在6个月内出现在几乎每一家超市，接下来就有专门的八角食谱出版。这惊人的速度既是幸事又是一种祸害。

相反，如果我们观察生物（包括人类）的进化方式，我们会注意到一些有趣的现象：变化发生得很缓慢。这意味着，现代生物的属性不仅受制于它们目前所处的环境，也由它们过去的历史共同塑造而成。例如，人类神经系统奇怪的交叉分配（左侧身体由右侧大脑控制，反之亦然）反映出脊椎动物的进化史。这种现象被称为“交叉”，该理论出现在早期脊椎动物进化过程中（相对于它们的头，身体扭曲180度这个过程中），无脊椎动物如龙虾和蚯蚓的神经索是在“肚子”一侧，而脊椎动物的神经索是沿着脊柱生长的。

人类的耳朵又提供了另一个例子。从其功能的角度看，它是一种通过震动放大（主要通过三大骨骼系统：锤骨、砧骨、镫骨）将声波转化成电子信号的系统。这个放大系统是很惊人的，但它的具体工作原理有很多是与历史的限制有关的。事实证明，爬行动物的耳朵里只有一根骨头，但哺乳动物的下颌骨缺少其他的骨头。这些下颌骨显然被使用在哺乳动物的耳朵里了。所以我们耳朵解剖学上的确切形式和配置反映出我们的进化史至少和反应出的听觉问题一样多。

过度拟合的概念给我们提供了一个能在进化的压力下看到其长处的机会。虽然交叉神经纤维和改变用途的颌骨似乎已经是最理想的安排，但至少我们应该认识到，我们并不一定要让进化去完全优化生物，以适应生态环境的每一点改变，这样做会使其对环境的变化极其敏感。另一方面，必须利用现有的材料，施加一种有用的约束。这使得它很难引起生物体结构的急剧变化，更难拟合。作为一个物种，受制于过去，就使我们不能完全地调整以适应目前所知的情况，但这有助于我们在未知的未来保持身体强健。

一种相似的洞察力可能帮助我们抵制人类社会快速转变的潮流。说到文化，传统对进化起着制约作用。一点点的保守主义，一种偏向历史的偏见，可以使我们对抗起起落落的时尚循环，进行缓冲。当然，这并不意味着我们应该忽略最新的数据。努力跳向乐队花车（寓意赶潮流），但不一定真要跳到它的上面。

在机器学习中，缓慢移动的优点最明显地出现在一种称为早期停止的正则化技术中。当我们在本章开头看德国婚姻调查数据时，我们直接研究了最适合的一、二、九因素模型。然而在许多情况下，调整参数寻找给定数据的最佳拟合是其自身和内部的一种过程。如果我们提前停止这个过程，不允许模型变得太复杂，会发生什么呢？再次，那些似乎乍一看像是被漠视或不彻底出现的东西，相反，在自己的权利下就是一种重要策略。

例如，许多预测算法都是先寻找单一的最重要的因素，而不是直接跳跃到多因素模型。只有找到第一个因素后，才会去寻找第二重要的因素添加至模型，然后再找下一个。因此，在过度拟合有机会出现之前，它们的模型可以让过程在短时间内停止，阻止过程变得过于复杂刻意。计算预测的一个相关方法在一次只考虑一个数据点，模型在添加更多的数据点之前会调整到新的点。同样在那种情况下，模型的复杂性逐渐增加，所以将过程停止并变短有助于防止过度拟合。

这种设置（更多的时间就意味着更复杂）成为很多人类行为的特征。给自己更多时间去决定某件事并不一定意味着你就会做出更好的决定。但它的确会保证你最终会考虑更多的因素、更多的假设、更多的利弊，从而对风险过度拟合。

汤姆成为教授的经历正是这样的过程。他在上第一学期的第一堂课前，花了大量的时间完善他的讲座——1小时的课他准备了超过10小时。第二学期，他教了另一个班级，他无法再投入那么多的时间，然后就开始担心他的课将会变糟。但是奇怪的事情发生了：学生们更喜欢上第二学期的课。事实上，相比第一学期的课，他们更喜欢第二学期的课。结果汤姆发现，那些额外的时间都花在了令人困惑的细节上，而这些细节只会让学生们感到困惑，汤姆再次上课的时候，就把这些内容从课堂上去除了。汤姆最终意识到，这个问题在于，他一直把自己的品味和判断当作自己学生的衡量标准（该代理指标作为一个近似值效果相当不错，但它不值得过度拟合），这解释了为什么额外花时间精心“完善”的所有幻灯片都适得其反。

在各种机器学习任务中，正则化的有效性表明，我们可以通过有意识地思考和少做一些事情来做出更好的决定。如果我们最先想到的因素可能是最重要的因素，那么如果思考的量超过某一个度的话，就不仅是浪费时间和努力，它将会让我们找到更糟糕的解决方案。早期停止为理性的论证而不是一味地推理提供了基础。但是把它变成实用的建议还需要回答一个问题：我们什么时候应该停止思考？





何时应该想得更少？


就像所有涉及过度拟合的问题一样，如何尽早停止取决于你能衡量的标准和真正重要的因素之间的差距。如果你了解了所有的事实，它们就不会有任何错误和不确定性，你可以直接评估什么对你来说是重要的，然后不要过早的停止。思考的时间长而努力：模型的复杂性和付出的努力都是值得的。

但事实并非如此。如果你有很高的不确定性和有限的数据，那么务必提前停止。如果你不清楚你的工作将如何被评估，以及由谁来评估，那么你就不值得花额外的时间来对你自己（或者其他人）的特质做出所谓完美的判断。不确定性越大，你所能衡量的东西和真正重要的东西之间的差距就越大，你就越应该注意过度拟合的风险，也就是说，你越喜欢简单，就应该越早停下来。

当你真正处于黑暗中，最好的计划将是最简单的。当我们对预期不确定，而且得到的数据杂乱无章时，最好的办法就是用一支粗的画笔来画画，用宽大的笔触来思考。有时候，照字面意思来处理就行。正如企业家杰森·弗里德和戴维·H.汉森解释的那样，在他们需要头脑风暴的时候，他们就会用越粗的笔（这是一种用来表达简单化的聪明的方式）：

当我们开始设计某样东西时，我们会用一个大而粗的记号笔勾勒出一些想法，而不是圆珠笔。为什么呢？因为圆珠笔的笔尖太细了。它们的分辨率太高。它们会促使你担心一些你不应该担心的事情，比如完善阴影，或者使用虚线。你最终会专注于那些不应该关注的事情。

记号笔不会局限住我们。你只能画出形状、线条和盒子。这很好。你最开始应该担心的是大局。

正如麦吉尔大学的亨利·明茨伯格所说：“如果我们从一个无法衡量什么是最重要的前提出发，又会发生什么？”我们必须用一些非常可怕的东西来代替衡量，那就是判断。

前期停止的结果是，有时这不是一个在理性和我们的第一直觉之间做出选择的问题。我们的第一反应可以是理性的解决方案。决策越复杂、越不稳定、越不确定，就越要理性。

再回到达尔文的例子，是否求婚的问题可能已经基于最初他所确认的几个利弊点得到了解决，后续增加的利弊点则会增加考虑时间和焦虑，但并没有帮助他做决定（并且很可能阻碍它）。他脑子里似乎有个想法，那就是：“如果一个人的一生像一只蜜蜂一样工作，工作，其他什么都不做，这是无法忍受的。”孩子和陪伴（他所提到的首要优点）正是那些最终使他选择结婚的原因。他对书的预算是干扰项。

然而，在我们对达尔文提出批评，把他描绘成一个根深蒂固的过度思考者之前，我们应该再到他的日记中看一看。在他日记的复本中可以看到一些有趣的东西。达尔文不是富兰克林，他在数天内添加了各种各样的考虑因素。尽管他对这一改变命运的选择很认真，但达尔文在他的笔记写到日记本底部的时候，还是下定了决心。他正在对那一页进行正则化。这让人想起了早期停止和套索算法：任何没有出现在页面上的东西都不能帮助他做出决定。

当达尔文下定决心要结婚时，他立即开始思考时间的问题。“什么时候结婚？马上还是再等等？他在另一份关于利弊的清单上列出了他的愿望：从幸福的考虑到某些“奇怪”的开支，再到他长期以来想乘坐热气球和去威尔士旅行。但在这一页的最后，他下定决心“不要在意，相信运气”。结果，在几个月的时间里，他向艾玛·韦奇伍德求婚，这是一段美好的关系和幸福家庭生活的开始。




