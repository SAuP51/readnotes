Run;

* * *

上述命令针对数据集 One 中两个样本人群组 group 进行了关于活跃度分数 score 是否相等的 T 检验，该数据集有两个样本人群分别为 a 和 b。

运行上述程序后得到针对两个独立样本进行 T 检验后的结果，如图 12-1 所示。

图　12-1　两组独立样本的 T 检验结果

从图 12-1 可以看出，pr＞F 的值为 0.372 6，该值大于 α 理论值 0.05，所有没有理由拒绝方差相等的假设，因而上述两组样本的方差是相等的。

再看 T-Tests：pr＞|t | 的值为 0.000 6，小于 α 理论值 0.05，所以有足够的理由拒绝两个样本的均值差为 0 的假设，也即两个样本组的活跃度分数的均值是不相等的。

12.2.5　两组独立样本的非参数检验

虽然两组观察值是各自独立的，但是每组观察值不一定来自正态分布的总体，同时两个独立样本组的方差也不一定相等，这时就不能采用独立样本的 T 检验了，而必须进行两组独立样本的 Wilcoxon 秩和检验。

两组独立样本的 Wilcoxon 秩和检验方式是比较两个独立组观察值的一种非参数检验。该检验结果类似于 T 检验的结果，该检验用于次序变量、区间变量和比例变量中。

还是以上述案例为例，假设案例的数据不满足 T 检验的前提条件，那么就应该采用两组独立样本的 Wilcoxon 秩和检验，在 SAS 中，可利用 Proc Npar1way 的过程语句来实现，程序代码如下：

* * *

Proc Npar1way data=Work.One WILCOXON;

Class group;

VAR score;

Run;

* * *

运行上述程序后得到两个独立样本进行 Wilcoxon 秩和检验后的结果，如图 12-2 所示。

图　12-2　两组独立样本的 Wilcoxon 秩和检验的结果

在图 12-2 中可以看到，Two-Sided pr＞|Z | 的值为 0.011 1，小于 α 理论值 0.05，所以有足够的理由拒绝原假设两个独立组的均值相等，也即两个独立组的活跃度分数的均值是不相等的。

需要强调的是，如果 Two-Sided pr＞|Z | 的值大于 α 理论值 0.05，则结论是两个独立组的均值没有显著差异，但是并不能说成两个独立组的均值相等。

12.2.6　配对差值的 T 检验

在数据化运营的实践应用场景中，进行配对组样本的比较时，一般是对样本运营前后的情况进行对比，比如针对运营前后的网站活跃度进行对比，通过 T 检验，来判断运营活动是否明显提升了样本人群的网站活跃度。

对配对组差值进行 T 检验的条件类似于独立组样本的 T 检验的条件，其中包含以下两个条件：

❑每对观察值与其他观察值之间相互独立。

❑配对差值来自正态分布。

由于是配对差值的检验，所以配对差值 T 检验只用于区间以上的变量。

示范案例：某公司运营团队从某个细分客户群体中随机抽取一部分客户进行有针对性的「旨在提升其网站活跃度」的专题运营活动，在为期两周的专题运营活动结束后，收集参与活动的客户运营前后的网站活跃度分数，希望通过数据分析来判断该专题运营活动的提升效果是否显著。

配对差值 T 检验在 SAS 中采用 PROC Univariate 过程来实现，本示范案例的具体程序代码如下：

* * *

Proc UNIVARIATE data=two;

VAR diff;

Run;

* * *

客户的前后活跃度分数的数据集存放在 two 表中，其前后活跃度分数的差值定义为 diff。

上述程序运行后得到对配对差值进行 T 检验后的结果，如图 12-3 所示。

图　12-3　配对差值的 T 检验的结果

从图 12-3 的 T 检验结果可以看出：

Student's t（T 检验），pr＞|t | 的值为 0.0017，远远小于 α 理论值 0.05，所以有足够的理由拒绝原假设（即配对差值与 0 的差别不明显），也即配对差值明显不为 0。

如果 pr＞|t | 的值大于 α 理论值 0.05 时，则没有足够的理由拒绝原假设，即配对差值与 0 的差别不明显，结论是配对差值与 0 的差别不显著，但是并不能说配对差值明显为 0。

12.2.7　配对差值的非参数检验

如果每对观察值与其他观察值相互之间是独立的，但是每组观察值不一定来自正态分布的总体，这时就不能采用配对差值的 T 检验了，而必须进行配对差值的 Wilcoxon 秩和检验。

还是以上述配对差值 T 检验的案例来进行说明，针对配对差值的 Wilcoxon 秩和检验过程如下。

在 SAS 中，配对差值的 Wilcoxon 秩和检验仍然是采用 PROC Univariate 过程来实现的。但是观察的指标不同。

这里仍然以 12.2.6 节中的数据和代码为例，配对差值的 Wilcoxon 秩和检验仍然是采用 PROC Univariate 过程来实现的，运行该程序后得到的 Wilcoxon 秩和检验结果，如图 12-4 所示。

图　12-4　配对差值的 Wilcoxon 秩和检验结果

对于配对差值进行 Wilcoxon 秩和检验的统计量，只需要观察 pr＞|S | 后面的值，相当于概率 P 即可。

回到本示范案例，从图 12-4 的结果中可以看出，pr＞|S | 后面的值为 0.007 8，远远小于 α 理论值 0.05，表明配对差值明显不为 0。如果 pr＞|S | 后面的值大于 α 理论值 0.05，则表明平均配对差值与 0 的差别不明显，但千万不能说成平均配对差值为 0。

12.2.8　方差分析概述

当我们分析的对象不限于两个独立样本组，而是扩展到更多个样本组时，T 检验就不适用了，在这种情况下，就需要进行方差分析（Analysis of Variance,ANOVA），或者叫做 F 检验。

方差分析是利用样本数据检验两个以上的总体均值是否有差异来进行分析的一种方法。在研究一个变量的时候，它能够解决多个总体的均值是否相等的检验问题；在研究多个变量对不同总体的影响时，它也是分析各个自变量对因变量影响的方法。通俗地理解，方差分析是 T 检验的扩展，T 检验用于两组连续型数据的比较，而方差分析则用于三组或三组以上的连续型数据的比较。

方差分析也要满足以下 3 个前提条件：

❑各组观察值是来自于正态分布的总体的随机样本。

❑各组观察值之间是相互独立的。

❑各组观察值具有同方差性。

根据分析因素的个数不同，方差分析可以分为单因素方差分析和多因素方差分析。

所谓多因素方差分析，是指当有两个或两个以上的因素对因变量产生影响时，采用此方法，利用假设检验的过程来判断多个因素是否对目标变量产生明显的影响。

在运营效果分析实践中最常见的是单因素的方差分析，比如，针对多个样本组，都是从同样的总体中随机抽取的，只是随后的运营策略有所不同，同时比较运营后的行为指标有所差异的场景。单因素实际上就是运营策略的不同，单因素方差分析就是希望通过假设检验来验证运营策略的不同是否真的导致了随后各样本组的行为指标之间有差异。所以，针对方差分析的介绍，本章只限于单因素的方差分析，至于多因素方差分析、协方差分析，感兴趣的读者可以查阅相关的统计专业书籍进行更详细的了解。

12.2.9　单因素方差分析

单因素方差分析（One-Way ANOVA）主要研究单个因素对目标变量的影响，这种方式将通过因素的不同水平对目标变量进行分组计算，得到组间和组内方差，并利用方差比较对分组所形成的总体均值进行比较，从而对各总体均值相等的原假设进行检验。

示范案例：某公司运营团队计划对某一类特定客户群体进行不同内容的，旨在提升客户网站活跃度的运营刺激，不同的运营内容分别为 a、b、c、d、e 5 种方案。这时，将从上述客户群体中随机抽取一部分客户，然后将其分别分配到这 5 种不同的运营方案中。在为期两周的运营活动结束后，运营方希望通过数据分析来评价不同的运营方案，是否在客户的活跃度提升上有明显的差异。

在 SAS 中，单因素方差分析是通过 ANOVA 过程来实现的，本案例具体的程序代码如下：

* * *

Proc ANOVA data=three;

Class group;

Model score=group;

Means group/snk;

Means group/scheffe tukey;

Run;

* * *

上述程序运行后得到了单因素方差分析的结果，如图 12-5～图 12-8 所示。

从图 12-5 可以看出：F 检验的概率（pr＞F）值为 0.0062，远远小于 α 理论值 0.05，所以可以拒绝 H0，同时表明运营方案（或内容）不同，则客户的活跃度提升分数也不相同。

图　12-5　单因素 ANOVA 输出的结果

从图 12-6 可以看出，经过 SNK 方法检验，C 组客户的活跃度分数与其他各组的客户活跃度分数有明显的区别。

图　12-6　单因素 ANOVA 的 SNK（Student-Newman-Keuls）检验结果

从图 12-7 可以看出，经过 Tukey 方法检验，c 组分数与 a、b、d、e 各组的分数差异明显。

图　12-7　单因素 ANOVA 的 Tukey 检验结果

从图 12-8 可以看出，经过 Scheffe 方法检验，c 组与 e、d 组的分数差异非常明显。

图　12-8　单因素 ANOVA 的 Scheffe 检验结果

12.2.10　多个样本组的非参数检验

如果多个样本组的数据不是来自正态分布的总体，或者各样本组的方差不相等，在这些场景中，就不能使用方差分析的方法了，而只能采用非参数检验的方法。

还是以上一节的案例为例来进行说明，在为期两周的运营活动结束后，运营方希望通过数据分析来评价不同的运营方案是否对客户的活跃度提升有明显的差异。

最常用的多个样本组的非参数检验方法是 Kruskal-Wallis 检验，但在 SAS 中仍然可以利用 NPAR1WAY 过程中的 Wilcoxon 方法来实现，示范案例的具体程序代码如下：

* * *

Proc npar1way data=four Wilcoxon;

VAR score;

Class group;

Run;

* * *

运行上述程序后得到了非参数检验的结果，如图 12-9 所示。

图　12-9　多个独立样本组的 Kruskal-Wallis 检验结果

依据图 12-9 中的 Kruskal-Wallis 检验统计量对应的 P 值，即 pr＞Chi-Square＜0.0001 来看，在给定的显著性水平 α=0.05 的条件下，可知不同群体（Group）所反映的活跃度分数（Score）的总体位置是不相同的，即可以认为不同群体的活跃度分数是有明显差异的。

12.2.11　卡方检验

卡方检验（Chi-Square Test）也是一种应用非常广泛的假设检验方法，它属于非参数检验的范畴，主要是比较两个和两个以上的样本率（构成比例），以及对两个分类变量的关联性进行分析，其根本思想是比较理论频数和实际频数的吻合程度或者拟合度。

关于卡方检验的原理和公式，本书在第 8.6.5 节已有详细介绍，在这里就不再赘述了。

示范案例：某公司运营部门根据用户的属性将用户分为 5 个不同的群体 Segment，分别为 a,b,c,d,e 5 个群体，并从总体中提取 5 个群体中的一些样本，分别针对各个群体在过去 30 天内是否发生网上交易（Make-Deal）的记录进行统计，现在想知道不同群体之间发生网上交易的比例是否有明显的差别。

卡方检验在 SAS 中可以通过 Freq 过程来实现，本示范的具体程序代码如下：

* * *

Proc freq data=five;

Table segment*make_deal/chisq;

Run;

* * *

运行上述程序后得到卡方检验的结果，如图 12-10 所示。

图　12-10　卡方检验的结果

从图 12-10 的结果中可以看出，Chi-Square 统计量的值为 4.0133，其对应的 P 值，即 Prob 值为 0.404 2，假定显著性水平 α=0.05，则 P 值远远大于 α，因此没有理由拒绝细分群体与是否成交之间相互独立的原假设，也就是说细分群体之间的成交情况没有明显的关联性。

12.2.12　控制变量的方法

除了上面谈到的这些基本的、常见的统计分析检验技术之外，在数据化运营的商业实践中，针对运营效果进行分析时还有一些重要的思路和策略，利用这些思路和策略来处理数据可以有效提升分析效率，更好、更准确地发现正确的结论。其中，最常见的一个思路和策略就是控制变量的方法。

所谓控制变量，是指在分析某个核心因素针对不同群体的运营效果时，为了防止其他因素的干扰，而人为地将考虑到的其他因素，即一些潜在的、重要的、可能影响运营效果的因素进行固化（或排除），从而在一个人为控制的比较单纯的数据中专门分析核心因素的影响。

虽然从统计学的角度看，多个因素对目标变量的影响可以通过方差分析、协方差分析等方法加以解决，但是这些复杂的统计方法不是运营团队中的每个人都可以熟练掌握的；另外，控制变量的方法本身简单易行，通俗易懂，所以在数据化运营的商业实践中还是有很大的应用空间的。

举例来说，为了分析在线旺铺装修要素对于在线成交的影响，数据分析师在分析之前应该了解，对于在线成交的潜在影响因素，从电子商务平台的买卖双方的行为来看，有太多的可能性，如在线广告的投放、线上商品的 Offer 情况、商品的价格、品类、促销措施、卖家资质、卖家规模等都要考虑，至于在线旺铺装修要素对于在线成交的影响，放在上面提到的电子商务平台的买卖双方的海量行为因素中，就很有可能会被其他因素所掩盖。在这种情况下，为了专门分析在线旺铺装修要素对在线成交量的影响，就很有必要在分析之前考虑控制变量的方法，即把那些跟在线成交密切相关的因素排除在外，这些核心因素包括购买了在线点击付费广告 P4P 业务，并且最终的分析样本应该在很多核心因素方面是一致的，比如商品来自同一个品种，卖家具有相同的资质和规模，价格基本上属于同一个层次，所抽取的数据都没有受促销措施的影响等。只有把这些应该考虑的核心因素都考虑到，并且都进行了有效的控制，才可以在一个比较单纯的数据集中专门分析在线旺铺装修要素对于在线成交量的影响。

12.2.13　AB Test

提到 AB Test，人们最容易想起的就是它是在网页设计优化中的一种比较策略。同一个功能页面，设计两种不同的页面布局（或风格），通过技术手段将两种不同风格的页面设计随机分配给浏览该功能页面的不同访问者，根据随机分配的页面浏览转换效果，来评价不同设计风格的优劣。

其实，除了上面提到的网页设计和优化中常常用到这种方法之外，AB Test 与控制变量的方法一样可以看做是进行运营效果分析时的思路和策略，也是数据化运营实践中运营团队最熟悉的方法论。

AB Test 最基本的含义就是对于一个运营活动的效果进行评价。在使用此方法时，一定要事先把同一类客户群体随机分成 A 和 B 两组，一组进行运营，另一组不进行运营，这样才可以比较合理地评估运营的效果；或者一组采用甲方案进行运营，另一组采用乙方案进行运营。但是，也并不是说只能局限于两个样本组，在实践中可以根据具体项目需求分成多个分组。

使用 AB Test 方法时要注意以下的几点：

