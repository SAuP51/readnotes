dies tonight, what will I have lost?」If your answer is more than a few hours of

work, you need to take a close look at your data backup procedure. You do have a

data backup procedure, right?

CHAPTER 24  Ten VBA Do's and Don'ts    387

Index

A

assignment statements

equal sign, 108–109

Abs function, 136

examples, 108

absolute mode, macro recorder, 82–83

operators, 109–110

activating VBE, 32

audience of this book, 1–2, 4–5

activation events, 175–178

Auto Data Tips option, Editor tab, 47

AddChart, 226–228

Auto Indent setting, Editor tab, 47

AddEmUp Sub procedure, 14

Auto List Members, 46, 63–64

add-ins

Auto Quick Info option, Editor tab, 46–47

creating

Auto Syntax Check, 45–46, 375–376

adding descriptive information, 362–363

automatic calculation, turning off, 232

distributing, 364–365

automatic events

modifying, 365

examples of, 171–174

opening, 364

overview, 165

process of, 363

types of, 167–168

protecting VBA code, 363

reasons for, 356–357

setting up workbook, 359–361

B

testing workbook, 362

backups, 387

general discussion of, 358–359

BeforeDoubleClick event, 178–179

overview, 355–356

BeforeRightClick event, 179

working with, 357–358

BeforeSave event, 174

Address property, 122

block of cells, selecting, 217–218

AddTwo function, 14

blogs, 380–381

advantages of VBA, 12–13

Boolean settings, 224

alert messages, eliminating, 233

Break mode, 209–210

arguments in functions

breakpoints, 207–210

none, 339

bugs

one, 339–341

debugging techniques, 203–206

optional, 344–346

debugging tools, 207–212

overview, 338

differences between syntax error and, 202

range, 342–344

identifying, 202–203

two, 341–342

overview, 201

array formulas

reduction tips, 212

month names, 349

types of, 201–202

overview, 348

built-in dialog boxes, displaying, 254–255

sorted lists, 349–351

built-in VBA functions

Array function, 136, 354

benefits of, 134–135

arrays

discovering, 135–138

declaring, 111

examples of, 132–135

dynamic, 112–113

overview, 132

multidimensional, 112

Index    389

C

columns, selecting, 218

ComboBox control, 280

CallerSub procedure, 75, 76

CommandButton control

calling functions

adding, 265–266

from Sub procedures, 75–76

general discussion, 280–281

from worksheet formula, 76–77

comments, 93–95, 370

cell values, prompting for, 221–222

Commission function, 340–341

cells, selecting block of, 217–218

compatibility of different versions of Excel, 386

Cells property, 117–118

components, VBE, 32

Change event, 179–181

constants, premade, 105–106

ChangeCase macro, 264, 269, 362

control properties, changing, 276–278

ChangeComment function, 336

Copy method, 127–128

ChartObjects collection, looping through, 228–229

CopyOne procedure, 60

chart-related macros, 226

Count property, 121

charts

COUNTA function, 302, 303

displaying in UserForms, 318–319

CountBold procedure, 163

properties of, modifying, 229

CubeRoot function, 66–67, 75–76

types of, modifying, 228

CurDir function, 136

using, 225–229

custom dialog boxes.  See UserForms

CheckBox control, 279

customizing VBE

Choose function, 136

Docking tab, 50

Chr function, 136

Editor Format tab, 48–49

Clear method, 127–128

Editor tab, 45–48

code

General tab, 49

cleaning up, 384–385

copying multiple lines of, 371

dialog boxes, writing to display, 297–299

D

examining, 204

data types

experimenting with, 386

dates, 107

Internet search for, 379

declaring variables as

predefined stopping point, 374–375

life of variables, 104

stepping through, 372–373

module-only variables, 102

stepping to specific line in, 373–374

overview, 98–99

UserForms, writing for, 296

procedure-only variables, 101–102

writing with macro recorder, 378

public variables, 103

Code Colors option, Editor Format tab, 48

static variables, 103–104

Code windows, VBE

overview, 97–98

copying VBA code, 45

data validation, 180–181, 302

creating modules, 38–39

Date function, 132, 136

entering code directly, 39–42

DateAdd function, 136

inserting code in module, 39

DateDiff function, 136

minimizing and maximizing windows, 37–38

DatePart function, 136

overview, 33, 37

dates, 107

using macro recorder, 42–44

DateSerial function, 136

collections, 53–54

DateValue function, 136

Column property, 121

Day function, 136

390   Excel VBA Programming For Dummies

debugging

EnterRandomNumbers procedure, 314, 316

techniques for, 203–206

EnterSquareRoot procedure, 192–193

tools for, 207–212

equal sign, 108–109

Debug.Print statements, inserting, 206

Err function, 136

decisions, making

Error function, 136

If-Then structure, using, 148–151

errors

overview, 148

example of, 188–192

Select Case structure, 152–155

handling

declaring

EnterSquareRoot procedure, using, 192–193

arrays, 111

On Error statement, using, 192–193

module-only variables, 102

ignoring, 197–199

procedure-only variables, 101–102

overview, 192

public variables, 103

Resume statement, using, 194–196

static variables, 103–104

intentional, 199–200

variables, 383–384

overview, 187

variables as data types, 98–104

types of, 187–188

Default to Full Module View option, Editor tab, 48

event-handler procedures

Delete method, 128–129

adding, 268–269, 300–302

DeleteFromShortcut procedure, 331

overview, 168–170

Dev Center, Office, 382

events

Developer tabs, in macros, 17–18

activation of, 175–178

dialog boxes

automatic, types of, 165–168, 171–174

built-in, displaying, 254–255

keypresses, 182–185

checklists, 319–320

objects and, 61

controls.  See UserForm controls

OnTime, 181–182

testing, 300

overview, 161

Dir function, 136

worksheet-related, 179–181

disadvantages of VBA, 13

Excel

DisplayAlarm Sub alarm, 182

2007, differences in, 332

Docking tab, VBE, 50

compatibility in different versions of, 386

Do-Until loop, 161

compatibility with VBA, 16

Drag-and-Drop Text Editing option, Editor tab, 47

settings, changing, 223–225

dynamic arrays, 112–113

executing

functions, 75

E

macros, using shortcut key, 71–72

procedures

Editor Format tab

from another procedure, 74–75

Code Colors option, 48

from button or shape, 72–74

customizing, 48–49

from macro dialog box, 70–71

Font option, 48–49

Sub procedures, 68–70

Margin Indicator Bar option, 49

Exit For statements, 158

Size setting, 49

Exp function, 136

Editor tab, customizing, 45–48

Extensible Markup Language (XML), 325–329

ElseIf, 150–151

ExtractElement function, 347

embedded charts, 227

extreme-case bug, 202

EnterButton_Click procedure, 302

Index    391

F

G

FileLen function, 134, 136

General tab, VBE, 49

FirstName Function, 338

GetData macro, 299

Fix function, 136

GetOpenFilename method, 249–252

folder names, 253

GetSaveAsFilename method, 252–253

Font option, Editor Format tab,

GetSetting function, 136, 172

48–49

GoTo Statement, 146–147

Font property, 123–124

Graphical User Interface (GUI), 259

Format function, 136

GreetMe procedure, 149

formatting, applying, 228

GuessName procedure, 41–42

Formula property, 125–126

For-Next loops, 156–160

Frame control, 281, 291

H

functions

HasFormula property, 122–123

arguments

HideSheets procedure, 163

none, 339

hot keys, setting, 292

one, 339–341

Hour function, 136

optional, 344–346

overview, 338–346

I

range, 342–344

two, 341–342

icons used in this book, 5

arrays, 348–351

If-Then structure, examples of, 148–151

built-in VBA, using

Image control, 281–282

benefits, 134–135

Immediate window, 33–34, 209

discovering, 135–138

importing objects, to Project window, 37

examples of, 132–135

incorrect context bugs, 202

calling

indentations, formatting code with, 212

from sub procedure, 75–76

inner loop, 158

from worksheet formula, 76–77

InputBox function, 69, 136, 246–249

custom, 142–143, 336–337

Insert Function dialog box, 351–354

defined, 131–132

InStr function, 338

executing

InStrRev function, 136

macro, by using shortcut key,

Int function, 136

71–72

intentional errors, 199–200

overview, 75

Interior property, 124–125

procedure from another procedure,

IsArray function, 136

74–75

IsDate function, 136

procedure from button or shape,

IsEmpty function, 137

72–74

IsError function, 137

procedure from macro dialog box,

70–71

IsLike function, 348

Insert Function dialog box, 351–354

IsMissing function, 137

overview, 65–67, 337

IsNull function, 137

teleporting to, 371–372

IsNumeric function, 137, 180

worksheet, using, 138–142

wrapper functions, 346–348

J

writing, 338

JoinText function, 343

392   Excel VBA Programming For Dummies

K

chart-related, 226

creating, 18–19

keyboard users, 291–292

creating Developer tabs, 17–18

keypresses, 182–185

imperfection of, 189–192

InStr, 299–300

L

modifying, 23–24

Label control, 282–283

NameAndTime, 26–27

labels, 113

overview, 17

LARGE function, 343–344

recording, 19–20, 119, 125

LBound function, 137

saving workbooks containing, 24

LCase function, 137

security for, 24–26, 385–386

Left function, 137

testing, 21

LEFT function, 344

user interface, accessing

Len function, 133, 137

overview, 321

ListBox control, 283–284

Ribbon, customizing, 321–329

ListBoxes, 303–308

shortcut menus, customizing, 329–332

ListCount property, 303

using, 270–273

ListIndex property, 303

viewing, 21–23

LoadPicture function, 319

Margin Indicator Bar option, Editor Format tab, 49

Locals window, 211–212

MAX worksheet function, 139

LOOKUP table function, 340

menu bar, VBE, 33

looping

message boxes, 241–246

Do-Until loop, 161

methods, 59–61, 127–129

Do-While loop, 161

Microsoft Office Dev Center, 382

For-Next loops, 156–160

Mid function, 137

overview, 155–156

Minute function, 137

through ranges, 219–221

MOD function, 109, 142

modeless tabbed dialog boxes, 316–318

M

module-only variables, 102

Month function, 137

Macro Options dialog box, 185

MonthName function, 133–134, 349

macro recorder

MsgBox function, 46–47, 204–205, 241–246

absolute mode, 82–83

multidimensional arrays, 112

actions, recording with, 124

MultiPage control, 284–285, 291, 293

efficiency of, 87–90

multiple selection, 223, 306

generating, 84–86

MultiplyTwo function, 143

methods, identifying with, 212

MultiSelect property, 303

overview, 80–81

preparing, 81

N

properties, identifying with, 212

recording options, 86–87

NameAndTime macro, 26–27

relative mode, 83–84

nesting, defined, 150

writing code with, 378

non-Boolean settings, 225

MacroOptions macro, 352, 354

Now function, 137

macros

NumberFormat function, 346–347

adding to, 324–325

NumberFormat property, 126

Index    393

O

looping

Do-Until loop, 161

Object Browser, 62–63

Do-While loop, 161

object references, simplifying, 233–234

For-Next loops, 156–160

objects

overview, 155–156

Auto List Members, 63–64

programming constructs and, 145–147

collections, 53–54

progress indicator, using UserForms as

events and, 61

modeless tabbed dialog boxes, creating, 316–318

hierarchy, 52–53

overview, 312–313

methods of, 59–61

procedures, example of, 314–316

Object Browser, 62–63

progress-indicator dialog box, creating, 313–314

overview, 51–52

Project window, VBE

properties, 56–59

adding new VBA module, 35

referring to, 54–56

exporting objects, 36

VBA Help system, 61–62

importing objects, 37

Office Dev Center, 382

overview, 33

Offset property, 118–119

removing VBA module, 36

OKButton_Click procedure, 305

properties

On Error statement, 192–193

Address property, 122

OnTime, 181–182

Column property, 121

operators, assignment statements, 109–110

control properties, changing, 276–278

OptionButtons, 285

Count property, 121

adding, 266–268

Font property, 123–124

multiple sets, using, 310–311

Formula property, 125–126

outer loop, 158

HasFormula property, 122–123

Interior property, 124–125

P

NumberFormat property, 126

Paste method, 127–128

of objects, 56–59

PMT worksheet function, 140

overview, 119

premade constants, 105–106

Row property, 121–122

Procedure Separator option, Editor tab, 48

Text property, 121

procedure-only variables, 101–102

UserForm, changing for, 261–262

procedures

Value property, 120

example of, 314–316

public variables, 103

jumping between modules and, 371

mistakes in, 385

R

scrolling through, 372

RAND function, 138

ProcessCells procedure, 219

range, selecting, 308–310

program flow

Range objects

built-in VBA, using, 132

defined, 115

collections, looping through objects in, 161–163

methods of, 127–129

decisions, making

overview, 115–117

If-Then structure, using, 148–151

properties of

overview, 148

Address property, 122

Select Case structure, 152–155

Column property, 121

394   Excel VBA Programming For Dummies

Count property, 121

S

Font property, 123–124

sample files online, 5–6

Formula property, 125–126

SaveSetting function, 172

HasFormula property, 122–123

saving workbooks, 24

Interior property, 124–125

SayIt function, 348

NumberFormat property, 126

screen updating, turning off, 231–232

overview, 119

ScrollBar control, 286–287

Row property, 121–122

Second function, 137

Text property, 121

security

Value property, 120

for macros, 24–26, 385–386

referring to, 117–119

protecting VBA code, 363, 384

ranges

settings for, 3–4

block of cells, selecting, 217–218

Select Case structure, 152–155

cell values, prompting for, 221–222

Select method, 127

Charts, using, 225–229

Selected property, 303

copying, 214–215

selection type, 222

Excel Settings, changing, 223–225

Setup_OnKey procedure, 184

looping through, 219–221

sheets, activating and deactivating events in, 175–176

moving, 218–219

Shell function, 137

multiple selection, identifying, 223

shortcut menus, customizing, 329–332

overview, 214

ShowCubeRoot macro, 70

rows or columns, selecting, 218

ShowCubeRoot procedure, 71, 74

selection type, determining, 222

ShowDialogBox macro, 263

variable-size, copying, 215–217

ShowMessage macro, 325

recording macros, 19–20

ShowMessage procedure, 66

reduction tips, 212

Size setting, Editor Format tab, 49

RefEdit control, 286

SkipBlanks procedure, 219

relative mode, macro recorder, 83–84

Sorted function, 350–351

RemoveAllItems property, 303

Space function, 137

Replace function, 137

spaghetti code, 147

Require Variable Declaration option, Editor tab, 46

SpinButton control, 287–288, 311–312

Resume statement, 194–196

Split function, 137

RGB function, 124–125, 137

Sqr function, 137

Ribbon, customizing

static variables, 103–104

macros, adding to, 324–325

Step value, using, 157

manually, 321–324

StopClock procedure, 183

overview, 321–322

String function, 137

XML, using, 325–329

strings, in variables, 106

Right function, 137

structured programming, 147

Rnd function, 137

Sub procedures

Row property, 121–122

calling function from, 75–76

rows, selecting, 218

directly executing, 70

Index    395

Sub procedures  (continued)

user interface, accessing macros through

executing

Ribbon, customizing, 321–329

macro by using shortcut key, 71–72

shortcut menus, customizing, 329–332

overview, 68–69

UserForm Code window, viewing, 262

procedure from another, 74–75

UserForm controls

procedure from button or shape, 72–74

adding, 260–261, 276

procedure from macro dialog box, 70–71

aesthetics of, 293

overview, 65–67

aligning and spacing, 290

SUM function, 131, 138

control properties, changing, 276–278

syntax errors, differences between bugs and, 202

keyboard users, accommodating, 291–292

moving, 290

T

overview, 275

resizing, 290

tab order, changing, 291–292

testing, 292–293

TabStrip control, 288

types of

task ID, 135

CheckBox control, 279

TenByTen macro, 43–44

ComboBox control, 280

testing macros, 21

CommandButton control, 280–281

Text property, 121

Frame control, 281

TextBox control, 288–289, 311–312

Image control, 281–282

Time function, 137

Label control, 282–283

Timer function, 137

ListBox control, 283–284

TimeSerial function, 137

MultiPage control, 284–285

TimeValue function, 137, 182

OptionButton control, 285

ToggleButton control, 288–289

overview, 279

TogglePageBreaks procedure, 224

RefEdit control, 286

toolbar, VBE, 33

ScrollBar control, 286–287

TopAvg function, 352, 354

SpinButton control, 287–288

training classes, 381

TabStrip control, 288

TRANSPOSE function, 351

TextBox control, 288–289

Trim function, 138

ToggleButton control, 288–289

Type mismatch, 200

UserForm_Initialize procedure, 306

TypeName function, 123, 134–135, 138, 177

UserForms

typographical conventions, 2–3

alternatives for

folder names, getting, 253

U

GetOpenFilename method, 249–252

GetSaveAsFilename method, 252–253

UBound function, 138

InputBox function, 246–249

UCase function, 138, 257

MsgBox function, 241–246

UDF (User Defined Function).  See custom dialog boxes

overview, 240–241

UpdateClock procedure, 183

built-in dialog boxes, displaying, 254–255

UpdatePrices procedure, 200

charts, displaying in, 318–319

UpdateProgress procedure, 315, 316

creating, 258–259

User Defined Function (UDF).  See custom dialog boxes

dialog box checklists, 319–320

user forums, 379–380

396   Excel VBA Programming For Dummies

displaying, 263

VBA (Visual Basic for Applications)

example of

advantages of, 12–13

code, writing to display dialog boxes, 297–299

debugger, 206

CommandButtons, adding, 265–266

definition of, 9–10

creating, 264–265, 296–297

disadvantages of, 13

data, validating, 302

Excel compatibility with, 16

dialog boxes, testing, 300

help system, 61–62

event-handler procedures, adding, 268–269, 300–302

overview, 10–12

macros, 270–273, 299–300

speed tips, 231–235

OptionButtons, adding, 266–268

versatility of, 385

overview, 264, 296

vbAbort constant, 246

information, using from, 263–264

vbAbortRetryIgnore constant, 241

ListBoxes, using, 303–308

vbCancel constant, 246

new, inserting, 259–260

vbCritical constant, 241

OptionButtons, using multiple sets of, 310–311

vbDefaultButton1 constant, 243

overview, 239, 257–258

vbDefaultButton2 constant, 243

progress indicator, using as

vbDefaultButton3 constant, 243

modeless tabbed dialog boxes, creating, 316–318

vbDefaultButton4 constant, 243

overview, 312–313

VBE (Visual Basic Editor)

procedures, example of, 314–316

activating, 32

progress-indicator dialog box, creating, 313–314

Auto Syntax Check, turning off, 375–376

properties, changing for, 261–262

beginning and end of variable values, 375

range, selecting, 308–310

block comments, applying, 370

SpinButton, using, 311–312

Code windows, 33, 37–45

techniques for, 295

copying VBA code, 45

TextBox, using, 311–312

creating modules, 38–39

writing code for, 296

entering code directly, 39–42

inserting code in module, 39

V

minimizing and maximizing windows, 37–38

using macro recorder, 42–44

Val function, 138, 312

components, 32

Value property, 120, 303

copying multiple lines of code at once, 371

variable types, declaring, 234–235

customizing, 45–50

variables

Docking tab, 50

beginning and end values of, 375

Editor Format tab, 48–49

data types, declaring as

Editor tab, 45–48

life of, 104

General tab, 49

module-only, 102

Immediate window, 33–34

overview, 98–99

jumping between modules and procedures, 371

procedure-only, 101–102

menu bar, 33

public, 103

overview, 31–34

static, 103–104

Project windows, 33, 34–37

strings, 106

adding new vba module, 35

declaring, 383–384

exporting objects, 36

variable-size range, copying, 215–217

Index    397

VBE (Visual Basic Editor)  (continued)

Workbook Open event, 171–173

importing objects, 37

Workbook_BeforeClose event-handler procedure,

removing VBA module, 36

173–174

stepping through code, 372–373

Workbook_Open procedure

at predefined point, 374–375

creating, 170, 172

to specific line, 373–374

execution of, 332

teleporting to functions, 371–372

Workbook_SheetActivate procedure, 177

toolbar, 33

Workbook_SheetDeactivate procedure, 176

vbExclamation constant, 241

workbooks

vbIgnore constant, 246

activating/deactivating events in, 176–178

vbInformation constant, 241

setting up, 359–361

vbNo constant, 246

testing, 362

vbOK constant, 246

worksheet functions, 138–142

vbOKCancel constant, 241

Worksheet_BeforeDoubleClick procedure, 179

vbOKOnly constant, 241

worksheet-related events, 178–181

vbQuestion constant, 241

wrapper functions, 346–348

vbRetry constant, 246

ExtractElement, 347

vbRetryCancel constant, 241

IsLike, 348

vbYes constant, 246

NumberFormat, 346–347

vbYesNo constant, 241

SayIt, 348

vbYesNoCancel constant, 241

wrong data-type bugs, 202

viewing macros, 21–23

wrong version bugs, 202

Visual Basic for Applications.  See VBA

VLOOKUP worksheet function, 140–141

X XML (Extensible Markup Language), 325–329

W

watch expressions, setting, 210

Y

Watches window, 210–211

Year function, 138

WeekDay function, 138, 172

YouTube, training on, 381

With-End With structure, 235

398   Excel VBA Programming For Dummies

About the Author

Michael Alexander  is a Microsoft Certified Application Developer (MCAD) and author of several books on advanced business analysis with Microsoft Access and

Microsoft Excel. He has more than 20 years of experience consulting and developing

Microsoft Office solutions. Mike has been named a Microsoft MVP for his ongoing

contributions to the Excel community. You can find Mike at  www.datapig

technologies.com .

Publisher's Acknowledgments

Executive Editor: Katie Mohr

Production Editor: Mohammed Zafar Ali

Project Editor: Rebecca Senninger

Front Cover Image: ©sankai/iStockphoto

Sr. Editorial Assistant: Cherie Case

Document Outline

Title Page

Copyright Page

Table of Contents

Introduction

About This Book

Obligatory Typographical Conventions Section

Check Your Security Settings

Foolish Assumptions

Icons Used in This Book

Sample Files Online

Where to Go from Here

Part 1 Getting Started with Excel VBA Programming

Chapter 1 What Is VBA?

Okay, So What Is VBA?

What Can You Do with VBA?

Inserting a bunch of text

Automating a task you perform frequently

Automating repetitive operations

Creating a custom command

Creating a custom button

Developing new worksheet functions

Creating custom add-ins for Excel

Advantages and Disadvantages of VBA

VBA advantages

VBA disadvantages

VBA in a Nutshell

Excel Compatibility

Chapter 2 Jumping Right In

First Things First

What You'll Be Doing

Taking the First Steps

Recording the Macro

Testing the Macro

Examining the Macro

Modifying the Macro

Saving Workbooks That Contain Macros

Understanding Macro Security

Revealing More about the NameAndTime Macro

Part 2 How VBA Works with Excel

Chapter 3 Working in the Visual Basic Editor

What Is the Visual Basic Editor?

Activating the VBE

Understanding VBE components

Working with the Project Window

Adding a new VBA module

Removing a VBA module

Exporting and importing objects

Working with a Code Window

Minimizing and maximizing windows

Creating a module

Getting VBA code into a module

Entering code directly

Using the macro recorder

Copying VBA code

Customizing the VBA Environment

Using the Editor tab

Using the Editor Format tab

Using the General tab

Using the Docking tab

Chapter 4 Introducing the Excel Object Model

Excel Is an Object?

Climbing Down the Object Hierarchy

Wrapping Your Mind around Collections

Referring to Objects

Navigating through the hierarchy

Simplifying object references

Diving into Object Properties and Methods

Object properties

Object methods

Object events

Finding Out More

Using VBA's Help system

Using the Object Browser

Automatically listing properties and methods

Chapter 5 VBA Sub and Function Procedures

Understanding Subs versus Functions

Looking at Sub procedures

Looking at Function procedures

Naming Subs and Functions

Executing Sub procedures

Executing the Sub procedure directly

Executing the procedure from the Macro dialog box

Executing a macro by using a shortcut key

Executing the procedure from a button or shape

Executing the procedure from another procedure

Executing Function procedures

Calling the function from a Sub procedure

Calling a function from a worksheet formula

Chapter 6 Using the Excel Macro Recorder

Recording Basics

Preparing to Record

Relative or Absolute?

Recording in absolute mode

Recording in relative mode

What Gets Recorded?

Recording Options

Macro name

Shortcut key

Store Macro In option

Description

Is This Thing Efficient?

Part 3 Programming Concepts

Chapter 7 Essential VBA Language Elements

Using Comments in Your VBA Code

Using Variables, Constants, and Data Types

Understanding variables

What are VBA's data types?

Declaring and scoping variables

Working with constants

Premade constants

Working with strings

Working with dates

Using Assignment Statements

Assignment statement examples

About that equal sign

Smooth operators

Working with Arrays

Declaring arrays

Multidimensional arrays

Dynamic arrays

Using Labels

Chapter 8 Working with Range Objects

A Quick Review

Other Ways to Refer to a Range

The Cells property

The Offset property

Some Useful Range Object Properties

The Value property

The Text property

The Count property

The Column and Row properties

The Address property

The HasFormula property

The Font property

The Interior property

The Formula property

The NumberFormat property

Some Useful Range Object Methods

The Select method

The Copy and Paste methods

The Clear method

The Delete method

Chapter 9 Using VBA and Worksheet Functions

What Is a Function?

Using Built-In VBA Functions

VBA function examples

VBA functions that do more than return a value

Discovering VBA functions

Using Worksheet Functions in VBA

Worksheet function examples

Entering worksheet functions

More about using worksheet functions

Using Custom Functions

Chapter 10 Controlling Program Flow and Making Decisions

Going with the Flow, Dude

The GoTo Statement

Decisions, Decisions

The If-Then structure

The Select Case structure

Knocking Your Code for a Loop

For-Next loops

Do-While loop

Do-Until loop

Using For Each-Next Loops with Collections

Chapter 11 Automatic Procedures and Events

Preparing for the Big Event

Are events useful?

Programming event-handler procedures

Where Does the VBA Code Go?

Writing an Event-Handler Procedure

Introductory Examples

The Open event for a workbook

The BeforeClose event for a workbook

The BeforeSave event for a workbook

Examples of Activation Events

Activate and deactivate events in a sheet

Activate and deactivate events in a workbook

Workbook activation events

Other Worksheet-Related Events

The BeforeDoubleClick event

The BeforeRightClick event

The Change event

Events Not Associated with Objects

The OnTime event

Keypress events

Chapter 12 Error-Handling Techniques

Types of Errors

An Erroneous Example

The macro's not quite perfect

The macro is still not perfect

Is the macro perfect yet?

Giving up on perfection

Handling Errors Another Way

Revisiting the EnterSquareRoot procedure

About the On Error statement

Handling Errors: The Details

Resuming after an error

Error handling in a nutshell

Knowing when to ignore errors

Identifying specific errors

An Intentional Error

Chapter 13 Bug Extermination Techniques

Species of Bugs

Identifying Bugs

Debugging Techniques

Examining your code

Using the MsgBox function

Inserting Debug.Print statements

Using the VBA debugger

About the Debugger

Setting breakpoints in your code

Using the Watches window

Using the Locals window

Bug Reduction Tips

Chapter 14 VBA Programming Examples

Working with Ranges

Copying a range

Copying a variable-size range

Selecting to the end of a row or column

Selecting a row or column

Moving a range

Looping through a range efficiently

Looping through a range efficiently (Part II)

Prompting for a cell value

Determining the selection type

Identifying a multiple selection

Changing Excel Settings

Changing Boolean settings

Changing non-Boolean settings

Working with Charts

AddChart versus AddChart2

Modifying the chart type

Looping through the ChartObjects collection

Modifying chart properties

Applying chart formatting

VBA Speed Tips

Turning off screen updating

Turning off automatic calculation

Eliminating those pesky alert messages

Simplifying object references

Declaring variable types

Using the With-End With structure

Part 4 Communicating with Your Users

Chapter 15 Simple Dialog Boxes

UserForm Alternatives

The MsgBox Function

Displaying a simple message box

Getting a response from a message box

Customizing message boxes

The InputBox Function

InputBox syntax

An InputBox example

Another type of InputBox

The GetOpenFilename Method

The syntax for the GetOpenFilename method

A GetOpenFilename example

The GetSaveAsFilename Method

Getting a Folder Name

Displaying Excel's Built-in Dialog Boxes

Chapter 16 UserForm Basics

Knowing When to Use a UserForm

Creating UserForms: An Overview

Working with UserForms

Inserting a new UserForm

Adding controls to a UserForm

Changing properties for a UserForm control

Viewing the UserForm Code window

Displaying a UserForm

Using information from a UserForm

A UserForm Example

Creating the UserForm

Adding the CommandButtons

Adding the OptionButtons

Adding event-handler procedures

Creating a macro to display the dialog box

Making the macro available

Testing the macro

Chapter 17 Using UserForm Controls

Getting Started with Dialog Box Controls

Adding controls

Introducing control properties

Dialog Box Controls: The Details

CheckBox control

ComboBox control

CommandButton control

Frame control

Image control

Label control

ListBox control

MultiPage control

OptionButton control

RefEdit control

ScrollBar control

SpinButton control

TabStrip control

TextBox control

ToggleButton control

Working with Dialog Box Controls

Moving and resizing controls

Aligning and spacing controls

Accommodating keyboard users

Testing a UserForm

Dialog Box Aesthetics

Chapter 18 UserForm Techniques and Tricks

Using Dialog Boxes

A UserForm Example

Creating the dialog box

Writing code to display the dialog box

Making the macro available

Trying out your dialog box

Adding event-handler procedures

Validating the data

Now the dialog box works

A ListBox Example

Filling a ListBox

Determining the selected item

Determining multiple selections

Selecting a Range

Using Multiple Sets of OptionButtons

Using a SpinButton and a TextBox

Using a UserForm as a Progress Indicator

Creating the progress-indicator dialog box

The procedures

How this example works

Creating a Modeless Tabbed Dialog Box

Displaying a Chart in a UserForm

A Dialog Box Checklist

Chapter 19 Accessing Your Macros through the User Interface

Customizing the Ribbon

Customizing the Ribbon manually

Adding a macro to the Ribbon

Customizing the Ribbon with XML

Customizing Shortcut Menus

Adding a new item to the Cell shortcut menu

What's different since Excel 2007?

Part 5 Putting It All Together

Chapter 20 Creating Worksheet Functions — and Living to Tell about It

Why Create Custom Functions?

Understanding VBA Function Basics

Writing Functions

Working with Function Arguments

A function with no argument

A function with one argument

A function with two arguments

A function with a range argument

A function with an optional argument

Introducing Wrapper Functions

The NumberFormat function

The ExtractElement function

The SayIt function

The IsLike function

Working with Functions That Return an Array

Returning an array of month names

Returning a sorted list

Using the Insert Function Dialog Box

Displaying the function's description

Adding argument descriptions

Chapter 21 Creating Excel Add-Ins

Okay . . . So What's an Add-In?

Why Create Add-Ins?

Working with Add-Ins

Understanding Add-In Basics

Looking at an Add-In Example

Setting up the workbook

Testing the workbook

Adding descriptive information

Protecting the VBA code

Creating the add-in

Opening the add-in

Distributing the add-in

Modifying the add-in

Part 6 The Part of Tens

Chapter 22 Ten Handy Visual Basic Editor Tips

Applying Block Comments

Copying Multiple Lines of Code at Once

Jumping between Modules and Procedures

Teleporting to Your Functions

Staying in the Right Procedure

Stepping Through Your Code

Stepping to a Specific Line in Your Code

Stopping Your Code at a Predefined Point

Seeing the Beginning and End of Variable Values

Turning Off Auto Syntax Check

Chapter 23 Resources for VBA Help

Letting Excel Write Code for You

Pilfering Code from the Internet

Leveraging User Forums

Visiting Expert Blogs

Mining YouTube for Video Training

Attending Live and Online Training Classes

Learning from the Microsoft Office Dev Center

Dissecting the Other Excel Files in Your Organization

Asking Your Local Excel Guru

Chapter 24 Ten VBA Do's and Don'ts

Do Declare All Variables

Don't Confuse Passwords with Security

Do Clean Up Your Code

Don't Put Everything in One Procedure

Do Consider Other Software

Don't Assume That Everyone Enables Macros

Do Get in the Habit of Experimenting

Don't Assume That Your Code Will Work with Other Excel Versions

Do Keep Your Users in Mind

Don't Forget About Backups

Index

EULA

