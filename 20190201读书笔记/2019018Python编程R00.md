# 2019018Python编程R00

## 记忆时间

2019-12-10；2020-01-17

## 卡片

### 0101. 主题卡——Python 编程规范汇总

Python 编程规范汇总：

1、函数名用小写单词加下划线（不同于 Java、PHP 中的驼峰命名）。

2、定义函数，给形参指定默认值时，等号两边不要有空格。

3、类名应采用「驼峰命名法」，即将类名中的每个单词的首字母都大写，而不使用下划线。实例名和模块名都采用小写格式，并在单词之间加上下划线。

4、对于每个类，都应紧跟在类定义后面包含一个文档字符串。这种文档字符串简要地描述类的功能，并遵循编写函数的文档字符串时采用的格式约定。每个模块也都应包含一个文档字符串，对其中的类可用于做什么进行描述。

5、可使用空行来组织代码，但不要滥用。在类中，可使用一个空行来分隔方法；而在模块中，可使用两个空行来分隔类。

6、需要同时导入标准库中的模块和你编写的模块时，先编写导入标准库模块的 import 语句，再添加一个空行，然后编写导入你自己编写的模块的 import 语句。在包含多条 import 语句的程序中，这种做法让人更容易明白程序使用的各个模块都来自何方。

### 0201. 术语卡——

### 0202. 术语卡——

### 0301. 人名卡——

根据这些证据和案例，找出源头和提出术语的人是谁——产生一张人名卡，并且分析他为什么牛，有哪些作品，生平经历是什么。

### 0401. 金句卡——

最后根据他写的非常震撼的话语——产生一张金句卡。

### 0501. 任意卡——break 和 continue 的使用原则

首先这两个都只是针对循环语句的。1）break 是直接从该点退出循环，不执行其后面的语句，退出循环；2）continue 是直接从该点返回到判断语句，也是忽略后面的语句，但不退出循环。

## 前言

如何学习编写第一个程序，每个程序员都有不同的故事。我还是个孩子时就开始学习编程了，当时我父亲在计算时代的先锋之一——数字设备公司（Digital Equipment Corporation）工作。我使用一台简陋的计算机编写了第一个程序，这台计算机是父亲在家里的地下室组装而成的，它没有机箱，裸露的主板与键盘相连，显示器是裸露的阴极射线管。我编写的这个程序是一款简单的猜数字游戏，其输出类似于下面这样。

看到家人玩着我编写的游戏，而且它完全按我预期的方式运行，我心里不知有多满足。此情此景我永远都忘不了。儿童时期的这种体验一直影响我至今。现在，每当我通过编写程序解决了一个问题时，心里都会感到非常满足。相比于孩提时期，我现在编写的软件满足了更大的需求，但通过编写程序获得的满足感几乎与从前一样。

本书旨在让你成为优秀的程序员，具体地说，是优秀的 Python 程序员。通过阅读本书，你将迅速掌握编程概念，打下坚实的基础，并养成良好的习惯。阅读本书后，你就可以开始学习 Python 高级技术，并能够更轻松地掌握其他编程语言。

在本书的第一部分，你将学习编写 Python 程序时需要熟悉的基本编程概念，你刚接触几乎任何编程语言时都需要学习这些概念。你将学习各种数据以及在程序中将数据存储到列表和字典中的方式。你将学习如何创建数据集合以及如何高效地遍历这些集合。你将学习使用 while 和 if 语句来检查条件，并在条件满足时执行代码的一部分，而在条件不满足时执行代码的另一部分——这可为自动完成处理提供极大的帮助。

你将学习获取用户输入，让程序能够与用户交互，并在用户没停止输入时保持运行状态。你将探索如何编写函数来让程序的各个部分可重用，这样你编写执行特定任务的代码后，想使用它多少次都可以。然后，你将学习使用类来扩展这种概念以实现更复杂的行为，从而让非常简单的程序也能处理各种不同的情形。你将学习编写妥善处理常见错误的程序。学习这些基本概念后，你就能编写一些简短的程序来解决一些明确的问题。最后，你将向中级编程迈出第一步，学习如何为代码编写测试，以便在进一步改进程序时不用担心可能引入 bug。第一部分介绍的知识让你能够开发更大、更复杂的项目。

在第二部分，你将利用在第一部分学到的知识来开发三个项目。你可以根据自己的情况，以最合适的顺序完成这些项目；你也可以选择只完成其中的某些项目。在第一个项目（第 12~14 章）中，你将创建一个类似于《太空入侵者》的射击游戏。这个游戏名为《外星人入侵》，它包含多个难度不断增加的等级。完成这个项目后，你就能够自己动手开发 2D 游戏了。

第二个项目（第 15~17 章）介绍数据可视化。数据科学家的目标是通过各种可视化技术来搞懂海量信息。你将使用通过代码生成的数据集、已经从网络下载下来的数据集以及程序自动下载的数据集。完成这个项目后，你将能够编写能对大型数据集进行筛选的程序，并以可视化方式将筛选出来的数据呈现出来。

在第三个项目（第 18~20 章）中，你将创建一个名为「学习笔记」的小型 Web 应用程序。这个项目能够让用户将学到的与特定主题相关的概念记录下来。你将能够分别记录不同的主题，还可以让其他人建立账户并开始记录自己的学习笔记。你还将学习如何部署这个项目，让任何人都能够通过网络访问它，而不管他身处何方。

## 总结汇总

1、初步了解 Python，安装 Python3，安装文本编辑器 sublime text。

2、如何使用变量和字符串和数字的数据类型。

3、列表的概念，以及如何使用其元素，比如访问、修改、删除、增加、排序、确定长度、避免索引错误等等。

4、如何遍历列表里的元素（for 循环），学会避免缩进错误，如何创建以及使用数字列表，如何对列表切片，如何复制一个列表，如何创建一个元组，如何设置 Python 的代码格式。

5、如何使用 if 语句，比如简单的 if 语句、if-else 语句和 if-elif-else 结构，再比如包括加了关键词 add 和 or 的；学会使用 for 循环遍历列表的同时结合 if 语句。

6、字典的概念；如何使用字典（创建、修改、访问元素、遍历、删除等）；字典的嵌套，比如列表里存放字典、字典里存放列表、字典里存放字典。

7、如何使用输入函数 input()，主要是针对字符串的输入；数字的输入用 int()；while 循环的使用；如何使用 while 循环来处理列表和字典。

8、如何定义一个函数；实参传递给函数的几种方式（顺序实参、关键词实参、默认值）；函数返回值的使用；如何将函数与列表、字典、if 语句、while 语句等结合起来使用，比如把列表当作一个形参在函数里传递列表；如何将函数存储成一个模块供其他函数使用。

9、类的概念；如何创建和使用类（创建一个类后实例化，然后调用其属性和方法，以及如何修改实例的属性值）；如何使用类的继承；如何导入一个类（导入单个类、在一个模块里存储多个类、在一个模块里导入多个类、在一个模块里导入另一个模块等）。

10、如何读取数据；如何写入数据；如何处理异常；如何用 json 存储 Python 的数据结构。

11、如何使用模块 unittest 中的工具来为函数和类编写测试。

## 0101. 起步

如果你按前面的步骤做，应该能够成功地搭建编程环境。但如果你始终无法运行程序 hello_world.py，可尝试如下几个解决方案。

1. 程序存在严重的错误时，Python 将显示 traceback。Python 会仔细研究文件，试图找出其中的问题。trackback 可能会提供线索，让你知道是什么问题让程序无法运行。

2. 离开计算机，先休息一会儿，再尝试。别忘了，在编程中，语法非常重要，即便是少一个冒号、引号不匹配或括号不匹配，都可能导致程序无法正确地运行。请再次阅读本章相关的内容，再次审视你所做的工作，看看能否找出错误。

3. 推倒重来。你也许不需要把一切都推倒重来，但将文件hello_world.py删除并重新创建它也许是合理的选择。

4. 让别人在你的计算机或其他计算机上按本章的步骤重做一遍，并仔细观察。你可能遗漏了一小步，而别人刚好没有遗漏。

5. 请懂 Python 的人帮忙。当你有这样的想法时，可能会发现在你认识的人当中就有人使用 Python。

6. 本章的安装说明在网上也可以找到，其网址为 https://www.nostarch.com/pythoncrash-course/。对你来说，在线版也许更合适。

7. 到网上寻求帮助。附录 C 提供了很多在线资源，如论坛或在线聊天网站，你可以前往这些地方，请求解决过你面临的问题的人提供解决方案。

1『第 6 条里的这个网站：[Art & Design | No Starch Press](https://nostarch.com/catalog/art-photography-design)』

## 0201. 变量和简单数据类型

在 Python 中使用变量时，需要遵守一些规则和指南。违反这些规则将引发错误，而指南旨在让你编写的代码更容易阅读和理解。请务必牢记下述有关变量的规则。

1. 变量名只能包含字母、数字和下划线。变量名可以字母或下划线打头，但不能以数字打头，例如，可将变量命名为 message_1，但不能将其命名为 1_message。

2. 变量名不能包含空格，但可使用下划线来分隔其中的单词。例如，变量名 greeting_message 可行，但变量名 greeting message 会引发错误。

3. 不要将 Python 关键字和函数名用作变量名，即不要使用 Python 保留用于特殊用途的单词，如 print （请参见附录 A.4）。

4. 变量名应既简短又具有描述性。例如，name 比 n 好，student_name 比 s_n 好，name_length 比 length_of_persons_name 好。

5. 慎用小写字母 l 和大写字母 O，因为它们可能被人错看成数字 1 和 0。

要创建良好的变量名，需要经过一定的实践，在程序复杂而有趣时尤其如此。随着你编写的程序越来越多，并开始阅读别人编写的代码，将越来越善于创建有意义的变量名。

1『字符串涉及到的字符串函数有：1）首个字母变大写 title() 、修改成大写 upper()、修改成小写 lower()。2）剔除函数，删除首个空格 lstrip() 、删除末尾空格 rstrip() 和同时删除首个及末尾空格 strip()。3）拼接用 +。4）制表符 \t、换行符 \n。5）把数据类型转化为字符串 str()。』

在 Python 中，注释用井号（# ）标识。井号后面的内容都会被 Python 解释器忽略，如下所示：

编写注释的主要目的是阐述代码要做什么，以及是如何做的。在开发项目期间，你对各个部分如何协同工作了如指掌，但过段时间后，有些细节你可能不记得了。当然，你总是可以通过研究代码来确定各个部分的工作原理，但通过编写注释，以清晰的自然语言对解决方案进行概述，可节省很多时间。

要成为专业程序员或与其他程序员合作，就必须编写有意义的注释。当前，大多数软件都是合作编写的，编写者可能是同一家公司的多名员工，也可能是众多致力于同一个开源项目的人员。训练有素的程序员都希望代码中包含注释，因此你最好从现在开始就在程序中添加描述性注释。作为新手，最值得养成的习惯之一是，在代码中编写清晰、简洁的注释。

如果不确定是否要编写注释，就问问自己，找到合理的解决方案前，是否考虑了多个解决方案。如果答案是肯定的，就编写注释对你的解决方案进行说明吧。相比回过头去再添加注释，删除多余的注释要容易得多。

编程语言 Perl 曾在互联网领域长期占据着统治地位，早期的大多数交互式网站使用的都是 Perl 脚本。彼时，「解决问题的办法有多个」被 Perl 社区奉为座右铭。这种理念一度深受大家的喜爱，因为这种语言固有的灵活性使得大多数问题都有很多不同的解决之道。在开发项目期间，这种灵活性是可以接受的，但大家最终认识到，过于强调灵活性会导致大型项目难以维护：要通过研究代码搞清楚当时解决复杂问题的人是怎么想的，既困难又麻烦，还会耗费大量的时间。

经验丰富的程序员倡导尽可能避繁就简。Python 社区的理念都包含在 Tim Peters 撰写的「Python 之禅」中。要获悉这些有关编写优秀 Python 代码的指导原则，只需在解释器中执行命令 import this。这里不打算赘述整个「Python 之禅」，而只与大家分享其中的几条原则，让你明白为何它们对 Python 新手来说至关重要。

Python 程序员笃信代码可以编写得漂亮而优雅。编程是要解决问题的，设计良好、高效而漂亮的解决方案都会让程序员心生敬意。随着你对 Python 的认识越来越深入，并使用它来编写越来越多的代码，有一天也许会有人站在你后面惊呼：「哇，代码编写得真是漂亮！」

Simple is better than complex.

如果有两个解决方案，一个简单，一个复杂，但都行之有效，就选择简单的解决方案吧。这样，你编写的代码将更容易维护，你或他人以后改进这些代码时也会更容易。

Complex is better than complicated.

现实是复杂的，有时候可能没有简单的解决方案。在这种情况下，就选择最简单可行的解决方案吧。

Readability counts.

即便是复杂的代码，也要让它易于理解。开发的项目涉及复杂代码时，一定要为这些代码编写有益的注释。

There should be one -- and preferably only one -- obvious way to do it.

如果让两名 Python 程序员去解决同一个问题，他们提供的解决方案应大致相同。这并不是说编程没有创意空间，而是恰恰相反！然而，大部分编程工作都是使用常见解决方案来解决简单的小问题，但这些小问题都包含在更庞大、更有创意空间的项目中。在你的程序中，各种具体细节对其他 Python 程序员来说都应易于理解。

Now is better than never.

你可以将余生都用来学习 Python 和编程的纷繁难懂之处，但这样你什么项目都完不成。不要企图编写完美无缺的代码；先编写行之有效的代码，再决定是对其做进一步改进，还是转而去编写新代码。

等你进入下一章，开始研究更复杂的主题时，务必牢记这种简约而清晰的理念。如此，经验丰富的程序员定将对你编写的代码心生敬意，进而乐意向你提供反馈，并与你合作开发有趣的项目。

3『

python 交互解释器里输入 import this

	>>> import this

The Zen of Python, by Tim Peters

Beautiful is better than ugly.

Explicit is better than implicit.

Simple is better than complex.

Complex is better than complicated.

Flat is better than nested.

Sparse is better than dense.

Readability counts.

Special cases aren't special enough to break the rules.

Although practicality beats purity.

Errors should never pass silently.

Unless explicitly silenced.

In the face of ambiguity, refuse the temptation to guess.

There should be one-- and preferably only one --obvious way to do it.

Although that way may not be obvious at first unless you're Dutch.

Now is better than never.

Although never is often better than *right* now.

If the implementation is hard to explain, it's a bad idea.

If the implementation is easy to explain, it may be a good idea.

Namespaces are one honking great idea -- let's do more of those!

[免费中文Python电子书（教程） - FooFish-Python之禅](https://foofish.net/python-free-ebook.html)

』

## 0301. 列表简介

在本章中，你学习了：列表是什么以及如何使用其中的元素；如何定义列表以及如何增删元素；如何对列表进行永久性排序，以及如何为展示列表而进行临时排序；如何确定列表的长度，以及在使用列表时如何避免索引错误。

在本章和下一章中，你将学习列表是什么以及如何使用列表元素。列表让你能够在一个地方存储成组的信息，其中可以只包含几个元素，也可以包含数百万个元素。列表是新手可直接使用的最强大的 Python 功能之一，它融合了众多重要的编程概念。

列表由一系列按特定顺序排列的元素组成。你可以创建包含字母表中所有字母、数字 0~9 或所有家庭成员姓名的列表；也可以将任何东西加入列表中，其中的元素之间可以没有任何关系。鉴于列表通常包含多个元素，给列表指定一个表示复数的名称（如 letters 、digits 或 names ）是个不错的主意。

在 Python 中，第一个列表元素的索引为 0，而不是 1。在大多数编程语言中都是如此，这与列表操作的底层实现相关。根据这种简单的计数方式，要访问列表的任何元素，都可将其位置减 1，并将结果作为索引。例如，要访问第四个列表元素，可使用索引 3。Python 为访问最后一个列表元素提供了一种特殊语法。通过将索引指定为 -1，可让 Python 返回最后一个列表元素。这种语法很有用，因为你经常需要在不知道列表长度的情况下访问最后的元素。这种约定也适用于其他负数索引，例如，索引 -2 返回倒数第二个列表元素，索引 -3 返回倒数第三个列表元素，以此类推。

你创建的大多数列表都将是动态的，这意味着列表创建后，将随着程序的运行增删元素。例如，你创建一个游戏，要求玩家射杀从天而降的外星人；为此，可在开始时将一些外星人存储在列表中，然后每当有外星人被射杀时，都将其从列表中删除，而每次有新的外星人出现在屏幕上时，都将其添加到列表中。在整个游戏运行期间，外星人列表的长度将不断变化。

方法 append() 让动态地创建列表易如反掌，例如，你可以先创建一个空列表，再使用一系列的 append() 语句添加元素。下面来创建一个空列表，再在其中添加元素 'honda' 、'yamaha' 和 'suzuki' ：

这种创建列表的方式极其常见，因为经常要等程序运行后，你才知道用户要在程序中存储哪些数据。为控制用户，可首先创建一个空列表，用于存储用户将要输入的值，然后将用户提供的每个新值附加到列表中。

使用方法 insert() 可在列表的任何位置添加新元素。为此，你需要指定新元素的索引和值。

有时候，你要将元素从列表中删除，并接着使用它的值。例如，你可能需要获取刚被射杀的外星人的 x 和 y 坐标，以便在相应的位置显示爆炸效果；在 Web 应用程序中，你可能要将用户从活跃成员列表中删除，并将其加入到非活跃成员列表中。方法 pop() 可删除列表末尾的元素，并让你能够接着使用它。术语弹出 （pop）源自这样的类比：列表就像一个栈，而删除列表末尾的元素相当于弹出栈顶元素。

方法 pop() 是怎么起作用的呢？假设列表中的摩托车是按购买时间存储的，就可使用方法 pop() 打印一条消息，指出最后购买的是哪款摩托车。

如果你不确定该使用 del 语句还是 pop() 方法，下面是一个简单的判断标准：如果你要从列表中删除一个元素，且不再以任何方式使用它，就使用 del 语句；如果你要在删除元素后还能继续使用它，就使用方法 pop()。

方法 remove() 只删除第一个指定的值。如果要删除的值可能在列表中出现多次，就需要使用循环来判断是否删除了所有这样的值。你将在第 7 章学习如何这样做。

在你创建的列表中，元素的排列顺序常常是无法预测的，因为你并非总能控制用户提供数据的顺序。这虽然在大多数情况下都是不可避免的，但你经常需要以特定的顺序呈现信息。有时候，你希望保留列表元素最初的排列顺序，而有时候又需要调整排列顺序。Python 提供了很多组织列表的方式，可根据具体情况选用。

在并非所有的值都是小写时，按字母顺序排列列表要复杂些。决定排列顺序时，有多种解读大写字母的方式，要指定准确的排列顺序，可能比我们这里所做的要复杂。然而，大多数排序方式都基于本节介绍的知识。

要反转列表元素的排列顺序，可使用方法 reverse()。假设汽车列表是按购买时间排列的，可轻松地按相反的顺序排列其中的汽车。方法 reverse() 永久性地修改列表元素的排列顺序，但可随时恢复到原来的排列顺序，为此只需对列表再次调用 reverse() 即可。

使用函数 len() 可快速获悉列表的长度。在你需要完成如下任务时，len() 很有用：确定还有多少个外星人未被射杀，需要管理多少项可视化数据，网站有多少注册用户等。

刚开始使用列表时，经常会遇到一种错误。假设你有一个包含三个元素的列表，却要求获取第四个元素，这将导致索引错误。发生索引错误却找不到解决办法时，请尝试将列表或其长度打印出来。列表可能与你以为的截然不同，在程序对其进行了动态处理时尤其如此。通过查看列表或其包含的元素数，可帮助你找出这种逻辑错误。

1『列表涉及到的方法有：1）列组末尾增加元素的 append()。2）列组特定索引位置处增加元素 insert()。3）列组特定索引位置处弹出元素 pop()，也可以用语句 del。如果不知道该元素的索引号，但知道它的「值」，可以用方法 remove()。4）对列组里的元素进行永久性按字母顺序排序 sort()，临时性排序的话用 sorted()。5）将列表里的元素反转 reverse()。6）使用函数 len() 可快速获悉列表的长度，len(cars)。』

## 0401. 操作列表

在本章中，你学习了：如何高效地处理列表中的元素；如何使用 for 循环遍历列表，Python 如何根据缩进来确定程序的结构以及如何避免一些常见的缩进错误；如何创建简单的数字列表，以及可对数字列表执行的一些操作；如何通过切片来使用列表的一部分和复制列表。你还学习了元组（它对不应变化的值提供了一定程度的保护），以及在代码变得越来越复杂时如何设置格式，使其易于阅读。

在本章中，你将学习如何遍历整个列表，这只需要几行代码，无论列表有多长。循环让你能够对列表的每个元素都采取一个或一系列相同的措施，从而高效地处理任何长度的列表，包括包含数千乃至数百万个元素的列表。

你经常需要遍历列表的所有元素，对每个元素执行相同的操作。例如，在游戏中，可能需要将每个界面元素平移相同的距离；对于包含数字的列表，可能需要对每个元素执行相同的统计运算；在网站中，可能需要显示文章列表中的每个标题。需要对列表中的每个元素都执行相同的操作时，可使用 Python 中的 for 循环。

假设我们有一个魔术师名单，需要将其中每个魔术师的名字都打印出来。为此，我们可以分别获取名单中的每个名字，但这种做法会导致多个问题。例如，如果名单很长，将包含大量重复的代码。另外，每当名单的长度发生变化时，都必须修改代码。通过使用 for 循环，可让 Python 去处理这些问题。

1『 for 后面有个冒号 :，并且下面的 print() 语句一定要缩进。』

Python 再次打印变量 magician 的值——当前为 'david'。接下来，Python 再次执行整个循环，对列表中的最后一个值——'carolina' 进行处理。至此，列表中没有其他的值了，因此 Python 接着执行程序的下一行代码。在这个示例中，for 循环后面没有其他的代码，因此程序就此结束。

刚开始使用循环时请牢记，对列表中的每个元素，都将执行循环指定的步骤，而不管列表包含多少个元素。如果列表包含一百万个元素，Python 就重复执行指定的步骤一百万次，且通常速度非常快。

另外，编写 for 循环时，对于用于存储列表中每个值的临时变量，可指定任何名称。然而，选择描述单个列表元素的有意义的名称大有帮助。例如，对于小猫列表、小狗列表和一般性列表，像下面这样编写 for  循环的第一行代码是不错的选择。

在 for 循环中，想包含多少行代码都可以。在代码行 for magician in magicians 后面，每个缩进的代码行都是循环的一部分，且将针对列表中的每个值都执行一次。因此，可对列表中的每个值执行任意次数的操作。

在 for 循环后面，没有缩进的代码都只执行一次，而不会重复执行。

使用 for 循环处理数据是一种对数据集执行整体操作的不错的方式。例如，你可能使用 for 循环来初始化游戏——遍历角色列表，将每个角色都显示到屏幕上；再在循环后面添加一个不缩进的代码块，在屏幕上绘制所有角色后显示一个 Play Now 按钮。

Python 根据缩进来判断代码行与前一个代码行的关系。在前面的示例中，向各位魔术师显示消息的代码行是 for 循环的一部分，因为它们缩进了。Python 通过使用缩进让代码更易读；简单地说，它要求你使用缩进让代码整洁而结构清晰。在较长的 Python 程序中，你将看到缩进程度各不相同的代码块，这让你对程序的组织结构有大致的认识。

当你开始编写必须正确缩进的代码时，需要注意一些常见的缩进错误。例如，有时候，程序员会将不需要缩进的代码块缩进，而对于必须缩进的代码块却忘了缩进。通过查看这样的错误示例，有助于你以后避开它们，以及在它们出现在程序中时进行修复。

有时候，循环能够运行而不会报告错误，但结果可能会出乎意料。试图在循环中执行多项任务，却忘记缩进其中的一些代码行时，就会出现这种情况。

例如，如果忘记缩进循环中的第 2 行代码（它告诉每位魔术师，我们期待他的下一次表演），就会出现这种情况。第二条 print 语句（见❶）原本需要缩进，但 Python 发现 for 语句后面有一行代码是缩进的，因此它没有报告错误。最终的结果是，对于列表中的每位魔术师，都执行了第一条 print 语句，因为它缩进了；而第二条 print 语句没有缩进，因此它只在循环结束后执行一次。由于变量 magician 的终值为 'carolina'，因此只有她收到了消息 “looking forward to the next trick”。

为避免意外缩进错误，请只缩进需要缩进的代码。在前面编写的程序中，只有要在 for 循环中对每个元素执行的代码需要缩进。

这也是一个逻辑错误，与 4.2.2 节的错误类似。Python 不知道你的本意，只要代码符合语法，它就会运行。如果原本只应执行一次的操作执行了多次，请确定你是否不应该缩进执行该操作的代码。

1『所以说很多 bug 都是逻辑错误。』

for 语句末尾的冒号告诉 Python，下一行是循环的第一行。

需要存储一组数字的原因有很多，例如，在游戏中，需要跟踪每个角色的位置，还可能需要跟踪玩家的几个最高得分。在数据可视化中，处理的几乎都是由数字（如温度、距离、人口数量、经度和纬度等）组成的集合。

列表非常适合用于存储数字集合，而 Python 提供了很多工具，可帮助你高效地处理数字列表。明白如何有效地使用这些工具后，即便列表包含数百万个元素，你编写的代码也能运行得很好。

1『基本思路是用列表、字典等方式储存数据，然后调用各种强大的第三方库来操作这些数据做分析。』

要创建数字列表，可使用函数 list() 将 range() 的结果直接转换为列表。如果将 range() 作为 list() 的参数，输出将为一个数字列表。

使用函数 range() 时，还可指定步长。例如，下面的代码打印 1~10 内的偶数：range(1, 11, 2)。

使用函数 range() 几乎能够创建任何需要的数字集，例如，如何创建一个列表，其中包含前 10 个整数（即 1~10）的平方呢？在 Python 中，两个星号（** ）表示乘方运算。下面的代码演示了如何将前 10 个整数的平方加入到一个列表中。

```py
❶ squares = []
❷ for value in range(1,11):
	❸ square = value**2
	❹ squares.append(square)
❺ print(squares)

# 不用临时变量
squares = []
for value in range(1,11):
	❶ squares.append(value**2)
print(squares)
```

1『创建数字型列表就用 range() 和 list() 的结合体。』

创建更复杂的列表时，可使用上述两种方法中的任何一种。有时候，使用临时变量会让代码更易读；而在其他情况下，这样做只会让代码无谓地变长。你首先应该考虑的是，编写清晰易懂且能完成所需功能的代码；等到审核代码时，再考虑采用更高效的方法。

1『个人认为，用不用临时变量得试具体情况而定。回复：现在反而觉得应该别用临时变量，更简洁，也是重构里推荐的手段。（2020-08-28）』

前面介绍的生成列表 squares 的方式包含三四行代码，而列表解析让你只需编写一行代码就能生成这样的列表。列表解析将 for 循环和创建新元素的代码合并成一行，并自动附加新元素。面向初学者的书籍并非都会介绍列表解析，这里之所以介绍列表解析，是因为等你开始阅读他人编写的代码时，很可能会遇到它们。

```py
squares = [value**2 for value in range(1,11)]
print(squares)
```

要使用这种语法，首先指定一个描述性的列表名，如 squares；然后，指定一个左方括号，并定义一个表达式，用于生成你要存储到列表中的值。在这个示例中，表达式为 value^2，它计算平方值。接下来，编写一个 for 循环，用于给表达式提供值，再加上右方括号。在这个示例中，for 循环为 for value in range(1,11)，它将值 1~10 提供给表达式 value**2。请注意，这里的 for 语句末尾没有冒号。

2『好好去了解一下列表解析的概念。回复：能用列表解析的实现就用列表解析，简洁嘛，而且在 pandas 作者的那本书（数据分析的那本）里也推荐过这种实现。（2020-08-28）』

1『数字列表涉及到的函数：1）range() 函数可以生成一系列数字，将 range() 函数与 list() 函数结合起来即可创建数字列表。2）对数字列表简单计算的函数，比如取最大值 max()，取最小值 min()，取和 sum()。』

在第 3 章中，你学习了如何访问单个列表元素。在本章中，你一直在学习如何处理列表的所有元素。你还可以处理列表的部分元素——Python 称之为切片。

要创建切片，可指定要使用的第一个元素和最后一个元素的索引。与函数 range() 一样，Python 在到达你指定的第二个索引前面的元素后停止。要输出列表中的前三个元素，需要指定索引 0~3，这将输出分别为 0 、1 和 2 的元素。

在很多情况下，切片都很有用。例如，编写游戏时，你可以在玩家退出游戏时将其最终得分加入到一个列表中。然后，为获取该玩家的三个最高得分，你可以将该列表按降序排列，再创建一个只包含前三个得分的切片。处理数据时，可使用切片来进行批量处理；编写 Web 应用程序时，可使用切片来分页显示信息，并在每页显示数量合适的信息。

1『上面的都是切片的实际应用场景。』

要复制列表，可创建一个包含整个列表的切片，方法是同时省略起始索引和终止索引（[:] ）。这让 Python 创建一个始于第一个元素，终止于最后一个元素的切片，即复制整个列表。

```py
my_foods = ['pizza', 'falafel', 'carrot cake']

#这行不通
❶ friend_foods = my_foods
my_foods.append('cannoli')
friend_foods.append('ice cream')
print("My favorite foods are:")
print(my_foods)
print("\nMy friend's favorite foods are:")
print(friend_foods)
```

这里将 my\_foods 赋给 friend\_foods，而不是将 my\_foods 的副本存储到 friend_foods （见❶）。这种语法实际上是让 Python 将新变量 friend_foods 关联到包含在 my_foods 中的列表，因此这两个变量都指向同一个列表。鉴于此，当我们将 'cannoli' 添加到 my\_foods 中时，它也将出现在 friend\_foods 中；同样，虽然 'ice cream' 好像只被加入到了 friend\_foods 中，但它也将出现在这两个列表中。

1『复制列表副本的话：friend_foods = my_foods[:] 』

列表非常适合用于存储在程序运行期间可能变化的数据集。列表是可以修改的，这对处理网站的用户列表或游戏中的角色列表至关重要。然而，有时候你需要创建一系列不可修改的元素，元组可以满足这种需求。

Python 将不能修改的值称为不可变的，而不可变的列表被称为元组。元组看起来犹如列表，但使用圆括号而不是方括号来标识。定义元组后，就可以使用索引来访问其元素，就像访问列表元素一样。相比于列表，元组是更简单的数据结构。如果需要存储的一组值在程序的整个生命周期内都不变，可使用元组。

随着你编写的程序越来越长，有必要了解一些代码格式设置约定。请花时间让你的代码尽可能易于阅读；让代码易于阅读有助于你掌握程序是做什么的，也可以帮助他人理解你编写的代码。为确保所有人编写的代码的结构都大致一致，Python 程序员都遵循一些格式设置约定。学会编写整洁的 Python 后，就能明白他人编写的 Python 代码的整体结构——只要他们和你遵循相同的指南。要成为专业程序员，应从现在开始就遵循这些指南，以养成良好的习惯。

若要提出 Python 语言修改建议，需要编写 Python 改进提案 （Python Enhancement Proposal，PEP）。PEP 8 是最古老的 PEP 之一，它向 Python 程序员提供了代码格式设置指南。PEP 8 的篇幅很长，但大都与复杂的编码结构相关。Python 格式设置指南的编写者深知，代码被阅读的次数比编写的次数多。代码编写出来后，调试时你需要阅读它；给程序添加新功能时，需要花很长的时间阅读代码；与其他程序员分享代码时，这些程序员也将阅读它们。如果一定要在让代码易于编写和易于阅读之间做出选择，Python 程序员几乎总是会选择后者。

1『自己现在也认同了一个观点：代码的可读性排第一位，相比于易修改、可扩展性等，因为可读是前提，看不懂其他都是扯淡，哈哈。（2020-08-28）』

PEP 8 建议每级缩进都使用四个空格，这既可提高可读性，又留下了足够的多级缩进空间。

很多 Python 程序员都建议每行不超过 80 字符。最初制定这样的指南时，在大多数计算机中，终端窗口每行只能容纳 79 字符；当前，计算机屏幕每行可容纳的字符数多得多，为何还要使用 79 字符的标准行长呢？这里有别的原因。专业程序员通常会在同一个屏幕上打开多个文件，使用标准行长可以让他们在屏幕上并排打开两三个文件时能同时看到各个文件的完整行。PEP 8 还建议注释的行长都不超过 72 字符，因为有些工具为大型项目自动生成文档时，会在每行注释开头添加格式化字符。

PEP 8 中有关行长的指南并非不可逾越的红线，有些小组将最大行长设置为 99 字符。在学习期间，你不用过多地考虑代码的行长，但别忘了，协作编写程序时，大家几乎都遵守 PEP 8 指南。在大多数编辑器中，都可设置一个视觉标志——通常是一条竖线，让你知道不能越过的界线在什么地方。

要将程序的不同部分分开，可使用空行。你应该使用空行来组织程序文件，但也不能滥用；只要按本书的示例展示的那样做，就能掌握其中的平衡。例如，如果你有 5 行创建列表的代码，还有 3 行处理该列表的代码，那么用一个空行将这两部分隔开是合适的。然而，你不应使用三四个空行将它们隔开。空行不会影响代码的运行，但会影响代码的可读性。Python 解释器根据水平缩进情况来解读代码，但不关心垂直间距。

3『 [PEP 8 -- Style Guide for Python Code | Python.org](https://www.python.org/dev/peps/pep-0008/)』

## 0501. if 语句

在本章中，你学习了如何编写结果要么为 Ture 要么为 False 的条件测试。你学习了如何编写简单的 if 语句、if-else 语句和 if-elif-else 结构。在程序中，你使用了这些结构来测试特定的条件，以确定这些条件是否满足。你学习了如何在利用高效的 for 循环的同时，以不同于其他元素的方式对特定的列表元素进行处理。你还再次学习了 Python 就代码格式方面提出的建议，这可确保即便你编写的程序越来越复杂，其代码依然易于阅读和理解。

编程时经常需要检查一系列条件，并据此决定采取什么措施。在 Python 中，if 语句让你能够检查程序的当前状态，并据此采取相应的措施。

在本章中，你将学习条件测试，以检查感兴趣的任何条件。你将学习简单的 if 语句，以及创建一系列复杂的 if 语句来确定当前到底处于什么情形。接下来，你将把学到的知识应用于列表，以编写 for 循环，以一种方式处理列表中的大多数元素，并以另一种不同的方式处理包含特定值的元素。

1『注意：if 语句和 else 语句后面都有个冒号 : 』

每条 if 语句的核心都是一个值为 True 或 False 的表达式，这种表达式被称为条件测试。Python 根据条件测试的值为 True 还是 False 来决定是否执行 if 语句中的代码。如果条件测试的值为 True，Python 就执行紧跟在 if 语句后面的代码；如果为 False，Python 就忽略这些代码。

在 Python 中检查是否相等时区分大小写。如果大小写很重要，这种行为有其优点。但如果大小写无关紧要，而只想检查变量的值，可将变量的值转换为小写，再进行比较，用 lower() 函数。函数 lower() 不会修改存储在变量 car 中的值，因此进行这样的比较时不会影响原来的变量。

网站采用类似的方式让用户输入的数据符合特定的格式。例如，网站可能使用类似的测试来确保用户名是独一无二的，而并非只是与另一个用户名的大小写不同。用户提交新的用户名时，将把它转换为小写，并与所有既有用户名的小写版本进行比较。执行这种检查时，如果已经有用户名 'john' （不管大小写如何），则用户提交用户名 'John' 时将遭到拒绝。

要判断两个值是否不等，可结合使用惊叹号和等号（!= ），其中的惊叹号表示不，在很多编程语言中都如此。

你编写的大多数条件表达式都检查两个值是否相等，但有时候检查两个值是否不等的效率更高。

在 if 语句中可使用各种数学比较，这让你能够直接检查关心的条件。

你可能想同时检查多个条件，例如，有时候你需要在两个条件都为 True 时才执行相应的操作，而有时候你只要求一个条件为 True 时就执行相应的操作。在这些情况下，关键字 and 和 or 可助你一臂之力。

要检查是否两个条件都为 True，可使用关键字 and 将两个条件测试合而为一；如果每个测试都通过了，整个表达式就为 True ；如果至少有一个测试没有通过，整个表达式就为 False。为改善可读性，可将每个测试都分别放在一对括号内，但并非必须这样做。

关键字 or 也能够让你检查多个条件，但只要至少有一个条件满足，就能通过整个测试。仅当两个测试都没有通过时，使用 or 的表达式才为 False。

有时候，执行操作前必须检查列表是否包含特定的值。例如，结束用户的注册过程前，可能需要检查他提供的用户名是否已包含在用户名列表中。在地图程序中，可能需要检查用户提交的位置是否包含在已知位置列表中。

要判断特定的值是否已包含在列表中，可使用关键字 in。来看你可能为比萨店编写的一些代码；这些代码首先创建一个列表，其中包含用户点的比萨配料，然后检查特定的配料是否包含在该列表中。还有些时候，确定特定的值未包含在列表中很重要；在这种情况下，可使用关键字 not in。例如，如果有一个列表，其中包含被禁止在论坛上发表评论的用户，就可在允许用户提交评论前检查他是否被禁言。

```py
banned_users = ['andrew', 'carolina', 'david']
user = 'marie'
❶ if user not in banned_users:
	print(user.title() + ", you can post a response if you wish.")
```

1『要能想到有些场景可以用「in」和「not in」来解决。』

随着你对编程的了解越来越深入，将遇到术语布尔表达式，它不过是条件测试的别名。与条件表达式一样，布尔表达式的结果要么为 True，要么为 False。布尔值通常用于记录条件，如游戏是否正在运行，或用户是否可以编辑网站的特定内容。

在跟踪程序状态或程序中重要的条件方面，布尔值提供了一种高效的方式。

if 语句有很多种，选择使用哪种取决于要测试的条件数。前面讨论条件测试时，列举了多个 if 语句示例，下面更深入地讨论这个主题。

简单的 if 语句。在第 1 行中，可包含任何条件测试，而在紧跟在测试后面的缩进代码块中，可执行任何操作。如果条件测试的结果为 True，Python 就会执行紧跟在 if 语句后面的代码；否则 Python 将忽略这些代码。在 if 语句中，缩进的作用与 for 循环中相同。如果测试通过了，将执行 if 语句后面所有缩进的代码行，否则将忽略它们。

经常需要在条件测试通过了时执行一个操作，并在没有通过时执行另一个操作；在这种情况下，可使用 Python 提供的 if-else 语句。if-else 语句块类似于简单的 if 语句，但其中的 else 语句让你能够指定条件测试未通过时要执行的操作。if-else 结构非常适合用于要让 Python 执行两种操作之一的情形。在这种简单的 if-else 结构中，总是会执行两个操作中的一个。

经常需要检查超过两个的情形，为此可使用 Python 提供的 if-elif-else 结构。Python 只执行 if-elif-else 结构中的一个代码块，它依次检查每个条件测试，直到遇到通过了的条件测试。测试通过后，Python 将执行紧跟在它后面的代码，并跳过余下的测试。在现实世界中，很多情况下需要考虑的情形都超过两个。可根据需要使用任意数量的 elif 代码块。

❶  处的 elif 代码块在顾客的年龄超过 65（含）时，将价格设置为 5 美元，这比使用 else 代码块更清晰些。经过这样的修改后，每个代码块都仅在通过了相应的测试时才会执行。

else 是一条包罗万象的语句，只要不满足任何 if 或 elif 中的条件测试，其中的代码就会执行，这可能会引入无效甚至恶意的数据。如果知道最终要测试的条件，应考虑使用一个 elif 代码块来代替 else 代码块。这样，你就可以肯定，仅当满足相应的条件时，你的代码才会执行。

1『如果知道所有可能的状态，可以把所有的状态都写进 elif 语句里，删掉 else 语句，这种方式可以消除不确定性，消除潜在的 bug。这个观点我是认同的。』

if-elif-else 结构功能强大，但仅适合用于只有一个条件满足的情况：遇到通过了的测试后，Python 就跳过余下的测试。这种行为很好，效率很高，让你能够测试一个特定的条件。

然而，有时候必须检查你关心的所有条件。在这种情况下，应使用一系列不包含 elif 和 else 代码块的简单 if 语句。在可能有多个条件为 True，且你需要在每个条件为 True 时都采取相应措施时，适合使用这种方法。

我们首先创建了一个列表，其中包含顾客点的配料（见❶）。❷ 处的 if 语句检查顾客是否点了配料蘑菇（'mushrooms' ），如果点了，就打印一条确认消息。❸ 处检查配料辣香肠（'pepperoni' ）的代码也是一个简单的 if 语句，而不是 elif 或 else 语句；因此不管前一个测试是否通过，都将进行这个测试。❹ 处的代码检查顾客是否要求多加芝士（'extra cheese' ）；不管前两个测试的结果如何，都会执行这些代码。每当这个程序运行时，都会进行这三个独立的测试。

总之，如果你只想执行一个代码块，就使用 if-elif-else 结构；如果要运行多个代码块，就使用一系列独立的 if 语句。

1『说到点子上了，其他语言里也一样。只需执行一个代码块用 if-elif-else 结构，要执行多个代码块用一系列 if 语句。』

通过结合使用 if 语句和列表，可完成一些有趣的任务：对列表中特定的值做特殊处理；高效地管理不断变化的情形，如餐馆是否还有特定的食材；证明代码在各种情形下都将按预期那样运行。

到目前为止，对于处理的每个列表都做了一个简单的假设，即假设它们都至少包含一个元素。我们马上就要让用户来提供存储在列表中的信息，因此不能再假设循环运行时列表不是空的。有鉴于此，在运行 for 循环前确定列表是否为空很重要。

```py
❶ requested_toppings = []
❷ if requested_toppings:
	for requested_topping in requested_toppings:
		print("Adding " + requested_topping + ".")
	print("\nFinished making your pizza!")
❸ else:
print("Are you sure you want a plain pizza?")
```

1『不错不错，直接用 if 语句来检测列表是否为空。』

在这里，我们首先创建了一个空列表，其中不包含任何配料（见❶）。在 ❷ 处我们进行了简单检查，而不是直接执行 for 循环。在 if 语句中将列表名用在条件表达式中时，Python 将在列表至少包含一个元素时返回 True，并在列表为空时返回 False。如果 requested_toppings 不为空，就运行与前一个示例相同的 for 循环；否则，就打印一条消息，询问顾客是否确实要点不加任何配料的普通比萨（见❸）。

在 ❶ 处，我们定义了一个列表，其中包含比萨店供应的配料。请注意，如果比萨店供应的配料是固定的，也可使用一个元组来存储它们。在 ❷ 处，我们又创建了一个列表，其中包含顾客点的配料，请注意那个不同寻常的配料——'french fries'。在 ❸ 处，我们遍历顾客点的配料列表。在这个循环中，对于顾客点的每种配料，我们都检查它是否包含在供应的配料列表中（见❹）；如果答案是肯定的，就将其加入到比萨中，否则将运行 else 代码块（见❺）：打印一条消息，告诉顾客不供应这种配料。

本章的每个示例都展示了良好的格式设置习惯。在条件测试的格式设置方面，PEP 8 提供的唯一建议是，在诸如 == 、>= 和 <= 等比较运算符两边各添加一个空格，例如，if age < 4: 要比 if age<4: 好。这样的空格不会影响 Python 对代码的解读，而只是让代码阅读起来更容易。

1『个人感觉，只要有冒号 :，可以形成代码块的都是要缩进的。那么，逆向想，只要有缩进的，是不是漏掉了冒号呢？』

## 0601. 字典

在本章中，你学习了：如何定义字典，以及如何使用存储在字典中的信息；如何访问和修改字典中的元素，以及如何遍历字典中的所有信息；如何遍历字典中所有的「键-值」对、所有的键和所有的值；如何在列表中嵌套字典、在字典中嵌套列表以及在字典中嵌套字典。

你将学习能够将相关信息关联起来的 Python 字典。你将学习如何访问和修改字典中的信息。鉴于字典可存储的信息量几乎不受限制，因此我们会演示如何遍历字典中的数据。另外，你还将学习存储字典的列表、存储列表的字典和存储字典的字典。理解字典后，你就能够更准确地为各种真实物体建模。你可以创建一个表示人的字典，然后想在其中存储多少信息就存储多少信息：姓名、年龄、地址、职业以及要描述的任何方面。你还能够存储任意两种相关的信息，如一系列单词及其含义，一系列人名及其喜欢的数字，以及一系列山脉及其海拔等。

### 6.1 使用字典

在 Python 中，字典是一系列「键-值」对。每个键都与一个值相关联，你可以使用键来访问与之相关联的值。与键相关联的值可以是数字、字符串、列表乃至字典。事实上，可将任何 Python 对象用作字典中的值。在 Python 中，字典用放在花括号 {}  中的一系列「键-值」对表示。「键-值」对是两个相关联的值。指定键时，Python 将返回与之相关联的值。键和值之间用冒号分隔，而「键-值」对之间用逗号分隔。在字典中，你想存储多少个「键-值」对都可以。

1『 Python 里字典的表示方式跟 JS 里对象是一模一样的。（2020-08-29）』

字典是一种动态结构，可随时在其中添加「键-值」对。要添加「键-值」对，可依次指定字典名、用方括号括起的键和相关联的值。下面在字典 alien_0 中添加两项信息：外星人的 x 坐标和 y 坐标，让我们能够在屏幕的特定位置显示该外星人。我们将这个外星人放在屏幕左边缘，且离屏幕上边缘 25 像素的地方。由于屏幕坐标系的原点通常为左上角，因此要将该外星人放在屏幕左边缘，可将 x 坐标设置为 0；要将该外星人放在离屏幕顶部 25 像素的地方，可将 y 坐标设置为 25。

```py
alien_0 = {'color': 'green', 'points': 5}
print(alien_0)
❶ alien_0['x_position'] = 0
❷ alien_0['y_position'] = 25
print(alien_0)
```

这个字典的最终版本包含四个「键-值」对，其中原来的两个指定外星人的颜色和点数，而新增的两个指定位置。注意，「键-值」对的排列顺序与添加顺序不同。Python 不关心「键-值」对的添加顺序，而只关心键和值之间的关联关系。

使用字典来存储用户提供的数据或在编写能自动生成大量「键-值」对的代码时，通常都需要先定义一个空字典。要修改字典中的值，可依次指定字典名、用方括号括起的键以及与该键相关联的新值。对于字典中不再需要的信息，可使用 del 语句将相应的「键-值」对彻底删除。使用 del 语句时，必须指定字典名和要删除的键。

```py
alien_0 = {'color': 'green', 'points': 5}
print(alien_0)
❶ del alien_0['points']
print(alien_0)
```

在前面的示例中，字典存储的是一个对象（游戏中的一个外星人）的多种信息，但你也可以使用字典来存储众多对象的同一种信息。例如，假设你要调查很多人，询问他们最喜欢的编程语言，可使用一个字典来存储这种简单调查的结果。

```py
favorite_languages = {
	'jen': 'python',
	'sarah': 'c',
	'edward': 'ruby',
	'phil': 'python',
	}

❶ print("Sarah's favorite language is " +
❷ favorite_languages['sarah'].title() +
❸ ".")
```

正如你看到的，我们将一个较大的字典放在了多行中。其中每个键都是一个被调查者的名字，而每个值都是被调查者喜欢的语言。确定需要使用多行来定义字典时，在输入左花括号后按回车键，再在下一行缩进四个空格，指定第一个「键-值」对，并在它后面加上一个逗号。此后你再次按回车键时，文本编辑器将自动缩进后续「键-值」对，且缩进量与第一个「键-值」对相同。定义好字典后，在最后一个「键-值」对的下一行添加一个右花括号，并缩进四个空格，使其与字典中的键对齐。另外一种不错的做法是在最后一个「键-值」对后面也加上逗号，为以后在下一行添加「键-值」对做好准备。

1『字典培养多行的习惯，并且直接在最后一个「键-值」对后加花括号收尾。注意，最后一个「键-值」对后面可以加一个逗号，为以后扩展做准备。』

注意：对于较长的列表和字典，大多数编辑器都有以类似方式设置其格式的功能。对于较长的字典，还有其他一些可行的格式设置方式，因此在你的编辑器或其他源代码中，你可能会看到稍微不同的格式设置方式。这个示例还演示了如何将较长的 print 语句分成多行。单词 print 比大多数字典名都短，因此让输出的第一部分紧跟在左括号后面是合理的（见 ❶）。请选择在合适的地方拆分要打印的内容，并在第一行末尾（见 ❷）加上一个拼接运算符（+ ）。按回车键进入 print 语句的后续各行，并使用 Tab 键将它们对齐并缩进一级。指定要打印的所有内容后，在 print 语句的最后一行末尾加上右括号（见 ❸）。

### 6.2 遍历字典

一个 Python 字典可能只包含几个「键-值」对，也可能包含数百万个「键-值」对。鉴于字典可能包含大量的数据，Python 支持对字典遍历。字典可用于以各种方式存储信息，因此有多种遍历字典的方式：可遍历字典的所有「键-值」对、键或值。

1『通过方法来实现访问字典里的各个元素：访问「键-值」对用 items() 方法；访问键用 keys() 方法；访问值用 values() 方法。比如 dict1.items()，注意这些方法返回的都是一个列表。』

```py
user_0 = {
	'username': 'efermi',
	'first': 'enrico',
	'last': 'fermi',
	}

❶ for key, value in user_0.items():
	❷ print("\nKey: " + key)
	❸ print("Value: " + value)
```

for 语句的第二部分包含字典名和方法 items() （见 ❶），它返回一个「键-值」对列表。接下来，for 循环依次将每个「键-值」对存储到指定的两个变量中。在前面的示例中，我们使用这两个变量来打印每个键（见 ❷）及其相关联的值（见 ❸）。注意，即便遍历字典时，「键-值」对的返回顺序也与存储顺序不同。Python 不关心「键-值」对的存储顺序，而只跟踪键和值之间的关联关系。

在 6.2.6 节的示例 favorite_languages.py 中，字典存储的是不同人的同一种信息；对于类似这样的字典，遍历所有的「键-值」对很合适。如果遍历字典 favorite_languages，将得到其中每个人的姓名和喜欢的编程语言。

在不需要使用字典中的值时，方法 keys() 很有用。下面来遍历字典 favorite_languages ，并将每个被调查者的名字都打印出来：

```py
favorite_languages = {
	'jen': 'python',
	'sarah': 'c',
	'edward': 'ruby',
	'phil': 'python',
	}

❶ for name in favorite_languages.keys():
	print(name.title())
```

遍历字典时，会默认遍历所有的键，因此，如果将上述代码中的 for name in favorite_languages.keys(): 替换为 for name in favorite_languages:，输出将不变。

```py
favorite_languages = {
	'jen': 'python',
	'sarah': 'c',
	'edward': 'ruby',
	'phil': 'python',
	}

❶ if 'erin' not in favorite_languages.keys():
	print("Erin, please take our poll!")
```

方法 keys() 并非只能用于遍历；实际上，它返回一个列表，其中包含字典中的所有键，因此 ❶ 处的代码行只是核实 'erin' 是否包含在这个列表中。由于她并不包含在这个列表中，因此打印一条消息，邀请她参加调查。

字典总是明确地记录键和值之间的关联关系，但获取字典的元素时，获取顺序是不可预测的。这不是问题，因为通常你想要的只是获取与键相关联的正确的值。

要以特定的顺序返回元素，一种办法是在 for 循环中对返回的键进行排序。为此，可使用函数 sorted() 来获得按特定顺序排列的键列表的副本：

```py
for name in sorted(favorite_languages.key()):
```

如果你感兴趣的主要是字典包含的值，可使用方法 values()，它返回一个值列表，而不包含任何键。例如，如果我们想获得一个这样的列表，即其中只包含被调查者选择的各种语言，而不包含被调查者的名字。

这种做法提取字典中所有的值，而没有考虑是否重复。涉及的值很少时，这也许不是问题，但如果被调查者很多，最终的列表可能包含大量的重复项。为剔除重复项，可使用集合（set）。集合类似于列表，但每个元素都必须是独一无二的。通过对包含重复元素的列表调用 set()，可让 Python 找出列表中独一无二的元素，并使用这些元素来创建一个集合。在 ❶ 处，我们使用了 set() 来提取 favorite_languages.values() 中不同的语言。

```py
for language in set(favorite_languages.values()):
```

1『剔除列表里的重复元素，可以调用集合方法 set() 来实现。字典里每个「键-值」对之间记得要用逗号 , 隔开。遍历字典里的「键-值」对用函数 items()；遍历字典里的键用函数 keys()；遍历字典里的值用函数 values()。』

1『发现 Python 语法跟 JS 有很多是一样的，这里的 Set() 集合。（2020-08-29）』

### 6.3 嵌套

有时候，需要将一系列字典存储在列表中，或将列表作为值存储在字典中，这称为嵌套。你可以在列表中嵌套字典、在字典中嵌套列表甚至在字典中嵌套字典。正如下面的示例将演示的，嵌套是一项强大的功能。

字典 alien_0 包含一个外星人的各种信息，但无法存储第二个外星人的信息，更别说屏幕上全部外星人的信息了。如何管理成群结队的外星人呢？一种办法是创建一个外星人列表，其中每个外星人都是一个字典，包含有关该外星人的各种信息。

这些外星人都具有相同的特征，但在 Python 看来，每个外星人都是独立的，这让我们能够独立地修改每个外星人。

在什么情况下需要处理成群结队的外星人呢？想象一下，可能随着游戏的进行，有些外星人会变色且移动速度会加快。必要时，我们可以使用 for 循环和 if 语句来修改某些外星人的颜色。例如，要将前三个外星人修改为黄色的、速度为中等且值 10 个点，可以这样做。

经常需要在列表中包含大量的字典，而其中每个字典都包含特定对象的众多信息。例如，你可能需要为网站的每个用户创建一个字典（就像 6.3.1 节的 user.py 中那样），并将这些字典存储在一个名为 users 的列表中。在这个列表中，所有字典的结构都相同，因此你可以遍历这个列表，并以相同的方式处理其中的每个字典。

有时候，需要将列表存储在字典中，而不是将字典存储在列表中。例如，你如何描述顾客点的比萨呢？如果使用列表，只能存储要添加的比萨配料；但如果使用字典，就不仅可在其中包含配料列表，还可包含其他有关比萨的描述。

1『字典里的「值」可以是任意数据类型，甚至是任意的对象。』

在下面的示例中，存储了比萨的两方面信息：外皮类型和配料列表。其中的配料列表是一个与键 'toppings' 相关联的值。要访问该列表，我们使用字典名和键 'toppings'，就像访问字典中的其他值一样。这将返回一个配料列表，而不是单个值。

每当需要在字典中将一个键关联到多个值时，都可以在字典中嵌套一个列表。在本章前面有关喜欢的编程语言的示例中，如果将每个人的回答都存储在一个列表中，被调查者就可选择多种喜欢的语言。在这种情况下，当我们遍历字典时，与每个被调查者相关联的都是一个语言列表，而不是一种语言；因此，在遍历该字典的 for 循环中，我们需要再使用一个 for 循环来遍历与被调查者相关联的语言列表。

正如你看到的，现在与每个名字相关联的值都是一个列表（见❶）。请注意，有些人喜欢的语言只有一种，而有些人有多种。遍历字典时（见❷），我们使用了变量 languages 来依次存储字典中的每个值，因为我们知道这些值都是列表。在遍历字典的主循环中，我们又使用了一个 for 循环来遍历每个人喜欢的语言列表（见❸）。

列表和字典的嵌套层级不应太多。如果嵌套层级比前面的示例多得多，很可能有更简单的解决问题的方案。

可在字典中嵌套字典，但这样做时，代码可能很快复杂起来。例如，如果有多个网站用户，每个都有独特的用户名，可在字典中将用户名作为键，然后将每位用户的信息存储在一个字典中，并将该字典作为与用户名相关联的值。

## 0701. 用户输入和 while 循环

在本章中，你学习了：如何在程序中使用 input() 来让用户提供信息；如何处理文本和数字输入，以及如何使用 while 循环让程序按用户的要求不断地运行；多种控制 while 循环流程的方式：设置活动标志、使用 break 语句以及使用 continue 语句；如何使用 while 循环在列表之间移动元素，以及如何从列表中删除所有包含特定值的元素；如何结合使用 while 循环和字典。

大多数程序都旨在解决最终用户的问题，为此通常需要从用户那里获取一些信息。例如，假设有人要判断自己是否到了投票的年龄，要编写回答这个问题的程序，就需要知道用户的年龄，这样才能给出答案。因此，这种程序需要让用户输入其年龄，再将其与投票年龄进行比较，以判断用户是否到了投票的年龄，再给出结果。

在本章中，你将学习如何接受用户输入，让程序能够对其进行处理。在程序需要一个名字时，你需要提示用户输入该名字；程序需要一个名单时，你需要提示用户输入一系列名字。为此，你需要使用函数 input()。你还将学习如何让程序不断地运行，让用户能够根据需要输入信息，并在程序中使用这些信息。为此，你需要使用 while 循环让程序不断地运行，直到指定的条件不满足为止。通过获取用户输入并学会控制程序的运行时间，可编写出交互式程序。

### 7.1 函数 input() 的工作原理

函数 input() 接受一个参数：即要向用户显示的提示或说明，让用户知道该如何做。在这个示例中，Python 运行第1行代码时，用户将看到提示 Tell me something, and I will repeat it back to you: 。程序等待用户输入，并在用户按回车键后继续运行。输入存储在变量 message 中，接下来的 print(message) 将输入呈现给用户：

```py
prompt = "If you tell us who you are, we can personalize the messages you see."
prompt += "\nWhat is your first name? "
name = input(prompt)
print("\nHello, " + name + "!")
```

这个示例演示了一种创建多行字符串的方式。第1行将消息的前半部分存储在变量 prompt 中；在第 2 行中，运算符 += 在存储在 prompt 中的字符串末尾附加一个字符串。

使用 int() 来获取数值输入。使用函数 input() 时，Python 将用户输入解读为字符串。为解决这个问题，可使用函数 int()，它让 Python 将输入视为数值。函数 int() 将数字的字符串表示转换为数值表示。将数值输入用于计算和比较前，务必将其转换为数值表示。

1『不能将输入值直接存储为数字，只能在获得输入值（字符串）后用方法 int() 将其转化为数字类型。』

处理数值信息时，求模运算符（%）是一个很有用的工具，它将两个数相除并返回余数。求模运算符不会指出一个数是另一个数的多少倍，而只指出余数是多少。如果一个数可被另一个数整除，余数就为 0，因此求模运算符将返回 0。你可利用这一点来判断一个数是奇数还是偶数：

```py
number = input("Enter a number, and I'll tell you if it's even or odd: ")
number = int(number)
if number % 2 == 0:
	print("\nThe number " + str(number) + " is even.")
else:
	print("\nThe number " + str(number) + " is odd.")
```

### 7.2 while 循环简介

for 循环用于针对集合中的每个元素都一个代码块，而 while 循环不断地运行，直到指定的条件不满足为止。

1『注意，Python 里这边的 while 判断条件不需要放在括号里。』

你每天使用的程序很可能就包含 while 循环。例如，游戏使用 while 循环，确保在玩家想玩时不断运行，并在玩家想退出时停止运行。如果程序在用户没有让它停止时停止运行，或者在用户要退出时还继续运行，那就太没有意思了；有鉴于此，while 循环很有用。

在前一个示例中，我们让程序在满足指定条件时就执行特定的任务。但在更复杂的程序中，很多不同的事件都会导致程序停止运行；在这种情况下，该怎么办呢？例如，在游戏中，多种事件都可能导致游戏结束，如玩家一艘飞船都没有了或要保护的城市都被摧毁了。导致程序结束的事件有很多时，如果在一条 while 语句中检查所有这些条件，将既复杂又困难。

在要求很多条件都满足才继续运行的程序中，可定义一个变量，用于判断整个程序是否处于活动状态。这个变量被称为标志，充当了程序的交通信号灯。你可让程序在标志为 True 时继续运行，并在任何事件导致标志的值为 False 时让程序停止运行。这样，在 while 语句中就只需检查一个条件——标志的当前值是否为 True，并将所有测试（是否发生了应将标志设置为 False 的事件）都放在其他地方，从而让程序变得更为整洁。

1『 while 循环一般结合计数器 count 使用，或直接给定一个「退出」条件。count 的使用体现出的思维：定义一个变量为「标识」，充当交通信号灯。只需检测标识的状态是否为 Ture。』

```py
prompt = "\nTell me something, and I will repeat it back to you:"
prompt += "\nEnter 'quit' to end the program. "

❶ active = True
❷ while active:
	message = input(prompt)
	❸ if message == 'quit':
		active = False
	❹ else:
		print(message)
```

这个程序的输出与前一个示例相同。在前一个示例中，我们将条件测试直接放在了 while 语句中，而在这个程序中，我们使用了一个标志来指出程序是否处于活动状态，这样如果要添加测试（如 elif 语句）以检查是否发生了其他导致 active 变为 False 的事件，将很容易。在复杂的程序中，如很多事件都会导致程序停止运行的游戏中，标志很有用：在其中的任何一个事件导致活动标志变成 False 时，主游戏循环将退出，此时可显示一条游戏结束消息，并让用户选择是否要重新玩。

要立即退出 while 循环，不再运行循环中余下的代码，也不管条件测试的结果如何，可使用 break 语句。break 语句用于控制程序流程，可使用它来控制哪些代码行将执行，哪些代码行不执行，从而让程序按你的要求执行你要执行的代码。

例如，来看一个让用户指出他到过哪些地方的程序。在这个程序中，我们可以在用户输入 'quit' 后使用 break 语句立即退出 while 循环：

```py
prompt = "\nPlease enter the name of a city you have visited:"
prompt += "\n(Enter 'quit' when you are finished.) "

❶ while True:
	city = input(prompt)
	if city == 'quit':
		break
	else:
	print("I'd love to go to " + city.title() + "!")
```

以 while True 打头的循环（见❶）将不断运行，直到遇到 break 语句。这个程序中的循环不断输入用户到过的城市的名字，直到他输入 'quit' 为止。用户输入 'quit' 后，将执行 break 语句，导致 Python 退出循环：

注意：在任何 Python 循环中都可使用 break 语句。例如，可使用 break 语句来退出遍历列表或字典的 for 循环。

要返回到循环开头，并根据条件测试结果决定是否继续执行循环，可使用 continue 语句，它不像 break 语句那样不再执行余下的代码并退出整个循环。

2『哈哈，这里算是明白 break 和 continue 的使用原则：首先这两个都只是针对循环语句的。1）break 是直接从该点退出循环，不执行其后面的语句，退出循环；2）continue 是直接从该点返回到判断语句，也是忽略后面的语句，但不退出循环。做一张任意卡片。』——已完成

```py
current_number = 0

while current_number < 10:
    ❶ current_number += 1
    if current_number % 2 == 0:
        continue
    print(current_number)
```

我们首先将 current\_number 设置成了 0，由于它小于 10，Python 进入 while 循环。进入循环后，我们以步长 1 的方式往上数（见❶），因此 current\_number 为 1。接下来，if 语句检查 current_number 与 2 的求模运算结果。如果结果为 0（意味着 current\_number 可被 2 整除），就执行 continue 语句，让 Python 忽略余下的代码，并返回到循环的开头。如果当前的数字不能被 2 整除，就执行循环中余下的代码，Python 将这个数字打印出来：

每个 while 循环都必须有停止运行的途径，这样才不会没完没了地执行下去。每个程序员都会偶尔因不小心而编写出无限循环，在循环的退出条件比较微妙时尤其如此。如果程序陷入无限循环，可按 Ctrl + C，也可关闭显示程序输出的终端窗口。

要避免编写无限循环，务必对每个 while 循环进行测试，确保它按预期那样结束。如果你希望程序在用户输入特定值时结束，可运行程序并输入这样的值；如果在这种情况下程序没有结束，请检查程序处理这个值的方式，确认程序至少有一个这样的地方能让循环条件为 False 或让 break 语句得以执行。

### 7.3 使用 while 循环来处理列表和字典

到目前为止，我们每次都只处理了一项用户信息：获取用户的输入，再将输入打印出来或作出应答；循环再次运行时，我们获悉另一个输入值并作出响应。然而，要记录大量的用户和信息，需要在 while 循环中使用列表和字典。

for 循环是一种遍历列表的有效方式，但在 for 循环中不应修改列表，否则将导致 Python 难以跟踪其中的元素。要在遍历列表的同时对其进行修改，可使用 while 循环。通过将 while 循环同列表和字典结合起来使用，可收集、存储并组织大量输入，供以后查看和显示。

1『作者的观点：for 循环只适合遍历列表，想要遍历列表并修改列表的话，用 while 循环来实现。』

```py
# 首先，创建一个待验证用户列表
# 和一个用于存储已验证用户的空列表
❶ unconfirmed_users = ['alice', 'brian', 'candace']
confirmed_users = []

# 验证每个用户，直到没有未验证用户为止
# 将每个经过验证的列表都移到已验证用户列表中
❷ while unconfirmed_users:
	❸ current_user = unconfirmed_users.pop()
	print("Verifying user: " + current_user.title())
	❹ confirmed_users.append(current_user)

# 显示所有已验证的用户
print("\nThe following users have been confirmed:")
for confirmed_user in confirmed_users:
	print(confirmed_user.title())
```

我们首先创建了一个未验证用户列表（见❶），其中包含用户 Alice、Brian 和 Candace，还创建了一个空列表，用于存储已验证的用户。❷ 处的 while 循环将不断地运行，直到列表 unconfirmed\_users 变成空的。在这个循环中，❸ 处的函数 pop() 以每次一个的方式从列表 unconfirmed\_users 末尾删除未验证的用户。由于 Candace 位于列表 unconfirmed\_users 末尾，因此其名字将首先被删除、存储到变量current\_user 中并加入到列表 confirmed\_users 中（见❹）。接下来是 Brian，然后是 Alice。

为模拟用户验证过程，我们打印一条验证消息并将用户加入到已验证用户列表中。未验证用户列表越来越短，而已验证用户列表越来越长。未验证用户列表为空后结束循环，再打印已验证用户列表。

在第 3 章中，我们使用函数 remove() 来删除列表中的特定值，这之所以可行，是因为要删除的值在列表中只出现了一次。如果要删除列表中所有包含特定值的元素，该怎么办呢？假设你有一个宠物列表，其中包含多个值为 'cat' 的元素。要删除所有这些元素，可不断运行一个 while 循环，直到列表中不再包含值 'cat'，如下所示。

```py
pets = ['dog', 'cat', 'dog', 'goldfish', 'cat', 'rabbit', 'cat']
print(pets)

while 'cat' in pets:
	pets.remove('cat')
	print(pets)
```

可使用 while 循环提示用户输入任意数量的信息。下面来创建一个调查程序，其中的循环每次执行时都提示输入被调查者的名字和回答。我们将收集的数据存储在一个字典中，以便将回答同被调查者关联起来：

```py
responses = {}

# 设置一个标志，指出调查是否继续
polling_active = True
while polling_active:

# 提示输入被调查者的名字和回答
❶ name = input("\nWhat is your name? ")
response = input("Which mountain would you like to climb someday? ")

# 将答卷存储在字典中
❷ responses[name] = response

# 看看是否还有人要参与调查
❸ repeat = input("Would you like to let another person respond? (yes/ no) ")
if repeat == 'no':
polling_active = False

# 调查结束，显示结果
print("\n--- Poll Results ---")
❹ for name, response in responses.items():
print(name + " would like to climb " + response + ".")
```

这个程序首先定义了一个空字典（responses），并设置了一个标志（polling\_active），用于指出调查是否继续。只要 polling\_active 为 True，Python 就运行 while 循环中的代码。

在这个循环中，提示用户输入其用户名及其喜欢爬哪座山（见❶）。将这些信息存储在字典 responses 中（见❷），然后询问用户调查是否继续（见❸）。如果用户输入 yes，程序将再次进入 while 循环；如果用户输入 no，标志 polling\_active 将被设置为 False，而 while 循环将就此结束。最后一个代码块（见❹）显示调查结果。