

## 第 4 章加权分布 —— 有偏数据

科学主要是要建立模型，并不是试图去说明而且也很少去解释什么。

这里所说的模型是指一种数学结构，再加上某种特定语言的解释来描述

所观察到的现象。建立这样一种数学结构的理由惟一而且明确地由人们

所期待的它的机能来决定.

冯·诺伊曼（von Neumann）

4.1 设定

统计推断，也就是基于从总体中抽取的样本来做出有关总体的叙述时，有必要确认所有可能抽取样本的集合，记为样本空间 2，记 P 为支配样本所属的实际概率分布的概率分布族。推断分析中很大程度依赖于 P 的选择，我们称之为设定。错误的设定可以导致错误的推断，统计术语中，有时称这种错误为第 3 种错误。

设定的问题不是一个简单的问题。要得到一个正确的设定，一个基本因素是要对如何得到数据的实际过程有一个详细的了解。采用野外观察和非实验数据时的情形更为复杂，此时自然界按某个特定的随机模型产生事件，事件再由现场观察者观察并记录下来。设计一个抽样调查并不总是存在一个合适的抽样结构来保证所发生的事件具有指定的（通常是相等的）机会成为样本，实际上，自然界所发生的所有事件并不能产生抽样结构。例如，某些事件不可能被观察到，因而在记录中缺失。在这种情形下就产生了所谓的截尾样本、截断样本或不完全样本。或者，一个发生的事件仅以一定的概率能被观察到，其概率大小依赖于事件固有的性质，如它的显著性和用于观察的过程，其结果成为不等概率抽样。或者事件的发生随观察的时间或过程随机地变化，因而所记录到的实际上是修正了的事件。在统计分析中，这种变化或损伤必须进行适当的模型化。有时，事件来自两个或两个以上具有不同的随机结构的不同渠道，这些混杂在一起进入同一记录，结果成为污染了的样本。所有这些情形如果不进行适当的修正，对原始事件（将要发生）的设定与查明得到的事件（观察到的数据）便不一定吻合.

费歇（1934）在－一篇经典论文中说明了依赖数据所获得的方法来调整设定的必要性。本书作者劳在他的著作（1965，1973，1975，1977，1985）中发展了费歇的基本思想，提出了一种称为加权分布的理论，其作为一种调整的方法可以应用于很多情形。下面，通过对一些实例的讨论来叙述一般理论。读者阅读本章时可以跳过某 64

第 4 章加权分布 —— 有偏数据

些数学结果的证明

4.2 截断分布

某些事件尽管已经发生，但也许有不可观测的部分。因而所观察的分布在样

本空间中的某个部分是截断的。例如，如果我们调查一只昆虫产卵个数的分布，

则产卵个数为零的事件是不可观测的。另一个例子是考虑双亲均是缺乏色素的白

化病患者、而他们子女却没有因缺乏色素而患白化病这样的家庭的频数。除非父母

有患白化病的子女，一般没有证据说明双亲是缺乏色素的白化病患者。因此，双亲

是白化病患者没有患白化病子女的家庭已经与正常的家庭混在一起了。这样，双

亲患白化病家庭而子女患白化病人数为零的事件的实际频率是不能确定的.

一般来说，如果设 p（x，0）为随机变量 X 的概率密度函数，（X 为连续变量

时，p（x，0）表为概率密度函数；X 为离散变量时，p（x，0）表为概率.）0 表为未

知参数，随机变量 X 在样本空间的特定子空间 TC2 内截断，此时，截断随机

变量 XT 的概率密度函数为

p（x，0）=w（x，T）p（x，0）

（4.1）

这时，如果 x∈T，w（x，T）=1；xT，w（x，T）=0，u（T，0）=E［w（X，T）］.

公式（4.1）表示经一个适当的函数加权后的原始概率密度函数，这是加权概率分

布的一个简单例子。下一节将给出加权概率分布的一般定义.

假设在试验次数为 n、成功事件的概率为的二项分布抽样中，事件为零是

不可观测的。记 RT 表示截断二项随机变量 TB（truncated binomial），则

P（R2=r）=（n=x）（，=1，n

（4.2）

对这样的分布，有

E（R）=1-（1-n）n，E（R/n）=1-（1-x）

（4.3）

（4.3）中的值比起完全二项分布情形下分别对应的 nπ 和 π 来说要大一些.

下面的数据来自欧洲某一教授的私人电话簿，所记载的是一些女学生家庭中

的兄弟姐妹的人数（括号中第一个数是包括女学生本人在内的姐妹的人数，第二

个数是她兄弟的人数）.

（1，0），（1，0），（1，1），（1，1），（1，1），（1，1），（1，1），（1，1），（1，1），（1，1） （1，1），（2，0），（2，0），（2，0），（2，1），（2，1），（2，1），（2，1），（1，2），（1，2）4.2 截断分布

65

（3，0），（3，1），（3，1），（1，3），（1，3），（4，0），（4，1），（1，4）

（4.4）

因为所记载的家庭至少有一个女孩，所以我们试着来看看这些数据是否来自除去女孩观测数为零的截断二项分布（即二项分布在零处截断）. 设 f（n）为具有 n 个子女（即被观察的家庭中子女总人数为 n）的家庭的观测频数，并设女孩人数的概率为 π=0.5，则女孩数，来自截断二项分布假设下的期望值为

5

（4.5）

把（4.4）的数据代人公式（4.3）和（4.5），得到如下结果①：

子女数

观测值

期望值

女孩

47

46

男孩

30

31

上述结果显示：在截断二项分布的假设下观测数据与对应的期望值的结果非常接近。但是，在类似的情形下，利用下列数据却产生了不同的结果。下面这些数据是加尔各答一个男学生所认识的 10 个女孩子家庭中的子女人数，排列法同上。

（2，1），（1，1），（3，0），（2，0），（3，1），（1，0），（2，1），（1，0），（1，1），（1，1）（4.6）在同样的假设下，女孩数来自截断二项分布的期望值为 14.6（由公式（4.3）和（4.5），而观测值为 17. 因而截断二项分布的假设对数据（4.6）不合适。看起来欧洲的教授和加尔各答的男学生所结识的女孩的结构是不同的.

要注意的是，如果我们在某一城市抽取一些家庭作为样本，调查每一个家庭中的兄弟姐妹人数（即子女人数），则预期女孩的人数来自完全二项分布，如果从获得的数据中略去那些没有女孩的家庭，则数据就来自截断二项分布。欧洲教授的数据是从至少有一个女孩的家庭的集合中抽取的。下一节我们将看到由随意碰到的男孩或女孩调查他们的兄弟姐妹人数是来自不同的分布的。上面提到的加尔各答的男学生的情形人约是属于这种类型.

①对（4.4）数据来说，有如下结果：

n

2

3

4

5

E（r｜n）

1

4/3

12/7

32/15

80/31

f（n）

2

12

7

5

2 66

第 4 章加权分布 —— 有偏数据

4.3 加权分布

上一节中，我们已经考虑了某些事件不可观测的情形。但更一般的情况是已经以一定的概率记录下某一事件的发生（或是已经包含在样本中）. 设 X 为随机变量，其密度函数记为 p（x，0），0 为参数。设当 X=x 发生时所记录下来的概率为 w（x，a），其取决于观测值 x 也许同时还取决于一个未知参数 a. 这样得到的随机变量记为 X＂，它的概率密度函数为

p（x，0，a）=wa）p（x，0）

（4.7）

尽管在导出公式（4.7）时，我们选择 w（x，a）使其满足 0≤w（x，a）≤1，但一般说来，在 E［w（x，a）］存在时，我们可对任意非负函数 w（x，a）定义（4.7）. 这样得到的密度函数称为 p（x，）的加权形式，记为 p＂（x，0）. 特别是当（x）为 x 的单调函数时，加权分布： p（x，0）=（）

（4.8）

称为是 X 的容量有偏分布（size biased distribution）. 当 X 为一维变量且非负时，由劳（1965）介绍的加权分布 p（x，0）=，

（4.9）

已经用于很多实际问题（参见 Rao（1985）. 当 a=1 时，称为长度（容量）有偏分布。例如，如果 Ⅹ 服从对数级数分布

P（X=r）=-rlog（1-0），r=12，··

（4.10）

则长度有偏变量的分布为

P（X=r）=（1-0）0-`，r=1，2，·

（4.11）

这表明 X-1 服从几何分布。已经发现截断几何分布对家庭人数的观测分布有很好的拟合性（Feller，1968）. 但是，如果有关家庭人数的信息是从在校学生中获得的，则观测值可能服从容量有偏分布。这种情形下，几何分布对家庭人数观测值的优良拟合，实际上是指其本身的基础分布为一对数级数分布。

如劳（1965，1985）指出的那样，在很多离散分布的情形中，容量有偏分布的形式与其原始分布的形式是属于同一分布族的。对数级数分布是一个例外。4.4 随机比率抽样法（p.p.s. 抽样法）

67

自劳（1965）公式化加权分布的概念以来，已经出现了大量的有关文献。帕梯（Patil，1984）的文章中列举了大量的参考文献，特别是对加权分布研究的早期贡献可参考 Patil 和 Rao（1977，1978），Patil 和 Ord（1976）.Rao（1985）综合报告了迄今为止的研究工作和某些新的成果.

4.4 随机比率抽样法（p.p.s. 抽样法）

应用加权分布的一个例子可参见人们利用不等概率抽样法或概率比例 p.p.s. 抽样法（probability proportional to size）进行的抽样调查。一般在含有两个随机变量 X 和 Y 的样本抽样中，（X，Y）的联合概率密度函数为 p（x，y，0），加权函数 w（y）仅与 y 有关，则（X，Y）的加权联合概率密度函数为

p（x，y，0）=0（y）p（x，y，0）

（4.12）

样本抽样中，由服从概率密度函数（4.12）的随机变量（X，Y）的观测值来推断参数 θ.

有趣的是，X」的边缘分布为

p（x，6）=

（4.13）

它是 p（x，θ）的加权形式，权函数为

w（z，0）=p（yI z，0）w（y）dy

（4.14）

给定一个大小为 n、来自分布（4.12）的样本

（x1，y1），…，（xn，yn）

（4.15）

此时感兴趣的一个参数、即关于原始概率密度函数 p（x，y，θ）的均值 E（X）的一个估计量为

E［w（y）］（）

（4.16）

这是 E（X）的一个无偏估计量。而估计量

（4.17）

为 E（X＊）的一个无偏估计量，这里 E（X）为（4.13）式中加权概率密度函数 p（x，0）的均值. 68

第 4 章加权分布 —— 有偏数据

4.5 加权二项分布：经验定理

如果在任意时间和任意地点在一个班级或是任一个集合中调查其中每一男性所拥有的兄弟人数（包括被调查的男性本人）和姐妹人数，则出现下面的问题。如果 B，S 分别代表被调查男性所拥有的全部兄弟人数和姐妹人数，问 B/（B+S）的渐进值为多大？显然我们是从至少有一个男孩的具有截断分布的家庭中抽取的样本，因而 B/（B+S）的值应大于 1/2，但到底大多少呢？十分惊奇的是，如果被调查的男性人数 k 不是很小时，我们可以正确预测 B 和 S 的相对大小，以及比率 B/（B+S）的值。这可表为如下的经验定理.

经验定理 1 设 k 为在任意地点任意时间任一集合中观测到的男性样本人数，B 为其全部兄弟人数（包括 k 个男性在内），S 为姐妹总人数，则可做如下预测：（i）B 远大于 S.

（i）B-k 近似等于 S.

（i）B/（B+S）大于 1/2，接近 + 2（B+S）

（iv）（B-k）/（B+S-k）接近于 1/2.

如果数据是从一个女性集合中收集到的，则 B 和 S 的位置颠倒。

考虑一个有 n 个子女的家庭。这个家庭拥有的男孩的人数假设服从 π=1/2，指标为 n 的二项分布，则有 r 个男孩的概率为

p（r）=（n-2＂，r=0，1

（4.18）

这里，因我们考虑的是至少有一个男孩的事件，则适合的分布应是截断分布。一个可能的结果是截断二项分布（TB）:

p2（r）=r（n2r）121，r=1，2·

（4.19）

另一个可能是容量有偏分布（WB）（译注：实际上是加权二项分布，故原书也使用略写符号 WB）

p（）））=12.·（4.20）

劳（1977）指出，对各种观测数据来说，公式（4.20）比（4.19）更合适。基于对上海（中国），马尼拉（菲律宾）和孟买（印度）3 个城市的大学中男性大学生分别调查得 45 加权项分布：经验定理

69

来的数据，表 4.1 给出了不同人数的家庭中兄弟人数的频率分布的观测数据，以及分别在截断二项分布 TB（4.19）和容量有偏分布 WB（4.20）假设下的期望值。从表 4.1 中可知，WB（加权二项分布）比 TB（截断二项分布）的拟合性更好，并显示具有，个兄弟人数的家庭是按，进行概率比率抽样的.

表 4.1 不同人数家庭中男孩的观测频数以及假设 TB 和 WB 下的期望值

（数据来自上海，马尼拉，孟买的男性大学生）

－1

n=2

n-3

兄弟

期望值

期望值

期望值

人数观测值 TB

WB 观测值 TB

WH 观测值 ΊB

WB

6

6

6

24

28.7 21.5

12

20.1

11 7

2

19

14.3 21.5

24

20.2

23.6

3

1！

6.7

11.7

和

6

6

6

43

43.0 43.0

47

47.0

47.0

8

11.2

5.3

5

6.5

2.5

1.9

0.6

T

2

10）

16.8 15.7

8

12.9 L0. （）

4

4.8

3.1

3

17

11.2 15.7

15

12.9 15. （）

4

6.3

6.3

4

7

2.8

5.3

10

6.5 10.0

9

4.8

6.3

5

2

1.2

2.5

2

1.9

3.1

6

O

0.3

0.6

和

42

42.0 42.0

40

40.0 40.0

20

20.0

20.0

如接受加权二项分布（即容量有偏分布）（4.20）的假设，立即可得

E（rn）-（）=

（4.21）

E（r 1）=＂21

（4.22）

如果观测数据为（r1，n1），··，（r，n），S=T-B，B=r1+·+r，T=n1 70

第 4 章加权分布 —— 有偏数据

+·+n2，则对给定的 T 值，有

E（B-k）=E（r，-1）-=T=E（S）（4.23）

EB＊（）=s）-i2s （4.24）

如果在（4.23）和（4.24）中除去期望值的符号，就得到经验定理 1 中所叙述的渐进等式.

过去 20 年里，我在世界各地对学生和教师做讲座时，在听众中收集了他们家庭中的兄弟姐妹人数，所得的结果概括在表 4.2-4.5 中。可以看到由经验定理 1 所做的预测，在加权二项分布的假设下对各种情形均是吻合的。作为加权二项分布的进一步检验，计算了各种场合中统计量（4.25）的值。统计量（4.25）渐进服从自由度为 1 的卡方分布： x2=4（［B-K］-1（T-k）/2］）2

（4.25）

表 4.2 男性（学生）回答者的数据

地点和时间（年）

k

B

S

B-k

B+S B+Sk

x2

班加罗尔（印度，1975）

55

180

127

0.586

0.496

0.02

德里（印度，1975）

29

92

66

0.582

0.490

0.07

加尔各答（印度，1963） 104

414

312

0.570

0.498

0.04

威尔特（印度，1969）

39

123

88

0.583

0.491

0.09

阿美苔巴（印度，1975）

29

84

49

0.632

0.523

0.35

梯露帕提（印度，1975） 592

1902

1274

0.599

0.484

0.50

波那（印度，1975）

47

125

65

0.658

0.545

1.18

海得拉巴（印度，1975）

25

72

53

0.576

0.470

9. 364.5 加权二项分布；经验定理

71

续衣

地点和时间（年）

k

S

B

B k

B+S BISk

x2

德黑兰（伊朗，1975）

21

65

40）

0.619

0.500

0.19

伊斯法罕（伊朗，1975）

11

45

32

0.584

0.515

0.06

东京（H 本.1975）

50

90

34

0.725

0.540

0.49

利马（秘鲁，1982）

38

132

87

0. 603

0.519

0.27

上海（中国，1982）

74

193

132

0.594

0.474

0.67

哥伦布（美国，1975）

29

65

52

0.556

0.409

2.91

斯泰特科利奇

63

152

90

0628

0.497

0.01

（美国，1976）

和

1206

3734

2501

平均

0.600

0.503

0.14

注：k - 学生总数，B - 包括调查者本人在内的兄弟人数，S - 姐妹人数。容量有偏分布假设下 π 的估计值 =（B-k）/（B+S-k）.

从表中可以看到所有卡方统计量的值均很小，验证表明加权二项分布是适宜的。［实际上由于这些卡方值太小，有必要进一步考察观测数据的结构.］

表 4.3 女性（学生）回答者的数据

地点和时间（年）

k

S

Bk

B+S B+S-k

x2

利马（秘鲁，1982）

16

37

48

0.565

0.464

0.36

洛班斯（菲律宾，1983）

44

101

139

0.579

0.485

0.18

马尼拉（菲律宾，1983）

84

197

281

0.588

0.500

0.00

毕尔巴鄂（西班牙，1983）

14

19

35

0.576

0.525

0.10

上海（中国，1982）

27

28

55

0.662

0.500

0.00

注释 1 由（4.24），给定平均家庭子女人数 f=（B+S）/k 时，对应于各个 ∫值，比率 B/（B+S）的期望值如下：

f：1 2

3

4

5

6

EB/（B+S）］：1 0.75 0.67 0.6250.60.58

表 4.4 中教授回答的数据略有不同。从各地得到的估计值均大于 1/2，卡方值 72

第 4 章加权分布 —— 有偏数据

也较大。这表明适宜这些数据的加权函数应比兄弟人数 r 更高阶，看起来这些男

性教授出身的家庭中儿子的人数远大于女儿的人数.

表 4.4 男性（教授）回答者的数据

|

地点和时间（年）

k

B ！ B-k

B+S B+S k x2

斯泰特科利奇（美国，1976） 28

80

37

0.690 0. 584 2.53

华沙（波兰，1975）

18

41

2i

0.660 0.525 2.52

！_

波兹南（波兰，1975）

24

50

17

0.746 0. 567 1.88

匹兹堡（美国，1981）

69

|69

77

0.687 0. 565 2.99

梯露帕提（印度，1975）

50

172.

132

0.566 0.480 0.39

马拉开波（委内瑞拉，1982） 24

95

56

0.629 0. 559 1.77

里士满（美国，1981）

26

57

29

0. 663 0.517 （）.03

和

239

664

369

平均

0.642 0. 535 3.95

这些数字显示，在给定家庭的平均人数不超过 6 的情形下，对任意集合中的男性调查其兄弟和姐妹人数时，可对兄弟总人数 B 和姐妹总人数 S 做出以下预测：（i）B 远大于 S.

（ii）与 1/2 相比，B/（B+S）的值更接近于 0.6 或甚至到 2/3.

（）B/（B+S-k）接近于 1/2，这里 k 为回答问题的男性人数.

使人惊奇的是，甚至在一个集合中男性人数 k 较小时，这些预测依然成立。［这是一个很好的课堂练习题目，也可在任·集合中验证。可以事先做出这些预测，然后出从男性（或女性）成员中收集所得的数据来验证.

注释 2 当 n=1，2，··加权二项分布情形下时，表 4.5 给出 3 个事件 B>S，B·S，B<S 的概率.

表 4.5 事件 B>S，B=S，B<S 的概率

n

2

3

4

5

6

7

8

9

10

B>S

L

！2 3_4 2

11

16

12

12 163

256 12

B-S

0

12

0

38

0

0

35

90

32

128 0

512

B<$

0

0

14

18

5

15 62끊 29 93

166

128 256 5124.5 加权项分布：经验定理

73

从表 4.5 可知，对每一个 n，事件 B>S 的概率 P（B>S）远大于事件 B<S 的概率 P（B<S）. 由此可得：

在任意给定的听总休中，b（表男性所属家庭中 B>S）比 b（表男性所属家庭中 B<S）的比值依赖于家庭人数的分布，有可能增大。现给出另一个经验定理。经验定理 2b 对 b 的比值近似地等于下列（4.26）和（4.27）右边表达式的比值：

（4.26）

ECb）=e++…

（4.27）

这里 p 为有 n 个子女的家庭的个数.

在平均家庭人数较少的西方听众中比率 b:b 的值很可能比 4:1 还大，而东方听众的比值大于 2:1，两者均远大于 1:1.［这个现象是可以预测的，并且由要求听众举手回答是否属于类型 B>S 或者是类型 B<S 的家庭所得的分类数据可以验证这个现象。这也是一个很好的课堂练习题目，也可在任一集合中验证.］注释 3 设家庭人数 N=n，子女中兄弟数为 B-b 时的概率为 p（b，n），并且假设选择这样一个家庭的概率是与 b 成比率的，则有

（b.n）= e（= be（min）

（4.28）

P＂（n）=EEBp（m）

（4.29）

当 p（bn）服从二项分布时，有

p（n）=（，E＂（1/N） = 1/E（N）

（4.30）

因而，由分布（4.28）或（4.29），N 的观测值 n1，··，n 的调和平均值

k

Σ，＇

（4.31）

为原始分布期望值 E（N）的一个估计值。如果 p（n）的形式是给定的，则利用概率分布函数（4.29），可写出样本 n1，…，n2 的似然函数，再利用极大似然法求出未知参数、 74

第 4 章加权分布 —— 有偏数据

4.6 酗酒，家庭人数与出生顺序

斯马特（Smart，1963，1964）和斯普柔特（Sprott，1964）利用加拿大安大略省

的 3 个酒精中毒治疗所入院治疗的 242 个酒者的家庭人数和出生顺序的数据，

检验了加拿大人家庭中酗酒者的发生率等若干假设。这里所用的抽样方法是上一

节所讨论的类型.

假设检验之一是：如果家庭人口多，则酗酒中毒者人数大于期望值。这里给

出酒中毒者人数与期望值相等的零假设是由家庭人数的观测值服从加权分布

，n-1，2，…

（4.32）

的意义上得到的，这里 p（n），n=1，2，·为一般总体中家庭人数的分布。斯马特

和斯普柔特在他们的研究分析中利用安大略省 1931 年入口统计调查中家庭入数

的分布作为 p（n）. 这时容易检验他们所观测的家庭人数的分布是否与所预期的

加权分布（4.32）一致

要注意的是，如果从各个体（酗酒者或非酗酒者）组成的集合中随机地抽取样

本并调查他们的家庭人数，则分布（4.32）是合适的。但是，如像斯马特和斯普柔

特所做的那样，调查如果仅限于酒精中毒治疗所人院治疗的个体，那就不十分清

楚（4.32）是否仍然成立，上述情形可以通过下面的过程来验证。在他们的原假设下，即一个家庭的酗酒中毒者的人数服从二项分布（尤如独立试验中失败的次数），

进一步再假设每一个酒中毒者含有同样的独立的机会入院治疗。

设 π 为一个人变成酒中毒者的概率，并假设家庭中的一个成员变成酒中毒者的概率与家庭中一个其他成员是否是酗酒中毒者无关。进一步假设一般总

体中家庭入数的分布（无论这个家庭是否有酗酒中毒者）为 p（n），n=1，2，··. 则家庭人数为 n、酗酒者入数为 r 的概率为

p（n）［x，y=0.…，n；n=1，2.…

（4.33）

这里 = 1-π. 由（4.33），一般总体中一个家庭至少有一个酗酒者的家庭人数的分布可表为

1），

（4.34）

如果我们任意选择一些家庭，记录其中至少含有一个酗酒中毒者的那些家庭的人数，通过比较观测频数与在（4.34）下的期望频数，可检验人口口多的家庭中酗酒中 4.6 酗酒，家庭人数与出生顺序

75

..

毒者人数过度的原假设。但是，如果从某个酒精中毒治疗所收容的酗酒者中抽取 n 和 r，则下面的（n，r）的加权分布更合适，

n！

－

p＂（n，r）ー rp（n）（n-E（N

（4.35）

假如我们已经有了家庭人数 n 和其中含有的酗酒中毒者人数 r 的信息，则可比较（n，r）的联合观测频数和由模型（4.35）所得的期望值.

由（4.35），n 的边缘分布为

（，n=1，2，…

（4.36）

斯马特和斯普柔特用此作为家庭人数的观测频数模型。一般总体中，利用（4.34）至

（1-＂）

少有一个酒者的家庭人数的分布为 p（n），当接近于 1 时化简为

1-E（）

（4.36）. 换言之，如果一个个体变为酒中毒者的概率很小，则被调查的家庭人数的分布接近于一一般总体中至少有一个酗酒者的家庭人数的分布。如果不接近于 1，此结论不真实.

斯马特和斯普柔特发现，如果观测值分布的频数是厚尾的则不适合（4.36）式。他们断言人数较多的家庭产生酗酒中毒者的频率高于平均值。这个结论正确吗？我们知道，加权分布（4.36）是在两个假设下导出来的。一个假设是：－一般总体中，来自至少有一个酒中毒者的家庭子集合中的家庭人数的分布服从（4.34），这是最早由斯马特提出的零假设推出的。另一一个假设是：数据抽样方法等价于按一个家庭中酗酒中毒者人数的概率比进行的 p.p.s. 抽样。如果第二个假设是正确的，那么拒绝（4.36）就意味着拒绝这两个假设中的第一个。一般对这样的假定并无事前的根据，也缺乏客观的验证，所以在采用斯马特的结论时要慎重。

斯马特的另一个假设是，后出生的子女比先出生的子女更容易变成酗酒中毒者。斯马特在这里所用到的方法会使统计学家们多少感到有些迷惑。在批评斯马特的方法时，斯普柔特做了一些评论。下面由模型（4.35）来回顾一下斯马特的分析过程。如果假设出生顺序与成为酗酒中毒者无关，而且一个酗酒中毒者就住于某一治疗所治疗的概率独立于出生顺序，则一个观测到的酗酒中毒者出生于一个含有，个酗酒中毒者的 n 个子女的家庭，且这个被观察者的出生顺序为 s≤n 的概率为 （4.35）式除以 n，即

再对 r 求和，则可得到关于家庭人数 n 和出生顺序 s 即（n，s）的边缘概率分布 76

第 4 章加权分布 —— 有偏数据

，1

（4.38）

这个分布适用于观测数据。注意，这里的 p（n），n=1，2，··为一般总体中家庭人数的分布。斯马特给出了（n，s）的二元观测数列，因为 p（n）是已知的，我们能够计算（n，s）的期望值并与观测值进行比較。但是，斯马特不是这样做的.

由公式（4.38），出生顺序的边缘分布为

P（S=）-E1，2

（4.39）

在斯马特（1963）表 2 的分析中，他试图比较的是出生顺序观测值的分布与模型（4.39）下的期望值，其中 p（i）由观察数据利用模型（4.32）来估计。

一个较好的方法如下：由（4.38）可知，在给定家庭人数时，出生顺序频数的期望值计算结果与斯马特（1963）表 1 中计算的结果相同。这时，为比较每一家庭人数的期望值与观测频数的各卡方值将提供需要检验的有关假设的一切信息。这一过程与任何 p（n）的信息是无关的。但不清楚的是，斯马特提出的这种类型的假设是否能够在没有进一步的有关酒中毒者的信息，诸如年龄和性别，而只在现有的数据基础上进行检验

表 4.6 复制了斯马特（1963）表 1 中有关家庭人数为 4 以下，且出生顺序也为 4 以下的部分。可以看到当家庭人数为 2 和 3 时，观测频数与假设是矛盾的；而家庭人数在 3 以上时，出生顺序完全没有影响（参见斯马特表 1 或表 4.6）. 作者把匹兹堡大学两个系的教员中所收集到的类似的出生顺序与家庭人数的数据（表 4.7）与斯马特的结果作了比较，得到有趣的结果。大多数的教员都在家庭中排行靠前，显示了要成为教授是家中排行靠前者的苦恼。可以预期的是，在我们所考虑的数据中，即使无视出生顺序与某个特别的属性、特别是与年龄有关的隐含关系，在家庭中排行靠前的人也是占优势的.（这可以作为另一个课堂练习。去任意一个研究室调查多少人是长子 / 长女，第二出生的，···你会注意到先出生的人所占的优势.） 表 4.6 酒中毒者出生顺序和家庭人数的分布（摘自斯马特（1963）表 1）

n-1

¶=2

n=3

n=4

E

E

E

E

1

21

21

22

16

17

13.3

11

11 75

2

10

16

14

13.3

10

11.75

3

9

13.3

13

11.75

4

13

11.75

注：O = 观测值，E - 期望值.4.7 等待时间悖论

77

－.-

..

. .

..

表 4.7 匹兹堡大学教员的出生顺序和家庭人数 n≤4 的分布

n=1

n=2

n=3

n=4

1

7

14

9

6

2

6

4

2

3

2

0

4

0

4.7 等待时间悖论

帕梯（Patil，1984）提到了摩洛哥国立统计经济应用研究所 1966 年进行的一项研究。这个研究的目的是估计观光旅游者平均逗留的时间。这里进行了两种调查，一种是对住在旅馆的观光旅客进行调查，另一种是在边防站对即将离境的旅游者进行调查。从 3000 个住在旅馆的旅客的调查可知其平均逗留时间为 17.8 日，而在边境海关对 12321 个即将离境的旅游者的调查可知其平均逗留时间为 9 日。由于计划部门的官员们对这些数字感到怀疑，从而放弃了从旅馆旅客那里得到的估计值。

显然，从即将离境的旅游者方面所收集到的观测值对应于真实的逗留时间分布，因而观测的平均值 9 日是期望逗留时间的有效估计。可以证明，当旅游者的流量达到一个稳定的水平时，从旅馆的游客那里所得到的逗留时间服从容量有偏分布，因而此时所观测的平均值为期望逗留时间的过量估计。设 X」为容量有偏的随机变量，则

E（Xu）1=μ

（4.40）

这里 μ 为原始变量 X 的期望值。公式（4.40）表明容量有偏观测值的调和平均值是 μ 的一个有效估计量。因此，从旅馆游客那里所得到的观测值的调和平均提供了一个可与从边境即将离境的旅游者处所得到的算术平均值相近的估计值。

我们感兴趣地注意到，从旅馆的游客方面所得到的估计值几乎是另一个的两倍，这是一个与指数分布有关、产生等待时间悖论①的一个因素（参见 Feller，①这是由费勒引人的一个悖论，如果设公共汽车到达的时间服从泊松分布，参数为，则下一辆公共汽车到站的时间间隔为 λ`. 如果一一个人在时刻 t 开始等车，计算汽车到来时所等待时间的期望值。设等待时间为随机变量 w，即要求 E（w，）为多大。对这个问题，有两个不同的答案：

（i）由 J 泊松分布足尤记忆的，则（，）与时间无关，即有 E（u）-E（2）-x；

（）由于时刻 t 是随机的，则由对称性，E（，）=A3，

关这个问题的详细解释，可参见费勒（1966）.—— 译者注 78

第 4 章加权分布 —— 有偏数据

1966；Patil 和 Rao，1977）. 虽然不能肯定，但这暗示旅游者逗留时间的分布可能是指数分布.

假设对住在旅馆的游客调查他们迄今在这个国家所停留的时间。如果把一个游客到调查为止所停留的时间表示为随机变量 Y，则可假设 Y 的概率密度分布与乘积变量 XR 的概率密度分布相等，这里 X 为逗留时间变量 X 的容量有偏形式，R 为服从［0，1］区间上的均匀分布、并与 X 独立的随机变量。如令 X 的分布函数为 F（x），则 Y 的概率密度函数为

µ¯¹［1-F（y）］

（4.41）

如果给定逗留时间的分布函数 F（y），则可由 Y 的观测值来估计参数 μ.

有趣的是，公式（4.41）的概率密度函数与考克斯（Cox，1962）所研究的用于各种机器的某零件的失效时间的分布函数一样，这里考克斯利用的是机器零件到调查为止时所使用时间的观测值.

4.8 损伤模型

设 N 为随机变量，其概率分布为 p，n=1，2，·，R 为另一随机变量，使得

P（R =r iN=n）= s（r，n）

（4.42）

则 R 在 0 处截断的边缘分布为

p=（1-p）2ps（r，n），r=1，2，

（4.43）

这里

p=p1s（0，i）

（4.44）

原始数据 n 经过一破坏过程，以概率 s（r，n）从 n 减少到 r，观测值 r 为残存数。当我们仅以生存的子女人数（R）来考察家庭人口的观测值时，会出现这样的情况。在已知 R 的分布并假设一个适当的生存分布的情形下，问题是如何确定最初家庭人数 N 的分布

设 N 服从参数入的泊松分布，即 N~P（A），R 服从参数 π 的二项分布，R~B（）. 则

p＇=e，r=1，2，…

（4.45）

从（4.45）可知，参数 λ 和是交织在一起的，因而即使给定 R 的分布，也不能求参考文献

79

出 N 的分布，当 N 服从二项分布、负二项分布或对数级数分布时，会产生同样的

情形。斯普柔特（1965）在生存分布为二项分布时，给出了具有这种交织性质的分

布的一般情形。要恢复原始分布需要什么附加信息呢？例如，如果我们已知样本

中的某些观测值并没有受到损伤，则可同估计二项分布参数一样来估计原始分

布、这里要注意的是，未受到任何损伤的样本观测值的分布为一加权分布

p= cp，π

（4.46）

如果原始分布为泊松分布，则与（4.45）一样，分布为

p2=e（n）

（4.47）

劳和鲁宾（Rao and Rubin，1964）证明等式 p=p，具有泊松分布的特征.

劳（1965）介绍了上面描述的损伤模型。关于损伤模型的理论发展以及由此派生

出来的概率分布特征化方面的研究，读者可参见 Alzaid，Rao 和 Shanbhag（1984）.

参考文献

Alzaid A H，Rau （ R anud Shanbhag D N. 1984. Solutions of Certain Functional Equations And Related Results on Probability Distributions. Technical Report，University of Sheffield，U. K

Cox D R. 1962. Renewal ＇Theory. Chapman and llall，London

Feller W. 1966. An Introduction to Probability Theory and Its Applcations，Vol. 2，John Wiley Sons，New York

Feller W. 1968. An Introduction to Probability Theory and Its Applications，Vol. 1（3 edn.），John Wilcy Sons，New York

Fisher R A. 1934. The Effect of Methods of Ascertainmerit upon The Estination of Frequencies. Ann. Eugen. ，6，13~25

Patil G P. 1984. Studies in Statistical Ecology Involving Weighted Distributions. In：Statistics：Applications and New Directions，478~503. Indian Statistical Institute，Calcutta

Patil G P and （Ord K. 1976. On Size-Biasod Sampling and Relatud Form-Lrivariant Wcighted Instributions. Sankhya Ser. B33，49-61

Patil G P and Rao C：R. 1977. The Weighted T）istributions：A Survey of their Applcations. In

Applications of Statistics（P. R. Krishnaiah，Ed.），383405，North Holland Publishing Company，Arnsterdam

l＇atil G P and Rao C＇ R. 1978. Weighted Distributions and Size biased Sampling with Applications to Wildlife Populations and Human Familics. Biometrics，34，170~180

Rao C R. 1965. （On ［Discrete Distributions Arising out of Metheds of Ascertainment. In Classical and 80

第 4 章加权分布 —— 有偏数据

Contagious Discrete Distributions,（G. P. Patil, Ed. ）320~333. Statist. Publishing Society, Calcutta. Reprinted in Sankhya Ser. A, 27，311~324

Rao C R. 1973. Linear Statistical Inference and its Applications.（2 Edn. John Wiley Sons, New York

Rao C R. 1975. Some Problems of Sample Surveys. Suppl. Adv. Appl. Probab., 7, 50~61

Rao C R. 1977. A Natural Example of a Weightod Binornial Distribution. Arner. Statist., 31, 24- 26

Rao C R. 1985. Weighted Distributions Arising out of Methods of Ascerainment：What Population Dbes A Sample Reproscnt? In：A Celebration of Statistics, the ISI Centenary Volume(A. C. Atkinson and S. E. Fienberg, Eds. )，543-569. Springer-Verlag

Snart R（i. 1963. Alcoholism, Birth ordet, and Family Size. 1. Abron. Soc., Psychol., 66,

17-23

Smart R(G. 1964. A Response to Sprott's "Use of Chi-squarc". J. Abnortm. Soc., Psychol., 69,

103-105

Sprott D A. 1964. Using of Chi-Square. J. Abnorm. Soc., Psychol., 69, 101~103

Sprott D A. 1965. Some Comrnents on The Question of Indentifiability of Parameters Raised by Rao.

In：Classical and Contagious Discrete Distributions（G. P. Patil, Ed. )，333-336. Publishing

Society, Calcutta 