## 记忆时间

## 20200409Why-should-you-use-Vuejs-when-using-Laravel.md

### 01. What is Vue.js?

Straight from the horse’s mouth, “Vue is a progressive framework for building user interfaces”. Vue at its core is focused on the view layer only of an application, so integrating with other platforms or existing applications is really easy. You can also use Vue on its own to build sophisticated single page applications.

### 02. How does Vue work?

If you have programmed for the web before the era of event-driven frontend JavaScript frameworks, you would understand there are considerable difficulties and inefficiencies that arise from trying to update the Document Object Model (DOM).

To update the DOM directly means you would have to take the page, make the change to a small part of it, then reload the entire DOM so the changes can take effect. If say you are watching a YouTube video and there is a new comment, the entire page would reload and your video would have to start afresh.

1『 DOM 的一大弊端，页面改动一点点需要重新渲染整个 DOM。』

Vue tries to solve these challenges by utilizing a virtual DOM to manage the view a user sees. Vue essentially creates a copy of the DOM and stores it. When a change is made to any part of the DOM, it just updates only that section of the DOM without reloading the DOM. This means the comments would update without you even noticing it.

1『 Vue 的基本原理。』

Vue provides reactive and composable view components. Vue responds to events and triggers changes on the DOM instantaneously. Its composable components can be selected and assembled in various combinations to satisfy whatever need arises. You can have components for everything and reuse them however you need.

### 03. Why you should use Vue with Laravel

This is one question that you need to take your time to answer. It is important to understand what Vue has to offer and what that means for your work. We are going to explore a few reasons why you should use Vue with Laravel.

#### 1. Everything happens on the frontend

Applications on the internet today are event-driven. They are built to ensure users have a seamless experience like they would if they used an application installed on their computer. Everything now happens on the frontend and users never have to reload a page again (thank you JavaScript).

#### 2. Reactive components make for an excellent event-driven app

Vue lets you build a full-scale application that is event-driven and has all activity completely handle on the frontend. It also provides composable components that can be used however you wish. Given that it couples nicely with Laravel, you will only need to make a few trips to request data from your Laravel application and make UI changes by switching components without reloading the page.

1『上面的观点又想到，laravel 就负责做 api？』

You can trigger UI changes that are seamless with your Vue frontend, which in turn gives your users an amazing experience. It could be as simple as making a text on your page editable or swapping out an entire component to load up a video requested by a user without reloading the page. Given Vue’s speed and performance, this happens very fast and smoothly without taking up so much of your computer resources.

#### 3. Building optimal complex frontend pages

If you think of building an application with parts that need to update frequently, you have no other choice than to make the frontend run completely on JavaScript. The challenge with vanilla JavaScript or jQuery or other JavaScript libraries that do not have a virtual DOM is that you quickly hit performance issues with the frequency of update increases or the volume of data to track for changes increases significantly. Changes to the DOM will gradually cease to be instantaneous and you begin to experience noticeable performance lags.

When you compose your application with Vue components, each component’s dependencies are automatically tracked during its render, so the system knows precisely which component actually needs to be updated when there is a change in data. This makes all updates to the DOM use minimal resources, thereby improving the overall application efficiency.

Vue is also compatible with state managers like Flux, Redux, and Vuex which are excellent in managing data flow in complex applications. Vue’s utilization of a one-way data binding model also makes state management easier in complex applications.

#### 4. Single Page Application

I would like to share a personal opinion – Single Page Applications are the greatest thing to happen to the internet in the last decade. It opens up applications to a wider audience of users than was possible before. When you consider that many internet users outside of some parts of America and Europe have challenges getting on the internet, you begin to appreciate the role single page applications play in delivering a rich web experience to them. Your entire application assets get loaded once (and most of it cached), all that your application does as the user engages with it is request data which typically requires low bandwidth to fulfill.

#### 5. Easy to learn and use

Vue is easy to get into. It provides very few options for you as the developer and has a lot abstracted away. You feel like you are writing plain JavaScript when you use Vue and you can make a simple application with plain JavaScript and it remains valid in Vue.

Another great thing about Vue is that your valid HTML is also a valid Vue template. You can keep your CSS external or you can process it with JavaScript depending on your application needs. You can also take advantage of scoped styling, to apply style changes to a single component on the fly without the change affecting other components. If you are familiar with JavaScript, you can build a non-trivial application with Vue after just one day of reading the documentation.

### 04. Basic Vue usage with Laravel

Vue integrates nicely with Laravel. You can create Vue components and use them like you would use regular HTML tags inside your blade file. You can pass props to the component from the output generated when your blade file renders. To try it out, create a new Laravel installation using the Laravel installer:

    $ composer create-project laravel/laravel vueapp --prefer-dist '6.*'

Install Vue and other JavaScript libraries your application needs to run:

    $ npm install

1『

这里改用 yarn 安装：

```
yarn install --no-bin-links
yarn add cross-env
```

发现跑 watch 还是失败，最后还是通过 npm 安装解决的：npm install。

』

Setup your application to reload when you make changes to your js assets:

    $ npm run watch

1『用 npm run watch-poll 命令。』

If you like seeing your changes as you make them, especially since you are learning, then you should definitely run watch to watch the applications. Now, open another terminal instance and start the Laravel application server:

    $ php artisan serve

### 05. Creating your first Vue Component

1『在 resources//js/ 下新建文件夹 components，该文件夹下新建 Welcome.vue 并把原文中的代码复制过去。』

### 06. Using the component in your blade file

We have made our first Vue component (I know, it is that easy). To use it in the welcome.blade.php file, we would need to make Vue aware that it exists and give it a name Vue would label it with. Open the resources/assets/js/app.js file and edit it to the following:

```
require('./bootstrap');

window.Vue = require('vue');

Vue.component('welcome', require('./components/Welcome.vue'));

const app = new Vue({
    el: '#app'
});
```

1『

上面是配置的关键。报错：

```
ERROR in ./resources/js/app.js
Module not found: Error: Can't resolve 'vue' in '/Users/Daglas/laravel/vueapp/resources/js'
 @ ./resources/js/app.js 3:13-27
 @ multi ./resources/js/app.js ./resources/sass/app.scss
```

问题在这个语句：window.Vue = require('vue'); 从哪引入 vue 呢？因为之前 laravel 里没装 vue 框架。vue 官网上找到了答案：NPM，在用 Vue 构建大型应用时推荐使用 NPM 安装。NPM 能很好地和诸如 webpack 或 Browserify 模块打包器配合使用。同时 Vue 也提供配套工具来开发单文件组件。

```
# 最新稳定版
$ npm install vue
```

用 npm 装完后，上面 app.js 里的代码就没问题了。

』

Next, use the Vue component inside of your resources/views/welcome.blade.php file:

```html
[...]
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="csrf-token" content="{{ csrf_token() }}">

        <title>Laravel</title>

[...]
    <body>
        <div id="app">
            <welcome></welcome>
        </div>
        <script type="text/javascript" src="js/app.js"></script>
    </body>
[...]
```

1『

报错：Failed to mount component: template or render function not defined

搜索获得解决方案：[[Vue warn]: Failed to mount component: template or render function not defined. (found in root instance) · Issue #198 · JeffreyWay/laravel-mix](https://github.com/JeffreyWay/laravel-mix/issues/198)

It should be require('./components/Example.vue').default. Since v13, vue-loader exports the component as the default key, which still works the same when using import, but requires the above when using require.

把 app.js 里 vue 的引入语句改为：Vue.component('welcome', require('./components/Welcome.vue').default);

』

Make sure to edit the file accordingly and include the script tag in it so that your Vue component can be visible on the page. If you set your application to watch for changes to your js assets, then you should see that it already built the entire application and would output compiled successfully in XXXms.



