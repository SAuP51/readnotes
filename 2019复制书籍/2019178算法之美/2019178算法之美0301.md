# 
> 2018000模板



03 排序 建立秩序


罗伯特·考德雷，《词汇表》

如果你要查的单词的首字母是a，就在《词汇表》开头部分查找。如果首字母是v，就到靠后的位置查找。此外，如果开头的两个字母是ca，就在字母c项下的开头部分查找。如果是cu，则应到字母c部分的末尾处查找。以此类推。

多年以前，丹尼·希利斯是麻省理工学院的一名本科生。当时他还没有创立“思维机器公司”，也还没有发明著名的“连接机器”并行超级计算机，而是住在学生宿舍里，目瞪口呆地看着室友的袜子。

与许多大学生不同的是，希利斯关心的并不是室友的卫生状况。让他感到吃惊的，并不是他勤于洗袜子，室友却从来不洗，而是接下来发生的事情。

室友从干净的洗衣篮中拿出一只袜子。接着，又随机抽出另一只袜子。如果两只袜子不配对，他就把第二只扔回去。然后继续这个过程，他把袜子一个一个地抽出来，然后把它们扔回去，直到为第一只袜子成功配对为止。

洗衣篮里一共有10双不同的袜子。按照这个方法，配好第一对最多需要取19次，配好第二对又可能需要17次。如果要把20只袜子全部配成对，这个室友可能需要从洗衣篮里取110次袜子。

任何未来的计算机科学家看到这幅情景，可能都会要求换宿舍。

应该如何对袜子进行排序的问题引起了计算机科学家的热议。2013年，有人在“栈溢出”编程网站上贴出了一个关于袜子的问题，立刻引发了长达12000个单词的争论。

当我们对传奇式密码学家、计算机科学家、图灵奖得主罗恩·李维斯特提起这个话题时，他向我们坦承：“我被袜子打败了！”

当时，他穿着凉鞋。





排序狂潮


排序是计算机的核心内容。事实上，从很多方面看，如果没有排序，计算机就不会变成现实。

19世纪末期，美国人口每10年就会增加30%。1870年，美国人口普查只有5个“调查科目”，到1880年，就增加到了200多个。1880年人口普查的制表工作花了8年，在1890年人口普查即将开始时才勉强完工。当时，有一位作家评论说：“调查人员整天埋头整理那些令人头皮发麻的统计数字，竟然没有失明，也没有发疯，这真是一大奇迹。”所有从事人口普查的工作人员都不堪重负，濒临崩溃。这个局面已经到了不得不改变的地步。

发明家赫尔曼·霍尔瑞斯从当时使用的打孔火车票那里找到灵感，发明了一种可以存储信息的打孔统计卡和一种机器，用来完成计数与排序工作。他把这套系统称作“霍尔瑞斯计算机”。1889年，霍尔瑞斯获得专利，美国政府在1890年的人口普查中采用了霍尔瑞斯计算机。在这之前，从来没有人看到过这样的机器。一位惊叹不已的旁观者说：“这个装置就像众神的磨坊一样准确无误，速度则完胜对方。”然而，另一个人认为这项发明的用途十分有限：“除了政府以外，没有人愿意使用它，因此发明者不可能发财。”霍尔瑞斯把这个预言制成剪报并保存了下来，但是事实证明，这个预言并不完全正确。1911年，霍尔瑞斯公司与另外几家公司合并，变成了计算-制表-记录公司。几年之后，公司改名为国际商用机器公司，即IBM。

从计算机诞生直到进入20世纪，排序一直是推动计算机发展的一大动力。为“存储程序”计算机编写的第一个代码是一个高效排序程序。事实上，正是因为计算机的能力超越了IBM的专用卡片分类机，所以美国政府相信它们在通用机器上投入巨额资金的决定是正确的。到20世纪60年代，一项研究估计，世界上超过1/4的计算资源被用于排序。难怪排序对于处理几乎任何类型的信息来说都是至关重要的。无论是查找最大值或最小值，最常见数据或最罕见数据，还是清点、索引、标记副本，或者根据你的要求进行查找，其核心工作通常都是排序。

但是，排序不仅用于这些方面。毕竟，排序的主要原因之一是将内容变成方便人眼观察的形式，这意味着排序也是人类信息体验的关键。排序列表无处不在。就像鱼儿问“水是什么”一样，我们只有有意识地去感知，才会发现排序无处不在。

即使电子邮件收件箱有数千封邮件，它也通常会根据收件时间显示排在前面的50封。利用点评网站Yelp寻找餐厅时，它也会将成百上千家餐厅根据邻近程度与用户评分排序，然后为你显示前十几名。博客按日期对博文进行排序，显示一个不是很长的博文清单。脸书的动态信息、推特的信息流和红迪网的主页都是根据某些属性对内容进行排序，然后以列表的形式显示出来。我们把谷歌和必应等网站称作“搜索引擎”，但是这个称呼并不是非常恰当，因为它们其实都是排序引擎。作为接收全球信息的一种手段，谷歌占有非常明显的优势，究其原因，与其说是它可以在成千上万的网页中找到我们需要的文本（20世纪90年代，谷歌的竞争对手同样可以出色地完成这个任务），不如说是因为谷歌可以将这些网页进行有效地排序，然后只把关系最密切的前10个网页显示出来。

从很多方面看，在庞大排序表的顶部截取一部分，就可以当作通用的用户界面。

计算机科学可以帮助我们了解所有上述情况的深层次内容。当我们被账单、文件、书本、袜子等团团包围，希望厘出头绪（这种情况每天都会发生，而且比我们想象的还要多）时，这些知识又可以转化为一种深刻认识，帮助我们解决难题。通过量化混乱状况的缺点（和优点），计算机科学还告诉我们，在一些情况下，我们其实根本不应该排出次序。

此外，当我们开始看排序结果时，我们知道被排序的不仅是信息——被我们排序的其实是人！建立先后次序的计算机科学最适合大展身手的舞台可能是运动场和拳击场，因此，学会排序有助于理解人类可以和谐相处、偶尔才会拳脚相向的原因。也就是说，排序可以为我们提供一些令人吃惊的线索，帮助我们了解社会的本质。所谓社会，就是我们维持的另外一种更重要、规模更大的秩序。





排序带来的苦恼


1955年，詹姆斯·霍斯肯在第一篇公开发表的关于排序的科学论文中写道：“为了降低单位产出的成本，人们通常会增加他们的业务规模。”这是任何一名商科学生都很熟悉的规模经济。但是，在排序这个问题中，规模往往会招致灾难：如果扩大排序的规模，“排序的单位成本就会不降反升”。排序往往呈现非常明显的规模不经济现象，这与普通人认为大批量处理问题有诸多好处的直觉正好相反。一般来说，做两个人的饭并不比做一个人的饭难，肯定比为一个人做两次饭要容易得多。但是，整理好装有100本书的书架，比整理两个各有50本书的书架更费时：因为你需要整理的东西是后者的两倍，而且每件东西可以放置的位置也是后者的两倍。需要整理的东西越多，难度就越大。

这是排序理论的第一个，也是最基本的深刻见解：规模越大，难度越大。

由此我们可以推断，在排序的过程中，最大限度地减少痛苦的办法就是在排序时尽可能减少排序对象的数量。的确，降低袜子排序计算难度的一个最有效的预防措施就是勤洗衣服。如果洗衣服的频率增加到原来的3倍，排序时的难度就会变为原先的1/9。如果希利斯的室友继续采用他的那套独特程序，那么把洗衣服的间隔时间从14天改为13天，为袜子配对时从洗衣篮中拿袜子的总次数就可以减少28次。（间隔时间增加1天，拿袜子的次数就会增加30次。）

即使在14天这样一个不大不小的时间范围内，我们也可以看到排序的规模已经开始变得难以处理。然而，计算机通常需要一口气为数百万个项目排序。面对这种情况，我们可以借用电影《大白鲨》的一句台词：我们需要一艘更大的船以及更好的算法。

但是，要回答如何排序、哪种排序方法效果最佳这个问题，就需要先弄明白另外一个问题：如何计分。





大O符号：衡量最坏情况的标准


根据《吉尼斯世界纪录大全》，为一副扑克牌整理次序的最快记录是捷克魔术师兹德涅克·布拉德克保持的。2008年5月15日，布拉德克仅用时36.16秒就把52张扑克牌排好了先后次序。[1]他是怎么做到的？是什么排序技术让他获得这项殊荣的？答案可能与一些有趣的排序理论有关，但是布拉德克拒绝置评。

对于布拉德克的灵巧与技能，我们只能表示尊敬，但是我们百分之百地确定我们自己也可以打破他的纪录。事实上，我们非常确定，只要向这项殊荣发起80658175170943878571660636856403766975289505440883277824000000000000次挑战，就一定可以创造一个无法打破的纪录。这个数字比10的66次方的80倍略大一点儿，是52的阶乘，数学上记作“52！”——包含52张牌的一副扑克牌可以排出这么多不同的次序。在经过大约这么多次的尝试之后，我们迟早可以为经过洗牌变得杂乱无序的扑克牌快速排序，然后，我们可以自豪地让克里斯汀·格里菲斯这个名字载入《吉尼斯世界纪录大全》，然后在旁边标明一个不太难看的排序时间——0分00秒。

公正地说，在宇宙进入热寂状态之前，我们可能都需要不停地尝试，才有可能创造出这个完美的纪录。尽管如此，我们从中可以清楚地看到纪录保持者和计算机科学家之间最大、最根本的区别。吉尼斯纪录的工作人员只关心最好的成绩（和娱乐性）。当然，他们的行为也无可厚非，因为所有的体育纪录也都只能反映出最佳表现。然而，计算机科学几乎从不关心最好的情况。相反，计算机科学家可能想知道像布拉德克等人的平均排序时间：让他对所有8×1066副扑克牌或者合理大小的样本进行排序，然后记录平均速度。（这下你知道他们为什么不会让计算机科学家来做这些事情了吧？）

不仅如此，计算机科学家还希望知道最慢的排序速度。分析最糟糕的情况，可以让我们放心地做出硬性保证——确保关键程序可以及时完成，确保不会超出最后期限。因此，在本章剩余部分（事实上，是全书的剩余部分）里，除非另有说明，否则我们讨论的都是算法的最差表现。

计算机科学有一种专门用来测量算法最坏情况的速记法，即所谓的“大O”符号。大O符号有一个非常奇怪的特点——设计这个符号的目的就是用来表示不精确性。也就是说，大O符号的目的不是使用分钟和秒钟来表示算法的性能，而是方便我们讨论问题规模和程序运行时间之间的关系。由于大O符号故意剔除了细枝末节的内容，所以展示在我们眼前的是将问题分成不同大类的概略情况。

假设你准备邀请n名客人出席晚宴。在客人到来之前，打扫房间的时间与来客人数没有任何关系。这类问题最简单，被称为“O（1）”，也被称为“常数时间”。值得注意的是，大O符号根本不关心清理工作需要多长时间，只是要求它保持不变，与宾客名单没有任何关系。无论来几个客人，1个，10个，100个，或者n个，你都需要完成同样多的工作。

接下来，烤肉在所有客人面前传递一圈所需的时间将是“O（n）”，也被称为“线性时间”——客人增加一倍，菜传递一圈所需的时间就会增加一倍。同样，大O符号根本不关心一共有多少道菜，也不关心这些菜是否会上第二遍。在这两种情况下，时间仍然取决于宾客数量，如果你画出客人数量和时间的关系图，就会得到一条直线。更重要的是，在大O符号中，任何线性时间因子的存在，都会掩盖掉所有常数时间因子。也就是说，将烤肉传递一圈，或者花三个月时间把餐厅重新装修一遍，再把烤肉在所有客人面前传递一遍，对计算机科学家来说，两者都是等效的。不要认为这个说法不可思议，记住计算机处理的是n的值，这个数值变成几千、几十万，甚至几十亿，也不是难事。换句话说，计算机科学家正在考虑举行一个规模非常大的聚会。在数百万的来宾当中传递一次烤肉，所需时间之多，真的足以让房屋重新装修所需的时间变得无足轻重。

假设客人到来之后，你要与每个人热烈拥抱，情况又会怎么样？第一个到达你家的客人与你拥抱，第二个客人需要拥抱两次，第三个客人要拥抱三次。此时，拥抱一共发生了多少次？这种情况属于“O（n2）”，也称“平方时间”。此时，我们同样只关心n与时间的关系概貌。每个人拥抱两次不会是O（2n2），拥抱加传递食物不会是O（n2+n），拥抱加打扫房间也不是O（n2+1）。所有的时间都是平方时间，所以O（n2）将掩盖掉其他所有因素。





注：常数时间，记作O（1）；线性时间，记作O（n）；平方时间，记作O（n2）

从现在开始，情况就会变得越来越糟糕了。如果每增加一名客人都会让你的工作加倍，那么就会有“指数时间”，记作“O（2n）”。更糟糕的是，甚至还有“阶乘时间”，记作“O（n！）”。阶乘时间异常复杂，计算机科学家只有在开玩笑时（例如，我们设想通过洗牌这个方式为一副扑克牌排序），或者真的希望自己是在开玩笑时，才会讨论这类问题。

[1]除此以外，布拉德克还保持多项纪录。例如，他可以在水下打开三副手铐逃生，所耗时间与给扑克牌排序的时间差不多。





平方时间：冒泡排序与插入排序


2007年，时任参议员的奥巴马访问谷歌公司时，谷歌的首席执行官埃里克·施密特开了一个玩笑，以求职面试官的口气问了奥巴马一个问题：“为100万个32位整数排序，最好采用什么方法？”奥巴马诙谐一笑，回答道：“我认为用冒泡排序肯定是不对的。”谷歌的工程师们爆发出一阵欢呼。一位工程师后来回忆道：“他竟然知道冒泡排序，我一下子就被打动了。”

奥巴马排除冒泡排序的回答是正确的。这个简单的直觉式算法效率低下，已经成为计算机科学专业的学生攻击的目标。

假设你希望将杂乱无序的藏书按照字母顺序进行分类排序。那么你会很自然地想到一个方法，于是你在书架前巡视，看到有两本书颠倒了先后次序，就把它们调换过来（例如，将品钦的小说放在华莱士后面）。在将品钦放到华莱士前面之后，你继续巡视。走到书架最后端之后，你就会回过头来，从书架最前端重新开始。如果从头走到尾，都没有看到有哪两本书次序不对，就说明你完成了这项工作。

这就是冒泡排序，它会把我们带进平方时间。有n本书放在不正确的位置，每次巡视书架最多可以为一本书调换位置。（也就是说，我们发现了一个小问题，然后完成了一个小的修正。）所以，在最坏的情况下，即书架上的书正好是倒序放置的，那么至少有一本书需要移动n个位置。因此，在最坏的情况下，n本书都需要移动最多的n个位置，就会得出O（n2）这个结果。[1]不过，这并不是一个最令人害怕的结果，比如，前面说过，要用洗牌的方法把一副牌理顺，就会得到O（n！）这个可怕的结果。与之相比，O（n2）并不可怕（无须运用计算机科学加以证明，我们也知道是这么回事）。但是，这个平方项很快就会让我们望而生畏。举个例子，这意味着整理5个书架所需要的时间不是整理单个书架的5倍，而是25倍。

你可能会采取另外一种方法，即把所有的书都从书架上拿下来，然后一本一本放到合适的位置。你把第一本书放在书架中间，然后拿第二本书和第一本比较，根据比较结果把它插到第一本的右边或者左边。在放第三本书时，你先从左到右浏览书架，然后把它放到合适的位置。你不断重复这个过程，渐渐地所有的书都被按次序放到书架上，直到你最终完成这项工作。

计算机科学家们给这种方法起了一个非常贴切的名称——“插入排序”。好消息是，它比冒泡排序更直观，而且名声也不是太差。坏消息是它实际上并不比冒泡排序快多少。每本书仍然需要一次插入，而且平均每次插入都需要你移动大约半个书架的距离，才能找到合适的插入位置。虽然在实践中插入排序比冒泡排序要快一些，但我们还是会被带进平方时间。为不止一个书架排序仍然是一项难以处理的任务。

[1]其实，冒泡排序的平均运行时间并不好于这个结果。平均而言，书本与它们最终应该在的位置之间相差n/2个位置。计算机科学家会告诉我们，将n本书分别传递n/2个位置，约需要O（n2）次。





打破平方时间的魔咒：分治算法


看到两个完全合理的方法都会导致平方时间之后，我们不禁要问：真的有更快的排序方法吗？

这个问题听起来像是一个关于生产力的问题。但是，与计算机科学家讨论这个问题，就会发现它更接近于空谈，类似于思考光速，时光之旅，超导体，或者热力学中的熵。宇宙的基本规则和极限是什么？哪些是可能的？哪些是允许的？计算机科学家就像粒子物理学家和宇宙学家一样，通过这种方式一点一滴地窥探上帝的蓝图。整理出秩序，至少需要付出多少努力？

我们能否找到一种常数时间，也就是O（1）算法，无论规模大小，耗费的时间都不会有任何变化（就像在客人蜂拥而至之前打扫房间一样）？即使证实书架上的n本书已经排好序，也不可能在常数时间里完成，因为我们需要检查所有书的位置。因此，用常数时间完成图书分类排序工作其实是根本不可能的。

线性时间O（n）呢？可不可以像在餐桌上传递一道菜那样高效，排序对象增加一倍，工作量也仅仅增加一倍？想一想上面的那些例子，就会发现很难有这样的方法。在各种情况下，n2都与你需要移动n本书这个事实有关，而且每次将书移动位置所需的工作量与n也成某种比例关系。怎么可以把大小为n、次数也为n的工作变得只剩下一个n？在冒泡排序中，运行时间O（n2）是因为我们需要逐本移动n本书的位置，而且每次移动时需要跨越n个位置。在插入排序中，之所以是平方时间，是因为我们需要逐本处理n本书，而且在插入之前还要将每本书与n本书进行比较。线性时间排序意味着每本书都需要常数时间，无须考虑有多少本书需要排位的问题。这好像也是不可能做到的。

因此，我们知道我们至少可以在平方时间里完成任务，但是可能无法在线性时间里把所有书都排好序。我们的极限或许就在线性时间与平方时间之间的某个位置。在线性与平方之间，即n与n×n之间，是否可以找到合适的算法呢？

答案是肯定的，而且这些算法近在眼前。

前面说过，信息处理开始于19世纪的美国人口普查，是由赫尔曼·霍尔瑞斯及后来的IBM公司根据实体打孔卡排序设备开创形成的。1936年，IBM开始生产一系列名为“比较者”的机器，它可以将分别排序的两叠扑克牌合并到一起。只要两叠牌本身是排好序的，就可以在线性时间内，非常轻松地将它们合并到一起，并且排好序。该程序非常简单，首先把两叠牌最上面的那两张相互比较，将较小的那张放在新的那叠牌中。重复这个步骤，直到把所有牌都放好。

1945年，约翰·冯·诺伊曼为了展示存储程序计算机的威力，编写了一个程序。在这个程序的最终结论中，就包含有比较的概念。为两张牌排序很简单，把较小的那张牌放在上面就可以了。如果有两叠牌，每叠包含两张排好序的牌，我们可以很容易地将这四张牌整理成排好序的一叠牌。重复几次，就可以整理出越来越多且排好序的牌垛。很快，你就可以把完整的一副牌整理得井然有序。在最后一次合并时，你可以通过与交错式洗牌非常相似的手法，将扑克牌整理出你需要的次序。

这种方法现在被称作“合并排序”，是计算机科学中的传奇算法之一。正如1997年的一篇论文所指出的：“合并排序在排序历史中的重要地位与排序在计算历史中的重要地位旗鼓相当。”

合并排序威力巨大，是因为它的复杂程度位于线性时间和平方时间之间。具体来说，O（n log n）被称为“线性对数”时间。每一次操作都会把有序牌叠的规模增加一倍，所以要对n张牌完全排序，你需要的操作次数就等于2通过自乘变成n时所需的次数，换句话说，就是以2为底的对数。你可以通过两次比较操作，为4张牌排序；第三次操作之后，排好序的牌就会有8张；第四次操作，16张。合并排序的分治法问世之后，人们很快受到启发，提出了一系列其他线性对数排序算法。把线性对数复杂程度说成对平方复杂程度的一个改进，远不足以体现出两者之间的差距。如果需要排序的项目数量与人口普查差不多，那么两者的差距就相当于对数据集进行29次操作和3亿次操作之间的差别。各行业在解决大规模排序问题时都青睐这种方法，原因就不难理解了。

在家庭内部处理小规模排序问题时，合并排序也能找到合适的舞台。它之所以应用广泛，原因之一是它非常适合并行处理。如果你还在苦苦思索对付那个书架的办法，合并排序策略就会建议你订一个比萨，然后邀请几个朋友来分享。把书平均分配，并让每个人负责整理其中一堆。接着，让朋友们两两配对，把他们负责的书合并到一起。重复这个过程，直到最后剩下两堆书，再一次性地合并到书架上。需要注意的是，不要让比萨弄脏了那些书。





超越比较法：比对数更好的算法


在华盛顿州普雷斯顿镇附近有一个不起眼的工业公园，园内有许多不起眼的灰色入口，2011年和2013年美国国家图书馆分类排序冠军就“藏身”于其中一个入口的后面。一条长长的分段传送带以每分钟167本（每天85000本）的速度，运送图书从条形码扫描器前通过。随后，这些图书自动分流，进入投送舱门，被投送到96只不同的箱子中。




合并排序示意图


注：书架上有次序混乱的8本书。首先，把相邻两本书配成一对并排序，再通过比较将两对书合并成一组，而且这4本书的先后次序都是正确的。随后，通过比较将两组书全部按照正确次序放到书架上。

普雷斯顿分类排序中心是世界上规模最大、效率最高的图书分类排序设施之一，主管单位是金县图书馆系统。金县图书馆与纽约公共图书馆的设施大致相仿，它们一直是竞争关系。由于势均力敌，4年来两个图书馆在竞争中打成平手。在2014年的最后决战打响之前，纽约图书馆图书运营服务部副主管萨尔瓦多·马加蒂诺说：“金县图书馆今年要打败我们？想都别想！”

理论家也可以在普雷斯顿分类排序中心发现一些值得关注的东西，因为这套系统为图书排序所用的时间是O（n），即线性时间。

从某种非常重要的意义上看，合并排序算法给出的O（n log n）线性对数时间肯定是我们可以得到的最佳效果。已经有人证明，如果通过一系列面对面直接比较的方法对n个事物进行完全排序，比较的次数不可能少于O（n log n）。这是一条普世法则，是不可能违背的。

但是，严格说来，这条法则并不能平息排序问题上的所有争议。有的时候我们并不需要完全排序，有的时候根本不需要逐项比较也能完成排序工作。正是因为有这两个原因，实践中的粗略排序速度也可以比线性对数时间快。桶排序算法非常漂亮地展现了这个特点，而普雷斯顿分类排序中心就是桶排序的一个完美实例。

在桶排序中，排序对象按照排序类别分成若干组，类别之间更精细的排序问题会被留到后面解决，在分组时不予考虑。（在计算机科学中，“桶”这个术语仅表示一组未排序的数据，但是，金县图书馆系统等现实世界中最有影响力的桶排序用户则把这个表达按照字面含义来理解。）对于这一步骤，有人提出反对意见：如果你希望将n个对象分装到m个桶中，分组工作需要的时间是O（mn），也就是说，时间一定与对象数量和桶数量的乘积成比例关系。但是，只要桶的数量与排序对象的数量相比显得比较小，大O符号就认为这个时间约等于O（n），即线性时间。

真正打破线性对数壁垒的关键，是了解排序对象的分布情况。如果桶选得不合适，排序的效果就不会太好。例如，如果所有的书都被投放到同一个箱子里，排序工作就没有任何进展。但是，如果桶选得非常合适，所有项目都被分到大小差不多的组里，就表明已经朝着完全有序前进了一大步（鉴于排序工作在本质上遵循“规模越大，难度越大”这条准则）。普雷斯顿分类排序中心的任务是按照目的地，而不是字母顺序，进行排序，因此在选桶的时候考虑的是流通统计数据。有的分支流通量比较大，因此他们就分配给这些分支两只箱子，有时甚至是三只箱子。

人在完成排序工作时，如果对排序对象有类似的了解，也会对他们有利。为了现场观看专家的排序工作，我们前往加州大学伯克利分校的主图书馆和墨菲特图书馆，进行了一次实地考察。这些图书馆的书架长度加起来至少有52英里，所有的书都靠人工整理。归还到图书馆的书首先被放到后台，然后根据美国国会图书馆藏书书目，重新放回到不同的书架上。例如，一组书架上放有一堆最近归还的书籍，藏书书目都在PS3000到PS9999之间。然后，学生助手将这些图书装到小车上，每车装150本，所有的书都以适当的顺序放置，以方便他们放回到图书馆的书架上。学生们都接受过一些基本的排序训练，但是一段时间之后，他们都会找到一些适合自己的办法。积累了一定经验之后，他们可以在不到40秒的时间里，就把小车上150本书全部排好次序。这些经验的主要作用是让他们预先知道这些书有哪些特点。

伯克利分校化学专业的学生乔丹·何是一位图书分类排序高手。他一边整理着PS3000-PS9999书架上的一大堆图书，一边告诉我们：

据我的经验，书目号在3500至3600之间的书很多，因此我首先找3500以下的书，先粗排，再细排。等3500以下的书都排好之后，我知道3500以上的书（也就是3500至3599这些书）是个大头，所以我想把这些书单独排好序。如果这些书的数量太多，我可能会进一步细分，分成3510-3519、3520-3529、3530-3539等。

乔丹总是把25本左右的书编成一组，全部排好序之后，装到小车上。排序的时候，他使用的确实是插入排序法。他精心想出来的办法是一种桶排序法。他事先就知道各种书目号对应的图书数量，因此他清楚应该如何选桶。结果，这个办法取得了非常好的效果。





排序是搜索的准备工作


掌握了这些排序算法，你下一次整理书架时就应该能派上用场。同奥巴马一样，你也会知道不能使用冒泡排序法。好的办法（得到图书馆工作人员和机器的共同认证）是使用桶排序，等到将排序对象分成足够小的组之后，再使用插入排序，或者干脆举办比萨派对，使用合并排序。

但是，如果你邀请计算机科学家帮助你完成这项工作，他们询问的第一个问题应该是：你到底为什么要整理这些图书？

老师经常告诉那些本科生，计算机科学研究的就是如何取舍的问题。在前面讲到观察与行动以及探索与利用之间的矛盾时，就已经讨论过这个观点。而排序与搜索之间的取舍是最重要的取舍问题之一，其基本原理是：人们投入精力为物品排序是一种先发制人的措施，目的是保证以后无须在搜索上投入精力。平衡点应该如何确定，取决于当时情况的具体参数，但是，如果认为排序的价值仅仅是为未来的搜索提供支持，那么你会有一个令人吃惊的发现：

混乱无序也无伤大雅！

如果你从来不在某些物品中搜索某个目标，那么为这些物品排序就纯粹是一种浪费。如果你从来不为某些物品排序，那么你在其中搜索的效率就会很低。

因此，摆在我们面前的问题已经变成如何提前预估未来的用途。

谷歌等互联网搜索引擎是排序带来的一个典型益处。很难想象，谷歌可以利用你输入的搜索词，在不到半秒的时间内搜索整个互联网。事实上，谷歌做不到，不过它也无须这样做。如果你是谷歌，你几乎可以肯定以下3点：（1）你的数据会被搜索；（2）它不仅会被搜索，而且会被多次搜索；（3）与搜索所需时间相比，排序所需时间“价值较低”。（这里，排序是由机器提前完成的，排序结果暂时无用；搜索是由用户完成的，而用户的时间非常宝贵。）所有这些因素都倾向于预先排序，而谷歌和其他搜索引擎也正是这样做的。

因此，你是否应该整理你的书架呢？大多数家庭并不具备支持整理书架的任何条件。我们几乎不会在书架上的藏书中搜索某个书名，因此无序搜索的成本非常低：任何一本书，只要我们知道它的大致位置，就可以快速地找到它。在井然有序的书架上找到一本书或许需要2秒钟，而在一个胡乱堆放的书架上找到一本书则可能需要10秒钟，但是两者之间并不存在难以接受的差距。我们因为迫切需要某本书，而宁愿预先花几个小时时间书架，为将来再找它省下几秒钟，这种情况几乎不会发生。此外，我们的双眼可以快速搜索，而双手排序的速度却非常慢。

结论很明确：整理书架与在书架上浏览一遍相比，前者需要更多的时间和精力。

你可能不会每天都关注乱七八糟的书架，但是电子邮件的收件箱绝对是搜索轻松击败排序的另一个舞台。人工将电子信息归档到文件夹中所花费的时间与在现实世界中纸质文件归档所需的时间差不多，但是电子邮件的搜索速度要比纸质邮件高得多。随着搜索成本的下降，排序的价值也会随之降低。

IBM的研究科学家、加州大学圣克鲁兹分校教授史蒂夫·惠特克是研究人们处理电子邮件方式的知名专家之一。近20年来，惠特克一直在研究人们是如何管理个人信息的。（1996年，他写了一篇关于“电子邮件过载”的论文，当时很多人甚至还没有电子邮箱。）2011年，惠特克领导了一项关于电子邮件用户搜索和排序习惯的研究，其研究结果发表在一篇名为“我整理电子邮件是一种浪费时间的行为吗？”的文章中。我在这里来个剧透吧：结论不仅是肯定，而且是非常肯定。惠塔克指出：“这是一种经验，同时也是一种体验。在采访中谈论这些邮件整理问题时，他们告诉我，他们通常会讨论这个问题，并且认为这件事浪费了他们大量时间。”

计算机科学表明，混乱的危害和秩序的危害是可以量化的，他们的成本都可以用时间这个“货币”来衡量。杂乱无序可能会被认为是一种拖延的行为——把责任推给未来的自己，而且还要连本带息偿还我们不愿意提前支付的债务。但是，详细情况还要更加微妙。有时，混乱不仅仅是轻松的选择，还是一个最优选择。





排序与体育


搜索与排序的取舍问题表明混乱状况有时反而更加有效。不过，节省时间不是排序的唯一原因，有时秩序本身就是我们追求的目标。最清楚这一点的非运动场莫属。

1883年，查尔斯·路特维奇·道奇森对英国草地网球的状况产生了令人难以置信的强烈情怀。他解释说：

不久前，我去观看草地网球锦标赛，一位十分沮丧的运动员引起了我对球赛目前采用的名次确定方法的注意。这位运动员在比赛中早早落败，因此彻底失去了获得奖牌的机会。令他感到屈辱的是，获得第二名的是他知道的一名远不如自己的运动员。

普通观众可能会把这种“哀叹”归咎于失败的痛苦，但道奇森并不是一个同情心泛滥的人，他是牛津大学数学系讲师，因此，在听到运动员的抱怨之后，他决定对体育赛事展开深入调查。

道奇森不仅仅是一个数学家（其实他几乎不记得自己是从事数学研究的）。现在，反而是他的笔名——刘易斯·卡罗尔更加广为人知。他以这个笔名写出了《爱丽丝漫游奇境记》以及大量其他深受欢迎的文学作品。他还将他的数学知识与文学天赋相结合，完成了一篇知名度略低的文章——《草地网球锦标赛：正确的名次确定方法以及现行方法辨误》。

道奇森针对的是单一淘汰赛。在这种赛制下，运动员两两对决，只要输掉一场比赛，就会被淘汰出局。道奇森的理由非常有说服力，他认为，货真价实的第二名有可能是被第一名淘汰的任何人，而不一定是最后才被淘汰的那名运动员。具有讽刺意味的是，奥运会设立有铜牌争夺赛，这个规定似乎表明我们知道单一淘汰模式无法确定第三名。[1]但是，这种赛制其实同样不足以确定第二名的归属，实际上，它只能准确地判断出谁是第一名。正如道奇森所说：“利用现行办法确定的名次，除了第一名，其他的都毫无意义。”直白地说，银牌是一种假象。

“作为一个数学事实，”他继续写道，“实力排第二位的运动员获得应得名次的机会只有16/31，而最优秀的4名运动员获得与实力相称名次的机会非常小，发生的概率为1/12！”

尽管道奇森的文章犀利有力，却没有对草地网球产生任何影响。他提出应该采取三败淘汰制（根据这种赛制，击败过你的运动员如果落败，也有可能导致你随之出局），但是这个提议根本没有人理会。不过，虽然道奇森的解决方案实施起来有很大的难度，但是他在这个问题上的看法仍然是有道理的。（可惜的是，至今为止，在单淘汰赛中，仍然会颁发银牌。）

不过，道奇森的逻辑还给我们带来了一个更加深刻的认识。我们人类不仅会对数据、财产进行排序，还会把我们自己变成排序对象。

世界杯、奥运会、美国全国大学体育协会（NCAA）、美国全国橄榄球联盟（NFL）、美国全国曲棍球联合会（NHL）、美国职业篮球联赛（NBA）和美国职业棒球大联盟（MLB），所有这些赛事都毫无疑问地使用了排序程序，利用赛季、排位赛和季后赛等算法排出先后关系。

体育运动中的循环赛制就利用了算法。如果一共有n支运动队，那么每支运动队最终都要和其余n-1支队伍比赛。这种赛制虽然可以说是最全面的，但也最费时费力。让每一支运动队都与其他所有队伍比赛，就像在晚宴上让客人两两拥抱一样，最终会需要可怕的O（n2）次角逐。

排位赛（在羽毛球、英式壁球和美式壁球等体育项目中比较常见）对运动员进行线性排序，每个球员都可以直接向排在前面一位的球员发起挑战，如果获胜，则交换排位。排位赛就相当于运动场上的冒泡排序，因此也是平方排序，需要O（n2）场比赛才能得到稳定的排名。

不过，最流行的赛制可能还是分组淘汰——著名的“疯狂三月”NCAA篮球赛就是其中一例。“疯狂三月”锦标赛的赛程包含“64强赛”“32强赛”到“甜蜜16强”“8强赛”“最后4强”和总决赛。每一轮都会导致比赛人数减半。与我们熟悉的对数排序很像吧？这种赛制其实就是合并排序，先让球队无序配对，然后进行一轮又一轮的比较。

我们知道合并排序需要线性对数时间［即O（n log n）］，因此，如果一共有64支队伍，可以预计比赛只需要进行6轮（一共192场），而采用排位赛或者循环赛，则需要多达63轮（2016场）比赛。这是一个巨大的改进，说明对数设计发挥了效用。

“疯狂三月”有6轮比赛，似乎没有问题，但是怎么是192场比赛呢？美国大学体育协会锦标赛不是只有63场比赛吗？

“疯狂三月”其实不完全是一种合并排序法，因为它并没有产生所有64支队伍的完整排序。要对所有球队进行排名，我们需要增加一组比赛才能确定第二名，确定第三名时又需要增加一组比赛，以此类推，比赛的总场次就会是一个线性对数函数。但是“疯狂三月”没有采取这种赛制。相反，就像道奇森抱怨的草地网球锦标赛一样，它采用的是一种单一淘汰制，被淘汰的球队是不排序的。这种赛制的优势在于它的线性时间。由于每场比赛正好淘汰一支队伍，因此，要让一支队伍留到最后，一共需要n-1场比赛。这是一个线性数字。不足之处是，这种赛制只能决出第一名，无法给出名次表。

具有讽刺意味的是，单淘汰赛制其实根本不需要任何赛制结构。只要在63场比赛中保持不败，就是唯一的冠军。举个例子，你可以选择一支球队担任“擂主”，然后接受其他队伍的挑战。一旦某支队伍挑战成功，击败擂主，就立刻成为新的擂主，然后继续接受挑战。然而，这种赛制有一个缺点：因为所有比赛无法同时进行，63场比赛需要安排成63轮。此外，有一支队伍有可能需要连续参加63场比赛，从疲劳这个角度看，这种赛制不是最理想的。

迈克尔·特里克的出生时间比道奇森晚100多年。在用数学知识解决体育问题这个方面，他或许算得上是21世纪最坚定的人。我们在前面讨论最优停止问题时已经说过特里克。从他非常不幸地把37%法则应用到他的爱情生活中到现在，已经过去几十年了，他现在不仅已经结婚，并成为美国职业棒球大联盟和多个美国大学体育协会（例如十大联盟、大西洋海岸分区）的主要赛程编排人员，他利用计算机科学，确定当年的对阵安排。

特里克认为，体育联盟不关心如何快速地确定排名。相反，体育运动的赛程安排需要保证整个赛季都处于一种紧张状态，而排序理论几乎不会关注这个问题。

例如，在美国职业棒球大联盟，我们常常发现分区的竞争非常激烈。如果我们不重视分区的安排，有些分区的竞争结果可能会在赛季之初就比出来了。但是，我们要保证在最后五周内，每支球队都要与分区内其他球队会面。这样安排是出于一个目的：到底谁还在竞争队伍中并不重要，但是所有球队在赛季最后五周里，都至少要在6场比赛里遭遇势均力敌的对手。在这种情况下，比赛的不确定性将保持到最后，因此观众才会对整个赛程或者赛季感兴趣。

更重要的是，体育运动当然不可能一味地追求减少比赛场次。如果不注意到这一点，计算机科学家就有可能觉得某些体育赛程神秘莫测。关于包含2430场比赛的棒球常规赛季，特里克说：“我们知道只要比较n log n次，就可以排出完整的名次表。每支球队的名次都会很清楚。如果他们关心的仅仅是名次，那么他们安排n2场比赛，而且从某种意义上讲，仅仅决出第一名，又是为什么呢？”换句话说，如果我们知道利用线性对数时间就可以完成完全排序，或者利用不到n场比赛就可以把在单淘汰赛中保持不败的球队送上冠军宝座，那么我们为什么要安排O（n2）场循环赛，然后再安排一些其他比赛呢？原因很简单，把比赛场次降到最少其实并不符合联盟的利益。在计算机科学中，不必要的比较总是多余的，浪费时间和精力。但在体育运动中，情况远非如此。毕竟，在很多方面，比赛本身就是意义所在。

[1]只有极少数情况下（例如，在拳击比赛中，从医学这个角度看，刚刚被击败的选手再次比赛是有危险的），两名运动员才会分享铜牌。





发牢骚的权利：噪声与健壮性


将算法应用于体育的另外一个方法，也许是更加重要的方法，即不要问我们应该在银牌上有多大的信心，而是看我们应该对金牌有什么样的信心。

迈克尔·特里克解释说，在一些体育项目中，“例如棒球，无论哪支球队，都会输掉30%的比赛，都会赢得30%的比赛”。对于单淘汰赛制而言，这个事实就会产生令人不安的影响。比如说，美国大学体育协会锦标赛在70%的比赛中是更强大的球队获胜，并且冠军需要在6场比赛中连续获胜，那么最好的球队只有0.7的6次方（不到12%）的概率夺冠！换句话说，联盟中最优秀的球队每10年才会夺得一次冠军。

在一些体育项目中，哪怕对一场比赛的结果有70%的信心，也可能会让人们过于相信最后的比分。加州大学圣迭戈分校的物理学家汤姆·墨菲利用数值模拟技术来研究足球，结果发现足球的得分通常比较低，因此比赛结果的随机性远远超出了大多数球迷的想象。他说：“如果比分是3：2，那么获胜球队实力强于对手的概率只有5/8……就我个人而言，我觉得这并不是一个难以接受的事实。即使是6：1的完胜，也有7%可能是统计学上的一个巧合。”

计算机科学家把这种现象称作噪声。我们目前所考虑的所有排序算法都假设我们可以完美地完成比较这个步骤，而且比较结果准确无误，绝不会发生优劣颠倒的情况。一旦你接受“带噪比测器”，计算机科学中被人们敬若神明的算法就会走下神坛，而受到最多诟病的算法也有死灰复燃的机会。

新墨西哥大学计算机科学教授戴夫·阿克利研究的是计算机科学和“人工生命”的交叉领域。他相信生物学对计算机有一定的借鉴意义。首先，在生物生活的世界中，几乎所有过程的可靠性都比不上计算机不可或缺的那种可靠性，因此必须从头开始，培养研究人员所谓的健壮性。阿克利称，从现在开始，我们也应该认识到算法健壮性的好处。

因此，尽管权威的编程巨著《排序与搜索》大胆地宣称：“冒泡排序并没有明显的可取之处。”阿克利和合作伙伴的研究却表明，冒泡排序等算法或许可以卷土重来。冒泡排序的效率的确低下——每次只移动一个位置，但是它们对抗噪声的能力比较强，远胜于合并排序等速度更快的算法（在这种算法中，每一次比较都有可能将一个物品移动非常长的距离）。合并排序的效率非常高，因此健壮性不足。在合并排序早期发生错误，就会像在第一轮淘汰赛中意外失利一样，不仅会使有望夺冠的球队希望破灭，还会把球员们的排名永久性地降到半数球队之后。[1]另一方面，排位赛与冒泡排序相似，意外失利只会让运动员的排名下降一个位置。

但是，在带噪比测器面前表现最好的并不是冒泡算法，获得这项殊荣的是一种叫作比较计数排序的算法。在该算法中，每个排序对象都会与其他对象做比较，从而统计出比该排序对象小的对象一共有多少个。这个数字可以直接表示该排序对象的排名。因为比较计数排序让所有的排序对象都结对比较，因此与冒泡排序一样，它也是一个平方时间算法。正因为如此，它在传统的计算机科学应用程序中并不是一个深受欢迎的选择，但是它的容错能力非常强。

这个算法的作用原理听起来应该很熟悉。比较计数排序与循环赛十分相似。换句话说，就像一个运动队参加常规赛一样：与同一赛区中所有其他球队一一对垒，并通过胜败记录决出名次。

在所有已知的算法中，包括平方时间算法和其他更优秀的算法，比较计数排序是最健壮的排序算法。了解这个事实应该可以帮助体育迷们正确面对某些具体情况。如果球队没有进入季后赛，就不要怨天尤人了。采用合并排序的季后赛有运气的成分，但是采用比较计数排序的常规赛是无法碰运气的。冠军戒指也许不是那么可信，但是分区的排名货真价实。换句话说，如果一支球队在季后赛早早出局，那是运气太差。但是如果一支球队不能进入季后赛，那这就是一个严酷的事实了。失望的球队球迷可能会在运动酒吧里向他们表示同情，但是计算机科学家不会心生任何怜悯。

[1]值得注意的是，美国大学体育协会的“疯狂三月”锦标赛有意识地采取了某些安排，以缓和算法中的缺陷。前面说过，单淘汰赛制的最大问题是实力排第二位的球队有可能第一个被击败淘汰，从而跌进名次表的下半部分（没有具体名次）。为了解决这个问题，美国大学体育协会采取了设立种子队的办法，这样排名靠前的球队不能在较早轮次中相遇。设立种子的效果似乎比较可靠，至少没有出现最极端的情况。在“疯狂三月”的历史上，16号种子从来没有击败过1号种子。





杀戮排序：啄食顺序与优势等级


在我们目前考虑的所有例子中，每一个案例中的排序过程都是按照自上而下的顺序进行的，例如图书管理员把图书上到书架上，美国大学体育协会告诉各运动队的赛程安排。但是，如果在纯粹自愿的情况下进行面对面直接比较呢？自下而上、按部就班地完成排序工作，情况又会怎么样呢？

这种情形可能与在线扑克游戏相似。

大多数体育运动都有这样那样的管理机构，但是在过去10年里迅速蹿红的扑克游戏仍然是一种无人管理的状态。尽管一些高知名度的赛事会确定参赛玩家的排名（作为发放奖金的依据），但是有相当一部分人仍然利用扑克玩“现金游戏”。两名以上玩家自发地达成一致之后，就可以在网上游戏，为每一手牌押上现金。

几乎没有人比艾萨克·哈克斯顿更了解扑克世界，他是世界上最好的扑克现金游戏玩家之一。在大多数体育运动中，只要可以充分发挥就足够了，无须过分在意自己的技术水平。但是，哈克斯顿解释说：“在某些方面，作为职业扑克玩家，最重要的技能是能够评估自己的水平。如果你不是世界上最优秀的扑克玩家，如果你总想和更优秀的玩家同台竞技，那么你最终必将倾家荡产。”

哈克斯顿是无限注单挑扑克游戏的专家。“单挑”的意思是一对一，而“无限注”的意思就是赌注不设上限，只要你的筹码和胃口可以接受就没有问题。在多人现金扑克游戏中，通常会有一个比较弱的玩家（比如一个富有的业余爱好者），他会把满桌子的职业玩家都喂饱。在这种情况下，那些赢家就不会太关心谁的牌更好。单挑游戏的情况完全不同，“你和对手肯定都认为自己的牌更好，除非有一方甘心认输”。

那么，如果大家的意见都非常一致，不愿意和更优秀的玩家游戏，会有什么样的结果？这种情况与玩家争取游戏席位非常相似。大多数在线扑克网站的牌桌数量有限。哈克斯顿说：“假设只有10张牌桌可以玩盲注为50美元和100美元的无限注单挑游戏，那么只有10个公认的水平最高的玩家能坐到桌边，等着人去和他们玩。”这时候，如果一个超级玩家坐到其中一张桌子上，会怎么样呢？如果原先坐在那里的那位玩家不愿下赌注，他们就都会离开那张桌子。

克里斯托弗·诺依曼说：“假设有两只猴子。一只猴子坐在那里，正在慢条斯理地吃东西。这时候，另一只猴子走了过来，来到第一只猴子的旁边。通常，第一只猴子就会站起来，离开那里。”

诺依曼并不是用猴子来比喻扑克牌游戏。他是纳沙泰尔大学的行为生物学家，研究方向是猕猴的优势等级。他举那两只猴子的例子，目的是介绍转位这个概念。

如果一个动物根据它对等级概念的了解，判断不值得实施某个对抗行为，就会发生转位这种现象。在很多动物群体中，资源、机会、食物、配偶、受欢迎的空间等都非常稀缺，因此群体必须决定如何分配这些资源和机会。预先建立好秩序是一种比较温和的机制，这样，当出现一个交配机会或者发现一片茂盛的草地时，群体成员不至于相互争斗。尽管看到生物利用利爪、坚喙互相攻击时，我们可能会感到不寒而栗，但生物学家常常把啄食顺序视为一种以暴制暴的预防手段。

听上去是不是有点儿耳熟？其实搜索与排序的取舍问题在本质上是一样的。

创立啄食顺序，可以从根本上解决一个重要的计算问题。顺便说一句，农场为鸡去喙以免彼此争斗的做法可能是出于好意，但是效果往往适得其反，因为它剥夺了个体为秩序而战的权利，这会大大增加了整个鸡群执行排序程序的难度。结果，在许多情况下，鸡群内部的对抗不减反增。

从计算机科学的角度看动物的行为，可以给我们几点启示，其中之一便是，随着群体增大，每个个体遭遇敌意对抗的次数就会显著增加（至少成对数增长，甚至是平方增长）。事实上，对母鸡“争斗行为”的研究发现，“每只母鸡的攻击性行为会随着鸡群增长而增长”。因此，排序理论表明，牲畜的“道德培养”可能包括限制牲畜的群体规模。（生活在野外的野鸡群规模在10~20只之间，远小于商业农场中的鸡群。）研究还表明，几周之后，攻击行为就会逐渐消亡，除非有新的成员加入群体。这个发现表明，动物群体是一个秩序井然的群体。

威斯康星大学麦迪逊分校复杂性计算及集体计算中心的联合主任杰西卡·弗莱克认为，要理解自然界中的这种分散排序，关键是要知道优势等级归根结底是信息等级。弗莱克指出，对于这些分散的分类系统来说，计算的难度非常大。例如，在猕猴群体中，只有在每只猴子都对等级关系有一个非常详细（而且彼此差不多）的理解时，打斗的频次才会降至最低，否则暴力事件就会层出不穷。

说到动物对当前秩序的了解程度，我们可能需要寄希望于它们的推理与记忆能力。只有提高这些能力，才会减少对抗。或许人类与最高效排序的距离最近。在说到扑克游戏时，哈克斯顿说：“我算不上是世界一流的单挑无限注德州扑克游戏玩家。我心中有一个非常具体的前20名优秀玩家排名表，我想他们心中也有类似的名单。我觉得，大家对这样一个名单的意见高度一致。”只有排名有分歧时，才会有现金游戏。





以竞争取代争斗


至此，我们已经知道了群体为成员排序造成的两个不利结果。随着群体规模扩大，你至少会遭遇线性对数次对抗，因此所有成员的生活将充斥各种斗争。此外，你还将迫使所有竞争对手了解其他所有成员变化不定的状态，否则他们就会遭遇不必要的战斗。因此，群体成员身心俱疲。

但是，这种情况完全是可以避免的，因为通过某些办法建立秩序不需要付出任何成本。

例如，有一项体育赛事仅利用一场比赛的时间，就将几万选手全部排好了次序。（反过来，一场有1万名运动员参加的循环赛，需要安排1000万场对决。）唯一需要注意的是，赛事所需的时间是由最慢的选手决定的。这项体育赛事就是马拉松比赛，它给了我们一个重要提示：竞争与争斗在本质上是不同的。

想一想拳击运动员和滑雪运动员之间、击剑运动员与赛跑运动员之间有什么不同。奥运拳击手必须冒着脑震荡的危险，参加O（log n）次（通常是4~6次）比赛，才能登上领奖台。如果让更多的运动员参加奥运会拳击比赛，就会危及所有人的健康。但是，无论有多少人参赛，俯式冰橇运动员、单板滑雪U型池专业选手都只需要跟重力进行一定场次的对赌。击剑运动员需要O（log n）次面对对手的利剑，而马拉松选手只需坚持完成一场比赛。如果用一个简单数值就可以表示运动员在赛场上的表现，那么就可以用常数时间算法来表示他们的比赛状态。

把“序数”（只能表示排名）变成“基数”（直接为某人的水平赋予一个度量）之后，自然不需要两两比较就可以为一群对象排好次序。因此，在建立优势等级时，也无须进行一对一的直接对决。《财富》杂志的世界500强名单，创建了一种企业等级制度，从这个意义上讲，该名单就是一种等级体系。为了在美国找到最有价值的公司，分析师不需要花费大量精力，将微软与通用汽车、通用汽车与雪佛兰、雪佛兰与沃尔玛等公司放到一起进行比较。借助美元这个媒介，这些看似不是同类事物之间的竞赛变成了同类事物的竞争。制定基准（无论这个基准是什么），就可以解决排序规模变大时导致的计算难题。

举个例子。硅谷有一条关于相互关系的格言：“你需要主动追逐财富，财富不会主动找上门。”因此，商贩需要找工厂业主，工厂业主需要找风险资本家，风险资本家需要找他们的有限合作人。个人有可能对这种等级关系的基础心怀怨恨，但是不会真的对它做出的“裁决”提出异议。因此，个体与个体为各自地位而争斗的情况非常少。总的来说，两个人走到一起，无须商量就知道应该向对方表示何种程度的尊重。每个人都清楚应该如何相处。

同样地，船舶海上通行权在理论上需要遵循一套极其复杂的惯例，但是在实践中，到底哪条船应该给另一方让路是由“总吨位法则”这条简单易行的原则决定的。很简单，小船为大船让路。一些动物很幸运，也建立了非常明确的优势等级。诺依曼说：“比如说鱼。它们的关系就非常简单，大鱼居于优势地位。”正因为简单，所以鱼类可以和平相处。与鸡和灵长类动物不同，鱼可以在不流血的情况下建立秩序。

人类社会规模如此庞大，到底是哪些因素使其成为可能的？我们很容易就会把目光投向农业、金属和机械等技术。但是，通过量化指标来测量社会地位的文化实践可能发挥了同样重要的作用。当然，金钱不应该是唯一标准。例如，像“尊敬长辈”这样的规则，同样可以通过参照某个常量，解决人们的地位问题。同样的原则也适用于国际与国内关系。人们经常注意到，国内生产总值（GDP）作为标准（例如GDP是G20等外交峰会确定邀请名单的一个重要依据），其本身是一个并不完善的粗略测量结果。确定一个国家的地位本来至少需要线性对数的争斗与决议，但是在建立基准之后，通过一个参考点，就可以确定所有国家的地位。鉴于国与国之间的地位纷争常常诉诸武力，标准的建立不仅节省了时间，更挽救了生命。

线性对数次争斗或许对小规模群体有效。的确，它们在自然界中真的可以奏效。但是，在通过两两比较（无论是口水战还是真刀实枪的战斗）确定各自地位的世界里，随着社会规模增大，对抗的数量会迅速失去控制。在工业规模的经营活动中，有成千上万的个人共享同样的空间，因此必须通过实现从序数到基数的飞跃，才能有效地建立秩序。

尽管我们抱怨现代社会的快节奏、高压生活把我们变成了一只只仓皇四顾的老鼠，但是，正因为现代社会以竞争取代争斗，才使人类脱颖而出，与猴子、鸡和老鼠划清了界限。



