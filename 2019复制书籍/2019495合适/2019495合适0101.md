# 第一章 卓有成效的匹配

怎样把肾衰竭患者和肾脏捐献者匹配起来？学生们想换宿舍，怎样的分配方式最有效率？好的算法可以实现好的分配。

有时仅仅改变一下组合的方式，事情的进展就会出人意料地顺利。更换队员使团队更和谐、朋友之间交换想要的东西，或是在需要到同一个地方出差两次时将日程压缩为一天，这些都是例子。

改变组合并非増减什么，只是对已有的事物重新进行排列组合。这种做法虽然简单却能让团队更好地发挥作用、得到想要的东西、更有效地利用时间。因此，改善组合对于推进事情的发展非常关键。

具体要怎样做呢？有没有已经确定的方法呢？本章以改变肾病患者和捐献者的配对组合为例探讨这个问题。

突然听到“肾脏”，也许有人会觉得莫名其妙：这本书是关于市场设计的，患者和捐献者的组合怎么会与经济学有关？到底经济学的世界里发生了什么？让我从肾脏开始说起。

交换肾源

人体有总长度超过 10 万千米的血管像网络一样遍布全身，血液在

其中不断循环，将氧和营养物质输送到身体各处。

血液在循环过程中会不断积累废弃物，肾脏对血液进行过滤，将这

些废弃物以尿液的形式排出体外。肾脏只有握紧的拳头大小，但每分钟就会有一升血液流过，是身体中流经血液量最大的脏器。

肾脏功能低于正常时的 30%，就称为肾功能不全，功能极度低下的状态称为末期肾功能不全。末期肾功能不全就是尿毒症，如果任其发展将无法维持生命。

因此，末期肾功能不全的患者经常要做血液透析。透析是在血管中通入细管以将体内的血液引流到体外的人工肾机过滤、再引流回体内的疗法。这种疗法每次要花 3 到 5 小时，每周 2 到 3 次，非常费时。

日本的透析技术水平已世界领先，但效果却有限。透析患者要忍受肾功能低下引发的各种症状，同时严格控制水分及食物的摄人。

根据日本透析医学会的公报，2011 年底日本国内有超过 30 万人接受透析。但是通过透析无法恢复肾功能，患者必须终身接受治疗。

这种情况下治本的疗法就是肾脏移植。一个人有两个肾，即使失去 ・个，生活（基本上）也不会有问题。所以如果有人愿意捐献一个肾给某个末期肾功能不全的患者的话，不仅患者可以得救，捐献者自己也不会有实质上的损害。这种做法称为活体移植。

也就是可以这样做：现在妻子患有末期肾功能不全，为了根治需要进行移植，丈夫愿意捐一个肾给自己的妻子。此时如果丈夫作为捐献者，将自己的肾移植到妻子体内，妻子就可以得救。

但是肾脏移植并非在任何人之间都可以进行。它和输血一样，对血

型有这样的要求

捐献者和患者血型相同，可以捐献肾脏。

・0 型捐献者可以给 A、B、AB 型患者提供肾脏，反之不可。A 型和 B 型捐献者可以给 AB 型患者提供肾脏，反之不可。

A 型和 B 型不能互相提供肾脏。

上述条件称为血型相符条件（图 1)。如果血型不相符却进行了移植患者的身体会将捐献者的肾脏判断为异物，发生强烈的排异反应。但是近年来在擅长肾脏移植的医院，即使血型不相符也可以采用有效的免疫抑制剂和高水平的医疗技术使移植成为可能（有关日本肾脏移植的情况后面我会谈到）

除血型以外，患者和捐献者的相容性对能否进行移植及移植后的存活率也有影响。举个例子，如果患者的血液中含有对捐献者淋巴球的抗

体，那么即使血型相符也无法进行移植。这种情况称为交又配型阳性（淋

巴球）

此外，如果两人的 HLA 抗原和 DR 抗原接近，肾移植的存活率会增加。有的患者被称为“高致敏性患者”，适合他们的肾脏类型很少，很难找到适合他们的捐献者。

接下来，我们将针对以血型来判断是否适合肾脏移植的情况进行探讨。后文，我们把血型相合的患者和捐献者简称为“适合组（对”（compatible pairs），反之简称为“不适合组（对”。例如 AB 型患者和 A 型捐献者就是“适合组”，而 A 型患者和 AB 型捐献者就是“不适合组（对）

现在考虑一个不适合组：“A 型患者和 B 型捐献者”。以目前的情况来看，他们无论如何都不适合移植。但如果此时有两个以上的不适合组，情况就不同了。因为也许两个患者互相交换捐献者，就可成功配对。

例如有两个不适合组

A 型患者和 B 型捐献者

B 型患者和 A 型捐献者

如果将捐献者对调，就变成：

A 型患者和 A 型捐献者

B 型患者和 B 型捐献者

这样，两组都成了适合组。这一构思看似是顺理成章的，但是它的

首创简直就是一种发明。

世界上最早进行捐献者交换是在 1991 年，韩国延世大学医院以交换捐献者的方式，对两个不适合组进行了肾脏移植手术。以朴基日（Kiil Park）博土为首的延世大学团队以此为开端，将不适合组的信息建立了数据库，进行患者和捐献者的交换。朴基日博土和同事的做法被整理成论文，19 年发表在专业移植学术期刊《移植》（Transplantation）上。论文透露，移植的肾脏存活

率很高。

延世大学医院为何会尝试交换捐献者呢？理由很简单，就是与期望

接受肾脏移植的患者相比，肾源十分紧缺。

这里所说的“肾源”有两种。一种来自活着的捐献者，也就是从活体取得肾脏，即活体肾移植；另一种是从心脏死亡者或脑死亡者那里取

得肾脏，称为捐肾移植。

捐肾移植通常从一个心脏死亡者或脑死亡者身上摘取两个肾脏，分别移植给两个患者。但是捐肾移植的数量实在太少，所以人们希望活体移植能够发挥更大的作用，这一想法促生了交换捐献者的构想。

继韩国之后，1999 年瑞士巴塞尔大学医院、2012 年美国约輸・霍普金斯大学医院也采取了同样的做法

在此期间韩国完善了制度。根据朴基日博士 2004 年向《移植》投稿的论文，1995 年至 2003 年韩国一共进行了 978 例活体移植，其中有 101 例通过捐献者交换项目实现，而且比例呈逐年上升趋势。关于捐献者交换，朴基日博士等人的论文带给我们两点启示

(1)3 组以上的循环（图 2)

当有 3 组以上的患者和捐献者时，在 3 组之间循环重组患者和捐献者可以增加适合匹配。例如下面这两个不适合组：

0 型患者和 B 型捐献者

B 型患者和 A 型捐献者

如果交换捐献者就成了：

0 型患者和 A 型捐献者

B 型患者和 B 型捐献者

现在，第一组仍旧是不适合，虽然第二组适合，捐献者交换仍然无法进行。

而此时如果加入“AB 型患者和 O 型捐献者”，就有 3 组

0 型患者和 B 型捐献者

B 型患者和 A 型捐献者

AB 型患者和 O 型捐献者

这个新加入的组合虽然血型相符，但出于其他原因例如交叉配型阳性而无法进行移植。

但是如果这样重新分配 3 个捐献者

0 型患者和 O 型捐献者 B 型患者和 B 型捐献者

AB 型患者和 A 型捐献者

所有组合都是适合组

这里 AB 型患者易于受肾、O 型患者容易供肾的特性发挥了作用，3

个不适合组都成为适合组。

(2) 始于捐献者的链条（图 3) 设现在有 3 个不适合组

0 型患者和 A 型捐献者 A 型患者和 B 型捐献者 B 型患者和 AB 型捐献者

希望大家注意一点，O 型患者和任何捐献者血型都不相符，也就是说无法将“0 型患者和 A 型捐献者”这一组包含在内完成循环。

那么是否可以在剩下两组

oA 型患者和 B 型捐献者

B 型患者和 AB 型捐献者

之间进行交换呢？

即使交换为

A 型患者和 AB 型捐献者

B 型患者和 B 型捐献者

前者仍然是不适合组，所以无法交换。也就是说这 3 组之间患者和

捐献者无论怎样交换都不行。

但是如果此时出现了一个无偿捐献自己肾脏的 O 型捐献者，情况就

变为

0 型捐献者

0 型虑者和 A 型捐献者 A 型虑者和 B 型捐献者 B 型患者和 AB 型捐献者

这就等同于

0 型虑者和 O 型捐献者 A 型患者和 A 型捐献者 B 型患者和 B 型捐献者

AB 型捐献者

这样，像链条一样连起来，可以进行连环重组。也就是说会诞生 3 组适合组。而多出来的“AB 型捐献者”今后可以作为其他链条的一环

发挥作用。

朴基日博土的论文用图解的方式对循环式交换和链条式交换做出了说明。那如果有很多个不适合组，要怎样找到循环和链条呢？只有 3 组的话稍加思素就能找到，但如果有很多组，比如 10 组的话，就不能依靠直觉了。循环很难信手拈来，即使找到一个循环也无法判断它和其他可能的循环相比孰优孰劣。

此时就需要考虑，不依赖偶然和直觉，如何每次都能找到好的循环。也就是说，我们需要找到系统的解法，即计算机科学中所说的“算法”algorithm）。当然也必须考虑究竟何谓“好的”循环。

此外，触发链条的充满爱心的捐献者会出现吗？如果出现的话，应该怎样构成链条呢？世界并不是个爱心泛滥的地方，所以当善意出现时更要尽可能做到物尽其用。因此我们需要算法，规划出最佳的匹配链条。朴基日博士等人的论文并未意识到这些技术性问题。

这是个经济学问题？

将患者和捐献者进行系统重组的做法称为“肾脏移植匹配”。把肾脏移植匹配看作经济学问题，并首先采用匹配理论进行分析的是阿尔文・罗斯、森梅兹（Tayfun Sonmez）和云韦尔（Utku Unver) b 以他们的研究为开端，肾脏移植匹配研究取得了进展，朴基日博士等人的想法得以

实现。

在讲解罗斯等人的研究内容之前，我们先来考虑一个问题：将本章开头提到的组合患者和捐献者的研究归到经济学中是否恰当呢？这个问

题对于理解肾脏移植匹配乃至市场设计来说都是关键

结论是，肾脏移植匹配完完全全是经济学问题。

之所以这样说，是因为肾脏移植匹配研究的问题是，如何在需求肾脏的患者和提供肾脏的捐献者之间实现供求平衡，这就意味着要在社会上合理有效地分配肾脏这种稀缺资源。

供求平衡这个概念从 19 世纪 70 年代里昂・瓦尔拉斯正式进行分析以来，一直在经济学中发挥着核心作用，稀缺资源的分配问题也是一样。从这个意义上来说，肾脏移植匹配属于经济学的研究范围之内。通常教科书会说经济学的核心理念是“市场会实现供求平衡”，与之相对，肾脏移植匹配等大量市场设计的研究，关注的是“怎样设计机制，才能实现供求平衡”。也就是说，这门学问是要从好的结果倒推出好的制度。这种思维方式也是市场设计这个学术领域的特点

那么，肾脏移植匹配的特殊性在哪里呢？包括日本在内的几乎所有国家都禁止包含肾脏在内的器官买卖。既然不允许肾脏买卖，那么建立肾脏市场，通过交易的方式解决问题就不可能合法。

肾脏交易合法化的一个巨大隐忧就是在家庭处于弱势的人会被迫卖掉肾脏。类似地，在战前穷困的日本就曾出现过为了少张嘴吃饭而卖儿

鬻女的情况。

另一方面，经济学中有所谓“机会成本”（Opportunity Cost）的概念：做出某个选择也就意味着放弃了其他选择可能带来的好处，这是一种潜

在成本。

禁止肾脏交易的机会成本，包括原本可以得救的生命无法被拯救，以及完全无视靠卖肾才能生存下去的人的贫困等。所以说，不分青红皂白地全面禁止肾脏交易，也不见得是绝对正确的做法。但是现在包括日本在内的所有发达国家（译者注：世界所有国家和地区）都完全禁止器官交易，而且大多数人都对此持支持态度。

既然事实如此，那么以此为前提，设计出让社会认同的机制就很重要。人们排斥器官买卖，但是很多人可以接受患者和捐献者交换，因此

我们可以考虑交换的可能性。

Market Design 翻译过来就是“市场设计”，但是这里的“市场”不仅指普通市场。如前所述，市场设计中常常会使用市场思维，设计出使

供求达到平衡的机制

如果每人只需要一个肾脏

罗斯、森梅兹和云韦尔在 2004 年的《经济学季刊》（The Quarterly Journal of Economics）上共同发表了题为《肾脏交换》（Kidney Exchange 的论文。当时“市场设计”这个词尚未为学术界所熟知，谁都没有想到，

经济学的智慧可以运用到肾脏移植上。

从理论上说，他们的肾脏移植匹配模型源于罗伊德・沙普利和赫伯

特斯卡夫（Herbert Scarf）所创的“住宅市场模型”。也许有人会想，肾脏移植为什么会和住宅扯上关系，这是因为肾脏和住宅在“每人只需一个”这一点上是一致的

沙普利生于 1923 年，是加利福尼亚大学洛杉矶分校名誉教授。我在前言中提过，2012 年他和罗斯共同获得了诺贝尔经济学奖。斯卡夫生于 1930 年，是耶鲁大学名誉教授，开发了使用计算机找

出市场均衡的算法，证明了以合作行为为特征的市场均衡极限定理。他们以住宅市场模型为对象的论文《核与不可分割性》（On Cores and Indivisibility）发表在 1974 年的《数理经济学》（Journal of Mathematical Economics) E

所谓住宅市场模型是这样的：现在有学生宿舍，入住了很多学生。每个学生有一个房间，各房间的位置、日照及房租等各项条件有所不同。

有的学生觉得“比起我现在的房间，还是那个房间更好”。比如有人会想：“现在的房间日照是好，但是反正白天也不在房间里，暗一点也可以，我想换到房租便宜的房间。”还有人觉得：“房租稍贵点也没关系想换一个大点的房间。”

于是，对现有房间不满意的学生为了交换房间聚在一起。但是并不强迫来了就必须换，也不保证可以换到期望的房间。

这里最基本的约定是保证每个人都不会换到比现在更不满意的房间这一最基本条件。该条件称为个体合理性（Individual Rationality)

如果把这一情况与肾脏移植匹配相对照，学生就相当于患者，房间就相当于捐献者，现在所住的房间相当于不适合的捐献者，比现在的要好的房间相当于适合的捐献者。个体合理性条件意味着“不会和不适合的捐献者配对”。

接下来我们通过简单的例子来说明住宅市场模型。现在有四个学生 1、2、3、4, 各自在学生宿舍有自己的房间。为了使问题简化，每个学生现在所住的房间以该学生的名字命名。也就是说，现在学生 1 住房间 1, 学生 2 住房间 2, 学生 3 住房间 3, 学生 4 住房间 4。他们都对现在的房间不满意并且按照自己的个人好恶，为 4 个房间（房间 1、2、3、4) 排了优先次序。

来看一下这个表格，对于学生 1 来说排序是这样的：最好的是房间 4, 其次是房间 3, 第三位是房间 2, 第四位是房间 1。这个排序称为偏

好（Preference)

在此例中，要满足“所有人都不会换到比现在更不满意的房间”这一个体合理性条件，十分容易。因为原本学生 1、3、4 就住在自己最不喜欢的房间，所以也就不可能换到比现在更不满意的房间。也就是说这里的个体合理性仅仅是要求学生 2 不会换到房间 1 去。满足这项条件的

学生和房间的组合有很多，那么在这些组合中应该如何选择呢？我们将后文对学生和房间的重新组合称为分配（Imputation）我们

先考虑这样一组分配

分配 A：学生 1 住房间 3, 学生 2 住房间 4, 学生 3 住房间 1, 学生 4 住房间 2

分配 A 满足了个体合理性，但是该分配仍然有改善的余地。因为如果学生 1 和学生 2 在此基础上交换房间，他们都能换到最理想的房间。

也就是说

分配 B：学生 1 住房间 4, 学生 2 住房间 3, 学生 3 住房间 1, 学生 4 住房间

优于分配 A，这称为分配 B 对分配 A 进行了帕累托改进（Pareto Improvement

让我们在偏好表中，将分配 A 用口、分配 B 用 O 圈起来确认一下。

分配 A 被分配 B 帕累托改进。像这样，如果某个分配会被别的分配帕累托改进，就说明在不会使任何人处境变差的情况下，还有余地让某个人的情况变好，也就是说，资源没有处在最优分配的状况，尚未得到最好效率的利用。就拿分配 A 来说，它仍有通过交换来改善状况（既不给学生 3、4 带来不好的影响又可以让学生 1 和 2 更幸福）的余地。已经没有空间进行帕累托改进的分配，被称为达到帕累托最优（Pareto Efficiency），分配 A 就没有达到帕累托最优。学生们都想换到更理想的房间，所以，寻找满足帕累托最优的分配十分合理。那么分配 B 同时满足了个体合理性和帕累托最优，我们就应该选择它吗？事情并非如此简单，因为还存在同时满足个体合理性和帕

累托最优的其他分配。

例如：

分配 C：学生 1 住房间 4, 学生 2 住房间 3, 学生 3 住房间 2, 学生 4 住房

间

很容易确定它同时满足个体合理性和帕累托最优。

而且分配 B 和分配 C 之间相互不存在帕累托改进关系。因为对于学

生 1 和 2 来说，分配 B 和 C 一样，对于学生 3 来说分配 C 更好，而对于学生 4 来说分配 B 更好。让我们在和上面同样的表格中将分配 B 用、分

配 C 用△圈起来确认一下。

①用分配 C 代替分配 B，虽然学生 3 的境况改善了，学生 4 的境况却恶化了，所以分配 C 并不是分配 B 的帕累托改进。反之同理。

那么分配 B 和分配 C 应该选择哪一个呢？我们来考虑一个新的判断

标准。

如果采用分配 B，学生 2 得到了房间 3, 学生 3 得到了房间 1。但是当大家决定“那就选分配 B 吧”的时候，学生 2 和 3 两人说“我们还是不参加了”，抢在大家前头只在他们两人之间交换房间，这样学生 2 就可以得到房间 3, 学生 3 得到房间 2。

和分配 B 相比，这样做学生 2 仍然分得房间 3, 这一点没有变化，但是学生 3 可以得到（比房间 1) 更令其满意的房间 2。这次抢先交换学生 2 无损无得，但是如果他和学生 3 关系好，或者偷偷从他那里收了钱的话，这样的私下协议就可能会发生。像这样由小集团发起的私下协议，称为阻止（Block)

也许可以事先规定禁止“阻止”。但是如果这样的话，学生 2 和 3 可能从一开始就不会参加房间交换。参与者减少，交换的选择面就会变窄，效果就不理想。

不会发生阻止的分配称为强核配置（Strong Core Allocation），它

具备两个优点。首先从定义上来说，一且确定“用这个分配（强核配置ア，就不可能发生私下协议。

不可能发生私下协议，也就意味着这个分配会给予全体成员通过任何协议都无法实现的高度满足，这也意味着学生参与交换不会失去什么。也就是说强核配置可以有效地防止“阻止”，而且具有公平性。在这个例子中，分配 C 是强核配置，不存在其他强核配置。再进一步说，强核配置必然满足个体合理性和帕累托最优。因为个体合理性要求“不会有某个人因退出分配而受益”，帕累托最优要求“所有参与者作为一个整体不会因私下协议而受益”。而强核配置要求“无论某个人还是所有人，都不存在通过退出分配或私下协议而受益的可

能”，所以强核配置必然满足个体合理性，而且满足帕累托最优。

下面强调两个关于强核配置的重要事实：

事实 1 强核配置一定存在。也就是说，无论有多少学生，他们

的偏好如何，以实现强核配置为目标都是有意义的。

事实 2 强核配置一定唯一。这个结果让人意外，因为人们通常会觉得如果学生很多的话分配整体的数量也会变大，所以分配的数量应该也会增加。但是住宅市场模型中，强核配置在任何时候都是唯一的。也就是说要实现强核配置，不需要犹豫选择哪一个强核配置。

事实 1 由沙普利和斯卡夫在 1974 年发表的论文中证明，事实 2 由罗斯和安德鲁・波斯尔思韦特（Andrew Postlethwaite)1977 年刊登在《数理经济学》上的论文中揭示。

罗斯当时是刚刚取得博士学位的年轻研究人员。他在理论实践层面的研究获得了较多褒奖，其实他在基础理论研究方面也做出了很多重要贡献。

通过上述两个事实我们可以知道，在住宅市场模型中强核配置永远是唯一的。但不能轻易说那就选强核配置吧，因为存在一个很大的问题：要选择强核配置必须先找到它。

“某个事物存在”和“有找到它的方法”是两回事。知道有德川宝藏在，但是不知道在哪里，还是不能解决问题。

在住宅市场模型中，分配表示学生和房间的组合

假设现在有 n 个学生（和 n 个房间），分配的方式就有 n 的阶乘

n! =n× (n-1) x…×2 x1 种。

这个数字会随着人数的增加而迅速增大。当只有 3 个学生时分配方式不过 6 种而已；但如果有 10 个学生的话，分配方式就会超过 360 万种要逐一确认超过 360 万种的分配方式是否是强核配置，工作量很大。

有 10 个学生时，结盟成小集团的方式会超过 1000 个。所以哪怕仅仅针对一种分配方式，要确认其是否是强核配置也是非常困难的，花费

时间做这样一一检视很不现实。

①传说徳川幕府在幕末时期秘密埋藏的金银宝藏。一译注

解决这个问题的方法是由戴维・盖尔发明的最适交易循环算法（Top

trading Cycles Algorithm，以下称为 TC 算法）。

什么样的算法能解决问题？

戴维・盖尔是一名数学家，生于 1922 年，长期任加利福尼亚大学伯

克利分校教授，2008 年去世，终年 86 岁。虽然盖尔是一个数学家，但是他的研究也涉及很多博弈论、经济学等社会科学方面的内容。1980 年他获得了运筹学方面的最高奖项一冯·诺依曼奖

盖尔发明的 TTC 算法 1974 年首次在沙普利和斯卡夫的论文中以“该内容由盖尔首创”的形式公开发表。

因为不是登载在盖尔自己的论文中，所以在写与 TC 算法有关的书或者论文时，总要先说明“由盖尔编写的 TTC 算法”，然后引用沙普利和斯卡夫的论文（本书也是如此）

可能当时盖尔自己也没太意识到该算法的里程碑意义吧。

TTC 算法是在极短的时间内找到强核配置的算法。我们通过下面这个 7 个学生交换房间的例子来看看该算法是否有这样的威力。

大家能一眼望去就找到强核配置吗？我在上课时经常提这个问题。要找到很难，一般来说找不到。之前最常听到的学生答案是“学生 1 住房间 6, 学生 2 住房间 3, 学生 3 住房间 5, 学生 4 住房间 2, 学生 5 住房间 4, 学生 6 住房间 7, 学生 7 住房间 1”（下表中用口标出）。

这个分配中所有人都可以住在对自己来说满意度排在前两位的房间，看起来确实不错。我每次听到这个答案时也都很佩服能找到这个分

配的学生，觉得他很聪明。

但实际上这是一个圈套：该分配并非强核配置。因为如果像下表中画⊙的那样，学生 1、4、5 抢在全体前面仅在他们 3 个人之间进行交换：学生 1 住房间 5, 学生 4 住房间 1, 学生 5 住房间 4 一这样做对他们来

说更有利（学生 5 没有变化）。

那怎样才是强核配置呢？

答案是：“学生 1 住房间 5, 学生 2 住房间 3, 学生 3 住房间 2, 学生 4 住房间 1, 学生 5 住房间 4, 学生 6 住房间 6, 学生 7 住房间 X 下表中的 O”。强核配置是唯一的，再无其他。

现在有 7 个学生，分配方式总共有 7 的阶乘-5040 种。但在强核配置之外还有 5039 个组合，无论哪一个都必然会发生某个小集团结盟。考虑到这一点，它的唯一性仍然成立就让人很吃惊。刚才提到的那个经常被错认为是强核配置的解，看起来确实不错就连我也这么觉得。一直盯着偏好表看，的确会感觉这个分配很好。但问题是“哪一个是强核配置”？所以它并非正确答案。光用眼睛看很难得到正确答案，需要严谨的解法。

面对这类问题，TC 算法就是解法。采用 TYTC 算法来寻找，比町着看还要多花费一些时间。但是这个算法结构简单，普通人也能理解。

顺便说一句

我在美国留学时曾经用拙劣的英语向 50 来岁的主妇

们解释这种算法，她们也能理解。当时我的英语很差，甚至“but”的音都发不好（后来稍有进步）。那为什么还可以表述清楚呢，就是因为该算法的构成就像人的动作一样，很容易用感觉来理解。那么 TY℃算法是如何寻找强核配置的？我们以上页的偏好表为例逐

步讲解

O 第一轮

每个学生用手指出对自己来说排在首位的房间，这里用箭头表示“用

手指”，就是

4→1

4

6→7

例如 1→5, 就是学生 1 指了房间 5。把箭头连起来就会发现一个闭

循环

1→5→4→1

所谓循环，顾名思义就是开头和结尾相同的一串箭头的连接。箭头指向想要的东西，接照这个循环分配给学生 1 房间 5, 学生 5 房间 4, 学

生 4 房间 1。这样学生

的房间确定，他们离开。

O 第二轮

现在剩下的学生是 2、3、6、7, 他们也指出了剩下房间中自己最满意的房间

3-→2

6 77

用箭头连接起来就得到循环

7

7→7 很短，但也是一个完整的循环。和第一轮一样，分给学生 2 房间 3, 学生 3 房间 2, 学生 7 房间 7

这样学生 2、3、7 的房间确定，他们离开。

O 第三轮

现在只剩下学生 6, 他也要指出剩下房间中自己最满意的房间。但是现在只剩下房间 6, 所以他只能指 6, 也就是 6→6 学生 6 被分配了房间 6, 他也离开了，算法到此结束。将上述结果

归纳如下，这就是强核配置。

这个例子经过三轮算法结束。在 TTC 算法中，无论偏好如何，每轮必定会形成一个循环，所以每次最少会有一个人离开。

也就是说，如果有 n 个学生，无论花费多少时间，最多经过 n 轮，

所有人就一定会离开，TC 算法结束。

前面说过，有 n 个学生参与时分配的方法共有 n 的阶乘 n！种，随着 n 增大，分配方法也会迅速増加。而在实际运用 TC 算法时所需要的最

多步骤，往往和学生数相等，也是 n。

也就是说即使参与者的范围不断扩大，但计算所需的时间増加有限，可以说这个算法的运算速度很快。

我们再来看一个例子熟悉一下 TC 算法，这个例子在下节的讨论中

还会用到。

O 第一轮

每个学生指出对自己来说排在首位的房间

4→3

5→4

6→4

用箭头连接起来就找到循环 1→3→2→1。于是学生 1 得到房间 3, 学生 3 得到房间 2, 学生 2 得到房间 1, 他们离开。

O 第二轮

现在剩下的是学生 4、5、6, 这些学生在剩下的房间中指出自己最

满意的房间：

4 4

用萧头连接起来会得到循环 4→6→4, 于是学生 4 得到房间 6, 学

生 6 得到房间 4, 他们高开

O 第三轮

此时剩下的只有学生 5 了，他指了房间 5, 循环就是 5→5, 学生 5

得到了房间 5 离开

所有人都离开了，算法结東。将以上结果归纳如下，就是唯一的强

核配置

小算盘无效，说实话才是上策

在 TTC 算法中，学生们在报告最满意的房间时会不会考虑“那个房间确实最好，但是人气最高，还是退而求其次选择其他房间吧”呢？换种说法，就是选择策略性地隐瞒自己真实的偏好，做虚假的报告。这

样的做法是否为上策呢？

来看一个小选区制选举的例子。有的选民为了避免自己的选票不能发挥作用，常常避免将票投给胜算不高的政党。“其实最喜欢这个候选人但是他很难胜出，还是投给仅次于他的有可能获胜的候选人吧。因为选举规则是多数获胜，诚实地投票未必是上策。TC 算法会不会也可能发生同样的情况，也就是说有时不表露出最想要的而是选择第二第三满意的房间反而会更有利呢？

实际上只要使用这个算法，就完全不存在通过虚假报告而获利的可能。T℃算法所具备的这种性质称为防策略性（strategy- proof），已被罗

斯证明。

让我们用刚オ的例子确认一下虚假报告无法得利。我们将使用 TTC

算法得到的结果用标出。

